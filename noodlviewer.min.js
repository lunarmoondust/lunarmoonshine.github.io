!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Application=a()}}(function(){var b;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g||b===l?62:b===h||b===m?63:b<i?-1:b<i+10?b-i+26+26:b<k+26?b-k:b<j+26?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;d<g;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;e<g;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0),l="-".charCodeAt(0),m="_".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}("undefined"==typeof c?this.base64js={}:c)},{}],2:[function(a,b,c){function d(a,b){return 1-3*b+3*a}function e(a,b){return 3*b-6*a}function f(a){return 3*a}function g(a,b,c){return((d(b,c)*a+e(b,c))*a+f(b))*a}function h(a,b,c){return 3*d(b,c)*a*a+2*e(b,c)*a+f(b)}function i(a,b,c,d,e){var f,h,i=0;do h=b+(c-b)/2,f=g(h,d,e)-a,f>0?c=h:b=h;while(Math.abs(f)>n&&++i<o);return h}function j(a,b,c,d){for(var e=0;e<l;++e){var f=h(b,c,d);if(0===f)return b;var i=g(b,c,d)-a;b-=i/f}return b}function k(a,b,c,d){if(4===arguments.length)return new k([a,b,c,d]);if(!(this instanceof k))return new k(a);if(!a||4!==a.length)throw new Error("BezierEasing: points must contains 4 values");for(var e=0;e<4;++e)if("number"!=typeof a[e]||isNaN(a[e])||!isFinite(a[e]))throw new Error("BezierEasing: points should be integers.");if(a[0]<0||a[0]>1||a[2]<0||a[2]>1)throw new Error("BezierEasing x values must be in [0, 1] range.");this._str="BezierEasing("+a+")",this._css="cubic-bezier("+a+")",this._p=a,this._mSampleValues=r?new Float32Array(p):new Array(p),this._precomputed=!1,this.get=this.get.bind(this)}var l=4,m=.001,n=1e-7,o=10,p=11,q=1/(p-1),r="function"==typeof Float32Array;k.prototype={get:function(a){var b=this._p[0],c=this._p[1],d=this._p[2],e=this._p[3];return this._precomputed||this._precompute(),b===c&&d===e?a:0===a?0:1===a?1:g(this._getTForX(a),c,e)},getPoints:function(){return this._p},toString:function(){return this._str},toCSS:function(){return this._css},_precompute:function(){var a=this._p[0],b=this._p[1],c=this._p[2],d=this._p[3];this._precomputed=!0,a===b&&c===d||this._calcSampleValues()},_calcSampleValues:function(){for(var a=this._p[0],b=this._p[2],c=0;c<p;++c)this._mSampleValues[c]=g(c*q,a,b)},_getTForX:function(a){for(var b=this._p[0],c=this._p[2],d=this._mSampleValues,e=0,f=1,g=p-1;f!==g&&d[f]<=a;++f)e+=q;--f;var k=(a-d[f])/(d[f+1]-d[f]),l=e+k*q,n=h(l,b,c);return n>=m?j(a,l,b,c):0===n?l:i(a,e,e+q,b,c)}},k.css={ease:k.ease=k(.25,.1,.25,1),linear:k.linear=k(0,0,1,1),"ease-in":k.easeIn=k(.42,0,1,1),"ease-out":k.easeOut=k(0,0,.58,1),"ease-in-out":k.easeInOut=k(.42,0,.58,1)},b.exports=k},{}],3:[function(a,b,c){},{}],4:[function(a,b,c){(function(b){"use strict";var d=a("buffer"),e=d.Buffer,f=d.SlowBuffer,g=d.kMaxLength||2147483647;c.alloc=function(a,b,c){if("function"==typeof e.alloc)return e.alloc(a,b,c);if("number"==typeof c)throw new TypeError("encoding must not be number");if("number"!=typeof a)throw new TypeError("size must be a number");if(a>g)throw new RangeError("size is too large");var d=c,f=b;void 0===f&&(d=void 0,f=0);var h=new e(a);if("string"==typeof f)for(var i=new e(f,d),j=i.length,k=-1;++k<a;)h[k]=i[k%j];else h.fill(f);return h},c.allocUnsafe=function(a){if("function"==typeof e.allocUnsafe)return e.allocUnsafe(a);if("number"!=typeof a)throw new TypeError("size must be a number");if(a>g)throw new RangeError("size is too large");return new e(a)},c.from=function(a,c,d){if("function"==typeof e.from&&(!b.Uint8Array||Uint8Array.from!==e.from))return e.from(a,c,d);if("number"==typeof a)throw new TypeError('"value" argument must not be a number');if("string"==typeof a)return new e(a,c);if("undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer){var f=c;if(1===arguments.length)return new e(a);"undefined"==typeof f&&(f=0);var g=d;if("undefined"==typeof g&&(g=a.byteLength-f),f>=a.byteLength)throw new RangeError("'offset' is out of bounds");if(g>a.byteLength-f)throw new RangeError("'length' is out of bounds");return new e(a.slice(f,f+g))}if(e.isBuffer(a)){var h=new e(a.length);return a.copy(h,0,0,a.length),h}if(a){if(Array.isArray(a)||"undefined"!=typeof ArrayBuffer&&a.buffer instanceof ArrayBuffer||"length"in a)return new e(a);if("Buffer"===a.type&&Array.isArray(a.data))return new e(a.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},c.allocUnsafeSlow=function(a){if("function"==typeof e.allocUnsafeSlow)return e.allocUnsafeSlow(a);if("number"!=typeof a)throw new TypeError("size must be a number");if(a>=g)throw new RangeError("size is too large");return new f(a)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{buffer:5}],5:[function(a,b,c){(function(b){"use strict";function d(){function a(){}try{var b=new Uint8Array(1);return b.foo=function(){return 42},b.constructor=a,42===b.foo()&&b.constructor===a&&"function"==typeof b.subarray&&0===b.subarray(1,1).byteLength}catch(c){return!1}}function e(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(a){return this instanceof f?(f.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof a?g(this,a):"string"==typeof a?h(this,a,arguments.length>1?arguments[1]:"utf8"):i(this,a)):arguments.length>1?new f(a,arguments[1]):new f(a)}function g(a,b){if(a=p(a,b<0?0:0|q(b)),!f.TYPED_ARRAY_SUPPORT)for(var c=0;c<b;c++)a[c]=0;return a}function h(a,b,c){"string"==typeof c&&""!==c||(c="utf8");var d=0|s(b,c);return a=p(a,d),a.write(b,c),a}function i(a,b){if(f.isBuffer(b))return j(a,b);if(Y(b))return k(a,b);if(null==b)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(b.buffer instanceof ArrayBuffer)return l(a,b);if(b instanceof ArrayBuffer)return m(a,b)}return b.length?n(a,b):o(a,b)}function j(a,b){var c=0|q(b.length);return a=p(a,c),b.copy(a,0,0,c),a}function k(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function l(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function m(a,b){return f.TYPED_ARRAY_SUPPORT?(b.byteLength,a=f._augment(new Uint8Array(b))):a=l(a,new Uint8Array(b)),a}function n(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function o(a,b){var c,d=0;"Buffer"===b.type&&Y(b.data)&&(c=b.data,d=0|q(c.length)),a=p(a,d);for(var e=0;e<d;e+=1)a[e]=255&c[e];return a}function p(a,b){f.TYPED_ARRAY_SUPPORT?(a=f._augment(new Uint8Array(b)),a.__proto__=f.prototype):(a.length=b,a._isBuffer=!0);var c=0!==b&&b<=f.poolSize>>>1;return c&&(a.parent=Z),a}function q(a){if(a>=e())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+e().toString(16)+" bytes");return 0|a}function r(a,b){if(!(this instanceof r))return new r(a,b);var c=new f(a,b);return delete c.parent,c}function s(a,b){"string"!=typeof a&&(a=""+a);var c=a.length;if(0===c)return 0;for(var d=!1;;)switch(b){case"ascii":case"binary":case"raw":case"raws":return c;case"utf8":case"utf-8":return R(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return U(a).length;default:if(d)return R(a).length;b=(""+b).toLowerCase(),d=!0}}function t(a,b,c){var d=!1;if(b|=0,c=void 0===c||c===1/0?this.length:0|c,a||(a="utf8"),b<0&&(b=0),c>this.length&&(c=this.length),c<=b)return"";for(;;)switch(a){case"hex":return F(this,b,c);case"utf8":case"utf-8":return B(this,b,c);case"ascii":return D(this,b,c);case"binary":return E(this,b,c);case"base64":return A(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function u(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;g<d;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))throw new Error("Invalid hex string");a[c+g]=h}return g}function v(a,b,c,d){return V(R(b,a.length-c),a,c,d)}function w(a,b,c,d){return V(S(b),a,c,d)}function x(a,b,c,d){return w(a,b,c,d)}function y(a,b,c,d){return V(U(b),a,c,d)}function z(a,b,c,d){return V(T(b,a.length-c),a,c,d)}function A(a,b,c){return 0===b&&c===a.length?W.fromByteArray(a):W.fromByteArray(a.slice(b,c))}function B(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;e<c;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(e+h<=c){var i,j,k,l;switch(h){case 1:f<128&&(g=f);break;case 2:i=a[e+1],128===(192&i)&&(l=(31&f)<<6|63&i,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],128===(192&i)&&128===(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j,l>2047&&(l<55296||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128===(192&i)&&128===(192&j)&&128===(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k,l>65535&&l<1114112&&(g=l))}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return C(d)}function C(a){var b=a.length;if(b<=$)return String.fromCharCode.apply(String,a);for(var c="",d=0;d<b;)c+=String.fromCharCode.apply(String,a.slice(d,d+=$));return c}function D(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;e++)d+=String.fromCharCode(127&a[e]);return d}function E(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;e++)d+=String.fromCharCode(a[e]);return d}function F(a,b,c){var d=a.length;(!b||b<0)&&(b=0),(!c||c<0||c>d)&&(c=d);for(var e="",f=b;f<c;f++)e+=Q(a[f]);return e}function G(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function H(a,b,c){if(a%1!==0||a<0)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function I(a,b,c,d,e,g){if(!f.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(b>e||b<g)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range")}function J(a,b,c,d){b<0&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);e<f;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function K(a,b,c,d){b<0&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);e<f;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function L(a,b,c,d,e,f){if(b>e||b<f)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range");if(c<0)throw new RangeError("index out of range")}function M(a,b,c,d,e){return e||L(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),X.write(a,b,c,d,23,4),c+4}function N(a,b,c,d,e){return e||L(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),X.write(a,b,c,d,52,8),c+8}function O(a){if(a=P(a).replace(aa,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function P(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function Q(a){return a<16?"0"+a.toString(16):a.toString(16)}function R(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;g<d;g++){if(c=a.charCodeAt(g),c>55295&&c<57344){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(c<1114112))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function S(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function T(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);g++)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function U(a){return W.toByteArray(O(a))}function V(a,b,c,d){for(var e=0;e<d&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}var W=a("base64-js"),X=a("ieee754"),Y=a("isarray");c.Buffer=f,c.SlowBuffer=r,c.INSPECT_MAX_BYTES=50,f.poolSize=8192;var Z={};f.TYPED_ARRAY_SUPPORT=void 0!==b.TYPED_ARRAY_SUPPORT?b.TYPED_ARRAY_SUPPORT:d(),f.TYPED_ARRAY_SUPPORT?(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array):(f.prototype.length=void 0,f.prototype.parent=void 0),f.isBuffer=function(a){return!(null==a||!a._isBuffer)},f.compare=function(a,b){if(!f.isBuffer(a)||!f.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var c=a.length,d=b.length,e=0,g=Math.min(c,d);e<g&&a[e]===b[e];)++e;return e!==g&&(c=a[e],d=b[e]),c<d?-1:d<c?1:0},f.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(a,b){if(!Y(a))throw new TypeError("list argument must be an Array of Buffers.");if(0===a.length)return new f(0);var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var d=new f(b),e=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(d,e),e+=g.length}return d},f.byteLength=s,f.prototype.toString=function(){var a=0|this.length;return 0===a?"":0===arguments.length?B(this,0,a):t.apply(this,arguments)},f.prototype.equals=function(a){if(!f.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a||0===f.compare(this,a)},f.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... ")),"<Buffer "+a+">"},f.prototype.compare=function(a){if(!f.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?0:f.compare(this,a)},f.prototype.indexOf=function(a,b){function c(a,b,c){for(var d=-1,e=0;c+e<a.length;e++)if(a[c+e]===b[d===-1?0:e-d]){if(d===-1&&(d=e),e-d+1===b.length)return c+d}else d=-1;return-1}if(b>2147483647?b=2147483647:b<-2147483648&&(b=-2147483648),b>>=0,0===this.length)return-1;if(b>=this.length)return-1;if(b<0&&(b=Math.max(this.length+b,0)),"string"==typeof a)return 0===a.length?-1:String.prototype.indexOf.call(this,a,b);if(f.isBuffer(a))return c(this,a,b);if("number"==typeof a)return f.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,a,b):c(this,[a],b);throw new TypeError("val must be string, number or Buffer")},f.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},f.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},f.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b|=0,isFinite(c)?(c|=0,void 0===d&&(d="utf8")):(d=c,c=void 0);else{var e=d;d=b,b=0|c,c=e}var f=this.length-b;if((void 0===c||c>f)&&(c=f),a.length>0&&(c<0||b<0)||b>this.length)throw new RangeError("attempt to write outside buffer bounds");d||(d="utf8");for(var g=!1;;)switch(d){case"hex":return u(this,a,b,c);case"utf8":case"utf-8":return v(this,a,b,c);case"ascii":return w(this,a,b,c);case"binary":return x(this,a,b,c);case"base64":return y(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,a,b,c);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),g=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;f.prototype.slice=function(a,b){var c=this.length;a=~~a,b=void 0===b?c:~~b,a<0?(a+=c,a<0&&(a=0)):a>c&&(a=c),b<0?(b+=c,b<0&&(b=0)):b>c&&(b=c),b<a&&(b=a);var d;if(f.TYPED_ARRAY_SUPPORT)d=f._augment(this.subarray(a,b));else{var e=b-a;d=new f(e,void 0);for(var g=0;g<e;g++)d[g]=this[g+a]}return d.length&&(d.parent=this.parent||this),d},f.prototype.readUIntLE=function(a,b,c){a|=0,b|=0,c||H(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},f.prototype.readUIntBE=function(a,b,c){a|=0,b|=0,c||H(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},f.prototype.readUInt8=function(a,b){return b||H(a,1,this.length),this[a]},f.prototype.readUInt16LE=function(a,b){return b||H(a,2,this.length),this[a]|this[a+1]<<8},f.prototype.readUInt16BE=function(a,b){return b||H(a,2,this.length),this[a]<<8|this[a+1]},f.prototype.readUInt32LE=function(a,b){return b||H(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},f.prototype.readUInt32BE=function(a,b){return b||H(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},f.prototype.readIntLE=function(a,b,c){a|=0,b|=0,c||H(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},f.prototype.readIntBE=function(a,b,c){a|=0,b|=0,c||H(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},f.prototype.readInt8=function(a,b){return b||H(a,1,this.length),128&this[a]?(255-this[a]+1)*-1:this[a]},f.prototype.readInt16LE=function(a,b){b||H(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},f.prototype.readInt16BE=function(a,b){b||H(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},f.prototype.readInt32LE=function(a,b){return b||H(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},f.prototype.readInt32BE=function(a,b){return b||H(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},f.prototype.readFloatLE=function(a,b){return b||H(a,4,this.length),X.read(this,a,!0,23,4)},f.prototype.readFloatBE=function(a,b){return b||H(a,4,this.length),X.read(this,a,!1,23,4)},f.prototype.readDoubleLE=function(a,b){return b||H(a,8,this.length),X.read(this,a,!0,52,8)},f.prototype.readDoubleBE=function(a,b){return b||H(a,8,this.length),X.read(this,a,!1,52,8)},f.prototype.writeUIntLE=function(a,b,c,d){a=+a,b|=0,c|=0,d||I(this,a,b,c,Math.pow(2,8*c),0);var e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},f.prototype.writeUIntBE=function(a,b,c,d){a=+a,b|=0,c|=0,d||I(this,a,b,c,Math.pow(2,8*c),0);var e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},f.prototype.writeUInt8=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,1,255,0),f.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[b]=255&a,b+1},f.prototype.writeUInt16LE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8):J(this,a,b,!0),b+2},f.prototype.writeUInt16BE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=255&a):J(this,a,b,!1),b+2},f.prototype.writeUInt32LE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a):K(this,a,b,!0),b+4},f.prototype.writeUInt32BE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a):K(this,a,b,!1),b+4},f.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b|=0,!d){var e=Math.pow(2,8*c-1);I(this,a,b,c,e-1,-e)}var f=0,g=1,h=a<0?1:0;for(this[b]=255&a;++f<c&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},f.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b|=0,!d){var e=Math.pow(2,8*c-1);I(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=a<0?1:0;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},f.prototype.writeInt8=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,1,127,-128),f.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),a<0&&(a=255+a+1),this[b]=255&a,b+1},f.prototype.writeInt16LE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8):J(this,a,b,!0),b+2},f.prototype.writeInt16BE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=255&a):J(this,a,b,!1),b+2},f.prototype.writeInt32LE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):K(this,a,b,!0),b+4},f.prototype.writeInt32BE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a):K(this,a,b,!1),b+4},f.prototype.writeFloatLE=function(a,b,c){return M(this,a,b,!0,c)},f.prototype.writeFloatBE=function(a,b,c){return M(this,a,b,!1,c)},f.prototype.writeDoubleLE=function(a,b,c){return N(this,a,b,!0,c)},f.prototype.writeDoubleBE=function(a,b,c){return N(this,a,b,!1,c)},f.prototype.copy=function(a,b,c,d){if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&d<c&&(d=c),d===c)return 0;if(0===a.length||0===this.length)return 0;if(b<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("sourceStart out of bounds");if(d<0)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);var e,g=d-c;if(this===a&&c<b&&b<d)for(e=g-1;e>=0;e--)a[e+b]=this[e+c];else if(g<1e3||!f.TYPED_ARRAY_SUPPORT)for(e=0;e<g;e++)a[e+b]=this[e+c];else a._set(this.subarray(c,c+g),b);return g},f.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),c<b)throw new RangeError("end < start");if(c!==b&&0!==this.length){if(b<0||b>=this.length)throw new RangeError("start out of bounds");if(c<0||c>this.length)throw new RangeError("end out of bounds");var d;if("number"==typeof a)for(d=b;d<c;d++)this[d]=a;else{var e=R(a.toString()),f=e.length;for(d=b;d<c;d++)this[d]=e[d%f]}return this}},f.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(f.TYPED_ARRAY_SUPPORT)return new f(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;b<c;b+=1)a[b]=this[b];return a.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var _=f.prototype;f._augment=function(a){return a.constructor=f,a._isBuffer=!0,a._set=a.set,a.get=_.get,a.set=_.set,a.write=_.write,a.toString=_.toString,a.toLocaleString=_.toString,a.toJSON=_.toJSON,a.equals=_.equals,a.compare=_.compare,a.indexOf=_.indexOf,a.copy=_.copy,a.slice=_.slice,a.readUIntLE=_.readUIntLE,a.readUIntBE=_.readUIntBE,a.readUInt8=_.readUInt8,a.readUInt16LE=_.readUInt16LE,a.readUInt16BE=_.readUInt16BE,a.readUInt32LE=_.readUInt32LE,a.readUInt32BE=_.readUInt32BE,a.readIntLE=_.readIntLE,a.readIntBE=_.readIntBE,a.readInt8=_.readInt8,a.readInt16LE=_.readInt16LE,a.readInt16BE=_.readInt16BE,a.readInt32LE=_.readInt32LE,a.readInt32BE=_.readInt32BE,a.readFloatLE=_.readFloatLE,a.readFloatBE=_.readFloatBE,a.readDoubleLE=_.readDoubleLE,a.readDoubleBE=_.readDoubleBE,a.writeUInt8=_.writeUInt8,a.writeUIntLE=_.writeUIntLE,a.writeUIntBE=_.writeUIntBE,a.writeUInt16LE=_.writeUInt16LE,a.writeUInt16BE=_.writeUInt16BE,a.writeUInt32LE=_.writeUInt32LE,a.writeUInt32BE=_.writeUInt32BE,a.writeIntLE=_.writeIntLE,a.writeIntBE=_.writeIntBE,a.writeInt8=_.writeInt8,a.writeInt16LE=_.writeInt16LE,a.writeInt16BE=_.writeInt16BE,a.writeInt32LE=_.writeInt32LE,a.writeInt32BE=_.writeInt32BE,a.writeFloatLE=_.writeFloatLE,a.writeFloatBE=_.writeFloatBE,a.writeDoubleLE=_.writeDoubleLE,a.writeDoubleBE=_.writeDoubleBE,a.fill=_.fill,a.inspect=_.inspect,a.toArrayBuffer=_.toArrayBuffer,a};var aa=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:9,isarray:6}],6:[function(a,b,c){var d={}.toString;b.exports=Array.isArray||function(a){return"[object Array]"==d.call(a)}},{}],7:[function(a,b,c){(function(a){function b(a){return Array.isArray?Array.isArray(a):"[object Array]"===q(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return"[object RegExp]"===q(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return"[object Date]"===q(a)}function n(a){return"[object Error]"===q(a)||a instanceof Error}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function q(a){return Object.prototype.toString.call(a)}c.isArray=b,c.isBoolean=d,c.isNull=e,c.isNullOrUndefined=f,c.isNumber=g,c.isString=h,c.isSymbol=i,c.isUndefined=j,c.isRegExp=k,c.isObject=l,c.isDate=m,c.isError=n,c.isFunction=o,c.isPrimitive=p,c.isBuffer=a.isBuffer}).call(this,{isBuffer:a("../../is-buffer/index.js")})},{"../../is-buffer/index.js":11}],8:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;i<d;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;i<d;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;i<d;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],9:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],10:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],11:[function(a,b,c){function d(a){return!!a.constructor&&"function"==typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)}function e(a){return"function"==typeof a.readFloatLE&&"function"==typeof a.slice&&d(a.slice(0,0))}b.exports=function(a){return null!=a&&(d(a)||e(a)||!!a._isBuffer)}},{}],12:[function(a,b,c){!function(a){"use strict";var d="Compound",e="Identifier",f="MemberExpression",g="Literal",h="ThisExpression",i="CallExpression",j="UnaryExpression",k="BinaryExpression",l="LogicalExpression",m="ConditionalExpression",n="ArrayExpression",o=46,p=44,q=39,r=34,s=40,t=41,u=91,v=93,w=63,x=59,y=58,z=function(a,b){var c=new Error(a+" at character "+b);throw c.index=b,c.description=a,c},A=!0,B={"-":A,"!":A,"~":A,"+":A},C={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},D=function(a){var b,c=0;for(var d in a)(b=d.length)>c&&a.hasOwnProperty(d)&&(c=b);return c},E=D(B),F=D(C),G={
true:!0,false:!1,null:null},H="this",I=function(a){return C[a]||0},J=function(a,b,c){var d="||"===a||"&&"===a?l:k;return{type:d,operator:a,left:b,right:c}},K=function(a){return a>=48&&a<=57},L=function(a){return 36===a||95===a||a>=65&&a<=90||a>=97&&a<=122},M=function(a){return 36===a||95===a||a>=65&&a<=90||a>=97&&a<=122||a>=48&&a<=57},N=function(a){for(var b,c,k=0,l=a.charAt,A=a.charCodeAt,D=function(b){return l.call(a,b)},N=function(b){return A.call(a,b)},O=a.length,P=function(){for(var a=N(k);32===a||9===a;)a=N(++k)},Q=function(){var a,b,c=S();return P(),N(k)!==w?c:(k++,a=Q(),a||z("Expected expression",k),P(),N(k)===y?(k++,b=Q(),b||z("Expected expression",k),{type:m,test:c,consequent:a,alternate:b}):void z("Expected :",k))},R=function(){P();for(var b=a.substr(k,F),c=b.length;c>0;){if(C.hasOwnProperty(b))return k+=c,b;b=b.substr(0,--c)}return!1},S=function(){var a,b,c,d,e,f,g,h;if(f=T(),b=R(),!b)return f;for(e={value:b,prec:I(b)},g=T(),g||z("Expected expression after "+b,k),d=[f,e,g];(b=R())&&(c=I(b),0!==c);){for(e={value:b,prec:c};d.length>2&&c<=d[d.length-2].prec;)g=d.pop(),b=d.pop().value,f=d.pop(),a=J(b,f,g),d.push(a);a=T(),a||z("Expected expression after "+b,k),d.push(e,a)}for(h=d.length-1,a=d[h];h>1;)a=J(d[h-1].value,d[h-2],a),h-=2;return a},T=function(){var b,c,d;if(P(),b=N(k),K(b)||b===o)return U();if(b===q||b===r)return V();if(L(b)||b===s)return Y();if(b===u)return $();for(c=a.substr(k,E),d=c.length;d>0;){if(B.hasOwnProperty(c))return k+=d,{type:j,operator:c,argument:T(),prefix:!0};c=c.substr(0,--d)}return!1},U=function(){for(var a,b,c="";K(N(k));)c+=D(k++);if(N(k)===o)for(c+=D(k++);K(N(k));)c+=D(k++);if(a=D(k),"e"===a||"E"===a){for(c+=D(k++),a=D(k),"+"!==a&&"-"!==a||(c+=D(k++));K(N(k));)c+=D(k++);K(N(k-1))||z("Expected exponent ("+c+D(k)+")",k)}return b=N(k),L(b)?z("Variable names cannot start with a number ("+c+D(k)+")",k):b===o&&z("Unexpected period",k),{type:g,value:parseFloat(c),raw:c}},V=function(){for(var a,b="",c=D(k++),d=!1;k<O;){if(a=D(k++),a===c){d=!0;break}if("\\"===a)switch(a=D(k++)){case"n":b+="\n";break;case"r":b+="\r";break;case"t":b+="\t";break;case"b":b+="\b";break;case"f":b+="\f";break;case"v":b+="\v"}else b+=a}return d||z('Unclosed quote after "'+b+'"',k),{type:g,value:b,raw:c+b+c}},W=function(){var b,c=N(k),d=k;for(L(c)?k++:z("Unexpected "+D(k),k);k<O&&(c=N(k),M(c));)k++;return b=a.slice(d,k),G.hasOwnProperty(b)?{type:g,value:G[b],raw:b}:b===H?{type:h}:{type:e,name:b}},X=function(a){for(var b,c,e=[];k<O;){if(P(),b=N(k),b===a){k++;break}b===p?k++:(c=Q(),c&&c.type!==d||z("Expected comma",k),e.push(c))}return e},Y=function(){var a,b;for(a=N(k),b=a===s?Z():W(),P(),a=N(k);a===o||a===u||a===s;)k++,a===o?(P(),b={type:f,computed:!1,object:b,property:W()}):a===u?(b={type:f,computed:!0,object:b,property:Q()},P(),a=N(k),a!==v&&z("Unclosed [",k),k++):a===s&&(b={type:i,arguments:X(t),callee:b}),P(),a=N(k);return b},Z=function(){k++;var a=Q();return P(),N(k)===t?(k++,a):void z("Unclosed (",k)},$=function(){return k++,{type:n,elements:X(v)}},_=[];k<O;)b=N(k),b===x||b===p?k++:(c=Q())?_.push(c):k<O&&z('Unexpected "'+D(k)+'"',k);return 1===_.length?_[0]:{type:d,body:_}};if(N.version="0.3.0",N.toString=function(){return"JavaScript Expression Parser (JSEP) v"+N.version},N.addUnaryOp=function(a){return B[a]=A,this},N.addBinaryOp=function(a,b){return F=Math.max(a.length,F),C[a]=b,this},N.removeUnaryOp=function(a){return delete B[a],a.length===E&&(E=D(B)),this},N.removeBinaryOp=function(a){return delete C[a],a.length===F&&(F=D(C)),this},"undefined"==typeof c){var O=a.jsep;a.jsep=N,N.noConflict=function(){return a.jsep===N&&(a.jsep=O),N}}else"undefined"!=typeof b&&b.exports?c=b.exports=N:c.parse=N}(this)},{}],13:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"DataView");b.exports=f},{"./_getNative":77,"./_root":114}],14:[function(a,b,c){function d(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}var e=a("./_hashClear"),f=a("./_hashDelete"),g=a("./_hashGet"),h=a("./_hashHas"),i=a("./_hashSet");d.prototype.clear=e,d.prototype.delete=f,d.prototype.get=g,d.prototype.has=h,d.prototype.set=i,b.exports=d},{"./_hashClear":83,"./_hashDelete":84,"./_hashGet":85,"./_hashHas":86,"./_hashSet":87}],15:[function(a,b,c){function d(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}var e=a("./_listCacheClear"),f=a("./_listCacheDelete"),g=a("./_listCacheGet"),h=a("./_listCacheHas"),i=a("./_listCacheSet");d.prototype.clear=e,d.prototype.delete=f,d.prototype.get=g,d.prototype.has=h,d.prototype.set=i,b.exports=d},{"./_listCacheClear":95,"./_listCacheDelete":96,"./_listCacheGet":97,"./_listCacheHas":98,"./_listCacheSet":99}],16:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"Map");b.exports=f},{"./_getNative":77,"./_root":114}],17:[function(a,b,c){function d(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}var e=a("./_mapCacheClear"),f=a("./_mapCacheDelete"),g=a("./_mapCacheGet"),h=a("./_mapCacheHas"),i=a("./_mapCacheSet");d.prototype.clear=e,d.prototype.delete=f,d.prototype.get=g,d.prototype.has=h,d.prototype.set=i,b.exports=d},{"./_mapCacheClear":100,"./_mapCacheDelete":101,"./_mapCacheGet":102,"./_mapCacheHas":103,"./_mapCacheSet":104}],18:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"Promise");b.exports=f},{"./_getNative":77,"./_root":114}],19:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"Set");b.exports=f},{"./_getNative":77,"./_root":114}],20:[function(a,b,c){function d(a){var b=-1,c=null==a?0:a.length;for(this.__data__=new e;++b<c;)this.add(a[b])}var e=a("./_MapCache"),f=a("./_setCacheAdd"),g=a("./_setCacheHas");d.prototype.add=d.prototype.push=f,d.prototype.has=g,b.exports=d},{"./_MapCache":17,"./_setCacheAdd":115,"./_setCacheHas":116}],21:[function(a,b,c){function d(a){var b=this.__data__=new e(a);this.size=b.size}var e=a("./_ListCache"),f=a("./_stackClear"),g=a("./_stackDelete"),h=a("./_stackGet"),i=a("./_stackHas"),j=a("./_stackSet");d.prototype.clear=f,d.prototype.delete=g,d.prototype.get=h,d.prototype.has=i,d.prototype.set=j,b.exports=d},{"./_ListCache":15,"./_stackClear":120,"./_stackDelete":121,"./_stackGet":122,"./_stackHas":123,"./_stackSet":124}],22:[function(a,b,c){var d=a("./_root"),e=d.Symbol;b.exports=e},{"./_root":114}],23:[function(a,b,c){var d=a("./_root"),e=d.Uint8Array;b.exports=e},{"./_root":114}],24:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"WeakMap");b.exports=f},{"./_getNative":77,"./_root":114}],25:[function(a,b,c){function d(a,b,c){switch(c.length){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}b.exports=d},{}],26:[function(a,b,c){function d(a,b){for(var c=-1,d=null==a?0:a.length;++c<d;)if(!b(a[c],c,a))return!1;return!0}b.exports=d},{}],27:[function(a,b,c){function d(a,b){for(var c=-1,d=null==a?0:a.length,e=0,f=[];++c<d;){var g=a[c];b(g,c,a)&&(f[e++]=g)}return f}b.exports=d},{}],28:[function(a,b,c){function d(a,b){var c=g(a),d=!c&&f(a),k=!c&&!d&&h(a),m=!c&&!d&&!k&&j(a),n=c||d||k||m,o=n?e(a.length,String):[],p=o.length;for(var q in a)!b&&!l.call(a,q)||n&&("length"==q||k&&("offset"==q||"parent"==q)||m&&("buffer"==q||"byteLength"==q||"byteOffset"==q)||i(q,p))||o.push(q);return o}var e=a("./_baseTimes"),f=a("./isArguments"),g=a("./isArray"),h=a("./isBuffer"),i=a("./_isIndex"),j=a("./isTypedArray"),k=Object.prototype,l=k.hasOwnProperty;b.exports=d},{"./_baseTimes":59,"./_isIndex":88,"./isArguments":136,"./isArray":137,"./isBuffer":139,"./isTypedArray":146}],29:[function(a,b,c){function d(a,b){for(var c=-1,d=null==a?0:a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}b.exports=d},{}],30:[function(a,b,c){function d(a,b){for(var c=-1,d=b.length,e=a.length;++c<d;)a[e+c]=b[c];return a}b.exports=d},{}],31:[function(a,b,c){function d(a,b){for(var c=-1,d=null==a?0:a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}b.exports=d},{}],32:[function(a,b,c){function d(a,b,c){var d=a[b];h.call(a,b)&&f(d,c)&&(void 0!==c||b in a)||e(a,b,c)}var e=a("./_baseAssignValue"),f=a("./eq"),g=Object.prototype,h=g.hasOwnProperty;b.exports=d},{"./_baseAssignValue":35,"./eq":131}],33:[function(a,b,c){function d(a,b){for(var c=a.length;c--;)if(e(a[c][0],b))return c;return-1}var e=a("./eq");b.exports=d},{"./eq":131}],34:[function(a,b,c){function d(a,b){return a&&e(b,f(b),a)}var e=a("./_copyObject"),f=a("./keys");b.exports=d},{"./_copyObject":64,"./keys":147}],35:[function(a,b,c){function d(a,b,c){"__proto__"==b&&e?e(a,b,{configurable:!0,enumerable:!0,value:c,writable:!0}):a[b]=c}var e=a("./_defineProperty");b.exports=d},{"./_defineProperty":69}],36:[function(a,b,c){var d=a("./isObject"),e=Object.create,f=function(){function a(){}return function(b){if(!d(b))return{};if(e)return e(b);a.prototype=b;var c=new a;return a.prototype=void 0,c}}();b.exports=f},{"./isObject":143}],37:[function(a,b,c){var d=a("./_baseForOwn"),e=a("./_createBaseEach"),f=e(d);b.exports=f},{"./_baseForOwn":40,"./_createBaseEach":67}],38:[function(a,b,c){function d(a,b){var c=!0;return e(a,function(a,d,e){return c=!!b(a,d,e)}),c}var e=a("./_baseEach");b.exports=d},{"./_baseEach":37}],39:[function(a,b,c){var d=a("./_createBaseFor"),e=d();b.exports=e},{"./_createBaseFor":68}],40:[function(a,b,c){function d(a,b){return a&&e(a,b,f)}var e=a("./_baseFor"),f=a("./keys");b.exports=d},{"./_baseFor":39,"./keys":147}],41:[function(a,b,c){function d(a,b){b=e(b,a);for(var c=0,d=b.length;null!=a&&c<d;)a=a[f(b[c++])];return c&&c==d?a:void 0}var e=a("./_castPath"),f=a("./_toKey");b.exports=d},{"./_castPath":63,"./_toKey":126}],42:[function(a,b,c){function d(a,b,c){var d=b(a);return f(a)?d:e(d,c(a))}var e=a("./_arrayPush"),f=a("./isArray");b.exports=d},{"./_arrayPush":30,"./isArray":137}],43:[function(a,b,c){function d(a){return null==a?void 0===a?i:h:j&&j in Object(a)?f(a):g(a)}var e=a("./_Symbol"),f=a("./_getRawTag"),g=a("./_objectToString"),h="[object Null]",i="[object Undefined]",j=e?e.toStringTag:void 0;b.exports=d},{"./_Symbol":22,"./_getRawTag":78,"./_objectToString":111}],44:[function(a,b,c){function d(a,b){return null!=a&&b in Object(a)}b.exports=d},{}],45:[function(a,b,c){function d(a){return f(a)&&e(a)==g}var e=a("./_baseGetTag"),f=a("./isObjectLike"),g="[object Arguments]";b.exports=d},{"./_baseGetTag":43,"./isObjectLike":144}],46:[function(a,b,c){function d(a,b,c,g,h){return a===b||(null==a||null==b||!f(a)&&!f(b)?a!==a&&b!==b:e(a,b,c,g,d,h))}var e=a("./_baseIsEqualDeep"),f=a("./isObjectLike");b.exports=d},{"./_baseIsEqualDeep":47,"./isObjectLike":144}],47:[function(a,b,c){function d(a,b,c,d,q,s){var t=j(a),u=j(b),v=t?o:i(a),w=u?o:i(b);v=v==n?p:v,w=w==n?p:w;var x=v==p,y=w==p,z=v==w;if(z&&k(a)){if(!k(b))return!1;t=!0,x=!1}if(z&&!x)return s||(s=new e),t||l(a)?f(a,b,c,d,q,s):g(a,b,v,c,d,q,s);if(!(c&m)){var A=x&&r.call(a,"__wrapped__"),B=y&&r.call(b,"__wrapped__");if(A||B){var C=A?a.value():a,D=B?b.value():b;return s||(s=new e),q(C,D,c,d,s)}}return!!z&&(s||(s=new e),h(a,b,c,d,q,s))}var e=a("./_Stack"),f=a("./_equalArrays"),g=a("./_equalByTag"),h=a("./_equalObjects"),i=a("./_getTag"),j=a("./isArray"),k=a("./isBuffer"),l=a("./isTypedArray"),m=1,n="[object Arguments]",o="[object Array]",p="[object Object]",q=Object.prototype,r=q.hasOwnProperty;b.exports=d},{"./_Stack":21,"./_equalArrays":70,"./_equalByTag":71,"./_equalObjects":72,"./_getTag":80,"./isArray":137,"./isBuffer":139,"./isTypedArray":146}],48:[function(a,b,c){function d(a,b,c,d){var i=c.length,j=i,k=!d;if(null==a)return!j;for(a=Object(a);i--;){var l=c[i];if(k&&l[2]?l[1]!==a[l[0]]:!(l[0]in a))return!1}for(;++i<j;){l=c[i];var m=l[0],n=a[m],o=l[1];if(k&&l[2]){if(void 0===n&&!(m in a))return!1}else{var p=new e;if(d)var q=d(n,o,m,a,b,p);if(!(void 0===q?f(o,n,g|h,d,p):q))return!1}}return!0}var e=a("./_Stack"),f=a("./_baseIsEqual"),g=1,h=2;b.exports=d},{"./_Stack":21,"./_baseIsEqual":46}],49:[function(a,b,c){function d(a){if(!g(a)||f(a))return!1;var b=e(a)?o:j;return b.test(h(a))}var e=a("./isFunction"),f=a("./_isMasked"),g=a("./isObject"),h=a("./_toSource"),i=/[\\^$.*+?()[\]{}|]/g,j=/^\[object .+?Constructor\]$/,k=Function.prototype,l=Object.prototype,m=k.toString,n=l.hasOwnProperty,o=RegExp("^"+m.call(n).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");b.exports=d},{"./_isMasked":92,"./_toSource":127,"./isFunction":141,"./isObject":143}],50:[function(a,b,c){function d(a){return g(a)&&f(a.length)&&!!F[e(a)]}var e=a("./_baseGetTag"),f=a("./isLength"),g=a("./isObjectLike"),h="[object Arguments]",i="[object Array]",j="[object Boolean]",k="[object Date]",l="[object Error]",m="[object Function]",n="[object Map]",o="[object Number]",p="[object Object]",q="[object RegExp]",r="[object Set]",s="[object String]",t="[object WeakMap]",u="[object ArrayBuffer]",v="[object DataView]",w="[object Float32Array]",x="[object Float64Array]",y="[object Int8Array]",z="[object Int16Array]",A="[object Int32Array]",B="[object Uint8Array]",C="[object Uint8ClampedArray]",D="[object Uint16Array]",E="[object Uint32Array]",F={};F[w]=F[x]=F[y]=F[z]=F[A]=F[B]=F[C]=F[D]=F[E]=!0,F[h]=F[i]=F[u]=F[j]=F[v]=F[k]=F[l]=F[m]=F[n]=F[o]=F[p]=F[q]=F[r]=F[s]=F[t]=!1,b.exports=d},{"./_baseGetTag":43,"./isLength":142,"./isObjectLike":144}],51:[function(a,b,c){function d(a){return"function"==typeof a?a:null==a?g:"object"==typeof a?h(a)?f(a[0],a[1]):e(a):i(a)}var e=a("./_baseMatches"),f=a("./_baseMatchesProperty"),g=a("./identity"),h=a("./isArray"),i=a("./property");b.exports=d},{"./_baseMatches":53,"./_baseMatchesProperty":54,"./identity":135,"./isArray":137,"./property":150}],52:[function(a,b,c){function d(a){if(!e(a))return f(a);var b=[];for(var c in Object(a))h.call(a,c)&&"constructor"!=c&&b.push(c);return b}var e=a("./_isPrototype"),f=a("./_nativeKeys"),g=Object.prototype,h=g.hasOwnProperty;b.exports=d},{"./_isPrototype":93,"./_nativeKeys":109}],53:[function(a,b,c){function d(a){var b=f(a);return 1==b.length&&b[0][2]?g(b[0][0],b[0][1]):function(c){return c===a||e(c,a,b)}}var e=a("./_baseIsMatch"),f=a("./_getMatchData"),g=a("./_matchesStrictComparable");b.exports=d},{"./_baseIsMatch":48,"./_getMatchData":76,"./_matchesStrictComparable":106}],54:[function(a,b,c){function d(a,b){return h(a)&&i(b)?j(k(a),b):function(c){var d=f(c,a);return void 0===d&&d===b?g(c,a):e(b,d,l|m)}}var e=a("./_baseIsEqual"),f=a("./get"),g=a("./hasIn"),h=a("./_isKey"),i=a("./_isStrictComparable"),j=a("./_matchesStrictComparable"),k=a("./_toKey"),l=1,m=2;b.exports=d},{"./_baseIsEqual":46,"./_isKey":90,"./_isStrictComparable":94,"./_matchesStrictComparable":106,"./_toKey":126,"./get":133,"./hasIn":134}],55:[function(a,b,c){function d(a){return function(b){return null==b?void 0:b[a]}}b.exports=d},{}],56:[function(a,b,c){function d(a){return function(b){return e(b,a)}}var e=a("./_baseGet");b.exports=d},{"./_baseGet":41}],57:[function(a,b,c){function d(a,b){return g(f(a,b,e),a+"")}var e=a("./identity"),f=a("./_overRest"),g=a("./_setToString");b.exports=d},{"./_overRest":113,"./_setToString":118,"./identity":135}],58:[function(a,b,c){var d=a("./constant"),e=a("./_defineProperty"),f=a("./identity"),g=e?function(a,b){return e(a,"toString",{configurable:!0,enumerable:!1,value:d(b),writable:!0})}:f;b.exports=g},{"./_defineProperty":69,"./constant":129,"./identity":135}],59:[function(a,b,c){function d(a,b){for(var c=-1,d=Array(a);++c<a;)d[c]=b(c);return d}b.exports=d},{}],60:[function(a,b,c){function d(a){if("string"==typeof a)return a;if(g(a))return f(a,d)+"";if(h(a))return k?k.call(a):"";var b=a+"";return"0"==b&&1/a==-i?"-0":b}var e=a("./_Symbol"),f=a("./_arrayMap"),g=a("./isArray"),h=a("./isSymbol"),i=1/0,j=e?e.prototype:void 0,k=j?j.toString:void 0;b.exports=d},{"./_Symbol":22,"./_arrayMap":29,"./isArray":137,"./isSymbol":145}],61:[function(a,b,c){function d(a){return function(b){return a(b)}}b.exports=d},{}],62:[function(a,b,c){function d(a,b){return a.has(b)}b.exports=d},{}],63:[function(a,b,c){function d(a,b){return e(a)?a:f(a,b)?[a]:g(h(a))}var e=a("./isArray"),f=a("./_isKey"),g=a("./_stringToPath"),h=a("./toString");b.exports=d},{"./_isKey":90,"./_stringToPath":125,"./isArray":137,"./toString":153}],64:[function(a,b,c){function d(a,b,c,d){var g=!c;c||(c={});for(var h=-1,i=b.length;++h<i;){var j=b[h],k=d?d(c[j],a[j],j,c,a):void 0;void 0===k&&(k=a[j]),g?f(c,j,k):e(c,j,k)}return c}var e=a("./_assignValue"),f=a("./_baseAssignValue");b.exports=d},{"./_assignValue":32,"./_baseAssignValue":35}],65:[function(a,b,c){var d=a("./_root"),e=d["__core-js_shared__"];b.exports=e},{"./_root":114}],66:[function(a,b,c){function d(a){return e(function(b,c){var d=-1,e=c.length,g=e>1?c[e-1]:void 0,h=e>2?c[2]:void 0;for(g=a.length>3&&"function"==typeof g?(e--,g):void 0,h&&f(c[0],c[1],h)&&(g=e<3?void 0:g,e=1),b=Object(b);++d<e;){var i=c[d];i&&a(b,i,d,g)}return b})}var e=a("./_baseRest"),f=a("./_isIterateeCall");b.exports=d},{"./_baseRest":57,"./_isIterateeCall":89}],67:[function(a,b,c){function d(a,b){return function(c,d){if(null==c)return c;if(!e(c))return a(c,d);for(var f=c.length,g=b?f:-1,h=Object(c);(b?g--:++g<f)&&d(h[g],g,h)!==!1;);return c}}var e=a("./isArrayLike");b.exports=d},{"./isArrayLike":138}],68:[function(a,b,c){function d(a){return function(b,c,d){for(var e=-1,f=Object(b),g=d(b),h=g.length;h--;){var i=g[a?h:++e];if(c(f[i],i,f)===!1)break}return b}}b.exports=d},{}],69:[function(a,b,c){var d=a("./_getNative"),e=function(){try{var a=d(Object,"defineProperty");return a({},"",{}),a}catch(b){}}();b.exports=e},{"./_getNative":77}],70:[function(a,b,c){function d(a,b,c,d,j,k){var l=c&h,m=a.length,n=b.length;if(m!=n&&!(l&&n>m))return!1;var o=k.get(a);if(o&&k.get(b))return o==b;var p=-1,q=!0,r=c&i?new e:void 0;for(k.set(a,b),k.set(b,a);++p<m;){var s=a[p],t=b[p];if(d)var u=l?d(t,s,p,b,a,k):d(s,t,p,a,b,k);if(void 0!==u){if(u)continue;q=!1;break}if(r){if(!f(b,function(a,b){if(!g(r,b)&&(s===a||j(s,a,c,d,k)))return r.push(b)})){q=!1;break}}else if(s!==t&&!j(s,t,c,d,k)){q=!1;break}}return k.delete(a),k.delete(b),q}var e=a("./_SetCache"),f=a("./_arraySome"),g=a("./_cacheHas"),h=1,i=2;b.exports=d},{"./_SetCache":20,"./_arraySome":31,"./_cacheHas":62}],71:[function(a,b,c){function d(a,b,c,d,e,x,z){switch(c){case w:if(a.byteLength!=b.byteLength||a.byteOffset!=b.byteOffset)return!1;a=a.buffer,b=b.buffer;case v:return!(a.byteLength!=b.byteLength||!x(new f(a),new f(b)));case m:case n:case q:return g(+a,+b);case o:return a.name==b.name&&a.message==b.message;case r:case t:return a==b+"";case p:var A=i;case s:var B=d&k;if(A||(A=j),a.size!=b.size&&!B)return!1;var C=z.get(a);if(C)return C==b;d|=l,z.set(a,b);var D=h(A(a),A(b),d,e,x,z);return z.delete(a),D;case u:if(y)return y.call(a)==y.call(b)}return!1}var e=a("./_Symbol"),f=a("./_Uint8Array"),g=a("./eq"),h=a("./_equalArrays"),i=a("./_mapToArray"),j=a("./_setToArray"),k=1,l=2,m="[object Boolean]",n="[object Date]",o="[object Error]",p="[object Map]",q="[object Number]",r="[object RegExp]",s="[object Set]",t="[object String]",u="[object Symbol]",v="[object ArrayBuffer]",w="[object DataView]",x=e?e.prototype:void 0,y=x?x.valueOf:void 0;b.exports=d},{"./_Symbol":22,"./_Uint8Array":23,"./_equalArrays":70,"./_mapToArray":105,"./_setToArray":117,"./eq":131}],72:[function(a,b,c){function d(a,b,c,d,g,i){var j=c&f,k=e(a),l=k.length,m=e(b),n=m.length;if(l!=n&&!j)return!1;for(var o=l;o--;){var p=k[o];if(!(j?p in b:h.call(b,p)))return!1}var q=i.get(a);if(q&&i.get(b))return q==b;var r=!0;i.set(a,b),i.set(b,a);for(var s=j;++o<l;){p=k[o];var t=a[p],u=b[p];if(d)var v=j?d(u,t,p,b,a,i):d(t,u,p,a,b,i);if(!(void 0===v?t===u||g(t,u,c,d,i):v)){r=!1;break}s||(s="constructor"==p)}if(r&&!s){var w=a.constructor,x=b.constructor;w!=x&&"constructor"in a&&"constructor"in b&&!("function"==typeof w&&w instanceof w&&"function"==typeof x&&x instanceof x)&&(r=!1)}return i.delete(a),i.delete(b),r}var e=a("./_getAllKeys"),f=1,g=Object.prototype,h=g.hasOwnProperty;b.exports=d},{"./_getAllKeys":74}],73:[function(a,b,c){(function(a){var c="object"==typeof a&&a&&a.Object===Object&&a;b.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],74:[function(a,b,c){function d(a){return e(a,g,f)}var e=a("./_baseGetAllKeys"),f=a("./_getSymbols"),g=a("./keys");b.exports=d},{"./_baseGetAllKeys":42,"./_getSymbols":79,"./keys":147}],75:[function(a,b,c){function d(a,b){var c=a.__data__;return e(b)?c["string"==typeof b?"string":"hash"]:c.map}var e=a("./_isKeyable");b.exports=d},{"./_isKeyable":91}],76:[function(a,b,c){function d(a){for(var b=f(a),c=b.length;c--;){var d=b[c],g=a[d];b[c]=[d,g,e(g)]}return b}var e=a("./_isStrictComparable"),f=a("./keys");b.exports=d},{"./_isStrictComparable":94,"./keys":147}],77:[function(a,b,c){function d(a,b){var c=f(a,b);return e(c)?c:void 0}var e=a("./_baseIsNative"),f=a("./_getValue");b.exports=d},{"./_baseIsNative":49,"./_getValue":81}],78:[function(a,b,c){function d(a){var b=g.call(a,i),c=a[i];try{a[i]=void 0;var d=!0}catch(e){}var f=h.call(a);return d&&(b?a[i]=c:delete a[i]),f}var e=a("./_Symbol"),f=Object.prototype,g=f.hasOwnProperty,h=f.toString,i=e?e.toStringTag:void 0;b.exports=d},{"./_Symbol":22}],79:[function(a,b,c){var d=a("./_arrayFilter"),e=a("./stubArray"),f=Object.prototype,g=f.propertyIsEnumerable,h=Object.getOwnPropertySymbols,i=h?function(a){return null==a?[]:(a=Object(a),d(h(a),function(b){return g.call(a,b)}))}:e;b.exports=i},{"./_arrayFilter":27,"./stubArray":151}],80:[function(a,b,c){var d=a("./_DataView"),e=a("./_Map"),f=a("./_Promise"),g=a("./_Set"),h=a("./_WeakMap"),i=a("./_baseGetTag"),j=a("./_toSource"),k="[object Map]",l="[object Object]",m="[object Promise]",n="[object Set]",o="[object WeakMap]",p="[object DataView]",q=j(d),r=j(e),s=j(f),t=j(g),u=j(h),v=i;(d&&v(new d(new ArrayBuffer(1)))!=p||e&&v(new e)!=k||f&&v(f.resolve())!=m||g&&v(new g)!=n||h&&v(new h)!=o)&&(v=function(a){var b=i(a),c=b==l?a.constructor:void 0,d=c?j(c):"";if(d)switch(d){case q:return p;case r:return k;case s:return m;case t:return n;case u:return o}return b}),b.exports=v},{"./_DataView":13,"./_Map":16,"./_Promise":18,"./_Set":19,"./_WeakMap":24,"./_baseGetTag":43,"./_toSource":127}],81:[function(a,b,c){function d(a,b){return null==a?void 0:a[b]}b.exports=d},{}],82:[function(a,b,c){function d(a,b,c){b=e(b,a);for(var d=-1,k=b.length,l=!1;++d<k;){var m=j(b[d]);if(!(l=null!=a&&c(a,m)))break;a=a[m]}return l||++d!=k?l:(k=null==a?0:a.length,!!k&&i(k)&&h(m,k)&&(g(a)||f(a)))}var e=a("./_castPath"),f=a("./isArguments"),g=a("./isArray"),h=a("./_isIndex"),i=a("./isLength"),j=a("./_toKey");b.exports=d},{"./_castPath":63,"./_isIndex":88,"./_toKey":126,"./isArguments":136,"./isArray":137,"./isLength":142}],83:[function(a,b,c){function d(){this.__data__=e?e(null):{},this.size=0}var e=a("./_nativeCreate");b.exports=d},{"./_nativeCreate":108}],84:[function(a,b,c){function d(a){var b=this.has(a)&&delete this.__data__[a];return this.size-=b?1:0,b}b.exports=d},{}],85:[function(a,b,c){function d(a){var b=this.__data__;if(e){var c=b[a];return c===f?void 0:c}return h.call(b,a)?b[a]:void 0}var e=a("./_nativeCreate"),f="__lodash_hash_undefined__",g=Object.prototype,h=g.hasOwnProperty;b.exports=d},{"./_nativeCreate":108}],86:[function(a,b,c){function d(a){var b=this.__data__;return e?void 0!==b[a]:g.call(b,a)}var e=a("./_nativeCreate"),f=Object.prototype,g=f.hasOwnProperty;b.exports=d},{"./_nativeCreate":108}],87:[function(a,b,c){function d(a,b){var c=this.__data__;return this.size+=this.has(a)?0:1,c[a]=e&&void 0===b?f:b,this}var e=a("./_nativeCreate"),f="__lodash_hash_undefined__";b.exports=d},{"./_nativeCreate":108}],88:[function(a,b,c){function d(a,b){return b=null==b?e:b,!!b&&("number"==typeof a||f.test(a))&&a>-1&&a%1==0&&a<b}var e=9007199254740991,f=/^(?:0|[1-9]\d*)$/;b.exports=d},{}],89:[function(a,b,c){function d(a,b,c){if(!h(c))return!1;var d=typeof b;return!!("number"==d?f(c)&&g(b,c.length):"string"==d&&b in c)&&e(c[b],a)}var e=a("./eq"),f=a("./isArrayLike"),g=a("./_isIndex"),h=a("./isObject");b.exports=d},{"./_isIndex":88,"./eq":131,"./isArrayLike":138,"./isObject":143}],90:[function(a,b,c){function d(a,b){if(e(a))return!1;var c=typeof a;return!("number"!=c&&"symbol"!=c&&"boolean"!=c&&null!=a&&!f(a))||(h.test(a)||!g.test(a)||null!=b&&a in Object(b))}var e=a("./isArray"),f=a("./isSymbol"),g=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,h=/^\w*$/;b.exports=d},{"./isArray":137,"./isSymbol":145}],91:[function(a,b,c){function d(a){var b=typeof a;return"string"==b||"number"==b||"symbol"==b||"boolean"==b?"__proto__"!==a:null===a}b.exports=d},{}],92:[function(a,b,c){function d(a){return!!f&&f in a}var e=a("./_coreJsData"),f=function(){var a=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}();b.exports=d},{"./_coreJsData":65}],93:[function(a,b,c){function d(a){var b=a&&a.constructor,c="function"==typeof b&&b.prototype||e;return a===c}var e=Object.prototype;b.exports=d},{}],94:[function(a,b,c){function d(a){return a===a&&!e(a)}var e=a("./isObject");b.exports=d},{"./isObject":143}],95:[function(a,b,c){function d(){this.__data__=[],this.size=0}b.exports=d},{}],96:[function(a,b,c){function d(a){var b=this.__data__,c=e(b,a);if(c<0)return!1;var d=b.length-1;return c==d?b.pop():g.call(b,c,1),--this.size,!0}var e=a("./_assocIndexOf"),f=Array.prototype,g=f.splice;b.exports=d},{"./_assocIndexOf":33}],97:[function(a,b,c){function d(a){var b=this.__data__,c=e(b,a);return c<0?void 0:b[c][1]}var e=a("./_assocIndexOf");b.exports=d},{"./_assocIndexOf":33}],98:[function(a,b,c){function d(a){return e(this.__data__,a)>-1}var e=a("./_assocIndexOf");b.exports=d},{"./_assocIndexOf":33}],99:[function(a,b,c){function d(a,b){var c=this.__data__,d=e(c,a);return d<0?(++this.size,c.push([a,b])):c[d][1]=b,this}var e=a("./_assocIndexOf");b.exports=d},{"./_assocIndexOf":33}],100:[function(a,b,c){function d(){this.size=0,this.__data__={hash:new e,map:new(g||f),string:new e}}var e=a("./_Hash"),f=a("./_ListCache"),g=a("./_Map");b.exports=d},{"./_Hash":14,"./_ListCache":15,"./_Map":16}],101:[function(a,b,c){function d(a){var b=e(this,a).delete(a);return this.size-=b?1:0,b}var e=a("./_getMapData");b.exports=d},{"./_getMapData":75}],102:[function(a,b,c){function d(a){return e(this,a).get(a)}var e=a("./_getMapData");b.exports=d},{"./_getMapData":75}],103:[function(a,b,c){function d(a){return e(this,a).has(a)}var e=a("./_getMapData");b.exports=d},{"./_getMapData":75}],104:[function(a,b,c){function d(a,b){var c=e(this,a),d=c.size;return c.set(a,b),this.size+=c.size==d?0:1,this}var e=a("./_getMapData");b.exports=d},{"./_getMapData":75}],105:[function(a,b,c){function d(a){var b=-1,c=Array(a.size);return a.forEach(function(a,d){c[++b]=[d,a]}),c}b.exports=d},{}],106:[function(a,b,c){function d(a,b){return function(c){return null!=c&&(c[a]===b&&(void 0!==b||a in Object(c)))}}b.exports=d},{}],107:[function(a,b,c){function d(a){var b=e(a,function(a){return c.size===f&&c.clear(),a}),c=b.cache;return b}var e=a("./memoize"),f=500;b.exports=d},{"./memoize":149}],108:[function(a,b,c){var d=a("./_getNative"),e=d(Object,"create");b.exports=e},{"./_getNative":77}],109:[function(a,b,c){var d=a("./_overArg"),e=d(Object.keys,Object);b.exports=e},{"./_overArg":112}],110:[function(a,b,c){var d=a("./_freeGlobal"),e="object"==typeof c&&c&&!c.nodeType&&c,f=e&&"object"==typeof b&&b&&!b.nodeType&&b,g=f&&f.exports===e,h=g&&d.process,i=function(){try{return h&&h.binding&&h.binding("util")}catch(a){}}();b.exports=i},{"./_freeGlobal":73}],111:[function(a,b,c){function d(a){return f.call(a)}var e=Object.prototype,f=e.toString;b.exports=d},{}],112:[function(a,b,c){function d(a,b){return function(c){return a(b(c))}}b.exports=d},{}],113:[function(a,b,c){function d(a,b,c){return b=f(void 0===b?a.length-1:b,0),function(){for(var d=arguments,g=-1,h=f(d.length-b,0),i=Array(h);++g<h;)i[g]=d[b+g];g=-1;for(var j=Array(b+1);++g<b;)j[g]=d[g];return j[b]=c(i),e(a,this,j)}}var e=a("./_apply"),f=Math.max;b.exports=d},{"./_apply":25}],114:[function(a,b,c){var d=a("./_freeGlobal"),e="object"==typeof self&&self&&self.Object===Object&&self,f=d||e||Function("return this")();b.exports=f},{"./_freeGlobal":73}],115:[function(a,b,c){function d(a){return this.__data__.set(a,e),this}var e="__lodash_hash_undefined__";b.exports=d},{}],116:[function(a,b,c){function d(a){return this.__data__.has(a)}b.exports=d},{}],117:[function(a,b,c){function d(a){var b=-1,c=Array(a.size);return a.forEach(function(a){c[++b]=a}),c}b.exports=d},{}],118:[function(a,b,c){var d=a("./_baseSetToString"),e=a("./_shortOut"),f=e(d);b.exports=f},{"./_baseSetToString":58,"./_shortOut":119}],119:[function(a,b,c){function d(a){var b=0,c=0;return function(){var d=g(),h=f-(d-c);if(c=d,h>0){if(++b>=e)return arguments[0]}else b=0;return a.apply(void 0,arguments)}}var e=800,f=16,g=Date.now;b.exports=d},{}],120:[function(a,b,c){function d(){this.__data__=new e,this.size=0}var e=a("./_ListCache");b.exports=d},{"./_ListCache":15}],121:[function(a,b,c){function d(a){var b=this.__data__,c=b.delete(a);return this.size=b.size,c}b.exports=d},{}],122:[function(a,b,c){function d(a){return this.__data__.get(a)}b.exports=d},{}],123:[function(a,b,c){function d(a){return this.__data__.has(a)}b.exports=d},{}],124:[function(a,b,c){function d(a,b){var c=this.__data__;if(c instanceof e){var d=c.__data__;if(!f||d.length<h-1)return d.push([a,b]),this.size=++c.size,this;c=this.__data__=new g(d)}return c.set(a,b),this.size=c.size,this}var e=a("./_ListCache"),f=a("./_Map"),g=a("./_MapCache"),h=200;b.exports=d},{"./_ListCache":15,"./_Map":16,"./_MapCache":17}],125:[function(a,b,c){var d=a("./_memoizeCapped"),e=/^\./,f=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,g=/\\(\\)?/g,h=d(function(a){var b=[];return e.test(a)&&b.push(""),a.replace(f,function(a,c,d,e){b.push(d?e.replace(g,"$1"):c||a)}),b});b.exports=h},{"./_memoizeCapped":107}],126:[function(a,b,c){function d(a){if("string"==typeof a||e(a))return a;var b=a+"";return"0"==b&&1/a==-f?"-0":b}var e=a("./isSymbol"),f=1/0;b.exports=d},{"./isSymbol":145}],127:[function(a,b,c){function d(a){if(null!=a){try{return f.call(a)}catch(b){}try{return a+""}catch(b){}}return""}var e=Function.prototype,f=e.toString;b.exports=d},{}],128:[function(a,b,c){var d=a("./_assignValue"),e=a("./_copyObject"),f=a("./_createAssigner"),g=a("./isArrayLike"),h=a("./_isPrototype"),i=a("./keys"),j=Object.prototype,k=j.hasOwnProperty,l=f(function(a,b){if(h(b)||g(b))return void e(b,i(b),a);for(var c in b)k.call(b,c)&&d(a,c,b[c])});b.exports=l},{"./_assignValue":32,"./_copyObject":64,"./_createAssigner":66,"./_isPrototype":93,"./isArrayLike":138,"./keys":147}],129:[function(a,b,c){function d(a){return function(){return a}}b.exports=d},{}],130:[function(a,b,c){function d(a,b){var c=f(a);return null==b?c:e(c,b)}var e=a("./_baseAssign"),f=a("./_baseCreate");b.exports=d},{"./_baseAssign":34,"./_baseCreate":36}],131:[function(a,b,c){function d(a,b){return a===b||a!==a&&b!==b}b.exports=d},{}],132:[function(a,b,c){function d(a,b,c){var d=h(a)?e:f;return c&&i(a,b,c)&&(b=void 0),d(a,g(b,3))}var e=a("./_arrayEvery"),f=a("./_baseEvery"),g=a("./_baseIteratee"),h=a("./isArray"),i=a("./_isIterateeCall");b.exports=d},{"./_arrayEvery":26,"./_baseEvery":38,"./_baseIteratee":51,"./_isIterateeCall":89,"./isArray":137}],133:[function(a,b,c){function d(a,b,c){var d=null==a?void 0:e(a,b);return void 0===d?c:d}var e=a("./_baseGet");b.exports=d},{"./_baseGet":41}],134:[function(a,b,c){function d(a,b){return null!=a&&f(a,b,e)}var e=a("./_baseHasIn"),f=a("./_hasPath");b.exports=d},{"./_baseHasIn":44,"./_hasPath":82}],135:[function(a,b,c){function d(a){return a}b.exports=d},{}],136:[function(a,b,c){var d=a("./_baseIsArguments"),e=a("./isObjectLike"),f=Object.prototype,g=f.hasOwnProperty,h=f.propertyIsEnumerable,i=d(function(){return arguments}())?d:function(a){return e(a)&&g.call(a,"callee")&&!h.call(a,"callee")};b.exports=i},{"./_baseIsArguments":45,"./isObjectLike":144}],137:[function(a,b,c){var d=Array.isArray;b.exports=d},{}],138:[function(a,b,c){function d(a){
return null!=a&&f(a.length)&&!e(a)}var e=a("./isFunction"),f=a("./isLength");b.exports=d},{"./isFunction":141,"./isLength":142}],139:[function(a,b,c){var d=a("./_root"),e=a("./stubFalse"),f="object"==typeof c&&c&&!c.nodeType&&c,g=f&&"object"==typeof b&&b&&!b.nodeType&&b,h=g&&g.exports===f,i=h?d.Buffer:void 0,j=i?i.isBuffer:void 0,k=j||e;b.exports=k},{"./_root":114,"./stubFalse":152}],140:[function(a,b,c){function d(a){if(null==a)return!0;if(i(a)&&(h(a)||"string"==typeof a||"function"==typeof a.splice||j(a)||l(a)||g(a)))return!a.length;var b=f(a);if(b==m||b==n)return!a.size;if(k(a))return!e(a).length;for(var c in a)if(p.call(a,c))return!1;return!0}var e=a("./_baseKeys"),f=a("./_getTag"),g=a("./isArguments"),h=a("./isArray"),i=a("./isArrayLike"),j=a("./isBuffer"),k=a("./_isPrototype"),l=a("./isTypedArray"),m="[object Map]",n="[object Set]",o=Object.prototype,p=o.hasOwnProperty;b.exports=d},{"./_baseKeys":52,"./_getTag":80,"./_isPrototype":93,"./isArguments":136,"./isArray":137,"./isArrayLike":138,"./isBuffer":139,"./isTypedArray":146}],141:[function(a,b,c){function d(a){if(!f(a))return!1;var b=e(a);return b==h||b==i||b==g||b==j}var e=a("./_baseGetTag"),f=a("./isObject"),g="[object AsyncFunction]",h="[object Function]",i="[object GeneratorFunction]",j="[object Proxy]";b.exports=d},{"./_baseGetTag":43,"./isObject":143}],142:[function(a,b,c){function d(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=e}var e=9007199254740991;b.exports=d},{}],143:[function(a,b,c){function d(a){var b=typeof a;return null!=a&&("object"==b||"function"==b)}b.exports=d},{}],144:[function(a,b,c){function d(a){return null!=a&&"object"==typeof a}b.exports=d},{}],145:[function(a,b,c){function d(a){return"symbol"==typeof a||f(a)&&e(a)==g}var e=a("./_baseGetTag"),f=a("./isObjectLike"),g="[object Symbol]";b.exports=d},{"./_baseGetTag":43,"./isObjectLike":144}],146:[function(a,b,c){var d=a("./_baseIsTypedArray"),e=a("./_baseUnary"),f=a("./_nodeUtil"),g=f&&f.isTypedArray,h=g?e(g):d;b.exports=h},{"./_baseIsTypedArray":50,"./_baseUnary":61,"./_nodeUtil":110}],147:[function(a,b,c){function d(a){return g(a)?e(a):f(a)}var e=a("./_arrayLikeKeys"),f=a("./_baseKeys"),g=a("./isArrayLike");b.exports=d},{"./_arrayLikeKeys":28,"./_baseKeys":52,"./isArrayLike":138}],148:[function(a,c,d){(function(a){(function(){function e(a,b){return a.set(b[0],b[1]),a}function f(a,b){return a.add(b),a}function g(a,b,c){switch(c.length){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function h(a,b,c,d){for(var e=-1,f=null==a?0:a.length;++e<f;){var g=a[e];b(d,g,c(g),a)}return d}function i(a,b){for(var c=-1,d=null==a?0:a.length;++c<d&&b(a[c],c,a)!==!1;);return a}function j(a,b){for(var c=null==a?0:a.length;c--&&b(a[c],c,a)!==!1;);return a}function k(a,b){for(var c=-1,d=null==a?0:a.length;++c<d;)if(!b(a[c],c,a))return!1;return!0}function l(a,b){for(var c=-1,d=null==a?0:a.length,e=0,f=[];++c<d;){var g=a[c];b(g,c,a)&&(f[e++]=g)}return f}function m(a,b){var c=null==a?0:a.length;return!!c&&x(a,b,0)>-1}function n(a,b,c){for(var d=-1,e=null==a?0:a.length;++d<e;)if(c(b,a[d]))return!0;return!1}function o(a,b){for(var c=-1,d=null==a?0:a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function p(a,b){for(var c=-1,d=b.length,e=a.length;++c<d;)a[e+c]=b[c];return a}function q(a,b,c,d){var e=-1,f=null==a?0:a.length;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function r(a,b,c,d){var e=null==a?0:a.length;for(d&&e&&(c=a[--e]);e--;)c=b(c,a[e],e,a);return c}function s(a,b){for(var c=-1,d=null==a?0:a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}function t(a){return a.split("")}function u(a){return a.match(Qb)||[]}function v(a,b,c){var d;return c(a,function(a,c,e){if(b(a,c,e))return d=c,!1}),d}function w(a,b,c,d){for(var e=a.length,f=c+(d?1:-1);d?f--:++f<e;)if(b(a[f],f,a))return f;return-1}function x(a,b,c){return b===b?Y(a,b,c):w(a,z,c)}function y(a,b,c,d){for(var e=c-1,f=a.length;++e<f;)if(d(a[e],b))return e;return-1}function z(a){return a!==a}function A(a,b){var c=null==a?0:a.length;return c?F(a,b)/c:Ka}function B(a){return function(b){return null==b?da:b[a]}}function C(a){return function(b){return null==a?da:a[b]}}function D(a,b,c,d,e){return e(a,function(a,e,f){c=d?(d=!1,a):b(c,a,e,f)}),c}function E(a,b){var c=a.length;for(a.sort(b);c--;)a[c]=a[c].value;return a}function F(a,b){for(var c,d=-1,e=a.length;++d<e;){var f=b(a[d]);f!==da&&(c=c===da?f:c+f)}return c}function G(a,b){for(var c=-1,d=Array(a);++c<a;)d[c]=b(c);return d}function H(a,b){return o(b,function(b){return[b,a[b]]})}function I(a){return function(b){return a(b)}}function J(a,b){return o(b,function(b){return a[b]})}function K(a,b){return a.has(b)}function L(a,b){for(var c=-1,d=a.length;++c<d&&x(b,a[c],0)>-1;);return c}function M(a,b){for(var c=a.length;c--&&x(b,a[c],0)>-1;);return c}function N(a,b){for(var c=a.length,d=0;c--;)a[c]===b&&++d;return d}function O(a){return"\\"+ad[a]}function P(a,b){return null==a?da:a[b]}function Q(a){return Tc.test(a)}function R(a){return Uc.test(a)}function S(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function T(a){var b=-1,c=Array(a.size);return a.forEach(function(a,d){c[++b]=[d,a]}),c}function U(a,b){return function(c){return a(b(c))}}function V(a,b){for(var c=-1,d=a.length,e=0,f=[];++c<d;){var g=a[c];g!==b&&g!==ka||(a[c]=ka,f[e++]=c)}return f}function W(a){var b=-1,c=Array(a.size);return a.forEach(function(a){c[++b]=a}),c}function X(a){var b=-1,c=Array(a.size);return a.forEach(function(a){c[++b]=[a,a]}),c}function Y(a,b,c){for(var d=c-1,e=a.length;++d<e;)if(a[d]===b)return d;return-1}function Z(a,b,c){for(var d=c+1;d--;)if(a[d]===b)return d;return d}function $(a){return Q(a)?aa(a):rd(a)}function _(a){return Q(a)?ba(a):t(a)}function aa(a){for(var b=Rc.lastIndex=0;Rc.test(a);)++b;return b}function ba(a){return a.match(Rc)||[]}function ca(a){return a.match(Sc)||[]}var da,ea="4.17.4",fa=200,ga="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",ha="Expected a function",ia="__lodash_hash_undefined__",ja=500,ka="__lodash_placeholder__",la=1,ma=2,na=4,oa=1,pa=2,qa=1,ra=2,sa=4,ta=8,ua=16,va=32,wa=64,xa=128,ya=256,za=512,Aa=30,Ba="...",Ca=800,Da=16,Ea=1,Fa=2,Ga=3,Ha=1/0,Ia=9007199254740991,Ja=1.7976931348623157e308,Ka=NaN,La=4294967295,Ma=La-1,Na=La>>>1,Oa=[["ary",xa],["bind",qa],["bindKey",ra],["curry",ta],["curryRight",ua],["flip",za],["partial",va],["partialRight",wa],["rearg",ya]],Pa="[object Arguments]",Qa="[object Array]",Ra="[object AsyncFunction]",Sa="[object Boolean]",Ta="[object Date]",Ua="[object DOMException]",Va="[object Error]",Wa="[object Function]",Xa="[object GeneratorFunction]",Ya="[object Map]",Za="[object Number]",$a="[object Null]",_a="[object Object]",ab="[object Promise]",bb="[object Proxy]",cb="[object RegExp]",db="[object Set]",eb="[object String]",fb="[object Symbol]",gb="[object Undefined]",hb="[object WeakMap]",ib="[object WeakSet]",jb="[object ArrayBuffer]",kb="[object DataView]",lb="[object Float32Array]",mb="[object Float64Array]",nb="[object Int8Array]",ob="[object Int16Array]",pb="[object Int32Array]",qb="[object Uint8Array]",rb="[object Uint8ClampedArray]",sb="[object Uint16Array]",tb="[object Uint32Array]",ub=/\b__p \+= '';/g,vb=/\b(__p \+=) '' \+/g,wb=/(__e\(.*?\)|\b__t\)) \+\n'';/g,xb=/&(?:amp|lt|gt|quot|#39);/g,yb=/[&<>"']/g,zb=RegExp(xb.source),Ab=RegExp(yb.source),Bb=/<%-([\s\S]+?)%>/g,Cb=/<%([\s\S]+?)%>/g,Db=/<%=([\s\S]+?)%>/g,Eb=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Fb=/^\w*$/,Gb=/^\./,Hb=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ib=/[\\^$.*+?()[\]{}|]/g,Jb=RegExp(Ib.source),Kb=/^\s+|\s+$/g,Lb=/^\s+/,Mb=/\s+$/,Nb=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ob=/\{\n\/\* \[wrapped with (.+)\] \*/,Pb=/,? & /,Qb=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Rb=/\\(\\)?/g,Sb=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Tb=/\w*$/,Ub=/^[-+]0x[0-9a-f]+$/i,Vb=/^0b[01]+$/i,Wb=/^\[object .+?Constructor\]$/,Xb=/^0o[0-7]+$/i,Yb=/^(?:0|[1-9]\d*)$/,Zb=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,$b=/($^)/,_b=/['\n\r\u2028\u2029\\]/g,ac="\\ud800-\\udfff",bc="\\u0300-\\u036f",cc="\\ufe20-\\ufe2f",dc="\\u20d0-\\u20ff",ec=bc+cc+dc,fc="\\u2700-\\u27bf",gc="a-z\\xdf-\\xf6\\xf8-\\xff",hc="\\xac\\xb1\\xd7\\xf7",ic="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",jc="\\u2000-\\u206f",kc=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",lc="A-Z\\xc0-\\xd6\\xd8-\\xde",mc="\\ufe0e\\ufe0f",nc=hc+ic+jc+kc,oc="[']",pc="["+ac+"]",qc="["+nc+"]",rc="["+ec+"]",sc="\\d+",tc="["+fc+"]",uc="["+gc+"]",vc="[^"+ac+nc+sc+fc+gc+lc+"]",wc="\\ud83c[\\udffb-\\udfff]",xc="(?:"+rc+"|"+wc+")",yc="[^"+ac+"]",zc="(?:\\ud83c[\\udde6-\\uddff]){2}",Ac="[\\ud800-\\udbff][\\udc00-\\udfff]",Bc="["+lc+"]",Cc="\\u200d",Dc="(?:"+uc+"|"+vc+")",Ec="(?:"+Bc+"|"+vc+")",Fc="(?:"+oc+"(?:d|ll|m|re|s|t|ve))?",Gc="(?:"+oc+"(?:D|LL|M|RE|S|T|VE))?",Hc=xc+"?",Ic="["+mc+"]?",Jc="(?:"+Cc+"(?:"+[yc,zc,Ac].join("|")+")"+Ic+Hc+")*",Kc="\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",Lc="\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)",Mc=Ic+Hc+Jc,Nc="(?:"+[tc,zc,Ac].join("|")+")"+Mc,Oc="(?:"+[yc+rc+"?",rc,zc,Ac,pc].join("|")+")",Pc=RegExp(oc,"g"),Qc=RegExp(rc,"g"),Rc=RegExp(wc+"(?="+wc+")|"+Oc+Mc,"g"),Sc=RegExp([Bc+"?"+uc+"+"+Fc+"(?="+[qc,Bc,"$"].join("|")+")",Ec+"+"+Gc+"(?="+[qc,Bc+Dc,"$"].join("|")+")",Bc+"?"+Dc+"+"+Fc,Bc+"+"+Gc,Lc,Kc,sc,Nc].join("|"),"g"),Tc=RegExp("["+Cc+ac+ec+mc+"]"),Uc=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Vc=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Wc=-1,Xc={};Xc[lb]=Xc[mb]=Xc[nb]=Xc[ob]=Xc[pb]=Xc[qb]=Xc[rb]=Xc[sb]=Xc[tb]=!0,Xc[Pa]=Xc[Qa]=Xc[jb]=Xc[Sa]=Xc[kb]=Xc[Ta]=Xc[Va]=Xc[Wa]=Xc[Ya]=Xc[Za]=Xc[_a]=Xc[cb]=Xc[db]=Xc[eb]=Xc[hb]=!1;var Yc={};Yc[Pa]=Yc[Qa]=Yc[jb]=Yc[kb]=Yc[Sa]=Yc[Ta]=Yc[lb]=Yc[mb]=Yc[nb]=Yc[ob]=Yc[pb]=Yc[Ya]=Yc[Za]=Yc[_a]=Yc[cb]=Yc[db]=Yc[eb]=Yc[fb]=Yc[qb]=Yc[rb]=Yc[sb]=Yc[tb]=!0,Yc[Va]=Yc[Wa]=Yc[hb]=!1;var Zc={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"},$c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_c={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ad={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},bd=parseFloat,cd=parseInt,dd="object"==typeof a&&a&&a.Object===Object&&a,ed="object"==typeof self&&self&&self.Object===Object&&self,fd=dd||ed||Function("return this")(),gd="object"==typeof d&&d&&!d.nodeType&&d,hd=gd&&"object"==typeof c&&c&&!c.nodeType&&c,id=hd&&hd.exports===gd,jd=id&&dd.process,kd=function(){try{return jd&&jd.binding&&jd.binding("util")}catch(a){}}(),ld=kd&&kd.isArrayBuffer,md=kd&&kd.isDate,nd=kd&&kd.isMap,od=kd&&kd.isRegExp,pd=kd&&kd.isSet,qd=kd&&kd.isTypedArray,rd=B("length"),sd=C(Zc),td=C($c),ud=C(_c),vd=function a(b){function c(a){if(ii(a)&&!tm(a)&&!(a instanceof C)){if(a instanceof t)return a;if(tk.call(a,"__wrapped__"))return fg(a)}return new t(a)}function d(){}function t(a,b){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!b,this.__index__=0,this.__values__=da}function C(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=La,this.__views__=[]}function Y(){var a=new C(this.__wrapped__);return a.__actions__=Ne(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=Ne(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=Ne(this.__views__),a}function aa(){if(this.__filtered__){var a=new C(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a}function ba(){var a=this.__wrapped__.value(),b=this.__dir__,c=tm(a),d=b<0,e=c?a.length:0,f=Df(0,e,this.__views__),g=f.start,h=f.end,i=h-g,j=d?h:g-1,k=this.__iteratees__,l=k.length,m=0,n=Xk(i,this.__takeCount__);if(!c||!d&&e==i&&n==i)return ue(a,this.__actions__);var o=[];a:for(;i--&&m<n;){j+=b;for(var p=-1,q=a[j];++p<l;){var r=k[p],s=r.iteratee,t=r.type,u=s(q);if(t==Fa)q=u;else if(!u){if(t==Ea)continue a;break a}}o[m++]=q}return o}function Qb(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function ac(){this.__data__=fl?fl(null):{},this.size=0}function bc(a){var b=this.has(a)&&delete this.__data__[a];return this.size-=b?1:0,b}function cc(a){var b=this.__data__;if(fl){var c=b[a];return c===ia?da:c}return tk.call(b,a)?b[a]:da}function dc(a){var b=this.__data__;return fl?b[a]!==da:tk.call(b,a)}function ec(a,b){var c=this.__data__;return this.size+=this.has(a)?0:1,c[a]=fl&&b===da?ia:b,this}function fc(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function gc(){this.__data__=[],this.size=0}function hc(a){var b=this.__data__,c=Gc(b,a);if(c<0)return!1;var d=b.length-1;return c==d?b.pop():Hk.call(b,c,1),--this.size,!0}function ic(a){var b=this.__data__,c=Gc(b,a);return c<0?da:b[c][1]}function jc(a){return Gc(this.__data__,a)>-1}function kc(a,b){var c=this.__data__,d=Gc(c,a);return d<0?(++this.size,c.push([a,b])):c[d][1]=b,this}function lc(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function mc(){this.size=0,this.__data__={hash:new Qb,map:new(bl||fc),string:new Qb}}function nc(a){var b=zf(this,a).delete(a);return this.size-=b?1:0,b}function oc(a){return zf(this,a).get(a)}function pc(a){return zf(this,a).has(a)}function qc(a,b){var c=zf(this,a),d=c.size;return c.set(a,b),this.size+=c.size==d?0:1,this}function rc(a){var b=-1,c=null==a?0:a.length;for(this.__data__=new lc;++b<c;)this.add(a[b])}function sc(a){return this.__data__.set(a,ia),this}function tc(a){return this.__data__.has(a)}function uc(a){var b=this.__data__=new fc(a);this.size=b.size}function vc(){this.__data__=new fc,this.size=0}function wc(a){var b=this.__data__,c=b.delete(a);return this.size=b.size,c}function xc(a){return this.__data__.get(a)}function yc(a){return this.__data__.has(a)}function zc(a,b){var c=this.__data__;if(c instanceof fc){var d=c.__data__;if(!bl||d.length<fa-1)return d.push([a,b]),this.size=++c.size,this;c=this.__data__=new lc(d)}return c.set(a,b),this.size=c.size,this}function Ac(a,b){var c=tm(a),d=!c&&sm(a),e=!c&&!d&&vm(a),f=!c&&!d&&!e&&Am(a),g=c||d||e||f,h=g?G(a.length,mk):[],i=h.length;for(var j in a)!b&&!tk.call(a,j)||g&&("length"==j||e&&("offset"==j||"parent"==j)||f&&("buffer"==j||"byteLength"==j||"byteOffset"==j)||Lf(j,i))||h.push(j);return h}function Bc(a){var b=a.length;return b?a[be(0,b-1)]:da}function Cc(a,b){return bg(Ne(a),Mc(b,0,a.length))}function Dc(a){return bg(Ne(a))}function Ec(a,b,c){(c===da||Wh(a[b],c))&&(c!==da||b in a)||Kc(a,b,c)}function Fc(a,b,c){var d=a[b];tk.call(a,b)&&Wh(d,c)&&(c!==da||b in a)||Kc(a,b,c)}function Gc(a,b){for(var c=a.length;c--;)if(Wh(a[c][0],b))return c;return-1}function Hc(a,b,c,d){return rl(a,function(a,e,f){b(d,a,c(a),f)}),d}function Ic(a,b){return a&&Oe(b,Ri(b),a)}function Jc(a,b){return a&&Oe(b,Si(b),a)}function Kc(a,b,c){"__proto__"==b&&Lk?Lk(a,b,{configurable:!0,enumerable:!0,value:c,writable:!0}):a[b]=c}function Lc(a,b){for(var c=-1,d=b.length,e=fk(d),f=null==a;++c<d;)e[c]=f?da:Oi(a,b[c]);return e}function Mc(a,b,c){return a===a&&(c!==da&&(a=a<=c?a:c),b!==da&&(a=a>=b?a:b)),a}function Nc(a,b,c,d,e,f){var g,h=b&la,j=b&ma,k=b&na;if(c&&(g=e?c(a,d,e,f):c(a)),g!==da)return g;if(!hi(a))return a;var l=tm(a);if(l){if(g=Gf(a),!h)return Ne(a,g)}else{var m=Dl(a),n=m==Wa||m==Xa;if(vm(a))return Be(a,h);if(m==_a||m==Pa||n&&!e){if(g=j||n?{}:Hf(a),!h)return j?Qe(a,Jc(g,a)):Pe(a,Ic(g,a))}else{if(!Yc[m])return e?a:{};g=If(a,m,Nc,h)}}f||(f=new uc);var o=f.get(a);if(o)return o;f.set(a,g);var p=k?j?vf:uf:j?Si:Ri,q=l?da:p(a);return i(q||a,function(d,e){q&&(e=d,d=a[e]),Fc(g,e,Nc(d,b,c,e,a,f))}),g}function Oc(a){var b=Ri(a);return function(c){return Rc(c,a,b)}}function Rc(a,b,c){var d=c.length;if(null==a)return!d;for(a=kk(a);d--;){var e=c[d],f=b[e],g=a[e];if(g===da&&!(e in a)||!f(g))return!1}return!0}function Sc(a,b,c){if("function"!=typeof a)throw new nk(ha);return Gl(function(){a.apply(da,c)},b)}function Tc(a,b,c,d){var e=-1,f=m,g=!0,h=a.length,i=[],j=b.length;if(!h)return i;c&&(b=o(b,I(c))),d?(f=n,g=!1):b.length>=fa&&(f=K,g=!1,b=new rc(b));a:for(;++e<h;){var k=a[e],l=null==c?k:c(k);if(k=d||0!==k?k:0,g&&l===l){for(var p=j;p--;)if(b[p]===l)continue a;i.push(k)}else f(b,l,d)||i.push(k)}return i}function Uc(a,b){var c=!0;return rl(a,function(a,d,e){return c=!!b(a,d,e)}),c}function Zc(a,b,c){for(var d=-1,e=a.length;++d<e;){var f=a[d],g=b(f);if(null!=g&&(h===da?g===g&&!ti(g):c(g,h)))var h=g,i=f}return i}function $c(a,b,c,d){var e=a.length;for(c=zi(c),c<0&&(c=-c>e?0:e+c),d=d===da||d>e?e:zi(d),d<0&&(d+=e),d=c>d?0:Ai(d);c<d;)a[c++]=b;return a}function _c(a,b){var c=[];return rl(a,function(a,d,e){b(a,d,e)&&c.push(a)}),c}function ad(a,b,c,d,e){var f=-1,g=a.length;for(c||(c=Kf),e||(e=[]);++f<g;){var h=a[f];b>0&&c(h)?b>1?ad(h,b-1,c,d,e):p(e,h):d||(e[e.length]=h)}return e}function dd(a,b){return a&&tl(a,b,Ri)}function ed(a,b){return a&&ul(a,b,Ri)}function gd(a,b){return l(b,function(b){return ei(a[b])})}function hd(a,b){b=ze(b,a);for(var c=0,d=b.length;null!=a&&c<d;)a=a[cg(b[c++])];return c&&c==d?a:da}function jd(a,b,c){var d=b(a);return tm(a)?d:p(d,c(a))}function kd(a){return null==a?a===da?gb:$a:Kk&&Kk in kk(a)?Cf(a):Xf(a)}function rd(a,b){return a>b}function vd(a,b){return null!=a&&tk.call(a,b)}function xd(a,b){return null!=a&&b in kk(a)}function yd(a,b,c){return a>=Xk(b,c)&&a<Wk(b,c)}function zd(a,b,c){for(var d=c?n:m,e=a[0].length,f=a.length,g=f,h=fk(f),i=1/0,j=[];g--;){var k=a[g];g&&b&&(k=o(k,I(b))),i=Xk(k.length,i),h[g]=!c&&(b||e>=120&&k.length>=120)?new rc(g&&k):da}k=a[0];var l=-1,p=h[0];a:for(;++l<e&&j.length<i;){var q=k[l],r=b?b(q):q;if(q=c||0!==q?q:0,!(p?K(p,r):d(j,r,c))){for(g=f;--g;){var s=h[g];if(!(s?K(s,r):d(a[g],r,c)))continue a}p&&p.push(r),j.push(q)}}return j}function Ad(a,b,c,d){return dd(a,function(a,e,f){b(d,c(a),e,f)}),d}function Bd(a,b,c){b=ze(b,a),a=Zf(a,b);var d=null==a?a:a[cg(yg(b))];return null==d?da:g(d,a,c)}function Cd(a){return ii(a)&&kd(a)==Pa}function Dd(a){return ii(a)&&kd(a)==jb}function Ed(a){return ii(a)&&kd(a)==Ta}function Fd(a,b,c,d,e){return a===b||(null==a||null==b||!ii(a)&&!ii(b)?a!==a&&b!==b:Gd(a,b,c,d,Fd,e))}function Gd(a,b,c,d,e,f){var g=tm(a),h=tm(b),i=g?Qa:Dl(a),j=h?Qa:Dl(b);i=i==Pa?_a:i,j=j==Pa?_a:j;var k=i==_a,l=j==_a,m=i==j;if(m&&vm(a)){if(!vm(b))return!1;g=!0,k=!1}if(m&&!k)return f||(f=new uc),g||Am(a)?qf(a,b,c,d,e,f):rf(a,b,i,c,d,e,f);if(!(c&oa)){var n=k&&tk.call(a,"__wrapped__"),o=l&&tk.call(b,"__wrapped__");if(n||o){var p=n?a.value():a,q=o?b.value():b;return f||(f=new uc),e(p,q,c,d,f)}}return!!m&&(f||(f=new uc),sf(a,b,c,d,e,f))}function Hd(a){return ii(a)&&Dl(a)==Ya}function Id(a,b,c,d){var e=c.length,f=e,g=!d;if(null==a)return!f;for(a=kk(a);e--;){var h=c[e];if(g&&h[2]?h[1]!==a[h[0]]:!(h[0]in a))return!1}for(;++e<f;){h=c[e];var i=h[0],j=a[i],k=h[1];if(g&&h[2]){if(j===da&&!(i in a))return!1}else{var l=new uc;if(d)var m=d(j,k,i,a,b,l);if(!(m===da?Fd(k,j,oa|pa,d,l):m))return!1}}return!0}function Jd(a){if(!hi(a)||Qf(a))return!1;var b=ei(a)?zk:Wb;return b.test(dg(a))}function Kd(a){return ii(a)&&kd(a)==cb}function Ld(a){return ii(a)&&Dl(a)==db}function Md(a){return ii(a)&&gi(a.length)&&!!Xc[kd(a)]}function Nd(a){return"function"==typeof a?a:null==a?Hj:"object"==typeof a?tm(a)?Td(a[0],a[1]):Sd(a):Pj(a)}function Od(a){if(!Rf(a))return Vk(a);var b=[];for(var c in kk(a))tk.call(a,c)&&"constructor"!=c&&b.push(c);return b}function Pd(a){if(!hi(a))return Wf(a);var b=Rf(a),c=[];for(var d in a)("constructor"!=d||!b&&tk.call(a,d))&&c.push(d);return c}function Qd(a,b){return a<b}function Rd(a,b){var c=-1,d=Xh(a)?fk(a.length):[];return rl(a,function(a,e,f){d[++c]=b(a,e,f)}),d}function Sd(a){var b=Af(a);return 1==b.length&&b[0][2]?Tf(b[0][0],b[0][1]):function(c){return c===a||Id(c,a,b)}}function Td(a,b){return Nf(a)&&Sf(b)?Tf(cg(a),b):function(c){var d=Oi(c,a);return d===da&&d===b?Qi(c,a):Fd(b,d,oa|pa)}}function Ud(a,b,c,d,e){a!==b&&tl(b,function(f,g){if(hi(f))e||(e=new uc),Vd(a,b,g,c,Ud,d,e);else{var h=d?d(a[g],f,g+"",a,b,e):da;h===da&&(h=f),Ec(a,g,h)}},Si)}function Vd(a,b,c,d,e,f,g){var h=a[c],i=b[c],j=g.get(i);if(j)return void Ec(a,c,j);var k=f?f(h,i,c+"",a,b,g):da,l=k===da;if(l){var m=tm(i),n=!m&&vm(i),o=!m&&!n&&Am(i);k=i,m||n||o?tm(h)?k=h:Yh(h)?k=Ne(h):n?(l=!1,k=Be(i,!0)):o?(l=!1,k=Ie(i,!0)):k=[]:qi(i)||sm(i)?(k=h,sm(h)?k=Ci(h):(!hi(h)||d&&ei(h))&&(k=Hf(i))):l=!1}l&&(g.set(i,k),e(k,i,d,f,g),g.delete(i)),Ec(a,c,k)}function Wd(a,b){var c=a.length;if(c)return b+=b<0?c:0,Lf(b,c)?a[b]:da}function Xd(a,b,c){var d=-1;b=o(b.length?b:[Hj],I(yf()));var e=Rd(a,function(a,c,e){var f=o(b,function(b){return b(a)});return{criteria:f,index:++d,value:a}});return E(e,function(a,b){return Ke(a,b,c)})}function Yd(a,b){return Zd(a,b,function(b,c){return Qi(a,c)})}function Zd(a,b,c){for(var d=-1,e=b.length,f={};++d<e;){var g=b[d],h=hd(a,g);c(h,g)&&he(f,ze(g,a),h)}return f}function $d(a){return function(b){return hd(b,a)}}function _d(a,b,c,d){var e=d?y:x,f=-1,g=b.length,h=a;for(a===b&&(b=Ne(b)),c&&(h=o(a,I(c)));++f<g;)for(var i=0,j=b[f],k=c?c(j):j;(i=e(h,k,i,d))>-1;)h!==a&&Hk.call(h,i,1),Hk.call(a,i,1);return a}function ae(a,b){for(var c=a?b.length:0,d=c-1;c--;){var e=b[c];if(c==d||e!==f){var f=e;Lf(e)?Hk.call(a,e,1):re(a,e)}}return a}function be(a,b){return a+Qk($k()*(b-a+1))}function ce(a,b,c,d){for(var e=-1,f=Wk(Pk((b-a)/(c||1)),0),g=fk(f);f--;)g[d?f:++e]=a,a+=c;return g}function de(a,b){var c="";if(!a||b<1||b>Ia)return c;do b%2&&(c+=a),b=Qk(b/2),b&&(a+=a);while(b);return c}function ee(a,b){return Hl(Yf(a,b,Hj),a+"")}function fe(a){return Bc(cj(a))}function ge(a,b){var c=cj(a);return bg(c,Mc(b,0,c.length))}function he(a,b,c,d){if(!hi(a))return a;b=ze(b,a);for(var e=-1,f=b.length,g=f-1,h=a;null!=h&&++e<f;){var i=cg(b[e]),j=c;if(e!=g){var k=h[i];j=d?d(k,i,h):da,j===da&&(j=hi(k)?k:Lf(b[e+1])?[]:{})}Fc(h,i,j),h=h[i]}return a}function ie(a){return bg(cj(a))}function je(a,b,c){var d=-1,e=a.length;b<0&&(b=-b>e?0:e+b),c=c>e?e:c,c<0&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=fk(e);++d<e;)f[d]=a[d+b];return f}function ke(a,b){var c;return rl(a,function(a,d,e){return c=b(a,d,e),!c}),!!c}function le(a,b,c){var d=0,e=null==a?d:a.length;if("number"==typeof b&&b===b&&e<=Na){for(;d<e;){var f=d+e>>>1,g=a[f];null!==g&&!ti(g)&&(c?g<=b:g<b)?d=f+1:e=f}return e}return me(a,b,Hj,c)}function me(a,b,c,d){b=c(b);for(var e=0,f=null==a?0:a.length,g=b!==b,h=null===b,i=ti(b),j=b===da;e<f;){var k=Qk((e+f)/2),l=c(a[k]),m=l!==da,n=null===l,o=l===l,p=ti(l);if(g)var q=d||o;else q=j?o&&(d||m):h?o&&m&&(d||!n):i?o&&m&&!n&&(d||!p):!n&&!p&&(d?l<=b:l<b);q?e=k+1:f=k}return Xk(f,Ma)}function ne(a,b){for(var c=-1,d=a.length,e=0,f=[];++c<d;){var g=a[c],h=b?b(g):g;if(!c||!Wh(h,i)){var i=h;f[e++]=0===g?0:g}}return f}function oe(a){return"number"==typeof a?a:ti(a)?Ka:+a}function pe(a){if("string"==typeof a)return a;if(tm(a))return o(a,pe)+"";if(ti(a))return pl?pl.call(a):"";var b=a+"";return"0"==b&&1/a==-Ha?"-0":b}function qe(a,b,c){var d=-1,e=m,f=a.length,g=!0,h=[],i=h;if(c)g=!1,e=n;else if(f>=fa){var j=b?null:zl(a);if(j)return W(j);g=!1,e=K,i=new rc}else i=b?[]:h;a:for(;++d<f;){var k=a[d],l=b?b(k):k;if(k=c||0!==k?k:0,g&&l===l){for(var o=i.length;o--;)if(i[o]===l)continue a;b&&i.push(l),h.push(k)}else e(i,l,c)||(i!==h&&i.push(l),h.push(k))}return h}function re(a,b){return b=ze(b,a),a=Zf(a,b),null==a||delete a[cg(yg(b))]}function se(a,b,c,d){return he(a,b,c(hd(a,b)),d)}function te(a,b,c,d){for(var e=a.length,f=d?e:-1;(d?f--:++f<e)&&b(a[f],f,a););return c?je(a,d?0:f,d?f+1:e):je(a,d?f+1:0,d?e:f)}function ue(a,b){var c=a;return c instanceof C&&(c=c.value()),q(b,function(a,b){return b.func.apply(b.thisArg,p([a],b.args))},c)}function ve(a,b,c){var d=a.length;if(d<2)return d?qe(a[0]):[];for(var e=-1,f=fk(d);++e<d;)for(var g=a[e],h=-1;++h<d;)h!=e&&(f[e]=Tc(f[e]||g,a[h],b,c));return qe(ad(f,1),b,c)}function we(a,b,c){for(var d=-1,e=a.length,f=b.length,g={};++d<e;){var h=d<f?b[d]:da;c(g,a[d],h)}return g}function xe(a){return Yh(a)?a:[]}function ye(a){return"function"==typeof a?a:Hj}function ze(a,b){return tm(a)?a:Nf(a,b)?[a]:Il(Ei(a))}function Ae(a,b,c){var d=a.length;return c=c===da?d:c,!b&&c>=d?a:je(a,b,c)}function Be(a,b){if(b)return a.slice();var c=a.length,d=Dk?Dk(c):new a.constructor(c);return a.copy(d),d}function Ce(a){var b=new a.constructor(a.byteLength);return new Ck(b).set(new Ck(a)),b}function De(a,b){var c=b?Ce(a.buffer):a.buffer;return new a.constructor(c,a.byteOffset,a.byteLength)}function Ee(a,b,c){var d=b?c(T(a),la):T(a);return q(d,e,new a.constructor)}function Fe(a){var b=new a.constructor(a.source,Tb.exec(a));return b.lastIndex=a.lastIndex,b}function Ge(a,b,c){var d=b?c(W(a),la):W(a);return q(d,f,new a.constructor)}function He(a){return ol?kk(ol.call(a)):{}}function Ie(a,b){var c=b?Ce(a.buffer):a.buffer;return new a.constructor(c,a.byteOffset,a.length)}function Je(a,b){if(a!==b){var c=a!==da,d=null===a,e=a===a,f=ti(a),g=b!==da,h=null===b,i=b===b,j=ti(b);if(!h&&!j&&!f&&a>b||f&&g&&i&&!h&&!j||d&&g&&i||!c&&i||!e)return 1;if(!d&&!f&&!j&&a<b||j&&c&&e&&!d&&!f||h&&c&&e||!g&&e||!i)return-1}return 0}function Ke(a,b,c){for(var d=-1,e=a.criteria,f=b.criteria,g=e.length,h=c.length;++d<g;){var i=Je(e[d],f[d]);if(i){if(d>=h)return i;var j=c[d];return i*("desc"==j?-1:1)}}return a.index-b.index}function Le(a,b,c,d){for(var e=-1,f=a.length,g=c.length,h=-1,i=b.length,j=Wk(f-g,0),k=fk(i+j),l=!d;++h<i;)k[h]=b[h];for(;++e<g;)(l||e<f)&&(k[c[e]]=a[e]);for(;j--;)k[h++]=a[e++];return k}function Me(a,b,c,d){for(var e=-1,f=a.length,g=-1,h=c.length,i=-1,j=b.length,k=Wk(f-h,0),l=fk(k+j),m=!d;++e<k;)l[e]=a[e];for(var n=e;++i<j;)l[n+i]=b[i];for(;++g<h;)(m||e<f)&&(l[n+c[g]]=a[e++]);return l}function Ne(a,b){var c=-1,d=a.length;for(b||(b=fk(d));++c<d;)b[c]=a[c];return b}function Oe(a,b,c,d){var e=!c;c||(c={});for(var f=-1,g=b.length;++f<g;){var h=b[f],i=d?d(c[h],a[h],h,c,a):da;i===da&&(i=a[h]),e?Kc(c,h,i):Fc(c,h,i)}return c}function Pe(a,b){return Oe(a,Bl(a),b)}function Qe(a,b){return Oe(a,Cl(a),b)}function Re(a,b){return function(c,d){var e=tm(c)?h:Hc,f=b?b():{};return e(c,a,yf(d,2),f)}}function Se(a){return ee(function(b,c){var d=-1,e=c.length,f=e>1?c[e-1]:da,g=e>2?c[2]:da;for(f=a.length>3&&"function"==typeof f?(e--,f):da,g&&Mf(c[0],c[1],g)&&(f=e<3?da:f,e=1),b=kk(b);++d<e;){var h=c[d];h&&a(b,h,d,f)}return b})}function Te(a,b){return function(c,d){if(null==c)return c;if(!Xh(c))return a(c,d);for(var e=c.length,f=b?e:-1,g=kk(c);(b?f--:++f<e)&&d(g[f],f,g)!==!1;);return c}}function Ue(a){return function(b,c,d){for(var e=-1,f=kk(b),g=d(b),h=g.length;h--;){var i=g[a?h:++e];if(c(f[i],i,f)===!1)break}return b}}function Ve(a,b,c){function d(){var b=this&&this!==fd&&this instanceof d?f:a;return b.apply(e?c:this,arguments)}var e=b&qa,f=Ye(a);return d}function We(a){return function(b){b=Ei(b);var c=Q(b)?_(b):da,d=c?c[0]:b.charAt(0),e=c?Ae(c,1).join(""):b.slice(1);return d[a]()+e}}function Xe(a){return function(b){return q(Cj(ij(b).replace(Pc,"")),a,"")}}function Ye(a){return function(){var b=arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var c=ql(a.prototype),d=a.apply(c,b);return hi(d)?d:c}}function Ze(a,b,c){function d(){for(var f=arguments.length,h=fk(f),i=f,j=xf(d);i--;)h[i]=arguments[i];var k=f<3&&h[0]!==j&&h[f-1]!==j?[]:V(h,j);if(f-=k.length,f<c)return jf(a,b,af,d.placeholder,da,h,k,da,da,c-f);var l=this&&this!==fd&&this instanceof d?e:a;return g(l,this,h)}var e=Ye(a);return d}function $e(a){return function(b,c,d){var e=kk(b);if(!Xh(b)){var f=yf(c,3);b=Ri(b),c=function(a){return f(e[a],a,e)}}var g=a(b,c,d);return g>-1?e[f?b[g]:g]:da}}function _e(a){return tf(function(b){var c=b.length,d=c,e=t.prototype.thru;for(a&&b.reverse();d--;){var f=b[d];if("function"!=typeof f)throw new nk(ha);if(e&&!g&&"wrapper"==wf(f))var g=new t([],!0)}for(d=g?d:c;++d<c;){f=b[d];var h=wf(f),i="wrapper"==h?Al(f):da;g=i&&Pf(i[0])&&i[1]==(xa|ta|va|ya)&&!i[4].length&&1==i[9]?g[wf(i[0])].apply(g,i[3]):1==f.length&&Pf(f)?g[h]():g.thru(f)}return function(){var a=arguments,d=a[0];if(g&&1==a.length&&tm(d))return g.plant(d).value();for(var e=0,f=c?b[e].apply(this,a):d;++e<c;)f=b[e].call(this,f);return f}})}function af(a,b,c,d,e,f,g,h,i,j){function k(){for(var r=arguments.length,s=fk(r),t=r;t--;)s[t]=arguments[t];if(o)var u=xf(k),v=N(s,u);if(d&&(s=Le(s,d,e,o)),f&&(s=Me(s,f,g,o)),r-=v,o&&r<j){var w=V(s,u);return jf(a,b,af,k.placeholder,c,s,w,h,i,j-r)}var x=m?c:this,y=n?x[a]:a;return r=s.length,h?s=$f(s,h):p&&r>1&&s.reverse(),l&&i<r&&(s.length=i),this&&this!==fd&&this instanceof k&&(y=q||Ye(y)),y.apply(x,s)}var l=b&xa,m=b&qa,n=b&ra,o=b&(ta|ua),p=b&za,q=n?da:Ye(a);return k}function bf(a,b){return function(c,d){return Ad(c,a,b(d),{})}}function cf(a,b){return function(c,d){var e;if(c===da&&d===da)return b;if(c!==da&&(e=c),d!==da){if(e===da)return d;"string"==typeof c||"string"==typeof d?(c=pe(c),d=pe(d)):(c=oe(c),d=oe(d)),e=a(c,d)}return e}}function df(a){return tf(function(b){return b=o(b,I(yf())),ee(function(c){var d=this;return a(b,function(a){return g(a,d,c)})})})}function ef(a,b){b=b===da?" ":pe(b);var c=b.length;if(c<2)return c?de(b,a):b;var d=de(b,Pk(a/$(b)));return Q(b)?Ae(_(d),0,a).join(""):d.slice(0,a)}function ff(a,b,c,d){function e(){for(var b=-1,i=arguments.length,j=-1,k=d.length,l=fk(k+i),m=this&&this!==fd&&this instanceof e?h:a;++j<k;)l[j]=d[j];for(;i--;)l[j++]=arguments[++b];return g(m,f?c:this,l)}var f=b&qa,h=Ye(a);return e}function gf(a){return function(b,c,d){return d&&"number"!=typeof d&&Mf(b,c,d)&&(c=d=da),b=yi(b),c===da?(c=b,b=0):c=yi(c),d=d===da?b<c?1:-1:yi(d),ce(b,c,d,a)}}function hf(a){return function(b,c){return"string"==typeof b&&"string"==typeof c||(b=Bi(b),c=Bi(c)),a(b,c)}}function jf(a,b,c,d,e,f,g,h,i,j){var k=b&ta,l=k?g:da,m=k?da:g,n=k?f:da,o=k?da:f;b|=k?va:wa,b&=~(k?wa:va),b&sa||(b&=~(qa|ra));var p=[a,b,e,n,l,o,m,h,i,j],q=c.apply(da,p);return Pf(a)&&Fl(q,p),q.placeholder=d,_f(q,a,b)}function kf(a){var b=jk[a];return function(a,c){if(a=Bi(a),c=null==c?0:Xk(zi(c),292)){var d=(Ei(a)+"e").split("e"),e=b(d[0]+"e"+(+d[1]+c));return d=(Ei(e)+"e").split("e"),
+(d[0]+"e"+(+d[1]-c))}return b(a)}}function lf(a){return function(b){var c=Dl(b);return c==Ya?T(b):c==db?X(b):H(b,a(b))}}function mf(a,b,c,d,e,f,g,h){var i=b&ra;if(!i&&"function"!=typeof a)throw new nk(ha);var j=d?d.length:0;if(j||(b&=~(va|wa),d=e=da),g=g===da?g:Wk(zi(g),0),h=h===da?h:zi(h),j-=e?e.length:0,b&wa){var k=d,l=e;d=e=da}var m=i?da:Al(a),n=[a,b,c,d,e,k,l,f,g,h];if(m&&Vf(n,m),a=n[0],b=n[1],c=n[2],d=n[3],e=n[4],h=n[9]=n[9]===da?i?0:a.length:Wk(n[9]-j,0),!h&&b&(ta|ua)&&(b&=~(ta|ua)),b&&b!=qa)o=b==ta||b==ua?Ze(a,b,h):b!=va&&b!=(qa|va)||e.length?af.apply(da,n):ff(a,b,c,d);else var o=Ve(a,b,c);var p=m?vl:Fl;return _f(p(o,n),a,b)}function nf(a,b,c,d){return a===da||Wh(a,qk[c])&&!tk.call(d,c)?b:a}function of(a,b,c,d,e,f){return hi(a)&&hi(b)&&(f.set(b,a),Ud(a,b,da,of,f),f.delete(b)),a}function pf(a){return qi(a)?da:a}function qf(a,b,c,d,e,f){var g=c&oa,h=a.length,i=b.length;if(h!=i&&!(g&&i>h))return!1;var j=f.get(a);if(j&&f.get(b))return j==b;var k=-1,l=!0,m=c&pa?new rc:da;for(f.set(a,b),f.set(b,a);++k<h;){var n=a[k],o=b[k];if(d)var p=g?d(o,n,k,b,a,f):d(n,o,k,a,b,f);if(p!==da){if(p)continue;l=!1;break}if(m){if(!s(b,function(a,b){if(!K(m,b)&&(n===a||e(n,a,c,d,f)))return m.push(b)})){l=!1;break}}else if(n!==o&&!e(n,o,c,d,f)){l=!1;break}}return f.delete(a),f.delete(b),l}function rf(a,b,c,d,e,f,g){switch(c){case kb:if(a.byteLength!=b.byteLength||a.byteOffset!=b.byteOffset)return!1;a=a.buffer,b=b.buffer;case jb:return!(a.byteLength!=b.byteLength||!f(new Ck(a),new Ck(b)));case Sa:case Ta:case Za:return Wh(+a,+b);case Va:return a.name==b.name&&a.message==b.message;case cb:case eb:return a==b+"";case Ya:var h=T;case db:var i=d&oa;if(h||(h=W),a.size!=b.size&&!i)return!1;var j=g.get(a);if(j)return j==b;d|=pa,g.set(a,b);var k=qf(h(a),h(b),d,e,f,g);return g.delete(a),k;case fb:if(ol)return ol.call(a)==ol.call(b)}return!1}function sf(a,b,c,d,e,f){var g=c&oa,h=uf(a),i=h.length,j=uf(b),k=j.length;if(i!=k&&!g)return!1;for(var l=i;l--;){var m=h[l];if(!(g?m in b:tk.call(b,m)))return!1}var n=f.get(a);if(n&&f.get(b))return n==b;var o=!0;f.set(a,b),f.set(b,a);for(var p=g;++l<i;){m=h[l];var q=a[m],r=b[m];if(d)var s=g?d(r,q,m,b,a,f):d(q,r,m,a,b,f);if(!(s===da?q===r||e(q,r,c,d,f):s)){o=!1;break}p||(p="constructor"==m)}if(o&&!p){var t=a.constructor,u=b.constructor;t!=u&&"constructor"in a&&"constructor"in b&&!("function"==typeof t&&t instanceof t&&"function"==typeof u&&u instanceof u)&&(o=!1)}return f.delete(a),f.delete(b),o}function tf(a){return Hl(Yf(a,da,qg),a+"")}function uf(a){return jd(a,Ri,Bl)}function vf(a){return jd(a,Si,Cl)}function wf(a){for(var b=a.name+"",c=hl[b],d=tk.call(hl,b)?c.length:0;d--;){var e=c[d],f=e.func;if(null==f||f==a)return e.name}return b}function xf(a){var b=tk.call(c,"placeholder")?c:a;return b.placeholder}function yf(){var a=c.iteratee||Ij;return a=a===Ij?Nd:a,arguments.length?a(arguments[0],arguments[1]):a}function zf(a,b){var c=a.__data__;return Of(b)?c["string"==typeof b?"string":"hash"]:c.map}function Af(a){for(var b=Ri(a),c=b.length;c--;){var d=b[c],e=a[d];b[c]=[d,e,Sf(e)]}return b}function Bf(a,b){var c=P(a,b);return Jd(c)?c:da}function Cf(a){var b=tk.call(a,Kk),c=a[Kk];try{a[Kk]=da;var d=!0}catch(e){}var f=wk.call(a);return d&&(b?a[Kk]=c:delete a[Kk]),f}function Df(a,b,c){for(var d=-1,e=c.length;++d<e;){var f=c[d],g=f.size;switch(f.type){case"drop":a+=g;break;case"dropRight":b-=g;break;case"take":b=Xk(b,a+g);break;case"takeRight":a=Wk(a,b-g)}}return{start:a,end:b}}function Ef(a){var b=a.match(Ob);return b?b[1].split(Pb):[]}function Ff(a,b,c){b=ze(b,a);for(var d=-1,e=b.length,f=!1;++d<e;){var g=cg(b[d]);if(!(f=null!=a&&c(a,g)))break;a=a[g]}return f||++d!=e?f:(e=null==a?0:a.length,!!e&&gi(e)&&Lf(g,e)&&(tm(a)||sm(a)))}function Gf(a){var b=a.length,c=a.constructor(b);return b&&"string"==typeof a[0]&&tk.call(a,"index")&&(c.index=a.index,c.input=a.input),c}function Hf(a){return"function"!=typeof a.constructor||Rf(a)?{}:ql(Ek(a))}function If(a,b,c,d){var e=a.constructor;switch(b){case jb:return Ce(a);case Sa:case Ta:return new e(+a);case kb:return De(a,d);case lb:case mb:case nb:case ob:case pb:case qb:case rb:case sb:case tb:return Ie(a,d);case Ya:return Ee(a,d,c);case Za:case eb:return new e(a);case cb:return Fe(a);case db:return Ge(a,d,c);case fb:return He(a)}}function Jf(a,b){var c=b.length;if(!c)return a;var d=c-1;return b[d]=(c>1?"& ":"")+b[d],b=b.join(c>2?", ":" "),a.replace(Nb,"{\n/* [wrapped with "+b+"] */\n")}function Kf(a){return tm(a)||sm(a)||!!(Ik&&a&&a[Ik])}function Lf(a,b){return b=null==b?Ia:b,!!b&&("number"==typeof a||Yb.test(a))&&a>-1&&a%1==0&&a<b}function Mf(a,b,c){if(!hi(c))return!1;var d=typeof b;return!!("number"==d?Xh(c)&&Lf(b,c.length):"string"==d&&b in c)&&Wh(c[b],a)}function Nf(a,b){if(tm(a))return!1;var c=typeof a;return!("number"!=c&&"symbol"!=c&&"boolean"!=c&&null!=a&&!ti(a))||(Fb.test(a)||!Eb.test(a)||null!=b&&a in kk(b))}function Of(a){var b=typeof a;return"string"==b||"number"==b||"symbol"==b||"boolean"==b?"__proto__"!==a:null===a}function Pf(a){var b=wf(a),d=c[b];if("function"!=typeof d||!(b in C.prototype))return!1;if(a===d)return!0;var e=Al(d);return!!e&&a===e[0]}function Qf(a){return!!vk&&vk in a}function Rf(a){var b=a&&a.constructor,c="function"==typeof b&&b.prototype||qk;return a===c}function Sf(a){return a===a&&!hi(a)}function Tf(a,b){return function(c){return null!=c&&(c[a]===b&&(b!==da||a in kk(c)))}}function Uf(a){var b=Ih(a,function(a){return c.size===ja&&c.clear(),a}),c=b.cache;return b}function Vf(a,b){var c=a[1],d=b[1],e=c|d,f=e<(qa|ra|xa),g=d==xa&&c==ta||d==xa&&c==ya&&a[7].length<=b[8]||d==(xa|ya)&&b[7].length<=b[8]&&c==ta;if(!f&&!g)return a;d&qa&&(a[2]=b[2],e|=c&qa?0:sa);var h=b[3];if(h){var i=a[3];a[3]=i?Le(i,h,b[4]):h,a[4]=i?V(a[3],ka):b[4]}return h=b[5],h&&(i=a[5],a[5]=i?Me(i,h,b[6]):h,a[6]=i?V(a[5],ka):b[6]),h=b[7],h&&(a[7]=h),d&xa&&(a[8]=null==a[8]?b[8]:Xk(a[8],b[8])),null==a[9]&&(a[9]=b[9]),a[0]=b[0],a[1]=e,a}function Wf(a){var b=[];if(null!=a)for(var c in kk(a))b.push(c);return b}function Xf(a){return wk.call(a)}function Yf(a,b,c){return b=Wk(b===da?a.length-1:b,0),function(){for(var d=arguments,e=-1,f=Wk(d.length-b,0),h=fk(f);++e<f;)h[e]=d[b+e];e=-1;for(var i=fk(b+1);++e<b;)i[e]=d[e];return i[b]=c(h),g(a,this,i)}}function Zf(a,b){return b.length<2?a:hd(a,je(b,0,-1))}function $f(a,b){for(var c=a.length,d=Xk(b.length,c),e=Ne(a);d--;){var f=b[d];a[d]=Lf(f,c)?e[f]:da}return a}function _f(a,b,c){var d=b+"";return Hl(a,Jf(d,eg(Ef(d),c)))}function ag(a){var b=0,c=0;return function(){var d=Yk(),e=Da-(d-c);if(c=d,e>0){if(++b>=Ca)return arguments[0]}else b=0;return a.apply(da,arguments)}}function bg(a,b){var c=-1,d=a.length,e=d-1;for(b=b===da?d:b;++c<b;){var f=be(c,e),g=a[f];a[f]=a[c],a[c]=g}return a.length=b,a}function cg(a){if("string"==typeof a||ti(a))return a;var b=a+"";return"0"==b&&1/a==-Ha?"-0":b}function dg(a){if(null!=a){try{return sk.call(a)}catch(b){}try{return a+""}catch(b){}}return""}function eg(a,b){return i(Oa,function(c){var d="_."+c[0];b&c[1]&&!m(a,d)&&a.push(d)}),a.sort()}function fg(a){if(a instanceof C)return a.clone();var b=new t(a.__wrapped__,a.__chain__);return b.__actions__=Ne(a.__actions__),b.__index__=a.__index__,b.__values__=a.__values__,b}function gg(a,b,c){b=(c?Mf(a,b,c):b===da)?1:Wk(zi(b),0);var d=null==a?0:a.length;if(!d||b<1)return[];for(var e=0,f=0,g=fk(Pk(d/b));e<d;)g[f++]=je(a,e,e+=b);return g}function hg(a){for(var b=-1,c=null==a?0:a.length,d=0,e=[];++b<c;){var f=a[b];f&&(e[d++]=f)}return e}function ig(){var a=arguments.length;if(!a)return[];for(var b=fk(a-1),c=arguments[0],d=a;d--;)b[d-1]=arguments[d];return p(tm(c)?Ne(c):[c],ad(b,1))}function jg(a,b,c){var d=null==a?0:a.length;return d?(b=c||b===da?1:zi(b),je(a,b<0?0:b,d)):[]}function kg(a,b,c){var d=null==a?0:a.length;return d?(b=c||b===da?1:zi(b),b=d-b,je(a,0,b<0?0:b)):[]}function lg(a,b){return a&&a.length?te(a,yf(b,3),!0,!0):[]}function mg(a,b){return a&&a.length?te(a,yf(b,3),!0):[]}function ng(a,b,c,d){var e=null==a?0:a.length;return e?(c&&"number"!=typeof c&&Mf(a,b,c)&&(c=0,d=e),$c(a,b,c,d)):[]}function og(a,b,c){var d=null==a?0:a.length;if(!d)return-1;var e=null==c?0:zi(c);return e<0&&(e=Wk(d+e,0)),w(a,yf(b,3),e)}function pg(a,b,c){var d=null==a?0:a.length;if(!d)return-1;var e=d-1;return c!==da&&(e=zi(c),e=c<0?Wk(d+e,0):Xk(e,d-1)),w(a,yf(b,3),e,!0)}function qg(a){var b=null==a?0:a.length;return b?ad(a,1):[]}function rg(a){var b=null==a?0:a.length;return b?ad(a,Ha):[]}function sg(a,b){var c=null==a?0:a.length;return c?(b=b===da?1:zi(b),ad(a,b)):[]}function tg(a){for(var b=-1,c=null==a?0:a.length,d={};++b<c;){var e=a[b];d[e[0]]=e[1]}return d}function ug(a){return a&&a.length?a[0]:da}function vg(a,b,c){var d=null==a?0:a.length;if(!d)return-1;var e=null==c?0:zi(c);return e<0&&(e=Wk(d+e,0)),x(a,b,e)}function wg(a){var b=null==a?0:a.length;return b?je(a,0,-1):[]}function xg(a,b){return null==a?"":Uk.call(a,b)}function yg(a){var b=null==a?0:a.length;return b?a[b-1]:da}function zg(a,b,c){var d=null==a?0:a.length;if(!d)return-1;var e=d;return c!==da&&(e=zi(c),e=e<0?Wk(d+e,0):Xk(e,d-1)),b===b?Z(a,b,e):w(a,z,e,!0)}function Ag(a,b){return a&&a.length?Wd(a,zi(b)):da}function Bg(a,b){return a&&a.length&&b&&b.length?_d(a,b):a}function Cg(a,b,c){return a&&a.length&&b&&b.length?_d(a,b,yf(c,2)):a}function Dg(a,b,c){return a&&a.length&&b&&b.length?_d(a,b,da,c):a}function Eg(a,b){var c=[];if(!a||!a.length)return c;var d=-1,e=[],f=a.length;for(b=yf(b,3);++d<f;){var g=a[d];b(g,d,a)&&(c.push(g),e.push(d))}return ae(a,e),c}function Fg(a){return null==a?a:_k.call(a)}function Gg(a,b,c){var d=null==a?0:a.length;return d?(c&&"number"!=typeof c&&Mf(a,b,c)?(b=0,c=d):(b=null==b?0:zi(b),c=c===da?d:zi(c)),je(a,b,c)):[]}function Hg(a,b){return le(a,b)}function Ig(a,b,c){return me(a,b,yf(c,2))}function Jg(a,b){var c=null==a?0:a.length;if(c){var d=le(a,b);if(d<c&&Wh(a[d],b))return d}return-1}function Kg(a,b){return le(a,b,!0)}function Lg(a,b,c){return me(a,b,yf(c,2),!0)}function Mg(a,b){var c=null==a?0:a.length;if(c){var d=le(a,b,!0)-1;if(Wh(a[d],b))return d}return-1}function Ng(a){return a&&a.length?ne(a):[]}function Og(a,b){return a&&a.length?ne(a,yf(b,2)):[]}function Pg(a){var b=null==a?0:a.length;return b?je(a,1,b):[]}function Qg(a,b,c){return a&&a.length?(b=c||b===da?1:zi(b),je(a,0,b<0?0:b)):[]}function Rg(a,b,c){var d=null==a?0:a.length;return d?(b=c||b===da?1:zi(b),b=d-b,je(a,b<0?0:b,d)):[]}function Sg(a,b){return a&&a.length?te(a,yf(b,3),!1,!0):[]}function Tg(a,b){return a&&a.length?te(a,yf(b,3)):[]}function Ug(a){return a&&a.length?qe(a):[]}function Vg(a,b){return a&&a.length?qe(a,yf(b,2)):[]}function Wg(a,b){return b="function"==typeof b?b:da,a&&a.length?qe(a,da,b):[]}function Xg(a){if(!a||!a.length)return[];var b=0;return a=l(a,function(a){if(Yh(a))return b=Wk(a.length,b),!0}),G(b,function(b){return o(a,B(b))})}function Yg(a,b){if(!a||!a.length)return[];var c=Xg(a);return null==b?c:o(c,function(a){return g(b,da,a)})}function Zg(a,b){return we(a||[],b||[],Fc)}function $g(a,b){return we(a||[],b||[],he)}function _g(a){var b=c(a);return b.__chain__=!0,b}function ah(a,b){return b(a),a}function bh(a,b){return b(a)}function ch(){return _g(this)}function dh(){return new t(this.value(),this.__chain__)}function eh(){this.__values__===da&&(this.__values__=xi(this.value()));var a=this.__index__>=this.__values__.length,b=a?da:this.__values__[this.__index__++];return{done:a,value:b}}function fh(){return this}function gh(a){for(var b,c=this;c instanceof d;){var e=fg(c);e.__index__=0,e.__values__=da,b?f.__wrapped__=e:b=e;var f=e;c=c.__wrapped__}return f.__wrapped__=a,b}function hh(){var a=this.__wrapped__;if(a instanceof C){var b=a;return this.__actions__.length&&(b=new C(this)),b=b.reverse(),b.__actions__.push({func:bh,args:[Fg],thisArg:da}),new t(b,this.__chain__)}return this.thru(Fg)}function ih(){return ue(this.__wrapped__,this.__actions__)}function jh(a,b,c){var d=tm(a)?k:Uc;return c&&Mf(a,b,c)&&(b=da),d(a,yf(b,3))}function kh(a,b){var c=tm(a)?l:_c;return c(a,yf(b,3))}function lh(a,b){return ad(rh(a,b),1)}function mh(a,b){return ad(rh(a,b),Ha)}function nh(a,b,c){return c=c===da?1:zi(c),ad(rh(a,b),c)}function oh(a,b){var c=tm(a)?i:rl;return c(a,yf(b,3))}function ph(a,b){var c=tm(a)?j:sl;return c(a,yf(b,3))}function qh(a,b,c,d){a=Xh(a)?a:cj(a),c=c&&!d?zi(c):0;var e=a.length;return c<0&&(c=Wk(e+c,0)),si(a)?c<=e&&a.indexOf(b,c)>-1:!!e&&x(a,b,c)>-1}function rh(a,b){var c=tm(a)?o:Rd;return c(a,yf(b,3))}function sh(a,b,c,d){return null==a?[]:(tm(b)||(b=null==b?[]:[b]),c=d?da:c,tm(c)||(c=null==c?[]:[c]),Xd(a,b,c))}function th(a,b,c){var d=tm(a)?q:D,e=arguments.length<3;return d(a,yf(b,4),c,e,rl)}function uh(a,b,c){var d=tm(a)?r:D,e=arguments.length<3;return d(a,yf(b,4),c,e,sl)}function vh(a,b){var c=tm(a)?l:_c;return c(a,Jh(yf(b,3)))}function wh(a){var b=tm(a)?Bc:fe;return b(a)}function xh(a,b,c){b=(c?Mf(a,b,c):b===da)?1:zi(b);var d=tm(a)?Cc:ge;return d(a,b)}function yh(a){var b=tm(a)?Dc:ie;return b(a)}function zh(a){if(null==a)return 0;if(Xh(a))return si(a)?$(a):a.length;var b=Dl(a);return b==Ya||b==db?a.size:Od(a).length}function Ah(a,b,c){var d=tm(a)?s:ke;return c&&Mf(a,b,c)&&(b=da),d(a,yf(b,3))}function Bh(a,b){if("function"!=typeof b)throw new nk(ha);return a=zi(a),function(){if(--a<1)return b.apply(this,arguments)}}function Ch(a,b,c){return b=c?da:b,b=a&&null==b?a.length:b,mf(a,xa,da,da,da,da,b)}function Dh(a,b){var c;if("function"!=typeof b)throw new nk(ha);return a=zi(a),function(){return--a>0&&(c=b.apply(this,arguments)),a<=1&&(b=da),c}}function Eh(a,b,c){b=c?da:b;var d=mf(a,ta,da,da,da,da,da,b);return d.placeholder=Eh.placeholder,d}function Fh(a,b,c){b=c?da:b;var d=mf(a,ua,da,da,da,da,da,b);return d.placeholder=Fh.placeholder,d}function Gh(a,b,c){function d(b){var c=m,d=n;return m=n=da,s=b,p=a.apply(d,c)}function e(a){return s=a,q=Gl(h,b),t?d(a):p}function f(a){var c=a-r,d=a-s,e=b-c;return u?Xk(e,o-d):e}function g(a){var c=a-r,d=a-s;return r===da||c>=b||c<0||u&&d>=o}function h(){var a=hm();return g(a)?i(a):void(q=Gl(h,f(a)))}function i(a){return q=da,v&&m?d(a):(m=n=da,p)}function j(){q!==da&&yl(q),s=0,m=r=n=q=da}function k(){return q===da?p:i(hm())}function l(){var a=hm(),c=g(a);if(m=arguments,n=this,r=a,c){if(q===da)return e(r);if(u)return q=Gl(h,b),d(r)}return q===da&&(q=Gl(h,b)),p}var m,n,o,p,q,r,s=0,t=!1,u=!1,v=!0;if("function"!=typeof a)throw new nk(ha);return b=Bi(b)||0,hi(c)&&(t=!!c.leading,u="maxWait"in c,o=u?Wk(Bi(c.maxWait)||0,b):o,v="trailing"in c?!!c.trailing:v),l.cancel=j,l.flush=k,l}function Hh(a){return mf(a,za)}function Ih(a,b){if("function"!=typeof a||null!=b&&"function"!=typeof b)throw new nk(ha);var c=function(){var d=arguments,e=b?b.apply(this,d):d[0],f=c.cache;if(f.has(e))return f.get(e);var g=a.apply(this,d);return c.cache=f.set(e,g)||f,g};return c.cache=new(Ih.Cache||lc),c}function Jh(a){if("function"!=typeof a)throw new nk(ha);return function(){var b=arguments;switch(b.length){case 0:return!a.call(this);case 1:return!a.call(this,b[0]);case 2:return!a.call(this,b[0],b[1]);case 3:return!a.call(this,b[0],b[1],b[2])}return!a.apply(this,b)}}function Kh(a){return Dh(2,a)}function Lh(a,b){if("function"!=typeof a)throw new nk(ha);return b=b===da?b:zi(b),ee(a,b)}function Mh(a,b){if("function"!=typeof a)throw new nk(ha);return b=null==b?0:Wk(zi(b),0),ee(function(c){var d=c[b],e=Ae(c,0,b);return d&&p(e,d),g(a,this,e)})}function Nh(a,b,c){var d=!0,e=!0;if("function"!=typeof a)throw new nk(ha);return hi(c)&&(d="leading"in c?!!c.leading:d,e="trailing"in c?!!c.trailing:e),Gh(a,b,{leading:d,maxWait:b,trailing:e})}function Oh(a){return Ch(a,1)}function Ph(a,b){return nm(ye(b),a)}function Qh(){if(!arguments.length)return[];var a=arguments[0];return tm(a)?a:[a]}function Rh(a){return Nc(a,na)}function Sh(a,b){return b="function"==typeof b?b:da,Nc(a,na,b)}function Th(a){return Nc(a,la|na)}function Uh(a,b){return b="function"==typeof b?b:da,Nc(a,la|na,b)}function Vh(a,b){return null==b||Rc(a,b,Ri(b))}function Wh(a,b){return a===b||a!==a&&b!==b}function Xh(a){return null!=a&&gi(a.length)&&!ei(a)}function Yh(a){return ii(a)&&Xh(a)}function Zh(a){return a===!0||a===!1||ii(a)&&kd(a)==Sa}function $h(a){return ii(a)&&1===a.nodeType&&!qi(a)}function _h(a){if(null==a)return!0;if(Xh(a)&&(tm(a)||"string"==typeof a||"function"==typeof a.splice||vm(a)||Am(a)||sm(a)))return!a.length;var b=Dl(a);if(b==Ya||b==db)return!a.size;if(Rf(a))return!Od(a).length;for(var c in a)if(tk.call(a,c))return!1;return!0}function ai(a,b){return Fd(a,b)}function bi(a,b,c){c="function"==typeof c?c:da;var d=c?c(a,b):da;return d===da?Fd(a,b,da,c):!!d}function ci(a){if(!ii(a))return!1;var b=kd(a);return b==Va||b==Ua||"string"==typeof a.message&&"string"==typeof a.name&&!qi(a)}function di(a){return"number"==typeof a&&Tk(a)}function ei(a){if(!hi(a))return!1;var b=kd(a);return b==Wa||b==Xa||b==Ra||b==bb}function fi(a){return"number"==typeof a&&a==zi(a)}function gi(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=Ia}function hi(a){var b=typeof a;return null!=a&&("object"==b||"function"==b)}function ii(a){return null!=a&&"object"==typeof a}function ji(a,b){return a===b||Id(a,b,Af(b))}function ki(a,b,c){return c="function"==typeof c?c:da,Id(a,b,Af(b),c)}function li(a){return pi(a)&&a!=+a}function mi(a){if(El(a))throw new hk(ga);return Jd(a)}function ni(a){return null===a}function oi(a){return null==a}function pi(a){return"number"==typeof a||ii(a)&&kd(a)==Za}function qi(a){if(!ii(a)||kd(a)!=_a)return!1;var b=Ek(a);if(null===b)return!0;var c=tk.call(b,"constructor")&&b.constructor;return"function"==typeof c&&c instanceof c&&sk.call(c)==xk}function ri(a){return fi(a)&&a>=-Ia&&a<=Ia}function si(a){return"string"==typeof a||!tm(a)&&ii(a)&&kd(a)==eb}function ti(a){return"symbol"==typeof a||ii(a)&&kd(a)==fb}function ui(a){return a===da}function vi(a){return ii(a)&&Dl(a)==hb}function wi(a){return ii(a)&&kd(a)==ib}function xi(a){if(!a)return[];if(Xh(a))return si(a)?_(a):Ne(a);if(Jk&&a[Jk])return S(a[Jk]());var b=Dl(a),c=b==Ya?T:b==db?W:cj;return c(a)}function yi(a){if(!a)return 0===a?a:0;if(a=Bi(a),a===Ha||a===-Ha){var b=a<0?-1:1;return b*Ja}return a===a?a:0}function zi(a){var b=yi(a),c=b%1;return b===b?c?b-c:b:0}function Ai(a){return a?Mc(zi(a),0,La):0}function Bi(a){if("number"==typeof a)return a;if(ti(a))return Ka;if(hi(a)){var b="function"==typeof a.valueOf?a.valueOf():a;a=hi(b)?b+"":b}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(Kb,"");var c=Vb.test(a);return c||Xb.test(a)?cd(a.slice(2),c?2:8):Ub.test(a)?Ka:+a}function Ci(a){return Oe(a,Si(a))}function Di(a){return a?Mc(zi(a),-Ia,Ia):0===a?a:0}function Ei(a){return null==a?"":pe(a)}function Fi(a,b){var c=ql(a);return null==b?c:Ic(c,b)}function Gi(a,b){return v(a,yf(b,3),dd)}function Hi(a,b){return v(a,yf(b,3),ed)}function Ii(a,b){return null==a?a:tl(a,yf(b,3),Si)}function Ji(a,b){return null==a?a:ul(a,yf(b,3),Si)}function Ki(a,b){return a&&dd(a,yf(b,3))}function Li(a,b){return a&&ed(a,yf(b,3))}function Mi(a){return null==a?[]:gd(a,Ri(a))}function Ni(a){return null==a?[]:gd(a,Si(a))}function Oi(a,b,c){var d=null==a?da:hd(a,b);return d===da?c:d}function Pi(a,b){return null!=a&&Ff(a,b,vd)}function Qi(a,b){return null!=a&&Ff(a,b,xd)}function Ri(a){return Xh(a)?Ac(a):Od(a)}function Si(a){return Xh(a)?Ac(a,!0):Pd(a)}function Ti(a,b){var c={};return b=yf(b,3),dd(a,function(a,d,e){Kc(c,b(a,d,e),a)}),c}function Ui(a,b){var c={};return b=yf(b,3),dd(a,function(a,d,e){Kc(c,d,b(a,d,e))}),c}function Vi(a,b){return Wi(a,Jh(yf(b)))}function Wi(a,b){if(null==a)return{};var c=o(vf(a),function(a){return[a]});return b=yf(b),Zd(a,c,function(a,c){return b(a,c[0])})}function Xi(a,b,c){b=ze(b,a);var d=-1,e=b.length;for(e||(e=1,a=da);++d<e;){var f=null==a?da:a[cg(b[d])];f===da&&(d=e,f=c),a=ei(f)?f.call(a):f}return a}function Yi(a,b,c){return null==a?a:he(a,b,c)}function Zi(a,b,c,d){return d="function"==typeof d?d:da,null==a?a:he(a,b,c,d)}function $i(a,b,c){var d=tm(a),e=d||vm(a)||Am(a);if(b=yf(b,4),null==c){var f=a&&a.constructor;c=e?d?new f:[]:hi(a)&&ei(f)?ql(Ek(a)):{}}return(e?i:dd)(a,function(a,d,e){return b(c,a,d,e)}),c}function _i(a,b){return null==a||re(a,b)}function aj(a,b,c){return null==a?a:se(a,b,ye(c))}function bj(a,b,c,d){return d="function"==typeof d?d:da,null==a?a:se(a,b,ye(c),d)}function cj(a){return null==a?[]:J(a,Ri(a))}function dj(a){return null==a?[]:J(a,Si(a))}function ej(a,b,c){return c===da&&(c=b,b=da),c!==da&&(c=Bi(c),c=c===c?c:0),b!==da&&(b=Bi(b),b=b===b?b:0),Mc(Bi(a),b,c)}function fj(a,b,c){return b=yi(b),c===da?(c=b,b=0):c=yi(c),a=Bi(a),yd(a,b,c)}function gj(a,b,c){if(c&&"boolean"!=typeof c&&Mf(a,b,c)&&(b=c=da),c===da&&("boolean"==typeof b?(c=b,b=da):"boolean"==typeof a&&(c=a,a=da)),a===da&&b===da?(a=0,b=1):(a=yi(a),b===da?(b=a,a=0):b=yi(b)),a>b){var d=a;a=b,b=d}if(c||a%1||b%1){var e=$k();return Xk(a+e*(b-a+bd("1e-"+((e+"").length-1))),b)}return be(a,b)}function hj(a){return $m(Ei(a).toLowerCase())}function ij(a){return a=Ei(a),a&&a.replace(Zb,sd).replace(Qc,"")}function jj(a,b,c){a=Ei(a),b=pe(b);var d=a.length;c=c===da?d:Mc(zi(c),0,d);var e=c;return c-=b.length,c>=0&&a.slice(c,e)==b}function kj(a){return a=Ei(a),a&&Ab.test(a)?a.replace(yb,td):a}function lj(a){return a=Ei(a),a&&Jb.test(a)?a.replace(Ib,"\\$&"):a}function mj(a,b,c){a=Ei(a),b=zi(b);var d=b?$(a):0;if(!b||d>=b)return a;var e=(b-d)/2;return ef(Qk(e),c)+a+ef(Pk(e),c)}function nj(a,b,c){a=Ei(a),b=zi(b);var d=b?$(a):0;return b&&d<b?a+ef(b-d,c):a}function oj(a,b,c){a=Ei(a),b=zi(b);var d=b?$(a):0;return b&&d<b?ef(b-d,c)+a:a}function pj(a,b,c){return c||null==b?b=0:b&&(b=+b),Zk(Ei(a).replace(Lb,""),b||0)}function qj(a,b,c){return b=(c?Mf(a,b,c):b===da)?1:zi(b),de(Ei(a),b)}function rj(){var a=arguments,b=Ei(a[0]);return a.length<3?b:b.replace(a[1],a[2])}function sj(a,b,c){return c&&"number"!=typeof c&&Mf(a,b,c)&&(b=c=da),(c=c===da?La:c>>>0)?(a=Ei(a),a&&("string"==typeof b||null!=b&&!ym(b))&&(b=pe(b),!b&&Q(a))?Ae(_(a),0,c):a.split(b,c)):[]}function tj(a,b,c){return a=Ei(a),c=null==c?0:Mc(zi(c),0,a.length),b=pe(b),a.slice(c,c+b.length)==b}function uj(a,b,d){var e=c.templateSettings;d&&Mf(a,b,d)&&(b=da),a=Ei(a),b=Fm({},b,e,nf);var f,g,h=Fm({},b.imports,e.imports,nf),i=Ri(h),j=J(h,i),k=0,l=b.interpolate||$b,m="__p += '",n=lk((b.escape||$b).source+"|"+l.source+"|"+(l===Db?Sb:$b).source+"|"+(b.evaluate||$b).source+"|$","g"),o="//# sourceURL="+("sourceURL"in b?b.sourceURL:"lodash.templateSources["+ ++Wc+"]")+"\n";a.replace(n,function(b,c,d,e,h,i){return d||(d=e),m+=a.slice(k,i).replace(_b,O),c&&(f=!0,m+="' +\n__e("+c+") +\n'"),h&&(g=!0,m+="';\n"+h+";\n__p += '"),d&&(m+="' +\n((__t = ("+d+")) == null ? '' : __t) +\n'"),k=i+b.length,b}),m+="';\n";var p=b.variable;p||(m="with (obj) {\n"+m+"\n}\n"),m=(g?m.replace(ub,""):m).replace(vb,"$1").replace(wb,"$1;"),m="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(f?", __e = _.escape":"")+(g?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var q=_m(function(){return ik(i,o+"return "+m).apply(da,j)});if(q.source=m,ci(q))throw q;return q}function vj(a){return Ei(a).toLowerCase()}function wj(a){return Ei(a).toUpperCase()}function xj(a,b,c){if(a=Ei(a),a&&(c||b===da))return a.replace(Kb,"");if(!a||!(b=pe(b)))return a;var d=_(a),e=_(b),f=L(d,e),g=M(d,e)+1;return Ae(d,f,g).join("")}function yj(a,b,c){if(a=Ei(a),a&&(c||b===da))return a.replace(Mb,"");if(!a||!(b=pe(b)))return a;var d=_(a),e=M(d,_(b))+1;return Ae(d,0,e).join("")}function zj(a,b,c){if(a=Ei(a),a&&(c||b===da))return a.replace(Lb,"");if(!a||!(b=pe(b)))return a;var d=_(a),e=L(d,_(b));return Ae(d,e).join("")}function Aj(a,b){var c=Aa,d=Ba;if(hi(b)){var e="separator"in b?b.separator:e;c="length"in b?zi(b.length):c,d="omission"in b?pe(b.omission):d}a=Ei(a);var f=a.length;if(Q(a)){var g=_(a);f=g.length}if(c>=f)return a;var h=c-$(d);if(h<1)return d;var i=g?Ae(g,0,h).join(""):a.slice(0,h);if(e===da)return i+d;if(g&&(h+=i.length-h),ym(e)){if(a.slice(h).search(e)){var j,k=i;for(e.global||(e=lk(e.source,Ei(Tb.exec(e))+"g")),e.lastIndex=0;j=e.exec(k);)var l=j.index;i=i.slice(0,l===da?h:l)}}else if(a.indexOf(pe(e),h)!=h){var m=i.lastIndexOf(e);m>-1&&(i=i.slice(0,m))}return i+d}function Bj(a){return a=Ei(a),a&&zb.test(a)?a.replace(xb,ud):a}function Cj(a,b,c){return a=Ei(a),b=c?da:b,b===da?R(a)?ca(a):u(a):a.match(b)||[]}function Dj(a){var b=null==a?0:a.length,c=yf();return a=b?o(a,function(a){if("function"!=typeof a[1])throw new nk(ha);return[c(a[0]),a[1]]}):[],ee(function(c){for(var d=-1;++d<b;){var e=a[d];if(g(e[0],this,c))return g(e[1],this,c)}})}function Ej(a){return Oc(Nc(a,la))}function Fj(a){return function(){return a}}function Gj(a,b){return null==a||a!==a?b:a}function Hj(a){return a}function Ij(a){return Nd("function"==typeof a?a:Nc(a,la))}function Jj(a){return Sd(Nc(a,la))}function Kj(a,b){return Td(a,Nc(b,la))}function Lj(a,b,c){var d=Ri(b),e=gd(b,d);null!=c||hi(b)&&(e.length||!d.length)||(c=b,b=a,a=this,e=gd(b,Ri(b)));var f=!(hi(c)&&"chain"in c&&!c.chain),g=ei(a);return i(e,function(c){var d=b[c];a[c]=d,g&&(a.prototype[c]=function(){var b=this.__chain__;if(f||b){var c=a(this.__wrapped__),e=c.__actions__=Ne(this.__actions__);return e.push({func:d,args:arguments,thisArg:a}),c.__chain__=b,c}return d.apply(a,p([this.value()],arguments))})}),a}function Mj(){return fd._===this&&(fd._=yk),this}function Nj(){}function Oj(a){return a=zi(a),ee(function(b){return Wd(b,a)})}function Pj(a){return Nf(a)?B(cg(a)):$d(a)}function Qj(a){return function(b){return null==a?da:hd(a,b)}}function Rj(){return[]}function Sj(){return!1}function Tj(){return{}}function Uj(){return""}function Vj(){return!0}function Wj(a,b){if(a=zi(a),a<1||a>Ia)return[];var c=La,d=Xk(a,La);b=yf(b),a-=La;for(var e=G(d,b);++c<a;)b(c);return e}function Xj(a){return tm(a)?o(a,cg):ti(a)?[a]:Ne(Il(Ei(a)))}function Yj(a){var b=++uk;return Ei(a)+b}function Zj(a){return a&&a.length?Zc(a,Hj,rd):da}function $j(a,b){return a&&a.length?Zc(a,yf(b,2),rd):da}function _j(a){return A(a,Hj)}function ak(a,b){return A(a,yf(b,2))}function bk(a){return a&&a.length?Zc(a,Hj,Qd):da}function ck(a,b){return a&&a.length?Zc(a,yf(b,2),Qd):da}function dk(a){return a&&a.length?F(a,Hj):0}function ek(a,b){return a&&a.length?F(a,yf(b,2)):0}b=null==b?fd:wd.defaults(fd.Object(),b,wd.pick(fd,Vc));var fk=b.Array,gk=b.Date,hk=b.Error,ik=b.Function,jk=b.Math,kk=b.Object,lk=b.RegExp,mk=b.String,nk=b.TypeError,ok=fk.prototype,pk=ik.prototype,qk=kk.prototype,rk=b["__core-js_shared__"],sk=pk.toString,tk=qk.hasOwnProperty,uk=0,vk=function(){var a=/[^.]+$/.exec(rk&&rk.keys&&rk.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),wk=qk.toString,xk=sk.call(kk),yk=fd._,zk=lk("^"+sk.call(tk).replace(Ib,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ak=id?b.Buffer:da,Bk=b.Symbol,Ck=b.Uint8Array,Dk=Ak?Ak.allocUnsafe:da,Ek=U(kk.getPrototypeOf,kk),Fk=kk.create,Gk=qk.propertyIsEnumerable,Hk=ok.splice,Ik=Bk?Bk.isConcatSpreadable:da,Jk=Bk?Bk.iterator:da,Kk=Bk?Bk.toStringTag:da,Lk=function(){try{var a=Bf(kk,"defineProperty");return a({},"",{}),a}catch(b){}}(),Mk=b.clearTimeout!==fd.clearTimeout&&b.clearTimeout,Nk=gk&&gk.now!==fd.Date.now&&gk.now,Ok=b.setTimeout!==fd.setTimeout&&b.setTimeout,Pk=jk.ceil,Qk=jk.floor,Rk=kk.getOwnPropertySymbols,Sk=Ak?Ak.isBuffer:da,Tk=b.isFinite,Uk=ok.join,Vk=U(kk.keys,kk),Wk=jk.max,Xk=jk.min,Yk=gk.now,Zk=b.parseInt,$k=jk.random,_k=ok.reverse,al=Bf(b,"DataView"),bl=Bf(b,"Map"),cl=Bf(b,"Promise"),dl=Bf(b,"Set"),el=Bf(b,"WeakMap"),fl=Bf(kk,"create"),gl=el&&new el,hl={},il=dg(al),jl=dg(bl),kl=dg(cl),ll=dg(dl),ml=dg(el),nl=Bk?Bk.prototype:da,ol=nl?nl.valueOf:da,pl=nl?nl.toString:da,ql=function(){function a(){}return function(b){if(!hi(b))return{};if(Fk)return Fk(b);a.prototype=b;var c=new a;return a.prototype=da,c}}();c.templateSettings={escape:Bb,evaluate:Cb,interpolate:Db,variable:"",imports:{_:c}},c.prototype=d.prototype,c.prototype.constructor=c,t.prototype=ql(d.prototype),t.prototype.constructor=t,C.prototype=ql(d.prototype),C.prototype.constructor=C,Qb.prototype.clear=ac,Qb.prototype.delete=bc,Qb.prototype.get=cc,Qb.prototype.has=dc,Qb.prototype.set=ec,fc.prototype.clear=gc,fc.prototype.delete=hc,fc.prototype.get=ic,fc.prototype.has=jc,fc.prototype.set=kc,lc.prototype.clear=mc,lc.prototype.delete=nc,lc.prototype.get=oc,lc.prototype.has=pc,lc.prototype.set=qc,rc.prototype.add=rc.prototype.push=sc,rc.prototype.has=tc,uc.prototype.clear=vc,uc.prototype.delete=wc,uc.prototype.get=xc,uc.prototype.has=yc,uc.prototype.set=zc;var rl=Te(dd),sl=Te(ed,!0),tl=Ue(),ul=Ue(!0),vl=gl?function(a,b){return gl.set(a,b),a}:Hj,wl=Lk?function(a,b){return Lk(a,"toString",{configurable:!0,enumerable:!1,value:Fj(b),writable:!0})}:Hj,xl=ee,yl=Mk||function(a){return fd.clearTimeout(a)},zl=dl&&1/W(new dl([,-0]))[1]==Ha?function(a){return new dl(a)}:Nj,Al=gl?function(a){return gl.get(a)}:Nj,Bl=Rk?function(a){return null==a?[]:(a=kk(a),l(Rk(a),function(b){return Gk.call(a,b)}))}:Rj,Cl=Rk?function(a){for(var b=[];a;)p(b,Bl(a)),a=Ek(a);return b}:Rj,Dl=kd;(al&&Dl(new al(new ArrayBuffer(1)))!=kb||bl&&Dl(new bl)!=Ya||cl&&Dl(cl.resolve())!=ab||dl&&Dl(new dl)!=db||el&&Dl(new el)!=hb)&&(Dl=function(a){var b=kd(a),c=b==_a?a.constructor:da,d=c?dg(c):"";if(d)switch(d){case il:return kb;case jl:return Ya;case kl:return ab;case ll:return db;case ml:return hb}return b});var El=rk?ei:Sj,Fl=ag(vl),Gl=Ok||function(a,b){return fd.setTimeout(a,b)},Hl=ag(wl),Il=Uf(function(a){var b=[];return Gb.test(a)&&b.push(""),a.replace(Hb,function(a,c,d,e){b.push(d?e.replace(Rb,"$1"):c||a)}),b}),Jl=ee(function(a,b){return Yh(a)?Tc(a,ad(b,1,Yh,!0)):[]}),Kl=ee(function(a,b){var c=yg(b);return Yh(c)&&(c=da),Yh(a)?Tc(a,ad(b,1,Yh,!0),yf(c,2)):[]}),Ll=ee(function(a,b){var c=yg(b);return Yh(c)&&(c=da),Yh(a)?Tc(a,ad(b,1,Yh,!0),da,c):[]}),Ml=ee(function(a){var b=o(a,xe);return b.length&&b[0]===a[0]?zd(b):[]}),Nl=ee(function(a){var b=yg(a),c=o(a,xe);return b===yg(c)?b=da:c.pop(),c.length&&c[0]===a[0]?zd(c,yf(b,2)):[]}),Ol=ee(function(a){var b=yg(a),c=o(a,xe);return b="function"==typeof b?b:da,b&&c.pop(),c.length&&c[0]===a[0]?zd(c,da,b):[]}),Pl=ee(Bg),Ql=tf(function(a,b){var c=null==a?0:a.length,d=Lc(a,b);return ae(a,o(b,function(a){return Lf(a,c)?+a:a}).sort(Je)),d}),Rl=ee(function(a){return qe(ad(a,1,Yh,!0))}),Sl=ee(function(a){var b=yg(a);return Yh(b)&&(b=da),qe(ad(a,1,Yh,!0),yf(b,2))}),Tl=ee(function(a){var b=yg(a);return b="function"==typeof b?b:da,qe(ad(a,1,Yh,!0),da,b)}),Ul=ee(function(a,b){return Yh(a)?Tc(a,b):[]}),Vl=ee(function(a){return ve(l(a,Yh))}),Wl=ee(function(a){var b=yg(a);return Yh(b)&&(b=da),ve(l(a,Yh),yf(b,2))}),Xl=ee(function(a){var b=yg(a);return b="function"==typeof b?b:da,ve(l(a,Yh),da,b)}),Yl=ee(Xg),Zl=ee(function(a){var b=a.length,c=b>1?a[b-1]:da;return c="function"==typeof c?(a.pop(),c):da,Yg(a,c)}),$l=tf(function(a){var b=a.length,c=b?a[0]:0,d=this.__wrapped__,e=function(b){return Lc(b,a)};return!(b>1||this.__actions__.length)&&d instanceof C&&Lf(c)?(d=d.slice(c,+c+(b?1:0)),d.__actions__.push({func:bh,args:[e],thisArg:da}),new t(d,this.__chain__).thru(function(a){return b&&!a.length&&a.push(da),a})):this.thru(e)}),_l=Re(function(a,b,c){tk.call(a,c)?++a[c]:Kc(a,c,1)}),am=$e(og),bm=$e(pg),cm=Re(function(a,b,c){tk.call(a,c)?a[c].push(b):Kc(a,c,[b])}),dm=ee(function(a,b,c){var d=-1,e="function"==typeof b,f=Xh(a)?fk(a.length):[];return rl(a,function(a){f[++d]=e?g(b,a,c):Bd(a,b,c)}),f}),em=Re(function(a,b,c){Kc(a,c,b)}),fm=Re(function(a,b,c){a[c?0:1].push(b)},function(){return[[],[]]}),gm=ee(function(a,b){if(null==a)return[];var c=b.length;return c>1&&Mf(a,b[0],b[1])?b=[]:c>2&&Mf(b[0],b[1],b[2])&&(b=[b[0]]),Xd(a,ad(b,1),[])}),hm=Nk||function(){return fd.Date.now()},im=ee(function(a,b,c){var d=qa;if(c.length){var e=V(c,xf(im));d|=va}return mf(a,d,b,c,e)}),jm=ee(function(a,b,c){var d=qa|ra;if(c.length){var e=V(c,xf(jm));d|=va}return mf(b,d,a,c,e)}),km=ee(function(a,b){return Sc(a,1,b)}),lm=ee(function(a,b,c){return Sc(a,Bi(b)||0,c)});Ih.Cache=lc;var mm=xl(function(a,b){b=1==b.length&&tm(b[0])?o(b[0],I(yf())):o(ad(b,1),I(yf()));var c=b.length;return ee(function(d){for(var e=-1,f=Xk(d.length,c);++e<f;)d[e]=b[e].call(this,d[e]);return g(a,this,d)})}),nm=ee(function(a,b){var c=V(b,xf(nm));return mf(a,va,da,b,c)}),om=ee(function(a,b){
var c=V(b,xf(om));return mf(a,wa,da,b,c)}),pm=tf(function(a,b){return mf(a,ya,da,da,da,b)}),qm=hf(rd),rm=hf(function(a,b){return a>=b}),sm=Cd(function(){return arguments}())?Cd:function(a){return ii(a)&&tk.call(a,"callee")&&!Gk.call(a,"callee")},tm=fk.isArray,um=ld?I(ld):Dd,vm=Sk||Sj,wm=md?I(md):Ed,xm=nd?I(nd):Hd,ym=od?I(od):Kd,zm=pd?I(pd):Ld,Am=qd?I(qd):Md,Bm=hf(Qd),Cm=hf(function(a,b){return a<=b}),Dm=Se(function(a,b){if(Rf(b)||Xh(b))return void Oe(b,Ri(b),a);for(var c in b)tk.call(b,c)&&Fc(a,c,b[c])}),Em=Se(function(a,b){Oe(b,Si(b),a)}),Fm=Se(function(a,b,c,d){Oe(b,Si(b),a,d)}),Gm=Se(function(a,b,c,d){Oe(b,Ri(b),a,d)}),Hm=tf(Lc),Im=ee(function(a){return a.push(da,nf),g(Fm,da,a)}),Jm=ee(function(a){return a.push(da,of),g(Om,da,a)}),Km=bf(function(a,b,c){a[b]=c},Fj(Hj)),Lm=bf(function(a,b,c){tk.call(a,b)?a[b].push(c):a[b]=[c]},yf),Mm=ee(Bd),Nm=Se(function(a,b,c){Ud(a,b,c)}),Om=Se(function(a,b,c,d){Ud(a,b,c,d)}),Pm=tf(function(a,b){var c={};if(null==a)return c;var d=!1;b=o(b,function(b){return b=ze(b,a),d||(d=b.length>1),b}),Oe(a,vf(a),c),d&&(c=Nc(c,la|ma|na,pf));for(var e=b.length;e--;)re(c,b[e]);return c}),Qm=tf(function(a,b){return null==a?{}:Yd(a,b)}),Rm=lf(Ri),Sm=lf(Si),Tm=Xe(function(a,b,c){return b=b.toLowerCase(),a+(c?hj(b):b)}),Um=Xe(function(a,b,c){return a+(c?"-":"")+b.toLowerCase()}),Vm=Xe(function(a,b,c){return a+(c?" ":"")+b.toLowerCase()}),Wm=We("toLowerCase"),Xm=Xe(function(a,b,c){return a+(c?"_":"")+b.toLowerCase()}),Ym=Xe(function(a,b,c){return a+(c?" ":"")+$m(b)}),Zm=Xe(function(a,b,c){return a+(c?" ":"")+b.toUpperCase()}),$m=We("toUpperCase"),_m=ee(function(a,b){try{return g(a,da,b)}catch(c){return ci(c)?c:new hk(c)}}),an=tf(function(a,b){return i(b,function(b){b=cg(b),Kc(a,b,im(a[b],a))}),a}),bn=_e(),cn=_e(!0),dn=ee(function(a,b){return function(c){return Bd(c,a,b)}}),en=ee(function(a,b){return function(c){return Bd(a,c,b)}}),fn=df(o),gn=df(k),hn=df(s),jn=gf(),kn=gf(!0),ln=cf(function(a,b){return a+b},0),mn=kf("ceil"),nn=cf(function(a,b){return a/b},1),on=kf("floor"),pn=cf(function(a,b){return a*b},1),qn=kf("round"),rn=cf(function(a,b){return a-b},0);return c.after=Bh,c.ary=Ch,c.assign=Dm,c.assignIn=Em,c.assignInWith=Fm,c.assignWith=Gm,c.at=Hm,c.before=Dh,c.bind=im,c.bindAll=an,c.bindKey=jm,c.castArray=Qh,c.chain=_g,c.chunk=gg,c.compact=hg,c.concat=ig,c.cond=Dj,c.conforms=Ej,c.constant=Fj,c.countBy=_l,c.create=Fi,c.curry=Eh,c.curryRight=Fh,c.debounce=Gh,c.defaults=Im,c.defaultsDeep=Jm,c.defer=km,c.delay=lm,c.difference=Jl,c.differenceBy=Kl,c.differenceWith=Ll,c.drop=jg,c.dropRight=kg,c.dropRightWhile=lg,c.dropWhile=mg,c.fill=ng,c.filter=kh,c.flatMap=lh,c.flatMapDeep=mh,c.flatMapDepth=nh,c.flatten=qg,c.flattenDeep=rg,c.flattenDepth=sg,c.flip=Hh,c.flow=bn,c.flowRight=cn,c.fromPairs=tg,c.functions=Mi,c.functionsIn=Ni,c.groupBy=cm,c.initial=wg,c.intersection=Ml,c.intersectionBy=Nl,c.intersectionWith=Ol,c.invert=Km,c.invertBy=Lm,c.invokeMap=dm,c.iteratee=Ij,c.keyBy=em,c.keys=Ri,c.keysIn=Si,c.map=rh,c.mapKeys=Ti,c.mapValues=Ui,c.matches=Jj,c.matchesProperty=Kj,c.memoize=Ih,c.merge=Nm,c.mergeWith=Om,c.method=dn,c.methodOf=en,c.mixin=Lj,c.negate=Jh,c.nthArg=Oj,c.omit=Pm,c.omitBy=Vi,c.once=Kh,c.orderBy=sh,c.over=fn,c.overArgs=mm,c.overEvery=gn,c.overSome=hn,c.partial=nm,c.partialRight=om,c.partition=fm,c.pick=Qm,c.pickBy=Wi,c.property=Pj,c.propertyOf=Qj,c.pull=Pl,c.pullAll=Bg,c.pullAllBy=Cg,c.pullAllWith=Dg,c.pullAt=Ql,c.range=jn,c.rangeRight=kn,c.rearg=pm,c.reject=vh,c.remove=Eg,c.rest=Lh,c.reverse=Fg,c.sampleSize=xh,c.set=Yi,c.setWith=Zi,c.shuffle=yh,c.slice=Gg,c.sortBy=gm,c.sortedUniq=Ng,c.sortedUniqBy=Og,c.split=sj,c.spread=Mh,c.tail=Pg,c.take=Qg,c.takeRight=Rg,c.takeRightWhile=Sg,c.takeWhile=Tg,c.tap=ah,c.throttle=Nh,c.thru=bh,c.toArray=xi,c.toPairs=Rm,c.toPairsIn=Sm,c.toPath=Xj,c.toPlainObject=Ci,c.transform=$i,c.unary=Oh,c.union=Rl,c.unionBy=Sl,c.unionWith=Tl,c.uniq=Ug,c.uniqBy=Vg,c.uniqWith=Wg,c.unset=_i,c.unzip=Xg,c.unzipWith=Yg,c.update=aj,c.updateWith=bj,c.values=cj,c.valuesIn=dj,c.without=Ul,c.words=Cj,c.wrap=Ph,c.xor=Vl,c.xorBy=Wl,c.xorWith=Xl,c.zip=Yl,c.zipObject=Zg,c.zipObjectDeep=$g,c.zipWith=Zl,c.entries=Rm,c.entriesIn=Sm,c.extend=Em,c.extendWith=Fm,Lj(c,c),c.add=ln,c.attempt=_m,c.camelCase=Tm,c.capitalize=hj,c.ceil=mn,c.clamp=ej,c.clone=Rh,c.cloneDeep=Th,c.cloneDeepWith=Uh,c.cloneWith=Sh,c.conformsTo=Vh,c.deburr=ij,c.defaultTo=Gj,c.divide=nn,c.endsWith=jj,c.eq=Wh,c.escape=kj,c.escapeRegExp=lj,c.every=jh,c.find=am,c.findIndex=og,c.findKey=Gi,c.findLast=bm,c.findLastIndex=pg,c.findLastKey=Hi,c.floor=on,c.forEach=oh,c.forEachRight=ph,c.forIn=Ii,c.forInRight=Ji,c.forOwn=Ki,c.forOwnRight=Li,c.get=Oi,c.gt=qm,c.gte=rm,c.has=Pi,c.hasIn=Qi,c.head=ug,c.identity=Hj,c.includes=qh,c.indexOf=vg,c.inRange=fj,c.invoke=Mm,c.isArguments=sm,c.isArray=tm,c.isArrayBuffer=um,c.isArrayLike=Xh,c.isArrayLikeObject=Yh,c.isBoolean=Zh,c.isBuffer=vm,c.isDate=wm,c.isElement=$h,c.isEmpty=_h,c.isEqual=ai,c.isEqualWith=bi,c.isError=ci,c.isFinite=di,c.isFunction=ei,c.isInteger=fi,c.isLength=gi,c.isMap=xm,c.isMatch=ji,c.isMatchWith=ki,c.isNaN=li,c.isNative=mi,c.isNil=oi,c.isNull=ni,c.isNumber=pi,c.isObject=hi,c.isObjectLike=ii,c.isPlainObject=qi,c.isRegExp=ym,c.isSafeInteger=ri,c.isSet=zm,c.isString=si,c.isSymbol=ti,c.isTypedArray=Am,c.isUndefined=ui,c.isWeakMap=vi,c.isWeakSet=wi,c.join=xg,c.kebabCase=Um,c.last=yg,c.lastIndexOf=zg,c.lowerCase=Vm,c.lowerFirst=Wm,c.lt=Bm,c.lte=Cm,c.max=Zj,c.maxBy=$j,c.mean=_j,c.meanBy=ak,c.min=bk,c.minBy=ck,c.stubArray=Rj,c.stubFalse=Sj,c.stubObject=Tj,c.stubString=Uj,c.stubTrue=Vj,c.multiply=pn,c.nth=Ag,c.noConflict=Mj,c.noop=Nj,c.now=hm,c.pad=mj,c.padEnd=nj,c.padStart=oj,c.parseInt=pj,c.random=gj,c.reduce=th,c.reduceRight=uh,c.repeat=qj,c.replace=rj,c.result=Xi,c.round=qn,c.runInContext=a,c.sample=wh,c.size=zh,c.snakeCase=Xm,c.some=Ah,c.sortedIndex=Hg,c.sortedIndexBy=Ig,c.sortedIndexOf=Jg,c.sortedLastIndex=Kg,c.sortedLastIndexBy=Lg,c.sortedLastIndexOf=Mg,c.startCase=Ym,c.startsWith=tj,c.subtract=rn,c.sum=dk,c.sumBy=ek,c.template=uj,c.times=Wj,c.toFinite=yi,c.toInteger=zi,c.toLength=Ai,c.toLower=vj,c.toNumber=Bi,c.toSafeInteger=Di,c.toString=Ei,c.toUpper=wj,c.trim=xj,c.trimEnd=yj,c.trimStart=zj,c.truncate=Aj,c.unescape=Bj,c.uniqueId=Yj,c.upperCase=Zm,c.upperFirst=$m,c.each=oh,c.eachRight=ph,c.first=ug,Lj(c,function(){var a={};return dd(c,function(b,d){tk.call(c.prototype,d)||(a[d]=b)}),a}(),{chain:!1}),c.VERSION=ea,i(["bind","bindKey","curry","curryRight","partial","partialRight"],function(a){c[a].placeholder=c}),i(["drop","take"],function(a,b){C.prototype[a]=function(c){c=c===da?1:Wk(zi(c),0);var d=this.__filtered__&&!b?new C(this):this.clone();return d.__filtered__?d.__takeCount__=Xk(c,d.__takeCount__):d.__views__.push({size:Xk(c,La),type:a+(d.__dir__<0?"Right":"")}),d},C.prototype[a+"Right"]=function(b){return this.reverse()[a](b).reverse()}}),i(["filter","map","takeWhile"],function(a,b){var c=b+1,d=c==Ea||c==Ga;C.prototype[a]=function(a){var b=this.clone();return b.__iteratees__.push({iteratee:yf(a,3),type:c}),b.__filtered__=b.__filtered__||d,b}}),i(["head","last"],function(a,b){var c="take"+(b?"Right":"");C.prototype[a]=function(){return this[c](1).value()[0]}}),i(["initial","tail"],function(a,b){var c="drop"+(b?"":"Right");C.prototype[a]=function(){return this.__filtered__?new C(this):this[c](1)}}),C.prototype.compact=function(){return this.filter(Hj)},C.prototype.find=function(a){return this.filter(a).head()},C.prototype.findLast=function(a){return this.reverse().find(a)},C.prototype.invokeMap=ee(function(a,b){return"function"==typeof a?new C(this):this.map(function(c){return Bd(c,a,b)})}),C.prototype.reject=function(a){return this.filter(Jh(yf(a)))},C.prototype.slice=function(a,b){a=zi(a);var c=this;return c.__filtered__&&(a>0||b<0)?new C(c):(a<0?c=c.takeRight(-a):a&&(c=c.drop(a)),b!==da&&(b=zi(b),c=b<0?c.dropRight(-b):c.take(b-a)),c)},C.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},C.prototype.toArray=function(){return this.take(La)},dd(C.prototype,function(a,b){var d=/^(?:filter|find|map|reject)|While$/.test(b),e=/^(?:head|last)$/.test(b),f=c[e?"take"+("last"==b?"Right":""):b],g=e||/^find/.test(b);f&&(c.prototype[b]=function(){var b=this.__wrapped__,h=e?[1]:arguments,i=b instanceof C,j=h[0],k=i||tm(b),l=function(a){var b=f.apply(c,p([a],h));return e&&m?b[0]:b};k&&d&&"function"==typeof j&&1!=j.length&&(i=k=!1);var m=this.__chain__,n=!!this.__actions__.length,o=g&&!m,q=i&&!n;if(!g&&k){b=q?b:new C(this);var r=a.apply(b,h);return r.__actions__.push({func:bh,args:[l],thisArg:da}),new t(r,m)}return o&&q?a.apply(this,h):(r=this.thru(l),o?e?r.value()[0]:r.value():r)})}),i(["pop","push","shift","sort","splice","unshift"],function(a){var b=ok[a],d=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",e=/^(?:pop|shift)$/.test(a);c.prototype[a]=function(){var a=arguments;if(e&&!this.__chain__){var c=this.value();return b.apply(tm(c)?c:[],a)}return this[d](function(c){return b.apply(tm(c)?c:[],a)})}}),dd(C.prototype,function(a,b){var d=c[b];if(d){var e=d.name+"",f=hl[e]||(hl[e]=[]);f.push({name:b,func:d})}}),hl[af(da,ra).name]=[{name:"wrapper",func:da}],C.prototype.clone=Y,C.prototype.reverse=aa,C.prototype.value=ba,c.prototype.at=$l,c.prototype.chain=ch,c.prototype.commit=dh,c.prototype.next=eh,c.prototype.plant=gh,c.prototype.reverse=hh,c.prototype.toJSON=c.prototype.valueOf=c.prototype.value=ih,c.prototype.first=c.prototype.head,Jk&&(c.prototype[Jk]=fh),c},wd=vd();"function"==typeof b&&"object"==typeof b.amd&&b.amd?(fd._=wd,b(function(){return wd})):hd?((hd.exports=wd)._=wd,gd._=wd):fd._=wd}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],149:[function(a,b,c){function d(a,b){if("function"!=typeof a||null!=b&&"function"!=typeof b)throw new TypeError(f);var c=function(){var d=arguments,e=b?b.apply(this,d):d[0],f=c.cache;if(f.has(e))return f.get(e);var g=a.apply(this,d);return c.cache=f.set(e,g)||f,g};return c.cache=new(d.Cache||e),c}var e=a("./_MapCache"),f="Expected a function";d.Cache=e,b.exports=d},{"./_MapCache":17}],150:[function(a,b,c){function d(a){return g(a)?e(h(a)):f(a)}var e=a("./_baseProperty"),f=a("./_basePropertyDeep"),g=a("./_isKey"),h=a("./_toKey");b.exports=d},{"./_baseProperty":55,"./_basePropertyDeep":56,"./_isKey":90,"./_toKey":126}],151:[function(a,b,c){function d(){return[]}b.exports=d},{}],152:[function(a,b,c){function d(){return!1}b.exports=d},{}],153:[function(a,b,c){function d(a){return null==a?"":e(a)}var e=a("./_baseToString");b.exports=d},{"./_baseToString":60}],154:[function(a,b,c){"undefined"==typeof Paho&&(Paho={}),Paho.MQTT=function(a){function b(a,b,c){return b[c++]=a>>8,b[c++]=a%256,c}function c(a,c,d,f){return f=b(c,d,f),e(a,d,f),f+c}function d(a){for(var b=0,c=0;c<a.length;c++){var d=a.charCodeAt(c);2047<d?(55296<=d&&56319>=d&&(c++,b++),b+=3):127<d?b+=2:b++}return b}function e(a,b,c){for(var d=0;d<a.length;d++){var e=a.charCodeAt(d);if(55296<=e&&56319>=e){var f=a.charCodeAt(++d);if(isNaN(f))throw Error(k(i.MALFORMED_UNICODE,[e,f]));e=(e-55296<<10)+(f-56320)+65536}127>=e?b[c++]=e:(2047>=e?b[c++]=e>>6&31|192:(65535>=e?b[c++]=e>>12&15|224:(b[c++]=e>>18&7|240,b[c++]=e>>12&63|128),b[c++]=e>>6&63|128),b[c++]=63&e|128)}return b}function f(a,b,c){for(var d,e="",f=b;f<b+c;){if(d=a[f++],!(128>d)){var g=a[f++]-128;if(0>g)throw Error(k(i.MALFORMED_UTF,[d.toString(16),g.toString(16),""]));if(224>d)d=64*(d-192)+g;else{var h=a[f++]-128;if(0>h)throw Error(k(i.MALFORMED_UTF,[d.toString(16),g.toString(16),h.toString(16)]));if(240>d)d=4096*(d-224)+64*g+h;else{var j=a[f++]-128;if(0>j)throw Error(k(i.MALFORMED_UTF,[d.toString(16),g.toString(16),h.toString(16),j.toString(16)]));if(!(248>d))throw Error(k(i.MALFORMED_UTF,[d.toString(16),g.toString(16),h.toString(16),j.toString(16)]));d=262144*(d-240)+4096*g+64*h+j}}}65535<d&&(d-=65536,e+=String.fromCharCode(55296+(d>>10)),d=56320+(1023&d)),e+=String.fromCharCode(d)}return e}var g=function(a,b){for(var c in a)if(a.hasOwnProperty(c)){if(!b.hasOwnProperty(c)){var d="Unknown property, "+c+". Valid properties are:";for(c in b)b.hasOwnProperty(c)&&(d=d+" "+c);throw Error(d)}if(typeof a[c]!==b[c])throw Error(k(i.INVALID_TYPE,[typeof a[c],c]))}},h=function(a,b){return function(){return a.apply(b,arguments)}},i={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."}},j={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},k=function(a,b){var c=a.text;if(b)for(var d,e,f=0;f<b.length;f++)if(d="{"+f+"}",e=c.indexOf(d),0<e)var g=c.substring(0,e),c=c.substring(e+d.length),c=g+b[f]+c;return c},l=[0,6,77,81,73,115,100,112,3],m=[0,4,77,81,84,84,4],n=function(a,b){this.type=a;for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c])};n.prototype.encode=function(){var a=(15&this.type)<<4,e=0,f=[],g=0;switch(void 0!=this.messageIdentifier&&(e+=2),this.type){case 1:switch(this.mqttVersion){case 3:e+=l.length+3;break;case 4:e+=m.length+3}if(e+=d(this.clientId)+2,void 0!=this.willMessage){var e=e+(d(this.willMessage.destinationName)+2),h=this.willMessage.payloadBytes;h instanceof Uint8Array||(h=new Uint8Array(j)),e+=h.byteLength+2}void 0!=this.userName&&(e+=d(this.userName)+2),void 0!=this.password&&(e+=d(this.password)+2);break;case 8:for(var a=2|a,i=0;i<this.topics.length;i++)f[i]=d(this.topics[i]),e+=f[i]+2;e+=this.requestedQos.length;break;case 10:for(a|=2,i=0;i<this.topics.length;i++)f[i]=d(this.topics[i]),e+=f[i]+2;break;case 6:a|=2;break;case 3:this.payloadMessage.duplicate&&(a|=8),a=a|=this.payloadMessage.qos<<1,this.payloadMessage.retained&&(a|=1);var g=d(this.payloadMessage.destinationName),j=this.payloadMessage.payloadBytes,e=e+(g+2)+j.byteLength;j instanceof ArrayBuffer?j=new Uint8Array(j):j instanceof Uint8Array||(j=new Uint8Array(j.buffer))}var k=e,i=Array(1),n=0;do{var o=k%128,k=k>>7;0<k&&(o|=128),i[n++]=o}while(0<k&&4>n);if(k=i.length+1,e=new ArrayBuffer(e+k),n=new Uint8Array(e),n[0]=a,n.set(i,1),3==this.type)k=c(this.payloadMessage.destinationName,g,n,k);else if(1==this.type){switch(this.mqttVersion){case 3:n.set(l,k),k+=l.length;break;case 4:n.set(m,k),k+=m.length}a=0,this.cleanSession&&(a=2),void 0!=this.willMessage&&(a=4|a|this.willMessage.qos<<3,this.willMessage.retained&&(a|=32)),void 0!=this.userName&&(a|=128),void 0!=this.password&&(a|=64),n[k++]=a,k=b(this.keepAliveInterval,n,k)}switch(void 0!=this.messageIdentifier&&(k=b(this.messageIdentifier,n,k)),this.type){case 1:k=c(this.clientId,d(this.clientId),n,k),void 0!=this.willMessage&&(k=c(this.willMessage.destinationName,d(this.willMessage.destinationName),n,k),k=b(h.byteLength,n,k),n.set(h,k),k+=h.byteLength),void 0!=this.userName&&(k=c(this.userName,d(this.userName),n,k)),void 0!=this.password&&c(this.password,d(this.password),n,k);break;case 3:n.set(j,k);break;case 8:for(i=0;i<this.topics.length;i++)k=c(this.topics[i],f[i],n,k),n[k++]=this.requestedQos[i];break;case 10:for(i=0;i<this.topics.length;i++)k=c(this.topics[i],f[i],n,k)}return e};var o=function(a,b,c){this._client=a,this._window=b,this._keepAliveInterval=1e3*c,this.isReset=!1;var d=new n(12).encode(),e=function(a){return function(){return f.apply(a)}},f=function(){this.isReset?(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(d),this.timeout=this._window.setTimeout(e(this),this._keepAliveInterval)):(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(i.PING_TIMEOUT.code,k(i.PING_TIMEOUT)))};this.reset=function(){this.isReset=!0,this._window.clearTimeout(this.timeout),0<this._keepAliveInterval&&(this.timeout=setTimeout(e(this),this._keepAliveInterval))},this.cancel=function(){this._window.clearTimeout(this.timeout)}},p=function(a,b,c,d,e){this._window=b,c||(c=30),this.timeout=setTimeout(function(a,b,c){return function(){return a.apply(b,c)}}(d,a,e),1e3*c),this.cancel=function(){this._window.clearTimeout(this.timeout)}},q=function(b,c,d,e,f){if(!("WebSocket"in a&&null!==a.WebSocket))throw Error(k(i.UNSUPPORTED,["WebSocket"]));if(!("localStorage"in a&&null!==a.localStorage))throw Error(k(i.UNSUPPORTED,["localStorage"]));if(!("ArrayBuffer"in a&&null!==a.ArrayBuffer))throw Error(k(i.UNSUPPORTED,["ArrayBuffer"]));this._trace("Paho.MQTT.Client",b,c,d,e,f),this.host=c,this.port=d,this.path=e,this.uri=b,this.clientId=f,this._localKey=c+":"+d+("/mqtt"!=e?":"+e:"")+":"+f+":",this._msg_queue=[],this._sentMessages={},this._receivedMessages={},this._notify_msg_sent={},this._message_identifier=1,this._sequence=0;for(var g in localStorage)0!=g.indexOf("Sent:"+this._localKey)&&0!=g.indexOf("Received:"+this._localKey)||this.restore(g)};q.prototype.host,q.prototype.port,q.prototype.path,q.prototype.uri,q.prototype.clientId,q.prototype.socket,q.prototype.connected=!1,q.prototype.maxMessageIdentifier=65536,q.prototype.connectOptions,q.prototype.hostIndex,q.prototype.onConnectionLost,q.prototype.onMessageDelivered,q.prototype.onMessageArrived,q.prototype.traceFunction,q.prototype._msg_queue=null,q.prototype._connectTimeout,q.prototype.sendPinger=null,q.prototype.receivePinger=null,q.prototype.receiveBuffer=null,q.prototype._traceBuffer=null,q.prototype._MAX_TRACE_ENTRIES=100,q.prototype.connect=function(a){var b=this._traceMask(a,"password");if(this._trace("Client.connect",b,this.socket,this.connected),this.connected)throw Error(k(i.INVALID_STATE,["already connected"]));if(this.socket)throw Error(k(i.INVALID_STATE,["already connected"]));this.connectOptions=a,a.uris?(this.hostIndex=0,this._doConnect(a.uris[0])):this._doConnect(this.uri)},q.prototype.subscribe=function(a,b){if(this._trace("Client.subscribe",a,b),!this.connected)throw Error(k(i.INVALID_STATE,["not connected"]));var c=new n(8);c.topics=[a],c.requestedQos=void 0!=b.qos?[b.qos]:[0],b.onSuccess&&(c.onSuccess=function(a){b.onSuccess({invocationContext:b.invocationContext,grantedQos:a})}),b.onFailure&&(c.onFailure=function(a){b.onFailure({invocationContext:b.invocationContext,errorCode:a})}),b.timeout&&(c.timeOut=new p(this,window,b.timeout,b.onFailure,[{invocationContext:b.invocationContext,errorCode:i.SUBSCRIBE_TIMEOUT.code,errorMessage:k(i.SUBSCRIBE_TIMEOUT)}])),this._requires_ack(c),this._schedule_message(c)},q.prototype.unsubscribe=function(a,b){if(this._trace("Client.unsubscribe",a,b),!this.connected)throw Error(k(i.INVALID_STATE,["not connected"]));var c=new n(10);c.topics=[a],b.onSuccess&&(c.callback=function(){b.onSuccess({invocationContext:b.invocationContext})}),b.timeout&&(c.timeOut=new p(this,window,b.timeout,b.onFailure,[{invocationContext:b.invocationContext,errorCode:i.UNSUBSCRIBE_TIMEOUT.code,errorMessage:k(i.UNSUBSCRIBE_TIMEOUT)}])),this._requires_ack(c),this._schedule_message(c)},q.prototype.send=function(a){if(this._trace("Client.send",a),!this.connected)throw Error(k(i.INVALID_STATE,["not connected"]));wireMessage=new n(3),wireMessage.payloadMessage=a,0<a.qos?this._requires_ack(wireMessage):this.onMessageDelivered&&(this._notify_msg_sent[wireMessage]=this.onMessageDelivered(wireMessage.payloadMessage)),this._schedule_message(wireMessage)},q.prototype.disconnect=function(){if(this._trace("Client.disconnect"),!this.socket)throw Error(k(i.INVALID_STATE,["not connecting or connected"]));wireMessage=new n(14),this._notify_msg_sent[wireMessage]=h(this._disconnected,this),this._schedule_message(wireMessage)},q.prototype.getTraceLog=function(){if(null!==this._traceBuffer){this._trace("Client.getTraceLog",new Date),this._trace("Client.getTraceLog in flight messages",this._sentMessages.length);for(var a in this._sentMessages)this._trace("_sentMessages ",a,this._sentMessages[a]);for(a in this._receivedMessages)this._trace("_receivedMessages ",a,this._receivedMessages[a]);return this._traceBuffer}},q.prototype.startTrace=function(){null===this._traceBuffer&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date,"1.0.2")},q.prototype.stopTrace=function(){delete this._traceBuffer},q.prototype._doConnect=function(a){this.connectOptions.useSSL&&(a=a.split(":"),a[0]="wss",a=a.join(":")),this.connected=!1,this.socket=4>this.connectOptions.mqttVersion?new WebSocket(a,["mqttv3.1"]):new WebSocket(a,["mqtt"]),this.socket.binaryType="arraybuffer",this.socket.onopen=h(this._on_socket_open,this),this.socket.onmessage=h(this._on_socket_message,this),this.socket.onerror=h(this._on_socket_error,this),this.socket.onclose=h(this._on_socket_close,this),this.sendPinger=new o(this,window,this.connectOptions.keepAliveInterval),this.receivePinger=new o(this,window,this.connectOptions.keepAliveInterval),this._connectTimeout=new p(this,window,this.connectOptions.timeout,this._disconnected,[i.CONNECT_TIMEOUT.code,k(i.CONNECT_TIMEOUT)])},q.prototype._schedule_message=function(a){this._msg_queue.push(a),this.connected&&this._process_queue()},q.prototype.store=function(a,b){var c={type:b.type,messageIdentifier:b.messageIdentifier,version:1};switch(b.type){case 3:b.pubRecReceived&&(c.pubRecReceived=!0),c.payloadMessage={};for(var d="",e=b.payloadMessage.payloadBytes,f=0;f<e.length;f++)d=15>=e[f]?d+"0"+e[f].toString(16):d+e[f].toString(16);c.payloadMessage.payloadHex=d,c.payloadMessage.qos=b.payloadMessage.qos,c.payloadMessage.destinationName=b.payloadMessage.destinationName,b.payloadMessage.duplicate&&(c.payloadMessage.duplicate=!0),b.payloadMessage.retained&&(c.payloadMessage.retained=!0),0==a.indexOf("Sent:")&&(void 0===b.sequence&&(b.sequence=++this._sequence),c.sequence=b.sequence);break;default:throw Error(k(i.INVALID_STORED_DATA,[key,c]))}localStorage.setItem(a+this._localKey+b.messageIdentifier,JSON.stringify(c))},q.prototype.restore=function(a){var b=localStorage.getItem(a),c=JSON.parse(b),d=new n(c.type,c);switch(c.type){case 3:for(var b=c.payloadMessage.payloadHex,e=new ArrayBuffer(b.length/2),e=new Uint8Array(e),f=0;2<=b.length;){var g=parseInt(b.substring(0,2),16),b=b.substring(2,b.length);e[f++]=g}b=new Paho.MQTT.Message(e),b.qos=c.payloadMessage.qos,b.destinationName=c.payloadMessage.destinationName,c.payloadMessage.duplicate&&(b.duplicate=!0),c.payloadMessage.retained&&(b.retained=!0),d.payloadMessage=b;break;default:throw Error(k(i.INVALID_STORED_DATA,[a,b]))}0==a.indexOf("Sent:"+this._localKey)?(d.payloadMessage.duplicate=!0,this._sentMessages[d.messageIdentifier]=d):0==a.indexOf("Received:"+this._localKey)&&(this._receivedMessages[d.messageIdentifier]=d)},q.prototype._process_queue=function(){for(var a=null,b=this._msg_queue.reverse();a=b.pop();)this._socket_send(a),this._notify_msg_sent[a]&&(this._notify_msg_sent[a](),delete this._notify_msg_sent[a])},q.prototype._requires_ack=function(a){var b=Object.keys(this._sentMessages).length;if(b>this.maxMessageIdentifier)throw Error("Too many messages:"+b);for(;void 0!==this._sentMessages[this._message_identifier];)this._message_identifier++;a.messageIdentifier=this._message_identifier,this._sentMessages[a.messageIdentifier]=a,3===a.type&&this.store("Sent:",a),this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)},q.prototype._on_socket_open=function(){var a=new n(1,this.connectOptions);a.clientId=this.clientId,this._socket_send(a)},q.prototype._on_socket_message=function(a){this._trace("Client._on_socket_message",a.data),a=this._deframeMessages(a.data);for(var b=0;b<a.length;b+=1)this._handleMessage(a[b])},q.prototype._deframeMessages=function(a){if(a=new Uint8Array(a),this.receiveBuffer){var b=new Uint8Array(this.receiveBuffer.length+a.length);b.set(this.receiveBuffer),b.set(a,this.receiveBuffer.length),a=b,delete this.receiveBuffer}try{for(var b=0,c=[];b<a.length;){var d;a:{var e=a,g=b,h=g,j=e[g],l=j>>4,m=15&j,g=g+1,o=void 0,p=0,q=1;do{if(g==e.length){d=[null,h];break a}o=e[g++],p+=(127&o)*q,q*=128}while(0!=(128&o));if(o=g+p,o>e.length)d=[null,h];else{var r=new n(l);switch(l){case 2:1&e[g++]&&(r.sessionPresent=!0),r.returnCode=e[g++];break;case 3:var h=m>>1&3,s=256*e[g]+e[g+1],g=g+2,t=f(e,g,s),g=g+s;0<h&&(r.messageIdentifier=256*e[g]+e[g+1],g+=2);var u=new Paho.MQTT.Message(e.subarray(g,o));1==(1&m)&&(u.retained=!0),8==(8&m)&&(u.duplicate=!0),u.qos=h,u.destinationName=t,r.payloadMessage=u;break;case 4:case 5:case 6:case 7:case 11:r.messageIdentifier=256*e[g]+e[g+1];break;case 9:r.messageIdentifier=256*e[g]+e[g+1],g+=2,r.returnCode=e.subarray(g,o)}d=[r,o]}}var v=d[0],b=d[1];if(null===v)break;c.push(v)}b<a.length&&(this.receiveBuffer=a.subarray(b))}catch(w){return void this._disconnected(i.INTERNAL_ERROR.code,k(i.INTERNAL_ERROR,[w.message,w.stack.toString()]))}return c},q.prototype._handleMessage=function(a){this._trace("Client._handleMessage",a);try{switch(a.type){case 2:if(this._connectTimeout.cancel(),this.connectOptions.cleanSession){for(var b in this._sentMessages){var c=this._sentMessages[b];localStorage.removeItem("Sent:"+this._localKey+c.messageIdentifier)}this._sentMessages={};for(b in this._receivedMessages){var d=this._receivedMessages[b];localStorage.removeItem("Received:"+this._localKey+d.messageIdentifier)}this._receivedMessages={}}if(0!==a.returnCode){this._disconnected(i.CONNACK_RETURNCODE.code,k(i.CONNACK_RETURNCODE,[a.returnCode,j[a.returnCode]]));break}this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length),a=[];for(var e in this._sentMessages)this._sentMessages.hasOwnProperty(e)&&a.push(this._sentMessages[e]);a=a.sort(function(a,b){return a.sequence-b.sequence}),e=0;for(var f=a.length;e<f;e++)if(c=a[e],3==c.type&&c.pubRecReceived){var g=new n(6,{messageIdentifier:c.messageIdentifier});this._schedule_message(g)}else this._schedule_message(c);this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext}),this._process_queue();break;case 3:this._receivePublish(a);break;case 4:(c=this._sentMessages[a.messageIdentifier])&&(delete this._sentMessages[a.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+a.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(c.payloadMessage));break;case 5:(c=this._sentMessages[a.messageIdentifier])&&(c.pubRecReceived=!0,g=new n(6,{messageIdentifier:a.messageIdentifier}),this.store("Sent:",c),this._schedule_message(g));break;case 6:d=this._receivedMessages[a.messageIdentifier],localStorage.removeItem("Received:"+this._localKey+a.messageIdentifier),d&&(this._receiveMessage(d),delete this._receivedMessages[a.messageIdentifier]);var h=new n(7,{messageIdentifier:a.messageIdentifier});this._schedule_message(h);break;case 7:c=this._sentMessages[a.messageIdentifier],delete this._sentMessages[a.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+a.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(c.payloadMessage);break;case 9:(c=this._sentMessages[a.messageIdentifier])&&(c.timeOut&&c.timeOut.cancel(),128===a.returnCode[0]?c.onFailure&&c.onFailure(a.returnCode):c.onSuccess&&c.onSuccess(a.returnCode),delete this._sentMessages[a.messageIdentifier]);break;case 11:(c=this._sentMessages[a.messageIdentifier])&&(c.timeOut&&c.timeOut.cancel(),c.callback&&c.callback(),delete this._sentMessages[a.messageIdentifier]);break;case 13:this.sendPinger.reset();break;case 14:this._disconnected(i.INVALID_MQTT_MESSAGE_TYPE.code,k(i.INVALID_MQTT_MESSAGE_TYPE,[a.type]));break;default:this._disconnected(i.INVALID_MQTT_MESSAGE_TYPE.code,k(i.INVALID_MQTT_MESSAGE_TYPE,[a.type]))}}catch(l){this._disconnected(i.INTERNAL_ERROR.code,k(i.INTERNAL_ERROR,[l.message,l.stack.toString()]))}},q.prototype._on_socket_error=function(a){this._disconnected(i.SOCKET_ERROR.code,k(i.SOCKET_ERROR,[a.data]))},q.prototype._on_socket_close=function(){this._disconnected(i.SOCKET_CLOSE.code,k(i.SOCKET_CLOSE))},q.prototype._socket_send=function(a){if(1==a.type){var b=this._traceMask(a,"password");this._trace("Client._socket_send",b)}else this._trace("Client._socket_send",a);this.socket.send(a.encode()),this.sendPinger.reset()},q.prototype._receivePublish=function(a){switch(a.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(a);break;case 1:var b=new n(4,{messageIdentifier:a.messageIdentifier});this._schedule_message(b),this._receiveMessage(a);break;case 2:this._receivedMessages[a.messageIdentifier]=a,this.store("Received:",a),a=new n(5,{messageIdentifier:a.messageIdentifier}),this._schedule_message(a);break;default:throw Error("Invaild qos="+wireMmessage.payloadMessage.qos)}},q.prototype._receiveMessage=function(a){this.onMessageArrived&&this.onMessageArrived(a.payloadMessage)},q.prototype._disconnected=function(a,b){this._trace("Client._disconnected",a,b),this.sendPinger.cancel(),this.receivePinger.cancel(),this._connectTimeout&&this._connectTimeout.cancel(),this._msg_queue=[],this._notify_msg_sent={},this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,1===this.socket.readyState&&this.socket.close(),delete this.socket),this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1?(this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex])):(void 0===a&&(a=i.OK.code,b=k(i.OK)),this.connected?(this.connected=!1,this.onConnectionLost&&this.onConnectionLost({errorCode:a,errorMessage:b})):4===this.connectOptions.mqttVersion&&!1===this.connectOptions.mqttVersionExplicit?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:a,errorMessage:b}))},q.prototype._trace=function(){if(this.traceFunction){for(var a in arguments)"undefined"!=typeof arguments[a]&&(arguments[a]=JSON.stringify(arguments[a]));a=Array.prototype.slice.call(arguments).join(""),this.traceFunction({severity:"Debug",message:a})}if(null!==this._traceBuffer){a=0;for(var b=arguments.length;a<b;a++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),0===a?this._traceBuffer.push(arguments[a]):"undefined"==typeof arguments[a]?this._traceBuffer.push(arguments[a]):this._traceBuffer.push("  "+JSON.stringify(arguments[a]))}},q.prototype._traceMask=function(a,b){var c,d={};for(c in a)a.hasOwnProperty(c)&&(d[c]=c==b?"******":a[c]);return d};var r=function(a,b,c,d){var e;if("string"!=typeof a)throw Error(k(i.INVALID_TYPE,[typeof a,"host"]));if(2==arguments.length){d=b,e=a;var f=e.match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(!f)throw Error(k(i.INVALID_ARGUMENT,[a,"host"]));a=f[4]||f[2],b=parseInt(f[7]),c=f[8]}else{if(3==arguments.length&&(d=c,c="/mqtt"),"number"!=typeof b||0>b)throw Error(k(i.INVALID_TYPE,[typeof b,"port"]));if("string"!=typeof c)throw Error(k(i.INVALID_TYPE,[typeof c,"path"]));e="ws://"+(-1!=a.indexOf(":")&&"["!=a.slice(0,1)&&"]"!=a.slice(-1)?"["+a+"]":a)+":"+b+c;
}for(var h=f=0;h<d.length;h++){var j=d.charCodeAt(h);55296<=j&&56319>=j&&h++,f++}if("string"!=typeof d||65535<f)throw Error(k(i.INVALID_ARGUMENT,[d,"clientId"]));var l=new q(e,a,b,c,d);this._getHost=function(){return a},this._setHost=function(){throw Error(k(i.UNSUPPORTED_OPERATION))},this._getPort=function(){return b},this._setPort=function(){throw Error(k(i.UNSUPPORTED_OPERATION))},this._getPath=function(){return c},this._setPath=function(){throw Error(k(i.UNSUPPORTED_OPERATION))},this._getURI=function(){return e},this._setURI=function(){throw Error(k(i.UNSUPPORTED_OPERATION))},this._getClientId=function(){return l.clientId},this._setClientId=function(){throw Error(k(i.UNSUPPORTED_OPERATION))},this._getOnConnectionLost=function(){return l.onConnectionLost},this._setOnConnectionLost=function(a){if("function"!=typeof a)throw Error(k(i.INVALID_TYPE,[typeof a,"onConnectionLost"]));l.onConnectionLost=a},this._getOnMessageDelivered=function(){return l.onMessageDelivered},this._setOnMessageDelivered=function(a){if("function"!=typeof a)throw Error(k(i.INVALID_TYPE,[typeof a,"onMessageDelivered"]));l.onMessageDelivered=a},this._getOnMessageArrived=function(){return l.onMessageArrived},this._setOnMessageArrived=function(a){if("function"!=typeof a)throw Error(k(i.INVALID_TYPE,[typeof a,"onMessageArrived"]));l.onMessageArrived=a},this._getTrace=function(){return l.traceFunction},this._setTrace=function(a){if("function"!=typeof a)throw Error(k(i.INVALID_TYPE,[typeof a,"onTrace"]));l.traceFunction=a},this.connect=function(a){if(a=a||{},g(a,{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",mqttVersion:"number",mqttVersionExplicit:"boolean",uris:"object"}),void 0===a.keepAliveInterval&&(a.keepAliveInterval=60),4<a.mqttVersion||3>a.mqttVersion)throw Error(k(i.INVALID_ARGUMENT,[a.mqttVersion,"connectOptions.mqttVersion"]));if(void 0===a.mqttVersion?(a.mqttVersionExplicit=!1,a.mqttVersion=4):a.mqttVersionExplicit=!0,void 0!==a.password&&void 0===a.userName)throw Error(k(i.INVALID_ARGUMENT,[a.password,"connectOptions.password"]));if(a.willMessage){if(!(a.willMessage instanceof s))throw Error(k(i.INVALID_TYPE,[a.willMessage,"connectOptions.willMessage"]));if(a.willMessage.stringPayload,"undefined"==typeof a.willMessage.destinationName)throw Error(k(i.INVALID_TYPE,[typeof a.willMessage.destinationName,"connectOptions.willMessage.destinationName"]))}if("undefined"==typeof a.cleanSession&&(a.cleanSession=!0),a.hosts){if(!(a.hosts instanceof Array))throw Error(k(i.INVALID_ARGUMENT,[a.hosts,"connectOptions.hosts"]));if(1>a.hosts.length)throw Error(k(i.INVALID_ARGUMENT,[a.hosts,"connectOptions.hosts"]));for(var b=!1,d=0;d<a.hosts.length;d++){if("string"!=typeof a.hosts[d])throw Error(k(i.INVALID_TYPE,[typeof a.hosts[d],"connectOptions.hosts["+d+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(a.hosts[d])){if(0==d)b=!0;else if(!b)throw Error(k(i.INVALID_ARGUMENT,[a.hosts[d],"connectOptions.hosts["+d+"]"]))}else if(b)throw Error(k(i.INVALID_ARGUMENT,[a.hosts[d],"connectOptions.hosts["+d+"]"]))}if(b)a.uris=a.hosts;else{if(!a.ports)throw Error(k(i.INVALID_ARGUMENT,[a.ports,"connectOptions.ports"]));if(!(a.ports instanceof Array))throw Error(k(i.INVALID_ARGUMENT,[a.ports,"connectOptions.ports"]));if(a.hosts.length!=a.ports.length)throw Error(k(i.INVALID_ARGUMENT,[a.ports,"connectOptions.ports"]));for(a.uris=[],d=0;d<a.hosts.length;d++){if("number"!=typeof a.ports[d]||0>a.ports[d])throw Error(k(i.INVALID_TYPE,[typeof a.ports[d],"connectOptions.ports["+d+"]"]));var b=a.hosts[d],f=a.ports[d];e="ws://"+(-1!=b.indexOf(":")?"["+b+"]":b)+":"+f+c,a.uris.push(e)}}}l.connect(a)},this.subscribe=function(a,b){if("string"!=typeof a)throw Error("Invalid argument:"+a);if(b=b||{},g(b,{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),b.timeout&&!b.onFailure)throw Error("subscribeOptions.timeout specified with no onFailure callback.");if("undefined"!=typeof b.qos&&0!==b.qos&&1!==b.qos&&2!==b.qos)throw Error(k(i.INVALID_ARGUMENT,[b.qos,"subscribeOptions.qos"]));l.subscribe(a,b)},this.unsubscribe=function(a,b){if("string"!=typeof a)throw Error("Invalid argument:"+a);if(b=b||{},g(b,{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),b.timeout&&!b.onFailure)throw Error("unsubscribeOptions.timeout specified with no onFailure callback.");l.unsubscribe(a,b)},this.send=function(a,b,c,d){var e;if(0==arguments.length)throw Error("Invalid argument.length");if(1==arguments.length){if(!(a instanceof s)&&"string"!=typeof a)throw Error("Invalid argument:"+typeof a);if(e=a,"undefined"==typeof e.destinationName)throw Error(k(i.INVALID_ARGUMENT,[e.destinationName,"Message.destinationName"]))}else e=new s(b),e.destinationName=a,3<=arguments.length&&(e.qos=c),4<=arguments.length&&(e.retained=d);l.send(e)},this.disconnect=function(){l.disconnect()},this.getTraceLog=function(){return l.getTraceLog()},this.startTrace=function(){l.startTrace()},this.stopTrace=function(){l.stopTrace()},this.isConnected=function(){return l.connected}};r.prototype={get host(){return this._getHost()},set host(a){this._setHost(a)},get port(){return this._getPort()},set port(a){this._setPort(a)},get path(){return this._getPath()},set path(a){this._setPath(a)},get clientId(){return this._getClientId()},set clientId(a){this._setClientId(a)},get onConnectionLost(){return this._getOnConnectionLost()},set onConnectionLost(a){this._setOnConnectionLost(a)},get onMessageDelivered(){return this._getOnMessageDelivered()},set onMessageDelivered(a){this._setOnMessageDelivered(a)},get onMessageArrived(){return this._getOnMessageArrived()},set onMessageArrived(a){this._setOnMessageArrived(a)},get trace(){return this._getTrace()},set trace(a){this._setTrace(a)}};var s=function(a){var b;if(!("string"==typeof a||a instanceof ArrayBuffer||a instanceof Int8Array||a instanceof Uint8Array||a instanceof Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array))throw k(i.INVALID_ARGUMENT,[a,"newPayload"]);b=a,this._getPayloadString=function(){return"string"==typeof b?b:f(b,0,b.length)},this._getPayloadBytes=function(){if("string"==typeof b){var a=new ArrayBuffer(d(b)),a=new Uint8Array(a);return e(b,a,0),a}return b};var c=void 0;this._getDestinationName=function(){return c},this._setDestinationName=function(a){if("string"!=typeof a)throw Error(k(i.INVALID_ARGUMENT,[a,"newDestinationName"]));c=a};var g=0;this._getQos=function(){return g},this._setQos=function(a){if(0!==a&&1!==a&&2!==a)throw Error("Invalid argument:"+a);g=a};var h=!1;this._getRetained=function(){return h},this._setRetained=function(a){if("boolean"!=typeof a)throw Error(k(i.INVALID_ARGUMENT,[a,"newRetained"]));h=a};var j=!1;this._getDuplicate=function(){return j},this._setDuplicate=function(a){j=a}};return s.prototype={get payloadString(){return this._getPayloadString()},get payloadBytes(){return this._getPayloadBytes()},get destinationName(){return this._getDestinationName()},set destinationName(a){this._setDestinationName(a)},get qos(){return this._getQos()},set qos(a){this._setQos(a)},get retained(){return this._getRetained()},set retained(a){this._setRetained(a)},get duplicate(){return this._getDuplicate()},set duplicate(a){this._setDuplicate(a)}},{Client:r,Message:s}}(window)},{}],155:[function(a,b,c){(function(a){"use strict";function c(b,c,d,e){if("function"!=typeof b)throw new TypeError('"callback" argument must be a function');var f,g,h=arguments.length;switch(h){case 0:case 1:return a.nextTick(b);case 2:return a.nextTick(function(){b.call(null,c)});case 3:return a.nextTick(function(){b.call(null,c,d)});case 4:return a.nextTick(function(){b.call(null,c,d,e)});default:for(f=new Array(h-1),g=0;g<f.length;)f[g++]=arguments[g];return a.nextTick(function(){b.apply(null,f)})}}!a.version||0===a.version.indexOf("v0.")||0===a.version.indexOf("v1.")&&0!==a.version.indexOf("v1.8.")?b.exports=c:b.exports=a.nextTick}).call(this,a("_process"))},{_process:156}],156:[function(a,b,c){function d(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function f(a){if(l===setTimeout)return setTimeout(a,0);if((l===d||!l)&&setTimeout)return l=setTimeout,setTimeout(a,0);try{return l(a,0)}catch(b){try{return l.call(null,a,0)}catch(b){return l.call(this,a,0)}}}function g(a){if(m===clearTimeout)return clearTimeout(a);if((m===e||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(a);try{return m(a)}catch(b){try{return m.call(null,a)}catch(b){return m.call(this,a)}}}function h(){q&&o&&(q=!1,o.length?p=o.concat(p):r=-1,p.length&&i())}function i(){if(!q){var a=f(h);q=!0;for(var b=p.length;b;){for(o=p,p=[];++r<b;)o&&o[r].run();r=-1,b=p.length}o=null,q=!1,g(a)}}function j(a,b){this.fun=a,this.array=b}function k(){}var l,m,n=b.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:d}catch(a){l=d}try{m="function"==typeof clearTimeout?clearTimeout:e}catch(a){m=e}}();var o,p=[],q=!1,r=-1;n.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];p.push(new j(a,b)),1!==p.length||q||f(i)},j.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=k,n.addListener=k,n.once=k,n.off=k,n.removeListener=k,n.removeAllListeners=k,n.emit=k,n.binding=function(a){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(a){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],157:[function(a,b,c){b.exports=a("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":158}],158:[function(a,b,c){"use strict";function d(a){return this instanceof d?(j.call(this,a),k.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||h(f,this)}function f(a){a.end()}var g=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b};b.exports=d;var h=a("process-nextick-args"),i=a("core-util-is");i.inherits=a("inherits");var j=a("./_stream_readable"),k=a("./_stream_writable");i.inherits(d,j);for(var l=g(k.prototype),m=0;m<l.length;m++){var n=l[m];d.prototype[n]||(d.prototype[n]=k.prototype[n])}},{"./_stream_readable":160,"./_stream_writable":162,"core-util-is":7,inherits:10,"process-nextick-args":155}],159:[function(a,b,c){"use strict";function d(a){return this instanceof d?void e.call(this,a):new d(a)}b.exports=d;var e=a("./_stream_transform"),f=a("core-util-is");f.inherits=a("inherits"),f.inherits(d,e),d.prototype._transform=function(a,b,c){c(null,a)}},{"./_stream_transform":161,"core-util-is":7,inherits:10}],160:[function(a,b,c){(function(c){"use strict";function d(a,b,c){return"function"==typeof a.prependListener?a.prependListener(b,c):void(a._events&&a._events[b]?F(a._events[b])?a._events[b].unshift(c):a._events[b]=[c,a._events[b]]:a.on(b,c))}function e(b,c){D=D||a("./_stream_duplex"),b=b||{},this.objectMode=!!b.objectMode,c instanceof D&&(this.objectMode=this.objectMode||!!b.readableObjectMode);var d=b.highWaterMark,e=this.objectMode?16:16384;this.highWaterMark=d||0===d?d:e,this.highWaterMark=~~this.highWaterMark,this.buffer=new O,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(N||(N=a("string_decoder/").StringDecoder),this.decoder=new N(b.encoding),this.encoding=b.encoding)}function f(b){return D=D||a("./_stream_duplex"),this instanceof f?(this._readableState=new e(b,this),this.readable=!0,b&&"function"==typeof b.read&&(this._read=b.read),void G.call(this)):new f(b)}function g(a,b,c,d,e){var f=k(b,c);if(f)a.emit("error",f);else if(null===c)b.reading=!1,l(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var g=new Error("stream.push() after EOF");a.emit("error",g)}else if(b.endEmitted&&e){var i=new Error("stream.unshift() after end event");a.emit("error",i)}else{var j;!b.decoder||e||d||(c=b.decoder.write(c),j=!b.objectMode&&0===c.length),e||(b.reading=!1),j||(b.flowing&&0===b.length&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&m(a))),o(a,b)}else e||(b.reading=!1);return h(b)}function h(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function i(a){return a>=P?a=P:(a--,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a++),a}function j(a,b){return a<=0||0===b.length&&b.ended?0:b.objectMode?1:a!==a?b.flowing&&b.length?b.buffer.head.data.length:b.length:(a>b.highWaterMark&&(b.highWaterMark=i(a)),a<=b.length?a:b.ended?b.length:(b.needReadable=!0,0))}function k(a,b){var c=null;return I.isBuffer(b)||"string"==typeof b||null===b||void 0===b||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function l(a,b){if(!b.ended){if(b.decoder){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,m(a)}}function m(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(M("emitReadable",b.flowing),b.emittedReadable=!0,b.sync?E(n,a):n(a))}function n(a){M("emit readable"),a.emit("readable"),u(a)}function o(a,b){b.readingMore||(b.readingMore=!0,E(p,a,b))}function p(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(M("maybeReadMore read 0"),a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function q(a){return function(){var b=a._readableState;M("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&H(a,"data")&&(b.flowing=!0,u(a))}}function r(a){M("readable nexttick read 0"),a.read(0)}function s(a,b){b.resumeScheduled||(b.resumeScheduled=!0,E(t,a,b))}function t(a,b){b.reading||(M("resume read 0"),a.read(0)),b.resumeScheduled=!1,b.awaitDrain=0,a.emit("resume"),u(a),b.flowing&&!b.reading&&a.read(0)}function u(a){var b=a._readableState;for(M("flow",b.flowing);b.flowing&&null!==a.read(););}function v(a,b){if(0===b.length)return null;var c;return b.objectMode?c=b.buffer.shift():!a||a>=b.length?(c=b.decoder?b.buffer.join(""):1===b.buffer.length?b.buffer.head.data:b.buffer.concat(b.length),b.buffer.clear()):c=w(a,b.buffer,b.decoder),c}function w(a,b,c){var d;return a<b.head.data.length?(d=b.head.data.slice(0,a),b.head.data=b.head.data.slice(a)):d=a===b.head.data.length?b.shift():c?x(a,b):y(a,b),d}function x(a,b){var c=b.head,d=1,e=c.data;for(a-=e.length;c=c.next;){var f=c.data,g=a>f.length?f.length:a;if(e+=g===f.length?f:f.slice(0,a),a-=g,0===a){g===f.length?(++d,c.next?b.head=c.next:b.head=b.tail=null):(b.head=c,c.data=f.slice(g));break}++d}return b.length-=d,e}function y(a,b){var c=J.allocUnsafe(a),d=b.head,e=1;for(d.data.copy(c),a-=d.data.length;d=d.next;){var f=d.data,g=a>f.length?f.length:a;if(f.copy(c,c.length-a,0,g),a-=g,0===a){g===f.length?(++e,d.next?b.head=d.next:b.head=b.tail=null):(b.head=d,d.data=f.slice(g));break}++e}return b.length-=e,c}function z(a){var b=a._readableState;if(b.length>0)throw new Error('"endReadable()" called on non-empty stream');b.endEmitted||(b.ended=!0,E(A,b,a))}function A(a,b){a.endEmitted||0!==a.length||(a.endEmitted=!0,b.readable=!1,b.emit("end"))}function B(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)}function C(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}b.exports=f;var D,E=a("process-nextick-args"),F=a("isarray");f.ReadableState=e;var G,H=(a("events").EventEmitter,function(a,b){return a.listeners(b).length});!function(){try{G=a("stream")}catch(b){}finally{G||(G=a("events").EventEmitter)}}();var I=a("buffer").Buffer,J=a("buffer-shims"),K=a("core-util-is");K.inherits=a("inherits");var L=a("util"),M=void 0;M=L&&L.debuglog?L.debuglog("stream"):function(){};var N,O=a("./internal/streams/BufferList");K.inherits(f,G),f.prototype.push=function(a,b){var c=this._readableState;return c.objectMode||"string"!=typeof a||(b=b||c.defaultEncoding,b!==c.encoding&&(a=J.from(a,b),b="")),g(this,c,a,b,!1)},f.prototype.unshift=function(a){var b=this._readableState;return g(this,b,a,"",!0)},f.prototype.isPaused=function(){return this._readableState.flowing===!1},f.prototype.setEncoding=function(b){return N||(N=a("string_decoder/").StringDecoder),this._readableState.decoder=new N(b),this._readableState.encoding=b,this};var P=8388608;f.prototype.read=function(a){M("read",a),a=parseInt(a,10);var b=this._readableState,c=a;if(0!==a&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return M("read: emitReadable",b.length,b.ended),0===b.length&&b.ended?z(this):m(this),null;if(a=j(a,b),0===a&&b.ended)return 0===b.length&&z(this),null;var d=b.needReadable;M("need readable",d),(0===b.length||b.length-a<b.highWaterMark)&&(d=!0,M("length less than watermark",d)),b.ended||b.reading?(d=!1,M("reading or ended",d)):d&&(M("do read"),b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1,b.reading||(a=j(c,b)));var e;return e=a>0?v(a,b):null,null===e?(b.needReadable=!0,a=0):b.length-=a,0===b.length&&(b.ended||(b.needReadable=!0),c!==a&&b.ended&&z(this)),null!==e&&this.emit("data",e),e},f.prototype._read=function(a){this.emit("error",new Error("_read() is not implemented"))},f.prototype.pipe=function(a,b){function e(a){M("onunpipe"),a===m&&g()}function f(){M("onend"),a.end()}function g(){M("cleanup"),a.removeListener("close",j),a.removeListener("finish",k),a.removeListener("drain",r),a.removeListener("error",i),a.removeListener("unpipe",e),m.removeListener("end",f),m.removeListener("end",g),m.removeListener("data",h),s=!0,!n.awaitDrain||a._writableState&&!a._writableState.needDrain||r()}function h(b){M("ondata"),t=!1;var c=a.write(b);!1!==c||t||((1===n.pipesCount&&n.pipes===a||n.pipesCount>1&&C(n.pipes,a)!==-1)&&!s&&(M("false write response, pause",m._readableState.awaitDrain),m._readableState.awaitDrain++,t=!0),m.pause())}function i(b){M("onerror",b),l(),a.removeListener("error",i),0===H(a,"error")&&a.emit("error",b)}function j(){a.removeListener("finish",k),l()}function k(){M("onfinish"),a.removeListener("close",j),l()}function l(){M("unpipe"),m.unpipe(a)}var m=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=a;break;case 1:n.pipes=[n.pipes,a];break;default:n.pipes.push(a)}n.pipesCount+=1,M("pipe count=%d opts=%j",n.pipesCount,b);var o=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,p=o?f:g;n.endEmitted?E(p):m.once("end",p),a.on("unpipe",e);var r=q(m);a.on("drain",r);var s=!1,t=!1;return m.on("data",h),d(a,"error",i),a.once("close",j),a.once("finish",k),a.emit("pipe",m),n.flowing||(M("pipe resume"),m.resume()),a},f.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var e=0;e<d;e++)c[e].emit("unpipe",this);return this}var f=C(b.pipes,a);return f===-1?this:(b.pipes.splice(f,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},f.prototype.on=function(a,b){var c=G.prototype.on.call(this,a,b);if("data"===a)this._readableState.flowing!==!1&&this.resume();else if("readable"===a){var d=this._readableState;d.endEmitted||d.readableListening||(d.readableListening=d.needReadable=!0,d.emittedReadable=!1,d.reading?d.length&&m(this,d):E(r,this))}return c},f.prototype.addListener=f.prototype.on,f.prototype.resume=function(){var a=this._readableState;return a.flowing||(M("resume"),a.flowing=!0,s(this,a)),this},f.prototype.pause=function(){return M("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(M("pause"),this._readableState.flowing=!1,this.emit("pause")),this},f.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(M("wrapped end"),b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(M("wrapped data"),b.decoder&&(e=b.decoder.write(e)),(!b.objectMode||null!==e&&void 0!==e)&&(b.objectMode||e&&e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)void 0===this[e]&&"function"==typeof a[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return B(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){M("wrapped _read",b),c&&(c=!1,a.resume())},d},f._fromList=v}).call(this,a("_process"))},{"./_stream_duplex":158,"./internal/streams/BufferList":163,_process:156,buffer:5,"buffer-shims":4,"core-util-is":7,events:8,inherits:10,isarray:164,"process-nextick-args":155,"string_decoder/":171,util:3}],161:[function(a,b,c){"use strict";function d(a){this.afterTransform=function(b,c){return e(a,b,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function e(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,null!==c&&void 0!==c&&a.push(c),e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function f(a){if(!(this instanceof f))return new f(a);h.call(this,a),this._transformState=new d(this);var b=this;this._readableState.needReadable=!0,this._readableState.sync=!1,a&&("function"==typeof a.transform&&(this._transform=a.transform),"function"==typeof a.flush&&(this._flush=a.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(a,c){g(b,a,c)}):g(b)})}function g(a,b,c){if(b)return a.emit("error",b);null!==c&&void 0!==c&&a.push(c);var d=a._writableState,e=a._transformState;if(d.length)throw new Error("Calling transform done when ws.length != 0");if(e.transforming)throw new Error("Calling transform done when still transforming");return a.push(null)}b.exports=f;var h=a("./_stream_duplex"),i=a("core-util-is");i.inherits=a("inherits"),i.inherits(f,h),f.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},f.prototype._transform=function(a,b,c){throw new Error("_transform() is not implemented")},f.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},f.prototype._read=function(a){var b=this._transformState;null!==b.writechunk&&b.writecb&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0}},{"./_stream_duplex":158,"core-util-is":7,inherits:10}],162:[function(a,b,c){(function(c){"use strict";function d(){}function e(a,b,c){this.chunk=a,this.encoding=b,this.callback=c,this.next=null}function f(b,c){x=x||a("./_stream_duplex"),b=b||{},this.objectMode=!!b.objectMode,c instanceof x&&(this.objectMode=this.objectMode||!!b.writableObjectMode);var d=b.highWaterMark,e=this.objectMode?16:16384;this.highWaterMark=d||0===d?d:e,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var f=b.decodeStrings===!1;this.decodeStrings=!f,this.defaultEncoding=b.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){o(c,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new w(this)}function g(b){return x=x||a("./_stream_duplex"),F.call(g,this)||this instanceof x?(this._writableState=new f(b,this),this.writable=!0,b&&("function"==typeof b.write&&(this._write=b.write),"function"==typeof b.writev&&(this._writev=b.writev)),void B.call(this)):new g(b)}function h(a,b){var c=new Error("write after end");a.emit("error",c),y(b,c)}function i(a,b,c,d){var e=!0,f=!1;return null===c?f=new TypeError("May not write null values to stream"):D.isBuffer(c)||"string"==typeof c||void 0===c||b.objectMode||(f=new TypeError("Invalid non-string/buffer chunk")),f&&(a.emit("error",f),y(d,f),e=!1),e}function j(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=E.from(b,c)),b}function k(a,b,c,d,f){c=j(b,c,d),D.isBuffer(c)&&(d="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;if(h||(b.needDrain=!0),b.writing||b.corked){var i=b.lastBufferedRequest;b.lastBufferedRequest=new e(c,d,f),i?i.next=b.lastBufferedRequest:b.bufferedRequest=b.lastBufferedRequest,b.bufferedRequestCount+=1}else l(a,b,!1,g,c,d,f);return h}function l(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function m(a,b,c,d,e){--b.pendingcb,c?y(e,d):e(d),a._writableState.errorEmitted=!0,a.emit("error",d)}function n(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function o(a,b){var c=a._writableState,d=c.sync,e=c.writecb;if(n(c),b)m(a,c,d,b,e);else{var f=s(c);f||c.corked||c.bufferProcessing||!c.bufferedRequest||r(a,c),d?z(p,a,c,f,e):p(a,c,f,e)}}function p(a,b,c,d){c||q(a,b),b.pendingcb--,d(),u(a,b)}function q(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function r(a,b){b.bufferProcessing=!0;var c=b.bufferedRequest;if(a._writev&&c&&c.next){var d=b.bufferedRequestCount,e=new Array(d),f=b.corkedRequestsFree;f.entry=c;for(var g=0;c;)e[g]=c,c=c.next,g+=1;l(a,b,!0,b.length,e,"",f.finish),b.pendingcb++,b.lastBufferedRequest=null,f.next?(b.corkedRequestsFree=f.next,f.next=null):b.corkedRequestsFree=new w(b)}else{for(;c;){var h=c.chunk,i=c.encoding,j=c.callback,k=b.objectMode?1:h.length;if(l(a,b,!1,k,h,i,j),c=c.next,b.writing)break}null===c&&(b.lastBufferedRequest=null)}b.bufferedRequestCount=0,b.bufferedRequest=c,b.bufferProcessing=!1}function s(a){return a.ending&&0===a.length&&null===a.bufferedRequest&&!a.finished&&!a.writing}function t(a,b){b.prefinished||(b.prefinished=!0,a.emit("prefinish"))}function u(a,b){var c=s(b);return c&&(0===b.pendingcb?(t(a,b),b.finished=!0,a.emit("finish")):t(a,b)),c}function v(a,b,c){b.ending=!0,u(a,b),c&&(b.finished?y(c):a.once("finish",c)),b.ended=!0,a.writable=!1}function w(a){var b=this;this.next=null,this.entry=null,this.finish=function(c){var d=b.entry;for(b.entry=null;d;){var e=d.callback;a.pendingcb--,e(c),d=d.next}a.corkedRequestsFree?a.corkedRequestsFree.next=b:a.corkedRequestsFree=b}}b.exports=g;var x,y=a("process-nextick-args"),z=!c.browser&&["v0.10","v0.9."].indexOf(c.version.slice(0,5))>-1?setImmediate:y;g.WritableState=f;var A=a("core-util-is");A.inherits=a("inherits");var B,C={deprecate:a("util-deprecate")};!function(){try{B=a("stream")}catch(b){}finally{B||(B=a("events").EventEmitter)}}();var D=a("buffer").Buffer,E=a("buffer-shims");A.inherits(g,B),f.prototype.getBuffer=function(){for(var a=this.bufferedRequest,b=[];a;)b.push(a),a=a.next;return b},function(){try{Object.defineProperty(f.prototype,"buffer",{get:C.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(a){}}();var F;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(F=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(a){return!!F.call(this,a)||a&&a._writableState instanceof f}})):F=function(a){return a instanceof this},g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},g.prototype.write=function(a,b,c){var e=this._writableState,f=!1;return"function"==typeof b&&(c=b,b=null),D.isBuffer(a)?b="buffer":b||(b=e.defaultEncoding),"function"!=typeof c&&(c=d),e.ended?h(this,c):i(this,e,a,c)&&(e.pendingcb++,f=k(this,e,a,b,c)),f},g.prototype.cork=function(){var a=this._writableState;a.corked++},g.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,a.writing||a.corked||a.finished||a.bufferProcessing||!a.bufferedRequest||r(this,a))},g.prototype.setDefaultEncoding=function(a){if("string"==typeof a&&(a=a.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((a+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+a);return this._writableState.defaultEncoding=a,this},g.prototype._write=function(a,b,c){c(new Error("_write() is not implemented"))},g.prototype._writev=null,g.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),null!==a&&void 0!==a&&this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||d.finished||v(this,d,c)}}).call(this,a("_process"))},{"./_stream_duplex":158,_process:156,buffer:5,"buffer-shims":4,"core-util-is":7,events:8,inherits:10,"process-nextick-args":155,"util-deprecate":173}],163:[function(a,b,c){"use strict";function d(){this.head=null,this.tail=null,this.length=0}var e=(a("buffer").Buffer,a("buffer-shims"));b.exports=d,d.prototype.push=function(a){var b={data:a,next:null};this.length>0?this.tail.next=b:this.head=b,this.tail=b,++this.length},d.prototype.unshift=function(a){var b={data:a,next:this.head};0===this.length&&(this.tail=b),this.head=b,++this.length},d.prototype.shift=function(){if(0!==this.length){var a=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,a}},d.prototype.clear=function(){this.head=this.tail=null,this.length=0},d.prototype.join=function(a){if(0===this.length)return"";for(var b=this.head,c=""+b.data;b=b.next;)c+=a+b.data;return c},d.prototype.concat=function(a){if(0===this.length)return e.alloc(0);if(1===this.length)return this.head.data;for(var b=e.allocUnsafe(a>>>0),c=this.head,d=0;c;)c.data.copy(b,d),d+=c.data.length,c=c.next;return b}},{buffer:5,"buffer-shims":4}],164:[function(a,b,c){arguments[4][6][0].apply(c,arguments)},{dup:6}],165:[function(a,b,c){b.exports=a("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":159}],166:[function(a,b,c){(function(d){var e=function(){try{return a("stream")}catch(b){}}();c=b.exports=a("./lib/_stream_readable.js"),c.Stream=e||c,c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js"),!d.browser&&"disable"===d.env.READABLE_STREAM&&e&&(b.exports=e)}).call(this,a("_process"))},{"./lib/_stream_duplex.js":158,"./lib/_stream_passthrough.js":159,"./lib/_stream_readable.js":160,"./lib/_stream_transform.js":161,"./lib/_stream_writable.js":162,_process:156}],167:[function(a,b,c){b.exports=a("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":161}],168:[function(a,b,c){b.exports=a("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":162}],169:[function(a,b,c){(function(b){!function(c){function d(a,b){if(!(this instanceof d))return new d(a,b);var e=this;f(e),e.q=e.c="",e.bufferCheckPosition=c.MAX_BUFFER_LENGTH,e.opt=b||{},e.opt.lowercase=e.opt.lowercase||e.opt.lowercasetags,e.looseCase=e.opt.lowercase?"toLowerCase":"toUpperCase",e.tags=[],e.closed=e.closedRoot=e.sawRoot=!1,e.tag=e.error=null,e.strict=!!a,e.noscript=!(!a&&!e.opt.noscript),e.state=V.BEGIN,e.strictEntities=e.opt.strictEntities,e.ENTITIES=e.strictEntities?Object.create(c.XML_ENTITIES):Object.create(c.ENTITIES),
e.attribList=[],e.opt.xmlns&&(e.ns=Object.create(Q)),e.trackPosition=e.opt.position!==!1,e.trackPosition&&(e.position=e.line=e.column=0),n(e,"onready")}function e(a){for(var b=Math.max(c.MAX_BUFFER_LENGTH,10),d=0,e=0,f=D.length;e<f;e++){var g=a[D[e]].length;if(g>b)switch(D[e]){case"textNode":p(a);break;case"cdata":o(a,"oncdata",a.cdata),a.cdata="";break;case"script":o(a,"onscript",a.script),a.script="";break;default:r(a,"Max buffer length exceeded: "+D[e])}d=Math.max(d,g)}var h=c.MAX_BUFFER_LENGTH-d;a.bufferCheckPosition=h+a.position}function f(a){for(var b=0,c=D.length;b<c;b++)a[D[b]]=""}function g(a){p(a),""!==a.cdata&&(o(a,"oncdata",a.cdata),a.cdata=""),""!==a.script&&(o(a,"onscript",a.script),a.script="")}function h(a,b){return new i(a,b)}function i(a,b){if(!(this instanceof i))return new i(a,b);E.apply(this),this._parser=new d(a,b),this.writable=!0,this.readable=!0;var c=this;this._parser.onend=function(){c.emit("end")},this._parser.onerror=function(a){c.emit("error",a),c._parser.error=null},this._decoder=null,G.forEach(function(a){Object.defineProperty(c,"on"+a,{get:function(){return c._parser["on"+a]},set:function(b){return b?void c.on(a,b):(c.removeAllListeners(a),c._parser["on"+a]=b,b)},enumerable:!0,configurable:!1})})}function j(a){return a.split("").reduce(function(a,b){return a[b]=!0,a},{})}function k(a){return"[object RegExp]"===Object.prototype.toString.call(a)}function l(a,b){return k(a)?!!b.match(a):a[b]}function m(a,b){return!l(a,b)}function n(a,b,c){a[b]&&a[b](c)}function o(a,b,c){a.textNode&&p(a),n(a,b,c)}function p(a){a.textNode=q(a.opt,a.textNode),a.textNode&&n(a,"ontext",a.textNode),a.textNode=""}function q(a,b){return a.trim&&(b=b.trim()),a.normalize&&(b=b.replace(/\s+/g," ")),b}function r(a,b){return p(a),a.trackPosition&&(b+="\nLine: "+a.line+"\nColumn: "+a.column+"\nChar: "+a.c),b=new Error(b),a.error=b,n(a,"onerror",b),a}function s(a){return a.sawRoot&&!a.closedRoot&&t(a,"Unclosed root tag"),a.state!==V.BEGIN&&a.state!==V.BEGIN_WHITESPACE&&a.state!==V.TEXT&&r(a,"Unexpected end"),p(a),a.c="",a.closed=!0,n(a,"onend"),d.call(a,a.strict,a.opt),a}function t(a,b){if("object"!=typeof a||!(a instanceof d))throw new Error("bad call to strictFail");a.strict&&r(a,b)}function u(a){a.strict||(a.tagName=a.tagName[a.looseCase]());var b=a.tags[a.tags.length-1]||a,c=a.tag={name:a.tagName,attributes:{}};a.opt.xmlns&&(c.ns=b.ns),a.attribList.length=0,o(a,"onopentagstart",c)}function v(a,b){var c=a.indexOf(":"),d=c<0?["",a]:a.split(":"),e=d[0],f=d[1];return b&&"xmlns"===a&&(e="xmlns",f=""),{prefix:e,local:f}}function w(a){if(a.strict||(a.attribName=a.attribName[a.looseCase]()),a.attribList.indexOf(a.attribName)!==-1||a.tag.attributes.hasOwnProperty(a.attribName))return void(a.attribName=a.attribValue="");if(a.opt.xmlns){var b=v(a.attribName,!0),c=b.prefix,d=b.local;if("xmlns"===c)if("xml"===d&&a.attribValue!==O)t(a,"xml: prefix must be bound to "+O+"\nActual: "+a.attribValue);else if("xmlns"===d&&a.attribValue!==P)t(a,"xmlns: prefix must be bound to "+P+"\nActual: "+a.attribValue);else{var e=a.tag,f=a.tags[a.tags.length-1]||a;e.ns===f.ns&&(e.ns=Object.create(f.ns)),e.ns[d]=a.attribValue}a.attribList.push([a.attribName,a.attribValue])}else a.tag.attributes[a.attribName]=a.attribValue,o(a,"onattribute",{name:a.attribName,value:a.attribValue});a.attribName=a.attribValue=""}function x(a,b){if(a.opt.xmlns){var c=a.tag,d=v(a.tagName);c.prefix=d.prefix,c.local=d.local,c.uri=c.ns[d.prefix]||"",c.prefix&&!c.uri&&(t(a,"Unbound namespace prefix: "+JSON.stringify(a.tagName)),c.uri=d.prefix);var e=a.tags[a.tags.length-1]||a;c.ns&&e.ns!==c.ns&&Object.keys(c.ns).forEach(function(b){o(a,"onopennamespace",{prefix:b,uri:c.ns[b]})});for(var f=0,g=a.attribList.length;f<g;f++){var h=a.attribList[f],i=h[0],j=h[1],k=v(i,!0),l=k.prefix,m=k.local,n=""===l?"":c.ns[l]||"",p={name:i,value:j,prefix:l,local:m,uri:n};l&&"xmlns"!==l&&!n&&(t(a,"Unbound namespace prefix: "+JSON.stringify(l)),p.uri=l),a.tag.attributes[i]=p,o(a,"onattribute",p)}a.attribList.length=0}a.tag.isSelfClosing=!!b,a.sawRoot=!0,a.tags.push(a.tag),o(a,"onopentag",a.tag),b||(a.noscript||"script"!==a.tagName.toLowerCase()?a.state=V.TEXT:a.state=V.SCRIPT,a.tag=null,a.tagName=""),a.attribName=a.attribValue="",a.attribList.length=0}function y(a){if(!a.tagName)return t(a,"Weird empty close tag."),a.textNode+="</>",void(a.state=V.TEXT);if(a.script){if("script"!==a.tagName)return a.script+="</"+a.tagName+">",a.tagName="",void(a.state=V.SCRIPT);o(a,"onscript",a.script),a.script=""}var b=a.tags.length,c=a.tagName;a.strict||(c=c[a.looseCase]());for(var d=c;b--;){var e=a.tags[b];if(e.name===d)break;t(a,"Unexpected close tag")}if(b<0)return t(a,"Unmatched closing tag: "+a.tagName),a.textNode+="</"+a.tagName+">",void(a.state=V.TEXT);a.tagName=c;for(var f=a.tags.length;f-- >b;){var g=a.tag=a.tags.pop();a.tagName=a.tag.name,o(a,"onclosetag",a.tagName);var h={};for(var i in g.ns)h[i]=g.ns[i];var j=a.tags[a.tags.length-1]||a;a.opt.xmlns&&g.ns!==j.ns&&Object.keys(g.ns).forEach(function(b){var c=g.ns[b];o(a,"onclosenamespace",{prefix:b,uri:c})})}0===b&&(a.closedRoot=!0),a.tagName=a.attribValue=a.attribName="",a.attribList.length=0,a.state=V.TEXT}function z(a){var b,c=a.entity,d=c.toLowerCase(),e="";return a.ENTITIES[c]?a.ENTITIES[c]:a.ENTITIES[d]?a.ENTITIES[d]:(c=d,"#"===c.charAt(0)&&("x"===c.charAt(1)?(c=c.slice(2),b=parseInt(c,16),e=b.toString(16)):(c=c.slice(1),b=parseInt(c,10),e=b.toString(10))),c=c.replace(/^0+/,""),e.toLowerCase()!==c?(t(a,"Invalid character entity"),"&"+a.entity+";"):String.fromCodePoint(b))}function A(a,b){"<"===b?(a.state=V.OPEN_WAKA,a.startTagPosition=a.position):m(H,b)&&(t(a,"Non-whitespace before first tag."),a.textNode=b,a.state=V.TEXT)}function B(a,b){var c="";return b<a.length&&(c=a.charAt(b)),c}function C(a){var b=this;if(this.error)throw this.error;if(b.closed)return r(b,"Cannot write after close. Assign an onready handler.");if(null===a)return s(b);"object"==typeof a&&(a=a.toString());for(var c=0,d="";;){if(d=B(a,c++),b.c=d,!d)break;switch(b.trackPosition&&(b.position++,"\n"===d?(b.line++,b.column=0):b.column++),b.state){case V.BEGIN:if(b.state=V.BEGIN_WHITESPACE,"\ufeff"===d)continue;A(b,d);continue;case V.BEGIN_WHITESPACE:A(b,d);continue;case V.TEXT:if(b.sawRoot&&!b.closedRoot){for(var f=c-1;d&&"<"!==d&&"&"!==d;)d=B(a,c++),d&&b.trackPosition&&(b.position++,"\n"===d?(b.line++,b.column=0):b.column++);b.textNode+=a.substring(f,c-1)}"<"!==d||b.sawRoot&&b.closedRoot&&!b.strict?(!m(H,d)||b.sawRoot&&!b.closedRoot||t(b,"Text data outside of root node."),"&"===d?b.state=V.TEXT_ENTITY:b.textNode+=d):(b.state=V.OPEN_WAKA,b.startTagPosition=b.position);continue;case V.SCRIPT:"<"===d?b.state=V.SCRIPT_ENDING:b.script+=d;continue;case V.SCRIPT_ENDING:"/"===d?b.state=V.CLOSE_TAG:(b.script+="<"+d,b.state=V.SCRIPT);continue;case V.OPEN_WAKA:if("!"===d)b.state=V.SGML_DECL,b.sgmlDecl="";else if(l(H,d));else if(l(R,d))b.state=V.OPEN_TAG,b.tagName=d;else if("/"===d)b.state=V.CLOSE_TAG,b.tagName="";else if("?"===d)b.state=V.PROC_INST,b.procInstName=b.procInstBody="";else{if(t(b,"Unencoded <"),b.startTagPosition+1<b.position){var g=b.position-b.startTagPosition;d=new Array(g).join(" ")+d}b.textNode+="<"+d,b.state=V.TEXT}continue;case V.SGML_DECL:(b.sgmlDecl+d).toUpperCase()===M?(o(b,"onopencdata"),b.state=V.CDATA,b.sgmlDecl="",b.cdata=""):b.sgmlDecl+d==="--"?(b.state=V.COMMENT,b.comment="",b.sgmlDecl=""):(b.sgmlDecl+d).toUpperCase()===N?(b.state=V.DOCTYPE,(b.doctype||b.sawRoot)&&t(b,"Inappropriately located doctype declaration"),b.doctype="",b.sgmlDecl=""):">"===d?(o(b,"onsgmldeclaration",b.sgmlDecl),b.sgmlDecl="",b.state=V.TEXT):l(K,d)?(b.state=V.SGML_DECL_QUOTED,b.sgmlDecl+=d):b.sgmlDecl+=d;continue;case V.SGML_DECL_QUOTED:d===b.q&&(b.state=V.SGML_DECL,b.q=""),b.sgmlDecl+=d;continue;case V.DOCTYPE:">"===d?(b.state=V.TEXT,o(b,"ondoctype",b.doctype),b.doctype=!0):(b.doctype+=d,"["===d?b.state=V.DOCTYPE_DTD:l(K,d)&&(b.state=V.DOCTYPE_QUOTED,b.q=d));continue;case V.DOCTYPE_QUOTED:b.doctype+=d,d===b.q&&(b.q="",b.state=V.DOCTYPE);continue;case V.DOCTYPE_DTD:b.doctype+=d,"]"===d?b.state=V.DOCTYPE:l(K,d)&&(b.state=V.DOCTYPE_DTD_QUOTED,b.q=d);continue;case V.DOCTYPE_DTD_QUOTED:b.doctype+=d,d===b.q&&(b.state=V.DOCTYPE_DTD,b.q="");continue;case V.COMMENT:"-"===d?b.state=V.COMMENT_ENDING:b.comment+=d;continue;case V.COMMENT_ENDING:"-"===d?(b.state=V.COMMENT_ENDED,b.comment=q(b.opt,b.comment),b.comment&&o(b,"oncomment",b.comment),b.comment=""):(b.comment+="-"+d,b.state=V.COMMENT);continue;case V.COMMENT_ENDED:">"!==d?(t(b,"Malformed comment"),b.comment+="--"+d,b.state=V.COMMENT):b.state=V.TEXT;continue;case V.CDATA:"]"===d?b.state=V.CDATA_ENDING:b.cdata+=d;continue;case V.CDATA_ENDING:"]"===d?b.state=V.CDATA_ENDING_2:(b.cdata+="]"+d,b.state=V.CDATA);continue;case V.CDATA_ENDING_2:">"===d?(b.cdata&&o(b,"oncdata",b.cdata),o(b,"onclosecdata"),b.cdata="",b.state=V.TEXT):"]"===d?b.cdata+="]":(b.cdata+="]]"+d,b.state=V.CDATA);continue;case V.PROC_INST:"?"===d?b.state=V.PROC_INST_ENDING:l(H,d)?b.state=V.PROC_INST_BODY:b.procInstName+=d;continue;case V.PROC_INST_BODY:if(!b.procInstBody&&l(H,d))continue;"?"===d?b.state=V.PROC_INST_ENDING:b.procInstBody+=d;continue;case V.PROC_INST_ENDING:">"===d?(o(b,"onprocessinginstruction",{name:b.procInstName,body:b.procInstBody}),b.procInstName=b.procInstBody="",b.state=V.TEXT):(b.procInstBody+="?"+d,b.state=V.PROC_INST_BODY);continue;case V.OPEN_TAG:l(S,d)?b.tagName+=d:(u(b),">"===d?x(b):"/"===d?b.state=V.OPEN_TAG_SLASH:(m(H,d)&&t(b,"Invalid character in tag name"),b.state=V.ATTRIB));continue;case V.OPEN_TAG_SLASH:">"===d?(x(b,!0),y(b)):(t(b,"Forward-slash in opening tag not followed by >"),b.state=V.ATTRIB);continue;case V.ATTRIB:if(l(H,d))continue;">"===d?x(b):"/"===d?b.state=V.OPEN_TAG_SLASH:l(R,d)?(b.attribName=d,b.attribValue="",b.state=V.ATTRIB_NAME):t(b,"Invalid attribute name");continue;case V.ATTRIB_NAME:"="===d?b.state=V.ATTRIB_VALUE:">"===d?(t(b,"Attribute without value"),b.attribValue=b.attribName,w(b),x(b)):l(H,d)?b.state=V.ATTRIB_NAME_SAW_WHITE:l(S,d)?b.attribName+=d:t(b,"Invalid attribute name");continue;case V.ATTRIB_NAME_SAW_WHITE:if("="===d)b.state=V.ATTRIB_VALUE;else{if(l(H,d))continue;t(b,"Attribute without value"),b.tag.attributes[b.attribName]="",b.attribValue="",o(b,"onattribute",{name:b.attribName,value:""}),b.attribName="",">"===d?x(b):l(R,d)?(b.attribName=d,b.state=V.ATTRIB_NAME):(t(b,"Invalid attribute name"),b.state=V.ATTRIB)}continue;case V.ATTRIB_VALUE:if(l(H,d))continue;l(K,d)?(b.q=d,b.state=V.ATTRIB_VALUE_QUOTED):(t(b,"Unquoted attribute value"),b.state=V.ATTRIB_VALUE_UNQUOTED,b.attribValue=d);continue;case V.ATTRIB_VALUE_QUOTED:if(d!==b.q){"&"===d?b.state=V.ATTRIB_VALUE_ENTITY_Q:b.attribValue+=d;continue}w(b),b.q="",b.state=V.ATTRIB_VALUE_CLOSED;continue;case V.ATTRIB_VALUE_CLOSED:l(H,d)?b.state=V.ATTRIB:">"===d?x(b):"/"===d?b.state=V.OPEN_TAG_SLASH:l(R,d)?(t(b,"No whitespace between attributes"),b.attribName=d,b.attribValue="",b.state=V.ATTRIB_NAME):t(b,"Invalid attribute name");continue;case V.ATTRIB_VALUE_UNQUOTED:if(m(L,d)){"&"===d?b.state=V.ATTRIB_VALUE_ENTITY_U:b.attribValue+=d;continue}w(b),">"===d?x(b):b.state=V.ATTRIB;continue;case V.CLOSE_TAG:if(b.tagName)">"===d?y(b):l(S,d)?b.tagName+=d:b.script?(b.script+="</"+b.tagName,b.tagName="",b.state=V.SCRIPT):(m(H,d)&&t(b,"Invalid tagname in closing tag"),b.state=V.CLOSE_TAG_SAW_WHITE);else{if(l(H,d))continue;m(R,d)?b.script?(b.script+="</"+d,b.state=V.SCRIPT):t(b,"Invalid tagname in closing tag."):b.tagName=d}continue;case V.CLOSE_TAG_SAW_WHITE:if(l(H,d))continue;">"===d?y(b):t(b,"Invalid characters in closing tag");continue;case V.TEXT_ENTITY:case V.ATTRIB_VALUE_ENTITY_Q:case V.ATTRIB_VALUE_ENTITY_U:var h,i;switch(b.state){case V.TEXT_ENTITY:h=V.TEXT,i="textNode";break;case V.ATTRIB_VALUE_ENTITY_Q:h=V.ATTRIB_VALUE_QUOTED,i="attribValue";break;case V.ATTRIB_VALUE_ENTITY_U:h=V.ATTRIB_VALUE_UNQUOTED,i="attribValue"}";"===d?(b[i]+=z(b),b.entity="",b.state=h):l(b.entity.length?U:T,d)?b.entity+=d:(t(b,"Invalid character in entity name"),b[i]+="&"+b.entity+d,b.entity="",b.state=h);continue;default:throw new Error(b,"Unknown state: "+b.state)}}return b.position>=b.bufferCheckPosition&&e(b),b}c.parser=function(a,b){return new d(a,b)},c.SAXParser=d,c.SAXStream=i,c.createStream=h,c.MAX_BUFFER_LENGTH=65536;var D=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];c.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(a){function b(){}b.prototype=a;var c=new b;return c}),Object.keys||(Object.keys=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}),d.prototype={end:function(){s(this)},write:C,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){g(this)}};var E;try{E=a("stream").Stream}catch(F){E=function(){}}var G=c.EVENTS.filter(function(a){return"error"!==a&&"end"!==a});i.prototype=Object.create(E.prototype,{constructor:{value:i}}),i.prototype.write=function(c){if("function"==typeof b&&"function"==typeof b.isBuffer&&b.isBuffer(c)){if(!this._decoder){var d=a("string_decoder").StringDecoder;this._decoder=new d("utf8")}c=this._decoder.write(c)}return this._parser.write(c.toString()),this.emit("data",c),!0},i.prototype.end=function(a){return a&&a.length&&this.write(a),this._parser.end(),!0},i.prototype.on=function(a,b){var c=this;return c._parser["on"+a]||G.indexOf(a)===-1||(c._parser["on"+a]=function(){var b=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);b.splice(0,0,a),c.emit.apply(c,b)}),E.prototype.on.call(c,a,b)};var H="\r\n\t ",I="0124356789",J="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",K="'\"",L=H+">",M="[CDATA[",N="DOCTYPE",O="http://www.w3.org/XML/1998/namespace",P="http://www.w3.org/2000/xmlns/",Q={xml:O,xmlns:P};H=j(H),I=j(I),J=j(J);var R=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,S=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,T=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,U=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;K=j(K),L=j(L);var V=0;c.STATE={BEGIN:V++,BEGIN_WHITESPACE:V++,TEXT:V++,TEXT_ENTITY:V++,OPEN_WAKA:V++,SGML_DECL:V++,SGML_DECL_QUOTED:V++,DOCTYPE:V++,DOCTYPE_QUOTED:V++,DOCTYPE_DTD:V++,DOCTYPE_DTD_QUOTED:V++,COMMENT_STARTING:V++,COMMENT:V++,COMMENT_ENDING:V++,COMMENT_ENDED:V++,CDATA:V++,CDATA_ENDING:V++,CDATA_ENDING_2:V++,PROC_INST:V++,PROC_INST_BODY:V++,PROC_INST_ENDING:V++,OPEN_TAG:V++,OPEN_TAG_SLASH:V++,ATTRIB:V++,ATTRIB_NAME:V++,ATTRIB_NAME_SAW_WHITE:V++,ATTRIB_VALUE:V++,ATTRIB_VALUE_QUOTED:V++,ATTRIB_VALUE_CLOSED:V++,ATTRIB_VALUE_UNQUOTED:V++,ATTRIB_VALUE_ENTITY_Q:V++,ATTRIB_VALUE_ENTITY_U:V++,CLOSE_TAG:V++,CLOSE_TAG_SAW_WHITE:V++,SCRIPT:V++,SCRIPT_ENDING:V++},c.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},c.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(c.ENTITIES).forEach(function(a){var b=c.ENTITIES[a],d="number"==typeof b?String.fromCharCode(b):b;c.ENTITIES[a]=d});for(var W in c.STATE)c.STATE[c.STATE[W]]=W;V=c.STATE,String.fromCodePoint||!function(){var a=String.fromCharCode,b=Math.floor,c=function(){var c,d,e=16384,f=[],g=-1,h=arguments.length;if(!h)return"";for(var i="";++g<h;){var j=Number(arguments[g]);if(!isFinite(j)||j<0||j>1114111||b(j)!==j)throw RangeError("Invalid code point: "+j);j<=65535?f.push(j):(j-=65536,c=(j>>10)+55296,d=j%1024+56320,f.push(c,d)),(g+1===h||f.length>e)&&(i+=a.apply(null,f),f.length=0)}return i};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:c,configurable:!0,writable:!0}):String.fromCodePoint=c}()}("undefined"==typeof c?this.sax={}:c)}).call(this,a("buffer").Buffer)},{buffer:5,stream:170,string_decoder:171}],170:[function(a,b,c){function d(){e.call(this)}b.exports=d;var e=a("events").EventEmitter,f=a("inherits");f(d,e),d.Readable=a("readable-stream/readable.js"),d.Writable=a("readable-stream/writable.js"),d.Duplex=a("readable-stream/duplex.js"),d.Transform=a("readable-stream/transform.js"),d.PassThrough=a("readable-stream/passthrough.js"),d.Stream=d,d.prototype.pipe=function(a,b){function c(b){a.writable&&!1===a.write(b)&&j.pause&&j.pause()}function d(){j.readable&&j.resume&&j.resume()}function f(){k||(k=!0,a.end())}function g(){k||(k=!0,"function"==typeof a.destroy&&a.destroy())}function h(a){if(i(),0===e.listenerCount(this,"error"))throw a}function i(){j.removeListener("data",c),a.removeListener("drain",d),j.removeListener("end",f),j.removeListener("close",g),j.removeListener("error",h),a.removeListener("error",h),j.removeListener("end",i),j.removeListener("close",i),a.removeListener("close",i)}var j=this;j.on("data",c),a.on("drain",d),a._isStdio||b&&b.end===!1||(j.on("end",f),j.on("close",g));var k=!1;return j.on("error",h),a.on("error",h),j.on("end",i),j.on("close",i),a.on("close",i),a.emit("pipe",j),a}},{events:8,inherits:10,"readable-stream/duplex.js":157,"readable-stream/passthrough.js":165,"readable-stream/readable.js":166,"readable-stream/transform.js":167,"readable-stream/writable.js":168}],171:[function(a,b,c){function d(a){if(a&&!i(a))throw new Error("Unknown encoding: "+a)}function e(a){return a.toString(this.encoding)}function f(a){this.charReceived=a.length%2,this.charLength=this.charReceived?2:0}function g(a){this.charReceived=a.length%3,this.charLength=this.charReceived?3:0}var h=a("buffer").Buffer,i=h.isEncoding||function(a){switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},j=c.StringDecoder=function(a){switch(this.encoding=(a||"utf8").toLowerCase().replace(/[-_]/,""),d(a),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=g;break;default:return void(this.write=e)}this.charBuffer=new h(6),this.charReceived=0,this.charLength=0};j.prototype.write=function(a){for(var b="";this.charLength;){var c=a.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:a.length;if(a.copy(this.charBuffer,this.charReceived,0,c),this.charReceived+=c,this.charReceived<this.charLength)return"";a=a.slice(c,a.length),b=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var d=b.charCodeAt(b.length-1);if(!(d>=55296&&d<=56319)){if(this.charReceived=this.charLength=0,0===a.length)return b;break}this.charLength+=this.surrogateSize,b=""}this.detectIncompleteChar(a);var e=a.length;this.charLength&&(a.copy(this.charBuffer,0,a.length-this.charReceived,e),e-=this.charReceived),b+=a.toString(this.encoding,0,e);var e=b.length-1,d=b.charCodeAt(e);if(d>=55296&&d<=56319){var f=this.surrogateSize;return this.charLength+=f,this.charReceived+=f,this.charBuffer.copy(this.charBuffer,f,0,f),a.copy(this.charBuffer,0,0,f),b.substring(0,e)}return b},j.prototype.detectIncompleteChar=function(a){for(var b=a.length>=3?3:a.length;b>0;b--){var c=a[a.length-b];if(1==b&&c>>5==6){this.charLength=2;break}if(b<=2&&c>>4==14){this.charLength=3;break}if(b<=3&&c>>3==30){this.charLength=4;break}}this.charReceived=b},j.prototype.end=function(a){var b="";if(a&&a.length&&(b=this.write(a)),this.charReceived){var c=this.charReceived,d=this.charBuffer,e=this.encoding;b+=d.slice(0,c).toString(e)}return b}},{buffer:5}],172:[function(a,b,c){function d(a,b){this._id=a,this._clearFn=b}var e=a("process/browser.js").nextTick,f=Function.prototype.apply,g=Array.prototype.slice,h={},i=0;c.setTimeout=function(){return new d(f.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new d(f.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(a){a.close()},d.prototype.unref=d.prototype.ref=function(){},d.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(a,b){clearTimeout(a._idleTimeoutId),a._idleTimeout=b},c.unenroll=function(a){clearTimeout(a._idleTimeoutId),a._idleTimeout=-1},c._unrefActive=c.active=function(a){clearTimeout(a._idleTimeoutId);var b=a._idleTimeout;b>=0&&(a._idleTimeoutId=setTimeout(function(){a._onTimeout&&a._onTimeout()},b))},c.setImmediate="function"==typeof setImmediate?setImmediate:function(a){var b=i++,d=!(arguments.length<2)&&g.call(arguments,1);return h[b]=!0,e(function(){h[b]&&(d?a.apply(null,d):a.call(null),c.clearImmediate(b))}),b},c.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(a){delete h[a]}},{"process/browser.js":156}],173:[function(a,b,c){(function(a){function c(a,b){function c(){if(!e){if(d("throwDeprecation"))throw new Error(b);d("traceDeprecation")?console.trace(b):console.warn(b),e=!0}return a.apply(this,arguments)}if(d("noDeprecation"))return a;var e=!1;return c}function d(b){try{if(!a.localStorage)return!1}catch(c){return!1}var d=a.localStorage[b];return null!=d&&"true"===String(d).toLowerCase()}b.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],174:[function(a,c,d){!function(){function a(a,b,c){return a.call.apply(a.bind,arguments)}function d(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function e(b,c,f){return e=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:d,e.apply(null,arguments)}function f(a,b){this.a=a,this.m=b||a,this.c=this.m.document}function g(a,b,c,d){if(b=a.c.createElement(b),c)for(var e in c)c.hasOwnProperty(e)&&("style"==e?b.style.cssText=c[e]:b.setAttribute(e,c[e]));return d&&b.appendChild(a.c.createTextNode(d)),b}function h(a,b,c){a=a.c.getElementsByTagName(b)[0],a||(a=document.documentElement),a.insertBefore(c,a.lastChild)}function i(a){a.parentNode&&a.parentNode.removeChild(a)}function j(a,b,c){b=b||[],c=c||[];for(var d=a.className.split(/\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}for(b=[],e=0;e<d.length;e+=1){for(f=!1,g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function k(a,b){for(var c=a.className.split(/\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return!0;return!1}function l(a){if("string"==typeof a.f)return a.f;var b=a.m.location.protocol;return"about:"==b&&(b=a.a.location.protocol),"https:"==b?"https:":"http:"}function m(a){return a.m.location.hostname||a.a.location.hostname}function n(a,b,c){function d(){j&&e&&f&&(j(i),j=null)}b=g(a,"link",{rel:"stylesheet",href:b,media:"all"});var e=!1,f=!0,i=null,j=c||null;fa?(b.onload=function(){e=!0,d()},b.onerror=function(){e=!0,i=Error("Stylesheet failed to load"),d()}):setTimeout(function(){e=!0,d()},0),h(a,"head",b)}function o(a,b,c,d){var e=a.c.getElementsByTagName("head")[0];if(e){var f=g(a,"script",{src:b}),h=!1;return f.onload=f.onreadystatechange=function(){h||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(h=!0,c&&c(null),f.onload=f.onreadystatechange=null,"HEAD"==f.parentNode.tagName&&e.removeChild(f))},e.appendChild(f),setTimeout(function(){h||(h=!0,c&&c(Error("Script load timeout")))},d||5e3),f}return null}function p(){this.a=0,this.c=null}function q(a){return a.a++,function(){a.a--,s(a)}}function r(a,b){a.c=b,s(a)}function s(a){0==a.a&&a.c&&(a.c(),a.c=null)}function t(a){this.a=a||"-"}function u(a,b){this.c=a,this.f=4,this.a="n";var c=(b||"n4").match(/^([nio])([1-9])$/i);c&&(this.a=c[1],this.f=parseInt(c[2],10))}function v(a){return y(a)+" "+(a.f+"00")+" 300px "+w(a.c)}function w(a){var b=[];a=a.split(/,\s*/);for(var c=0;c<a.length;c++){var d=a[c].replace(/['"]/g,"");-1!=d.indexOf(" ")||/^\d/.test(d)?b.push("'"+d+"'"):b.push(d)}return b.join(",")}function x(a){return a.a+a.f}function y(a){var b="normal";return"o"===a.a?b="oblique":"i"===a.a&&(b="italic"),b}function z(a){var b=4,c="n",d=null;return a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10)))),c+b}function A(a,b){this.c=a,this.f=a.m.document.documentElement,this.h=b,this.a=new t("-"),this.j=!1!==b.events,this.g=!1!==b.classes}function B(a){a.g&&j(a.f,[a.a.c("wf","loading")]),D(a,"loading")}function C(a){if(a.g){var b=k(a.f,a.a.c("wf","active")),c=[],d=[a.a.c("wf","loading")];b||c.push(a.a.c("wf","inactive")),j(a.f,c,d)}D(a,"inactive")}function D(a,b,c){a.j&&a.h[b]&&(c?a.h[b](c.c,x(c)):a.h[b]())}function E(){this.c={}}function F(a,b,c){var d,e=[];for(d in b)if(b.hasOwnProperty(d)){var f=a.c[d];f&&e.push(f(b[d],c))}return e}function G(a,b){this.c=a,this.f=b,this.a=g(this.c,"span",{"aria-hidden":"true"},this.f)}function H(a){h(a.c,"body",a.a)}function I(a){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+w(a.c)+";"+("font-style:"+y(a)+";font-weight:"+(a.f+"00")+";")}function J(a,b,c,d,e,f){this.g=a,this.j=b,this.a=d,this.c=c,this.f=e||3e3,this.h=f||void 0}function K(a,b,c,d,e,f,g){this.v=a,this.B=b,this.c=c,this.a=d,this.s=g||"BESbswy",this.f={},this.w=e||3e3,this.u=f||null,this.o=this.j=this.h=this.g=null,this.g=new G(this.c,this.s),this.h=new G(this.c,this.s),this.j=new G(this.c,this.s),this.o=new G(this.c,this.s),a=new u(this.a.c+",serif",x(this.a)),a=I(a),this.g.a.style.cssText=a,a=new u(this.a.c+",sans-serif",x(this.a)),a=I(a),this.h.a.style.cssText=a,a=new u("serif",x(this.a)),a=I(a),this.j.a.style.cssText=a,a=new u("sans-serif",x(this.a)),a=I(a),this.o.a.style.cssText=a,H(this.g),H(this.h),H(this.j),H(this.o)}function L(){if(null===ha){var a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);ha=!!a&&(536>parseInt(a[1],10)||536===parseInt(a[1],10)&&11>=parseInt(a[2],10))}return ha}function M(a,b,c){for(var d in ga)if(ga.hasOwnProperty(d)&&b===a.f[ga[d]]&&c===a.f[ga[d]])return!0;return!1}function N(a){var b,c=a.g.a.offsetWidth,d=a.h.a.offsetWidth;(b=c===a.f.serif&&d===a.f["sans-serif"])||(b=L()&&M(a,c,d)),b?ea()-a.A>=a.w?L()&&M(a,c,d)&&(null===a.u||a.u.hasOwnProperty(a.a.c))?P(a,a.v):P(a,a.B):O(a):P(a,a.v)}function O(a){setTimeout(e(function(){N(this)},a),50)}function P(a,b){setTimeout(e(function(){i(this.g.a),i(this.h.a),i(this.j.a),i(this.o.a),b(this.a)},a),0)}function Q(a,b,c){this.c=a,this.a=b,this.f=0,this.o=this.j=!1,this.s=c}function R(a){0==--a.f&&a.j&&(a.o?(a=a.a,a.g&&j(a.f,[a.a.c("wf","active")],[a.a.c("wf","loading"),a.a.c("wf","inactive")]),D(a,"active")):C(a.a))}function S(a){this.j=a,this.a=new E,this.h=0,this.f=this.g=!0}function T(a,b,c,d,f){var g=0==--a.h;(a.f||a.g)&&setTimeout(function(){var a=f||null,h=d||null||{};if(0===c.length&&g)C(b.a);else{b.f+=c.length,g&&(b.j=g);var i,k=[];for(i=0;i<c.length;i++){var l=c[i],m=h[l.c],n=b.a,o=l;if(n.g&&j(n.f,[n.a.c("wf",o.c,x(o).toString(),"loading")]),D(n,"fontloading",o),n=null,null===ia)if(window.FontFace){var o=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),p=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);ia=o?42<parseInt(o[1],10):!p}else ia=!1;n=ia?new J(e(b.g,b),e(b.h,b),b.c,l,b.s,m):new K(e(b.g,b),e(b.h,b),b.c,l,b.s,a,m),k.push(n)}for(i=0;i<k.length;i++)k[i].start()}},0)}function U(a,b,c){var d=[],e=c.timeout;B(b);var d=F(a.a,c,a.c),f=new Q(a.c,b,e);for(a.h=d.length,b=0,c=d.length;b<c;b++)d[b].load(function(b,c,d){T(a,f,b,c,d)})}function V(a,b){this.c=a,this.a=b}function W(a,b,c){var d=l(a.c);return a=(a.a.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,""),d+"//"+a+"/"+b+".js"+(c?"?v="+c:"")}function X(a,b){this.c=a,this.a=b}function Y(a,b,c){a?this.c=a:this.c=b+ja,this.a=[],this.f=[],this.g=c||""}function Z(a,b){for(var c=b.length,d=0;d<c;d++){var e=b[d].split(":");3==e.length&&a.f.push(e.pop());var f="";2==e.length&&""!=e[1]&&(f=":"),a.a.push(e.join(f))}}function $(a){if(0==a.a.length)throw Error("No fonts to load!");if(-1!=a.c.indexOf("kit="))return a.c;for(var b=a.a.length,c=[],d=0;d<b;d++)c.push(a.a[d].replace(/ /g,"+"));return b=a.c+"?family="+c.join("%7C"),0<a.f.length&&(b+="&subset="+a.f.join(",")),0<a.g.length&&(b+="&text="+encodeURIComponent(a.g)),b}function _(a){this.f=a,this.a=[],this.c={}}function aa(a){for(var b=a.f.length,c=0;c<b;c++){var d=a.f[c].split(":"),e=d[0].replace(/\+/g," "),f=["n4"];if(2<=d.length){var g,h=d[1];if(g=[],h)for(var h=h.split(","),i=h.length,j=0;j<i;j++){var k;if(k=h[j],k.match(/^[\w-]+$/)){var l=na.exec(k.toLowerCase());if(null==l)k="";else{if(k=l[2],k=null==k||""==k?"n":ma[k],l=l[1],null==l||""==l)l="4";else var m=la[l],l=m?m:isNaN(l)?"4":l.substr(0,1);k=[k,l].join("");
}}else k="";k&&g.push(k)}0<g.length&&(f=g),3==d.length&&(d=d[2],g=[],d=d?d.split(","):g,0<d.length&&(d=ka[d[0]])&&(a.c[e]=d))}for(a.c[e]||(d=ka[e])&&(a.c[e]=d),d=0;d<f.length;d+=1)a.a.push(new u(e,f[d]))}}function ba(a,b){this.c=a,this.a=b}function ca(a,b){this.c=a,this.a=b}function da(a,b){this.c=a,this.f=b,this.a=[]}var ea=Date.now||function(){return+new Date},fa=!!window.FontFace;t.prototype.c=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\W_]+/g,"").toLowerCase());return b.join(this.a)},J.prototype.start=function(){var a=this.c.m.document,b=this,c=ea(),d=new Promise(function(d,e){function f(){ea()-c>=b.f?e():a.fonts.load(v(b.a),b.h).then(function(a){1<=a.length?d():setTimeout(f,25)},function(){e()})}f()}),e=new Promise(function(a,c){setTimeout(c,b.f)});Promise.race([e,d]).then(function(){b.g(b.a)},function(){b.j(b.a)})};var ga={D:"serif",C:"sans-serif"},ha=null;K.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.o.a.offsetWidth,this.A=ea(),N(this)};var ia=null;Q.prototype.g=function(a){var b=this.a;b.g&&j(b.f,[b.a.c("wf",a.c,x(a).toString(),"active")],[b.a.c("wf",a.c,x(a).toString(),"loading"),b.a.c("wf",a.c,x(a).toString(),"inactive")]),D(b,"fontactive",a),this.o=!0,R(this)},Q.prototype.h=function(a){var b=this.a;if(b.g){var c=k(b.f,b.a.c("wf",a.c,x(a).toString(),"active")),d=[],e=[b.a.c("wf",a.c,x(a).toString(),"loading")];c||d.push(b.a.c("wf",a.c,x(a).toString(),"inactive")),j(b.f,d,e)}D(b,"fontinactive",a),R(this)},S.prototype.load=function(a){this.c=new f(this.j,a.context||this.j),this.g=!1!==a.events,this.f=!1!==a.classes,U(this,new A(this.c,a),a)},V.prototype.load=function(a){function b(){if(f["__mti_fntLst"+d]){var c,e=f["__mti_fntLst"+d](),g=[];if(e)for(var h=0;h<e.length;h++){var i=e[h].fontfamily;void 0!=e[h].fontStyle&&void 0!=e[h].fontWeight?(c=e[h].fontStyle+e[h].fontWeight,g.push(new u(i,c))):g.push(new u(i))}a(g)}else setTimeout(function(){b()},50)}var c=this,d=c.a.projectId,e=c.a.version;if(d){var f=c.c.m;o(this.c,W(c,d,e),function(e){e?a([]):(f["__MonotypeConfiguration__"+d]=function(){return c.a},b())}).id="__MonotypeAPIScript__"+d}else a([])},X.prototype.load=function(a){var b,c,d=this.a.urls||[],e=this.a.families||[],f=this.a.testStrings||{},g=new p;for(b=0,c=d.length;b<c;b++)n(this.c,d[b],q(g));var h=[];for(b=0,c=e.length;b<c;b++)if(d=e[b].split(":"),d[1])for(var i=d[1].split(","),j=0;j<i.length;j+=1)h.push(new u(d[0],i[j]));else h.push(new u(d[0]));r(g,function(){a(h,f)})};var ja="//fonts.googleapis.com/css",ka={latin:"BESbswy","latin-ext":"",cyrillic:"",greek:"",khmer:"",Hanuman:""},la={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},ma={i:"i",italic:"i",n:"n",normal:"n"},na=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/,oa={Arimo:!0,Cousine:!0,Tinos:!0};ba.prototype.load=function(a){var b=new p,c=this.c,d=new Y(this.a.api,l(c),this.a.text),e=this.a.families;Z(d,e);var f=new _(e);aa(f),n(c,$(d),q(b)),r(b,function(){a(f.a,f.c,oa)})},ca.prototype.load=function(a){var b=this.a.id,c=this.c.m;b?o(this.c,(this.a.api||"https://use.typekit.net")+"/"+b+".js",function(b){if(b)a([]);else if(c.Typekit&&c.Typekit.config&&c.Typekit.config.fn){b=c.Typekit.config.fn;for(var d=[],e=0;e<b.length;e+=2)for(var f=b[e],g=b[e+1],h=0;h<g.length;h++)d.push(new u(f,g[h]));try{c.Typekit.load({events:!1,classes:!1,async:!0})}catch(i){}a(d)}},2e3):a([])},da.prototype.load=function(a){var b=this.f.id,c=this.c.m,d=this;b?(c.__webfontfontdeckmodule__||(c.__webfontfontdeckmodule__={}),c.__webfontfontdeckmodule__[b]=function(b,c){for(var e=0,f=c.fonts.length;e<f;++e){var g=c.fonts[e];d.a.push(new u(g.name,z("font-weight:"+g.weight+";font-style:"+g.style)))}a(d.a)},o(this.c,l(this.c)+(this.f.api||"//f.fontdeck.com/s/css/js/")+m(this.c)+"/"+b+".js",function(b){b&&a([])})):a([])};var pa=new S(window);pa.a.c.custom=function(a,b){return new X(b,a)},pa.a.c.fontdeck=function(a,b){return new da(b,a)},pa.a.c.monotype=function(a,b){return new V(b,a)},pa.a.c.typekit=function(a,b){return new ca(b,a)},pa.a.c.google=function(a,b){return new ba(b,a)};var qa={load:e(pa.load,pa)};"function"==typeof b&&b.amd?b(function(){return qa}):"undefined"!=typeof c&&c.exports?c.exports=qa:(window.WebFont=qa,window.WebFontConfig&&pa.load(window.WebFontConfig))}()},{}],175:[function(a,b,c){(function(){"use strict";c.stripBOM=function(a){return"\ufeff"===a[0]?a.substring(1):a}}).call(this)},{}],176:[function(a,b,c){(function(){"use strict";var a;a=new RegExp(/(?!xmlns)^.*:/),c.normalize=function(a){return a.toLowerCase()},c.firstCharLowerCase=function(a){return a.charAt(0).toLowerCase()+a.slice(1)},c.stripPrefix=function(b){return b.replace(a,"")},c.parseNumbers=function(a){return isNaN(a)||(a=a%1===0?parseInt(a,10):parseFloat(a)),a},c.parseBooleans=function(a){return/^(?:true|false)$/i.test(a)&&(a="true"===a.toLowerCase()),a}}).call(this)},{}],177:[function(a,b,c){(function(){"use strict";var b,d,e,f,g,h,i,j,k,l,m,n=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},o={}.hasOwnProperty,p=function(a,b){return function(){return a.apply(b,arguments)}};k=a("sax"),f=a("events"),d=a("xmlbuilder"),b=a("./bom"),i=a("./processors"),l=a("timers").setImmediate,g=function(a){return"object"==typeof a&&null!=a&&0===Object.keys(a).length},h=function(a,b){var c,d,e;for(c=0,d=a.length;c<d;c++)e=a[c],b=e(b);return b},j=function(a){return a.indexOf("&")>=0||a.indexOf(">")>=0||a.indexOf("<")>=0},m=function(a){return"<![CDATA["+e(a)+"]]>"},e=function(a){return a.replace("]]>","]]]]><![CDATA[>")},c.processors=i,c.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}},c.ValidationError=function(a){function b(a){this.message=a}return n(b,a),b}(Error),c.Builder=function(){function a(a){var b,d,e;this.options={},d=c.defaults[.2];for(b in d)o.call(d,b)&&(e=d[b],this.options[b]=e);for(b in a)o.call(a,b)&&(e=a[b],this.options[b]=e)}return a.prototype.buildObject=function(a){var b,e,f,g,h;return b=this.options.attrkey,e=this.options.charkey,1===Object.keys(a).length&&this.options.rootName===c.defaults[.2].rootName?(h=Object.keys(a)[0],a=a[h]):h=this.options.rootName,f=function(a){return function(c,d){var g,h,i,k,l,n;if("object"!=typeof d)a.options.cdata&&j(d)?c.raw(m(d)):c.txt(d);else for(l in d)if(o.call(d,l))if(h=d[l],l===b){if("object"==typeof h)for(g in h)n=h[g],c=c.att(g,n)}else if(l===e)c=a.options.cdata&&j(h)?c.raw(m(h)):c.txt(h);else if(Array.isArray(h))for(k in h)o.call(h,k)&&(i=h[k],c="string"==typeof i?a.options.cdata&&j(i)?c.ele(l).raw(m(i)).up():c.ele(l,i).up():f(c.ele(l),i).up());else"object"==typeof h?c=f(c.ele(l),h).up():"string"==typeof h&&a.options.cdata&&j(h)?c=c.ele(l).raw(m(h)).up():(null==h&&(h=""),c=c.ele(l,h.toString()).up());return c}}(this),g=d.create(h,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),f(g,a).end(this.options.renderOpts)},a}(),c.Parser=function(a){function d(a){this.parseString=p(this.parseString,this),this.reset=p(this.reset,this),this.assignOrPush=p(this.assignOrPush,this),this.processAsync=p(this.processAsync,this);var b,d,e;if(!(this instanceof c.Parser))return new c.Parser(a);this.options={},d=c.defaults[.2];for(b in d)o.call(d,b)&&(e=d[b],this.options[b]=e);for(b in a)o.call(a,b)&&(e=a[b],this.options[b]=e);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(i.normalize)),this.reset()}return n(d,a),d.prototype.processAsync=function(){var a,b,c;try{return this.remaining.length<=this.options.chunkSize?(a=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(a),this.saxParser.close()):(a=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(a),l(this.processAsync))}catch(c){if(b=c,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(b)}},d.prototype.assignOrPush=function(a,b,c){return b in a?(a[b]instanceof Array||(a[b]=[a[b]]),a[b].push(c)):this.options.explicitArray?a[b]=[c]:a[b]=c},d.prototype.reset=function(){var a,b,c,d;return this.removeAllListeners(),this.saxParser=k.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=function(a){return function(b){if(a.saxParser.resume(),!a.saxParser.errThrown)return a.saxParser.errThrown=!0,a.emit("error",b)}}(this),this.saxParser.onend=function(a){return function(){if(!a.saxParser.ended)return a.saxParser.ended=!0,a.emit("end",a.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,d=[],a=this.options.attrkey,b=this.options.charkey,this.saxParser.onopentag=function(c){return function(e){var f,g,i,j,k;if(i={},i[b]="",!c.options.ignoreAttrs){k=e.attributes;for(f in k)o.call(k,f)&&(a in i||c.options.mergeAttrs||(i[a]={}),g=c.options.attrValueProcessors?h(c.options.attrValueProcessors,e.attributes[f]):e.attributes[f],j=c.options.attrNameProcessors?h(c.options.attrNameProcessors,f):f,c.options.mergeAttrs?c.assignOrPush(i,j,g):i[a][j]=g)}return i["#name"]=c.options.tagNameProcessors?h(c.options.tagNameProcessors,e.name):e.name,c.options.xmlns&&(i[c.options.xmlnskey]={uri:e.uri,local:e.local}),d.push(i)}}(this),this.saxParser.onclosetag=function(a){return function(){var c,e,f,i,j,k,l,m,n,p,q,r;if(m=d.pop(),l=m["#name"],a.options.explicitChildren&&a.options.preserveChildrenOrder||delete m["#name"],m.cdata===!0&&(c=m.cdata,delete m.cdata),q=d[d.length-1],m[b].match(/^\s*$/)&&!c?(e=m[b],delete m[b]):(a.options.trim&&(m[b]=m[b].trim()),a.options.normalize&&(m[b]=m[b].replace(/\s{2,}/g," ").trim()),m[b]=a.options.valueProcessors?h(a.options.valueProcessors,m[b]):m[b],1===Object.keys(m).length&&b in m&&!a.EXPLICIT_CHARKEY&&(m=m[b])),g(m)&&(m=""!==a.options.emptyTag?a.options.emptyTag:e),null!=a.options.validator){r="/"+function(){var a,b,c;for(c=[],a=0,b=d.length;a<b;a++)k=d[a],c.push(k["#name"]);return c}().concat(l).join("/");try{m=a.options.validator(r,q&&q[l],m)}catch(i){f=i,a.emit("error",f)}}if(a.options.explicitChildren&&!a.options.mergeAttrs&&"object"==typeof m)if(a.options.preserveChildrenOrder){if(q){q[a.options.childkey]=q[a.options.childkey]||[],n={};for(j in m)o.call(m,j)&&(n[j]=m[j]);q[a.options.childkey].push(n),delete m["#name"],1===Object.keys(m).length&&b in m&&!a.EXPLICIT_CHARKEY&&(m=m[b])}}else k={},a.options.attrkey in m&&(k[a.options.attrkey]=m[a.options.attrkey],delete m[a.options.attrkey]),!a.options.charsAsChildren&&a.options.charkey in m&&(k[a.options.charkey]=m[a.options.charkey],delete m[a.options.charkey]),Object.getOwnPropertyNames(m).length>0&&(k[a.options.childkey]=m),m=k;return d.length>0?a.assignOrPush(q,l,m):(a.options.explicitRoot&&(p=m,m={},m[l]=p),a.resultObject=m,a.saxParser.ended=!0,a.emit("end",a.resultObject))}}(this),c=function(a){return function(c){var e,f;if(f=d[d.length-1])return f[b]+=c,a.options.explicitChildren&&a.options.preserveChildrenOrder&&a.options.charsAsChildren&&(a.options.includeWhiteChars||""!==c.replace(/\\n/g,"").trim())&&(f[a.options.childkey]=f[a.options.childkey]||[],e={"#name":"__text__"},e[b]=c,a.options.normalize&&(e[b]=e[b].replace(/\s{2,}/g," ").trim()),f[a.options.childkey].push(e)),f}}(this),this.saxParser.ontext=c,this.saxParser.oncdata=function(a){return function(a){var b;if(b=c(a))return b.cdata=!0}}(this)},d.prototype.parseString=function(a,c){var d,e;null!=c&&"function"==typeof c&&(this.on("end",function(a){return this.reset(),c(null,a)}),this.on("error",function(a){return this.reset(),c(a)}));try{return a=a.toString(),""===a.trim()?(this.emit("end",null),!0):(a=b.stripBOM(a),this.options.async?(this.remaining=a,l(this.processAsync),this.saxParser):this.saxParser.write(a).close())}catch(e){if(d=e,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",d),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw d}},d}(f.EventEmitter),c.parseString=function(a,b,d){var e,f,g;return null!=d?("function"==typeof d&&(e=d),"object"==typeof b&&(f=b)):("function"==typeof b&&(e=b),f={}),g=new c.Parser(f),g.parseString(a,e)}}).call(this)},{"./bom":175,"./processors":176,events:8,sax:169,timers:172,xmlbuilder:194}],178:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing attribute name of element "+a.name);if(null==c)throw new Error("Missing attribute value for attribute "+b+" of element "+a.name);this.name=this.stringify.attName(b),this.value=this.stringify.attValue(c)}return a.prototype.clone=function(){return d(a.prototype,this)},a.prototype.toString=function(a,b){return" "+this.name+'="'+this.value+'"'},a}()}).call(this)},{"lodash/create":130}],179:[function(a,b,c){(function(){var c,d,e,f,g;g=a("./XMLStringifier"),d=a("./XMLDeclaration"),e=a("./XMLDocType"),f=a("./XMLElement"),b.exports=c=function(){function a(a,b){var c,d;if(null==a)throw new Error("Root element needs a name");null==b&&(b={}),this.options=b,this.stringify=new g(b),d=new f(this,"doc"),c=d.element(a),c.isRoot=!0,c.documentObject=this,this.rootObject=c,b.headless||(c.declaration(b),null==b.pubID&&null==b.sysID||c.doctype(b))}return a.prototype.root=function(){return this.rootObject},a.prototype.end=function(a){return this.toString(a)},a.prototype.toString=function(a){var b,c,d,e,f,g,h,i;return e=(null!=a?a.pretty:void 0)||!1,b=null!=(g=null!=a?a.indent:void 0)?g:"  ",d=null!=(h=null!=a?a.offset:void 0)?h:0,c=null!=(i=null!=a?a.newline:void 0)?i:"\n",f="",null!=this.xmldec&&(f+=this.xmldec.toString(a)),null!=this.doctype&&(f+=this.doctype.toString(a)),f+=this.rootObject.toString(a),e&&f.slice(-c.length)===c&&(f=f.slice(0,-c.length)),f},a}()}).call(this)},{"./XMLDeclaration":186,"./XMLDocType":187,"./XMLElement":188,"./XMLStringifier":192}],180:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),d=a("./XMLNode"),b.exports=c=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing CDATA text");this.text=this.stringify.cdata(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<![CDATA["+this.text+"]]>",f&&(g+=d),g},b}(d)}).call(this)},{"./XMLNode":189,"lodash/create":130}],181:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),d=a("./XMLNode"),b.exports=c=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing comment text");this.text=this.stringify.comment(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!-- "+this.text+" -->",f&&(g+=d),g},b}(d)}).call(this)},{"./XMLNode":189,"lodash/create":130}],182:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c,d,e,f){if(this.stringify=a.stringify,null==b)throw new Error("Missing DTD element name");if(null==c)throw new Error("Missing DTD attribute name");if(!d)throw new Error("Missing DTD attribute type");if(!e)throw new Error("Missing DTD attribute default");if(0!==e.indexOf("#")&&(e="#"+e),!e.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT");if(f&&!e.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT");this.elementName=this.stringify.eleName(b),this.attributeName=this.stringify.attName(c),this.attributeType=this.stringify.dtdAttType(d),this.defaultValue=this.stringify.dtdAttDefault(f),this.defaultValueType=e}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!ATTLIST "+this.elementName+" "+this.attributeName+" "+this.attributeType,"#DEFAULT"!==this.defaultValueType&&(g+=" "+this.defaultValueType),this.defaultValue&&(g+=' "'+this.defaultValue+'"'),g+=">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":130}],183:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing DTD element name");c||(c="(#PCDATA)"),Array.isArray(c)&&(c="("+c.join(",")+")"),this.name=this.stringify.eleName(b),this.value=this.stringify.dtdElementValue(c)}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!ELEMENT "+this.name+" "+this.value+">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":130}],184:[function(a,b,c){(function(){var c,d,e;d=a("lodash/create"),e=a("lodash/isObject"),b.exports=c=function(){function a(a,b,c,d){if(this.stringify=a.stringify,null==c)throw new Error("Missing entity name");if(null==d)throw new Error("Missing entity value");if(this.pe=!!b,this.name=this.stringify.eleName(c),e(d)){if(!d.pubID&&!d.sysID)throw new Error("Public and/or system identifiers are required for an external entity");if(d.pubID&&!d.sysID)throw new Error("System identifier is required for a public external entity");if(null!=d.pubID&&(this.pubID=this.stringify.dtdPubID(d.pubID)),null!=d.sysID&&(this.sysID=this.stringify.dtdSysID(d.sysID)),null!=d.nData&&(this.nData=this.stringify.dtdNData(d.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity")}else this.value=this.stringify.dtdEntityValue(d)}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!ENTITY",this.pe&&(g+=" %"),g+=" "+this.name,this.value?g+=' "'+this.value+'"':(this.pubID&&this.sysID?g+=' PUBLIC "'+this.pubID+'" "'+this.sysID+'"':this.sysID&&(g+=' SYSTEM "'+this.sysID+'"'),this.nData&&(g+=" NDATA "+this.nData)),g+=">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":130,"lodash/isObject":143}],185:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing notation name");if(!c.pubID&&!c.sysID)throw new Error("Public or system identifiers are required for an external entity");this.name=this.stringify.eleName(b),null!=c.pubID&&(this.pubID=this.stringify.dtdPubID(c.pubID)),null!=c.sysID&&(this.sysID=this.stringify.dtdSysID(c.sysID))}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!NOTATION "+this.name,this.pubID&&this.sysID?g+=' PUBLIC "'+this.pubID+'" "'+this.sysID+'"':this.pubID?g+=' PUBLIC "'+this.pubID+'"':this.sysID&&(g+=' SYSTEM "'+this.sysID+'"'),g+=">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":130}],186:[function(a,b,c){(function(){var c,d,e,f,g=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},h={}.hasOwnProperty;e=a("lodash/create"),f=a("lodash/isObject"),d=a("./XMLNode"),b.exports=c=function(a){function b(a,c,d,e){var g;b.__super__.constructor.call(this,a),f(c)&&(g=c,c=g.version,d=g.encoding,e=g.standalone),c||(c="1.0"),this.version=this.stringify.xmlVersion(c),null!=d&&(this.encoding=this.stringify.xmlEncoding(d)),null!=e&&(this.standalone=this.stringify.xmlStandalone(e))}return g(b,a),b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<?xml",g+=' version="'+this.version+'"',null!=this.encoding&&(g+=' encoding="'+this.encoding+'"'),null!=this.standalone&&(g+=' standalone="'+this.standalone+'"'),g+="?>",f&&(g+=d),g},b}(d)}).call(this)},{"./XMLNode":189,"lodash/create":130,"lodash/isObject":143}],187:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l;k=a("lodash/create"),l=a("lodash/isObject"),c=a("./XMLCData"),d=a("./XMLComment"),e=a("./XMLDTDAttList"),g=a("./XMLDTDEntity"),f=a("./XMLDTDElement"),h=a("./XMLDTDNotation"),j=a("./XMLProcessingInstruction"),b.exports=i=function(){function a(a,b,c){var d,e;this.documentObject=a,this.stringify=this.documentObject.stringify,this.children=[],l(b)&&(d=b,b=d.pubID,c=d.sysID),null==c&&(e=[b,c],c=e[0],b=e[1]),null!=b&&(this.pubID=this.stringify.dtdPubID(b)),null!=c&&(this.sysID=this.stringify.dtdSysID(c))}return a.prototype.element=function(a,b){var c;return c=new f(this,a,b),this.children.push(c),this},a.prototype.attList=function(a,b,c,d,f){var g;return g=new e(this,a,b,c,d,f),this.children.push(g),this},a.prototype.entity=function(a,b){var c;return c=new g(this,!1,a,b),this.children.push(c),this},a.prototype.pEntity=function(a,b){var c;return c=new g(this,!0,a,b),this.children.push(c),this},a.prototype.notation=function(a,b){var c;return c=new h(this,a,b),this.children.push(c),this},a.prototype.cdata=function(a){var b;return b=new c(this,a),this.children.push(b),this},a.prototype.comment=function(a){var b;return b=new d(this,a),this.children.push(b),this},a.prototype.instruction=function(a,b){var c;return c=new j(this,a,b),this.children.push(c),this},a.prototype.root=function(){return this.documentObject.root()},a.prototype.document=function(){return this.documentObject},a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o;if(i=(null!=a?a.pretty:void 0)||!1,e=null!=(k=null!=a?a.indent:void 0)?k:"  ",h=null!=(l=null!=a?a.offset:void 0)?l:0,g=null!=(m=null!=a?a.newline:void 0)?m:"\n",b||(b=0),o=new Array(b+h+1).join(e),j="",i&&(j+=o),j+="<!DOCTYPE "+this.root().name,this.pubID&&this.sysID?j+=' PUBLIC "'+this.pubID+'" "'+this.sysID+'"':this.sysID&&(j+=' SYSTEM "'+this.sysID+'"'),this.children.length>0){for(j+=" [",i&&(j+=g),n=this.children,d=0,f=n.length;d<f;d++)c=n[d],j+=c.toString(a,b+1);j+="]"}return j+=">",i&&(j+=g),j},a.prototype.ele=function(a,b){return this.element(a,b)},a.prototype.att=function(a,b,c,d,e){return this.attList(a,b,c,d,e)},a.prototype.ent=function(a,b){return this.entity(a,b)},a.prototype.pent=function(a,b){return this.pEntity(a,b)},a.prototype.not=function(a,b){return this.notation(a,b)},a.prototype.dat=function(a){return this.cdata(a)},a.prototype.com=function(a){return this.comment(a)},a.prototype.ins=function(a,b){return this.instruction(a,b)},a.prototype.up=function(){return this.root()},a.prototype.doc=function(){return this.document()},a}()}).call(this)},{"./XMLCData":180,"./XMLComment":181,"./XMLDTDAttList":182,"./XMLDTDElement":183,"./XMLDTDEntity":184,"./XMLDTDNotation":185,"./XMLProcessingInstruction":190,"lodash/create":130,"lodash/isObject":143}],188:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},l={}.hasOwnProperty;g=a("lodash/create"),j=a("lodash/isObject"),i=a("lodash/isFunction"),h=a("lodash/every"),e=a("./XMLNode"),c=a("./XMLAttribute"),f=a("./XMLProcessingInstruction"),b.exports=d=function(a){function b(a,c,d){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing element name");this.name=this.stringify.eleName(c),this.children=[],this.instructions=[],this.attributes={},null!=d&&this.attribute(d)}return k(b,a),b.prototype.clone=function(){var a,c,d,e,f,h,i,j;d=g(b.prototype,this),d.isRoot&&(d.documentObject=null),d.attributes={},i=this.attributes;for(c in i)l.call(i,c)&&(a=i[c],d.attributes[c]=a.clone());for(d.instructions=[],j=this.instructions,e=0,f=j.length;e<f;e++)h=j[e],d.instructions.push(h.clone());return d.children=[],this.children.forEach(function(a){var b;return b=a.clone(),b.parent=d,d.children.push(b)}),d},b.prototype.attribute=function(a,b){var d,e;if(null!=a&&(a=a.valueOf()),j(a))for(d in a)l.call(a,d)&&(e=a[d],this.attribute(d,e));else i(b)&&(b=b.apply()),this.options.skipNullAttributes&&null==b||(this.attributes[a]=new c(this,a,b));return this},b.prototype.removeAttribute=function(a){var b,c,d;if(null==a)throw new Error("Missing attribute name");if(a=a.valueOf(),Array.isArray(a))for(c=0,d=a.length;c<d;c++)b=a[c],delete this.attributes[b];else delete this.attributes[a];return this},b.prototype.instruction=function(a,b){var c,d,e,g,h;if(null!=a&&(a=a.valueOf()),null!=b&&(b=b.valueOf()),Array.isArray(a))for(c=0,h=a.length;c<h;c++)d=a[c],this.instruction(d);else if(j(a))for(d in a)l.call(a,d)&&(e=a[d],this.instruction(d,e));else i(b)&&(b=b.apply()),g=new f(this,a,b),this.instructions.push(g);return this},b.prototype.toString=function(a,b){var c,d,e,f,g,i,j,k,m,n,o,p,q,r,s,t,u,v,w,x;for(p=(null!=a?a.pretty:void 0)||!1,f=null!=(r=null!=a?a.indent:void 0)?r:"  ",o=null!=(s=null!=a?a.offset:void 0)?s:0,n=null!=(t=null!=a?a.newline:void 0)?t:"\n",b||(b=0),x=new Array(b+o+1).join(f),q="",u=this.instructions,e=0,j=u.length;e<j;e++)g=u[e],q+=g.toString(a,b);p&&(q+=x),q+="<"+this.name,v=this.attributes;for(m in v)l.call(v,m)&&(c=v[m],q+=c.toString(a));if(0===this.children.length||h(this.children,function(a){return""===a.value}))q+="/>",p&&(q+=n);else if(p&&1===this.children.length&&null!=this.children[0].value)q+=">",q+=this.children[0].value,q+="</"+this.name+">",q+=n;else{for(q+=">",p&&(q+=n),w=this.children,i=0,k=w.length;i<k;i++)d=w[i],q+=d.toString(a,b+1);p&&(q+=x),q+="</"+this.name+">",p&&(q+=n)}return q},b.prototype.att=function(a,b){return this.attribute(a,b)},b.prototype.ins=function(a,b){return this.instruction(a,b)},b.prototype.a=function(a,b){return this.attribute(a,b)},b.prototype.i=function(a,b){return this.instruction(a,b)},b}(e)}).call(this)},{"./XMLAttribute":178,"./XMLNode":189,"./XMLProcessingInstruction":190,"lodash/create":130,"lodash/every":132,"lodash/isFunction":141,"lodash/isObject":143}],189:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty;m=a("lodash/isObject"),l=a("lodash/isFunction"),k=a("lodash/isEmpty"),g=null,c=null,d=null,e=null,f=null,i=null,j=null,b.exports=h=function(){function b(b){this.parent=b,this.options=this.parent.options,this.stringify=this.parent.stringify,null===g&&(g=a("./XMLElement"),c=a("./XMLCData"),d=a("./XMLComment"),e=a("./XMLDeclaration"),f=a("./XMLDocType"),i=a("./XMLRaw"),j=a("./XMLText"))}return b.prototype.element=function(a,b,c){var d,e,f,g,h,i,j,o,p,q;if(i=null,null==b&&(b={}),b=b.valueOf(),m(b)||(p=[b,c],c=p[0],b=p[1]),null!=a&&(a=a.valueOf()),Array.isArray(a))for(f=0,j=a.length;f<j;f++)e=a[f],i=this.element(e);else if(l(a))i=this.element(a.apply());else if(m(a)){for(h in a)if(n.call(a,h))if(q=a[h],l(q)&&(q=q.apply()),m(q)&&k(q)&&(q=null),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===h.indexOf(this.stringify.convertAttKey))i=this.attribute(h.substr(this.stringify.convertAttKey.length),q);else if(!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===h.indexOf(this.stringify.convertPIKey))i=this.instruction(h.substr(this.stringify.convertPIKey.length),q);else if(!this.options.separateArrayItems&&Array.isArray(q))for(g=0,o=q.length;g<o;g++)e=q[g],d={},d[h]=e,i=this.element(d);else m(q)?(i=this.element(h),i.element(q)):i=this.element(h,q)}else i=!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?this.text(c):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===a.indexOf(this.stringify.convertCDataKey)?this.cdata(c):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===a.indexOf(this.stringify.convertCommentKey)?this.comment(c):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===a.indexOf(this.stringify.convertRawKey)?this.raw(c):this.node(a,b,c);if(null==i)throw new Error("Could not create any elements with: "+a);return i},b.prototype.insertBefore=function(a,b,c){var d,e,f;if(this.isRoot)throw new Error("Cannot insert elements at root level");return e=this.parent.children.indexOf(this),f=this.parent.children.splice(e),d=this.parent.element(a,b,c),Array.prototype.push.apply(this.parent.children,f),d},b.prototype.insertAfter=function(a,b,c){var d,e,f;if(this.isRoot)throw new Error("Cannot insert elements at root level");return e=this.parent.children.indexOf(this),f=this.parent.children.splice(e+1),d=this.parent.element(a,b,c),Array.prototype.push.apply(this.parent.children,f),d},b.prototype.remove=function(){var a,b;if(this.isRoot)throw new Error("Cannot remove the root element");return a=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[a,a-a+1].concat(b=[])),b,this.parent},b.prototype.node=function(a,b,c){var d,e;return null!=a&&(a=a.valueOf()),null==b&&(b={}),b=b.valueOf(),m(b)||(e=[b,c],c=e[0],b=e[1]),d=new g(this,a,b),null!=c&&d.text(c),this.children.push(d),d},b.prototype.text=function(a){var b;return b=new j(this,a),this.children.push(b),this},b.prototype.cdata=function(a){var b;return b=new c(this,a),this.children.push(b),this},b.prototype.comment=function(a){var b;return b=new d(this,a),this.children.push(b),this},b.prototype.raw=function(a){var b;return b=new i(this,a),this.children.push(b),this},b.prototype.declaration=function(a,b,c){var d,f;return d=this.document(),
f=new e(d,a,b,c),d.xmldec=f,d.root()},b.prototype.doctype=function(a,b){var c,d;return c=this.document(),d=new f(c,a,b),c.doctype=d,d},b.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},b.prototype.root=function(){var a;if(this.isRoot)return this;for(a=this.parent;!a.isRoot;)a=a.parent;return a},b.prototype.document=function(){return this.root().documentObject},b.prototype.end=function(a){return this.document().toString(a)},b.prototype.prev=function(){var a;if(this.isRoot)throw new Error("Root node has no siblings");if(a=this.parent.children.indexOf(this),a<1)throw new Error("Already at the first node");return this.parent.children[a-1]},b.prototype.next=function(){var a;if(this.isRoot)throw new Error("Root node has no siblings");if(a=this.parent.children.indexOf(this),a===-1||a===this.parent.children.length-1)throw new Error("Already at the last node");return this.parent.children[a+1]},b.prototype.importXMLBuilder=function(a){var b;return b=a.root().clone(),b.parent=this,b.isRoot=!1,this.children.push(b),this},b.prototype.ele=function(a,b,c){return this.element(a,b,c)},b.prototype.nod=function(a,b,c){return this.node(a,b,c)},b.prototype.txt=function(a){return this.text(a)},b.prototype.dat=function(a){return this.cdata(a)},b.prototype.com=function(a){return this.comment(a)},b.prototype.doc=function(){return this.document()},b.prototype.dec=function(a,b,c){return this.declaration(a,b,c)},b.prototype.dtd=function(a,b){return this.doctype(a,b)},b.prototype.e=function(a,b,c){return this.element(a,b,c)},b.prototype.n=function(a,b,c){return this.node(a,b,c)},b.prototype.t=function(a){return this.text(a)},b.prototype.d=function(a){return this.cdata(a)},b.prototype.c=function(a){return this.comment(a)},b.prototype.r=function(a){return this.raw(a)},b.prototype.u=function(){return this.up()},b}()}).call(this)},{"./XMLCData":180,"./XMLComment":181,"./XMLDeclaration":186,"./XMLDocType":187,"./XMLElement":188,"./XMLRaw":191,"./XMLText":193,"lodash/isEmpty":140,"lodash/isFunction":141,"lodash/isObject":143}],190:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing instruction target");this.target=this.stringify.insTarget(b),c&&(this.value=this.stringify.insValue(c))}return a.prototype.clone=function(){return d(a.prototype,this)},a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<?",g+=this.target,this.value&&(g+=" "+this.value),g+="?>",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":130}],191:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),c=a("./XMLNode"),b.exports=d=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing raw text");this.value=this.stringify.raw(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+=this.value,f&&(g+=d),g},b}(c)}).call(this)},{"./XMLNode":189,"lodash/create":130}],192:[function(a,b,c){(function(){var a,c=function(a,b){return function(){return a.apply(b,arguments)}},d={}.hasOwnProperty;b.exports=a=function(){function a(a){this.assertLegalChar=c(this.assertLegalChar,this);var b,e,f;this.allowSurrogateChars=null!=a?a.allowSurrogateChars:void 0,this.noDoubleEncoding=null!=a?a.noDoubleEncoding:void 0,e=(null!=a?a.stringify:void 0)||{};for(b in e)d.call(e,b)&&(f=e[b],this[b]=f)}return a.prototype.eleName=function(a){return a=""+a||"",this.assertLegalChar(a)},a.prototype.eleText=function(a){return a=""+a||"",this.assertLegalChar(this.elEscape(a))},a.prototype.cdata=function(a){if(a=""+a||"",a.match(/]]>/))throw new Error("Invalid CDATA text: "+a);return this.assertLegalChar(a)},a.prototype.comment=function(a){if(a=""+a||"",a.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+a);return this.assertLegalChar(a)},a.prototype.raw=function(a){return""+a||""},a.prototype.attName=function(a){return""+a||""},a.prototype.attValue=function(a){return a=""+a||"",this.attEscape(a)},a.prototype.insTarget=function(a){return""+a||""},a.prototype.insValue=function(a){if(a=""+a||"",a.match(/\?>/))throw new Error("Invalid processing instruction value: "+a);return a},a.prototype.xmlVersion=function(a){if(a=""+a||"",!a.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+a);return a},a.prototype.xmlEncoding=function(a){if(a=""+a||"",!a.match(/^[A-Za-z](?:[A-Za-z0-9._-]|-)*$/))throw new Error("Invalid encoding: "+a);return a},a.prototype.xmlStandalone=function(a){return a?"yes":"no"},a.prototype.dtdPubID=function(a){return""+a||""},a.prototype.dtdSysID=function(a){return""+a||""},a.prototype.dtdElementValue=function(a){return""+a||""},a.prototype.dtdAttType=function(a){return""+a||""},a.prototype.dtdAttDefault=function(a){return null!=a?""+a||"":a},a.prototype.dtdEntityValue=function(a){return""+a||""},a.prototype.dtdNData=function(a){return""+a||""},a.prototype.convertAttKey="@",a.prototype.convertPIKey="?",a.prototype.convertTextKey="#text",a.prototype.convertCDataKey="#cdata",a.prototype.convertCommentKey="#comment",a.prototype.convertRawKey="#raw",a.prototype.assertLegalChar=function(a){var b,c;if(b=this.allowSurrogateChars?/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uFFFE-\uFFFF]/:/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uD800-\uDFFF\uFFFE-\uFFFF]/,c=a.match(b))throw new Error("Invalid character ("+c+") in string: "+a+" at index "+c.index);return a},a.prototype.elEscape=function(a){var b;return b=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,a.replace(b,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")},a.prototype.attEscape=function(a){var b;return b=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,a.replace(b,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},a}()}).call(this)},{}],193:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),c=a("./XMLNode"),b.exports=d=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing element text");this.value=this.stringify.eleText(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+=this.value,f&&(g+=d),g},b}(c)}).call(this)},{"./XMLNode":189,"lodash/create":130}],194:[function(a,b,c){(function(){var c,d;d=a("lodash/assign"),c=a("./XMLBuilder"),b.exports.create=function(a,b,e,f){return f=d({},b,e,f),new c(a,f).root()}}).call(this)},{"./XMLBuilder":179,"lodash/assign":128}],195:[function(a,b,c){"use strict";function d(b){[a("./nodes/visual/group"),a("./nodes/visual/image"),a("./nodes/visual/rectangle"),a("./nodes/visual/circle"),a("./nodes/visual/text"),a("./nodes/visual/stacklayout"),a("./nodes/visual/flowlayout"),a("./nodes/visual/scrollview"),a("./nodes/counter"),a("./nodes/expression"),a("./nodes/and"),a("./nodes/or"),a("./nodes/switch"),a("./nodes/numberblend"),a("./nodes/stringselector"),a("./nodes/stringmapper"),a("./nodes/drag"),a("./nodes/inverter"),a("./nodes/timer"),a("./nodes/velocity"),a("./nodes/variables/number"),a("./nodes/variables/string"),a("./nodes/variables/boolean"),a("./nodes/variables/color"),a("./nodes/touchposition"),a("./nodes/signaltoindex"),a("./nodes/substring"),a("./nodes/gyroscope"),a("./nodes/reload"),a("./nodes/colorblend"),a("./nodes/globals"),a("./nodes/eventsender"),a("./nodes/eventreceiver"),a("./nodes/screenresolution"),a("./nodes/javascript"),a("./nodes/javascript2"),a("./nodes/animation"),a("./nodes/transition"),a("./nodes/numberremapper"),a("./nodes/websocket"),a("./nodes/componentinputs"),a("./nodes/componentoutputs"),a("./nodes/valuechanged"),a("./nodes/visual/textinput"),a("./nodes/visual/page"),a("./nodes/visual/pages"),a("./nodes/pagenavigation"),a("./nodes/pagenavigationback"),a("./nodes/states"),a("./nodes/stringformat"),a("./nodes/data/foreach"),a("./nodes/data/foreachactions"),a("./nodes/data/modelnode"),a("./nodes/data/collectionnode"),a("./nodes/data/staticdata"),a("./nodes/data/restnode"),a("./nodes/sendmessage"),a("./nodes/receivemessage"),a("./nodes/uniqueid")].forEach(function(a){b.registerNode(a)})}function e(a){if(!a)return{};for(var b={},c=a.substr(1).split("&"),d=0;d<c.length;d++){var e=c[d].split("=");b[decodeURIComponent(e[0])]=decodeURIComponent(e[1]||"")}return b}function f(a){function b(a,b){if(c.rootComponent){var d=c.rootComponent.nodeScope.getNodesWithIdRecursive(a);d.forEach(function(a){a.setHighlightEnabled&&a.setHighlightEnabled(b)})}}var c=this;a=a||{},f.instance=this,this.frameScheduled=!1,this.rootComponent=null,this._currentLoadedData=null,this.isWaitingForExport=!0,this.graphModel=new l,this.errorHandlers=[],this.runningInEditor=!a.runStandalone,n.instance.setIsRunningInEditor(this.runningInEditor),this.editorConnection=new h,this.editorConnection.on("exportDataFull",function(a){c.patchExportData(a)===!1?(c.isWaitingForExport=!1,y.isEqual(c._currentLoadedData,a)===!1&&c.setData(a)):c.editorConnection.requestFullExport()}),this.editorConnection.on("hoverStart",function(a){b(a,!0)}),this.editorConnection.on("hoverEnd",function(a){b(a,!1)}),this.editorConnection.on("reload",this.reload.bind(this)),this.editorConnection.on("inspectStart",function(){c.enableInspector(function(a){c.editorConnection.sendInspectId(a)})}),this.editorConnection.on("inspectEnd",this.disableInspector.bind(this)),this.editorConnection.on("modelUpdate",this.onModelUpdateReceived.bind(this)),this.context=new g({uiEngineClass:s,runningInEditor:this.runningInEditor,editorConnection:this.editorConnection}),this.editorConnection.isRunningLocally()&&(this.context.setOutputCollectionEnabled(!0),this.editorConnection.on("connected",function(){c.sendNodeLibrary()})),this.editorConnection.on("debuggingEnabledChanged",this.context.setOutputCollectionEnabled.bind(this.context)),this.editorConnection.on("captureScreenShot",function(a){a.callback(c.context.uiEngine.captureScreenShot(a.width,a.height))}),this.context.eventEmitter.on("scheduleFrame",this.scheduleFrame.bind(this)),this.context.eventEmitter.on("reloadApplication",this.reload.bind(this)),this.registerGraphModelListeners(),this._resetData(),d(this);for(var e=0;e<__noodl_modules.length;e++){var i=__noodl_modules[e];if(i.nodes)for(var j=0;j<i.nodes.length;j++){var k=i.nodes[j];k.node||(k={node:k}),this.registerNode(k)}}this.inspector=new w,this.textInputRenderer=new u,this.textInputRenderer.setRenderInputFieldsOnly(!0),p.pubsub=new q,p.pubsub.setConnection(this.editorConnection)}var g=a("./nodecontext"),h=a("./editorconnection"),i=a("./nodelibraryexport"),j=a("./projectsettings"),k=a("./projectpatchers"),l=a("./models/graphmodel"),m=a("./nodedefinition"),n=a("./fontloader"),o=a("./editormodeleventshandler"),p=a("./services/services"),q=a("./services/pubsub"),r=a("./services/mqtt-connection"),s=a("./uiengine/uiengine"),t=a("./uiengine/renderers/renderer-canvas2d"),u=a("./uiengine/renderers/renderer-dom"),v=a("./uiengine/renderers/renderer-webgl"),w=a("./inspector"),x=a("./useragent-utils"),y=(a("./guid"),a("lodash"));f.prototype.registerGraphModelListeners=function(){var a=this;this.graphModel.on("componentAdded",function(b){a.context.registerComponentModel(b)},this),this.graphModel.on("componentRemoved",function(b){a.context.deregisterComponentModel(b)},this),this.graphModel.on("settingsUpdated",function(){a.setViewportSettings(a.graphModel.getDeviceSettings(a.deviceName)),a.sendNodeLibrary()})},f.prototype.reload=function(){this._currentLoadedData&&this.setData(this._currentLoadedData)},f.prototype._resetData=function(){this.frameNumber=0,this.rootComponent=null,this._currentLoadedData=null,this.graphModel.reset(),this.context.reset()},f.prototype.registerNode=function(a){a.node?(this.context.nodeRegister.register(m.defineNode(a.node)),a.setup&&a.setup(this.context,this.graphModel)):this.context.nodeRegister.register(a)},f.prototype.patchExportData=function(a){var b=k.collectPatches(a),c=Object.keys(b),d=j.collectPatch(a.settings),e=this;return!!(c.length>0||d)&&(this.editorConnection.isRunningLocally()&&(c.forEach(function(a){e.editorConnection.sendPatches(b[a])}),d&&e.editorConnection.sendPatches(d)),!0)},f.prototype.setRenderer=function(a){var b=this.context.uiEngine;b.removeAllRenderers();var c=x.isMobile.any();if("canvas2d"===a)b.addRenderer(new t({alpha:!1,useScreenResolution:c})),b.addRenderer(this.textInputRenderer),b.imageCache.setCrossOrigin(!1);else if("webgl"===a)try{b.addRenderer(new v({alpha:!1})),b.addRenderer(this.textInputRenderer),b.imageCache.setCrossOrigin(!0)}catch(d){this.reportError(d.message)}else b.addRenderer(new u)},f.prototype.setViewportSettings=function(a){this.currentRenderer!==a.renderer&&(this.setRenderer(a.renderer),this.currentRenderer=a.renderer),this.context.uiEngine.setFillMode(a.fillMode),"aspectFit"===a.fillMode&&this.context.uiEngine.setAspectFitViewport(a.canvasWidth,a.canvasHeight)},f.prototype.findMQTTBrokerWithType=function(a){for(var b=0;b<__noodl_modules.length;b++){var c=__noodl_modules[b].mqttBrokers;if(c)for(var d=0;d<c.length;d++){var e=c[b];if(e.id===a)return e}}},f.prototype.showDeviceMenu=function(a){var b=JSON.stringify({settings:{devices:"Default Device","Default.fillMode":"fill","Default.renderer":"canvas2d","Default.rootComponent":"/Main","Default Device.fillMode":"fill","Default Device.canvasWidth":1080,"Default Device.canvasHeight":1920,"Default Device.renderer":"canvas2d"},components:[{name:"/Main",nodes:[{id:"2d3ccd33-f1ef-2dc5-3e1a-ca9d61cd222b",type:"Group",parameters:{fill:"parent"},ports:[],children:[{id:"fa90ea16-1232-0437-deea-5dd6263d8247",type:"Rectangle",parameters:{color:"#222222"},ports:[],children:[]},{id:"84ce46fb-1240-c8b1-6cf8-d49b466af961",type:"Scroll View",parameters:{sizeMode:"explicit",alignX:"left",alignY:"top",clip:!0,paddingTop:50,paddingBottom:50},ports:[],children:[{id:"919460fe-c10e-9656-1924-3b39afe0a908",type:"Text",version:2,parameters:{text:"DEVICE LIST",color:"#F7BC41",fontSize:26,x:30,fontFamily:"fonts/OpenSans-Regular.ttf"},ports:[],children:[]},{id:"01d3bb07-74e9-f7c5-442b-dda6601882b7",type:"Text",version:2,parameters:{text:"Choose a device from the list",color:"#7a7a7a",fontSize:16,x:30,fontFamily:"fonts/OpenSans-Light.ttf"},ports:[],children:[]},{id:"0a2e4207-be74-0e10-e3c7-c53c1f4cd287",type:"Group",version:2,parameters:{height:{value:15,unit:"px"}},ports:[],children:[]},{id:"88e5bc50-f85b-7cfc-61a9-8a8e947a91e0",type:"Stack Layout",parameters:{sizeMode:"childHeight",itemSpacing:5},ports:[],children:[{id:"6fff1cb1-b58c-aafd-8790-951dd51e2230",type:"For Each",parameters:{template:"/Device Item"},ports:[{name:"template",plug:"input",type:"component",displayName:"Component",group:"Appearance",index:3}],children:[]}]}]}]},{id:"23a6c0c0-859b-cf8d-af06-95dba0c57d78",type:"Collection",parameters:{collectionId:"Devices"},ports:[],children:[]},{id:"55b1046f-9c39-c183-7a7e-f7d0a0afd7a3",type:"Static Data",parameters:{csv:"DeviceName\nDevice 1\nMy Other Device\nSome third device"},ports:[{name:"csv",plug:"input",type:{name:"string",codeeditor:"text"},displayName:"CSV",group:"General",index:2}],children:[]}],connections:[{sourceId:"55b1046f-9c39-c183-7a7e-f7d0a0afd7a3",sourcePort:"items",targetId:"23a6c0c0-859b-cf8d-af06-95dba0c57d78",targetPort:"items"},{sourceId:"23a6c0c0-859b-cf8d-af06-95dba0c57d78",sourcePort:"items",targetId:"6fff1cb1-b58c-aafd-8790-951dd51e2230",targetPort:"items"}],ports:[],roots:["2d3ccd33-f1ef-2dc5-3e1a-ca9d61cd222b"]},{name:"/Device Item",nodes:[{id:"ccd8d324-7db3-d669-1099-dd84a0da6cf1",type:"Group",version:2,parameters:{sizeMode:"explicit",height:{value:55,unit:"px"}},ports:[],children:[{id:"73bb365b-38c7-efde-1516-d06c61315551",type:"Rectangle",parameters:{color:"#363637"},ports:[],children:[]},{id:"0e012b10-9938-cedd-cb1d-8f643353367d",type:"Group",version:2,parameters:{sizeMode:"explicit",paddingLeft:30,paddingRight:30},ports:[],children:[{id:"84669e81-f629-9b95-e309-a409ef64ff2e",type:"Text",version:2,parameters:{color:"#f8f8f8",fontFamily:"fonts/OpenSans-Light.ttf",alignX:"left",alignY:"center",sizeMode:"childHeight",fontSize:20},ports:[],children:[]},{id:"7e35cfcb-81a5-14d4-6e30-cf04ff69ec6f",type:"Group",version:2,parameters:{alignY:"center",sizeMode:"childSize",alignX:"right"},ports:[],children:[{id:"7210c16d-d9cf-604f-cd4e-c3014d6487ee",type:"Rectangle",parameters:{height:{value:2,unit:"px"},width:{value:10,unit:"px"},color:"#f8f8f8",rotationZ:45,y:-3},ports:[],children:[]},{id:"5faf645f-3c87-219c-3371-3eeda03986bc",type:"Rectangle",parameters:{height:{value:2,unit:"px"},width:{value:10,unit:"px"},color:"#f8f8f8",rotationZ:-45,y:4},ports:[],children:[]}]}]}]},{id:"26f178df-a067-6a5f-1d93-d146462b9c0b",type:"Model",parameters:{idType:"instance",properties:"DeviceName"},ports:[{type:{name:"*",allowConnectionsOnly:!0},plug:"input/output",group:"Properties",name:"DeviceName",index:7}],children:[]},{id:"28d2af23-0c6e-db12-ad4f-8b5e1099e083",type:"Event Sender",parameters:{channelName:"Device Chosen"},ports:[{name:"DeviceName",plug:"input",type:{name:"*",allowConnectionOnly:!0},index:1}],children:[]},{id:"7b90a527-a414-14b0-497f-ff4bc902f6df",type:"For Each Actions",parameters:{},ports:[],children:[]}],connections:[{sourceId:"26f178df-a067-6a5f-1d93-d146462b9c0b",sourcePort:"DeviceName",targetId:"84669e81-f629-9b95-e309-a409ef64ff2e",targetPort:"text"},{sourceId:"26f178df-a067-6a5f-1d93-d146462b9c0b",sourcePort:"DeviceName",targetId:"28d2af23-0c6e-db12-ad4f-8b5e1099e083",targetPort:"DeviceName"},{sourceId:"ccd8d324-7db3-d669-1099-dd84a0da6cf1",sourcePort:"touch.tap",targetId:"28d2af23-0c6e-db12-ad4f-8b5e1099e083",targetPort:"sendEvent"},{sourceId:"7b90a527-a414-14b0-497f-ff4bc902f6df",sourcePort:"itemId",targetId:"26f178df-a067-6a5f-1d93-d146462b9c0b",targetPort:"modelId"}],ports:[],roots:["ccd8d324-7db3-d669-1099-dd84a0da6cf1"]}],rootComponent:"/Main",rootNode:"2d3ccd33-f1ef-2dc5-3e1a-ca9d61cd222b"});b=b.replace(/fonts\//g,"external/viewer/fonts/"),b=JSON.parse(b),this._currentLoadedData=b,this.graphModel.importEditorData(b),this.graphModel.getComponentWithName("/Main").removeNodeWithId(this.graphModel.getNodesWithType("Static Data")[0].id),this.deviceName="Default Device",this.context.eventSenderEmitter.once("Device Chosen",function(a){window.location=window.location.href+(window.location.search?"&":"?")+"device="+a.DeviceName}),this.editorConnection.close();var c=a.split(",").map(function(a){return{DeviceName:a}}),d=this;this.context.eventEmitter.once("frameStart",function(){d.rootComponent.nodeScope.noodlJavascriptAPI.Collection.get("Devices").set(c)})},f.prototype.setupMQTT=function(a,b){var c=("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6),d=c+"-"+(b||"Noodl Editor"),e=this;if((!this.mqttConnection||!this.mqttConnection.isConnected())&&(a.mqttUseExternalBroker||this.runningInEditor)){if(this.mqttConnection||(this.mqttConnection=new r),a.mqttUseExternalBroker){var f=a.mqttBrokerUrl;if(a.mqttBrokerType&&"default"!==a.mqttBrokerType){var g=this.findMQTTBrokerWithType(a.mqttBrokerType);f=function(){return g.url(e.graphModel.projectSettings)}}this.mqttConnection.connect({url:f,clientId:d})}else this.mqttConnection.connect({url:"mqtt://"+location.hostname+":1884",clientId:d});p.pubsub.setConnection(this.mqttConnection)}},f.prototype.setData=function(b){var c=this;this.graphModel.isEmpty()===!1&&this._resetData();var d=b.settings.devices&&b.settings.devices.split(",").length>1,f=e(window.location.search),g=this.editorConnection.isRunningLocally()===!1&&d>0&&!f.device;if(g)this.showDeviceMenu(b.settings.devices);else{this._currentLoadedData=b,this.graphModel.importEditorData(b);var h=this.graphModel.getSettings();this.runningInEditor===!1&&h.analyticsEnabled&&this.recordSession(this.graphModel.getSettings().analyticsServerUrl);var i=this.graphModel.getDeviceSettings(f.device);this.setupMQTT(h,i.name)}var j,k,i=this.graphModel.getDeviceSettings(f.device);this.deviceName=i.name,this.editorConnection.isRunningLocally()&&!f.device?(j=this.graphModel.rootComponent,k=this.graphModel.rootNode):(j=i.rootComponent||this.graphModel.rootComponent,k=i.rootId),k||(k=this.graphModel.getComponentWithName(j).getFirstRootId()),window.Noodl.PubSub=p.pubsub,window.Noodl.getProjectSettings=function(){return c.graphModel.projectSettings},window.Noodl.Collection=a("./nodes/data/collection"),window.Noodl.Model=a("./nodes/data/model"),this.rootComponent=this.context.createComponentInstanceNode(j),this.rootComponent.setRoot(k),this.context.setRootComponent(this.rootComponent),this.setViewportSettings(i),y.extend(window.Noodl,this.rootComponent.nodeScope.noodlJavascriptAPI);for(var l=0;l<__noodl_modules.length;l++)"function"==typeof __noodl_modules[l].setup&&__noodl_modules[l].setup();this.scheduleFrame()},f.prototype.scheduleFrame=function(){this.frameScheduled||(window.requestAnimationFrame(f.prototype._doFrame.bind(this)),this.frameScheduled=!0)},f.prototype._doFrame=function(){this.frameScheduled=!1,this.context.currentFrameTime=window.performance.now(),this.context.eventEmitter.emit("frameStart"),this.context.update(),this.context.layout(),this.context.update(),this.context.uiEngine.renderFrame(),this.context.eventEmitter.emit("frameEnd"),this.frameNumber++},f.prototype.getNodeLibrary=function(){var a=j.generateProjectSettings(this.graphModel.getRawProjectSettings()),b=i(this.context.nodeRegister);return b.projectsettings=a,JSON.stringify(b,null,3)},f.prototype.sendNodeLibrary=function(){var a=this.getNodeLibrary();this.lastSentNodeLibrary!==a&&(this.lastSentNodeLibrary=a,this.editorConnection.send({cmd:"nodelibrary",type:"viewer",content:this.getNodeLibrary()}))},f.prototype.enableInspector=function(a){this.inspector.enable(this.context.uiEngine,a)},f.prototype.disableInspector=function(){this.inspector.disable()},f.prototype.connectToEditor=function(a){this.editorConnection.connect(a)},f.prototype.onModelUpdateReceived=function(a){this.isWaitingForExport||("projectInstanceChanged"===a.type?(this.context.uiEngine.clearImageCache(),this._resetData(),this.scheduleFrame(),this.isWaitingForExport=!0):o.handleEvent(this.context,this.graphModel,a))},f.prototype.addErrorHandler=function(a){this.errorHandlers.push(a)},f.prototype.reportError=function(a){this.errorHandlers.forEach(function(b){b(a)})},b.exports=f},{"./editorconnection":198,"./editormodeleventshandler":199,"./fontloader":201,"./guid":202,"./inspector":203,"./models/graphmodel":206,"./nodecontext":209,"./nodedefinition":210,"./nodelibraryexport":211,"./nodes/and":213,"./nodes/animation":214,"./nodes/colorblend":215,"./nodes/componentinputs":216,"./nodes/componentoutputs":218,"./nodes/counter":219,"./nodes/data/collection":220,"./nodes/data/collectionnode":221,"./nodes/data/foreach":222,"./nodes/data/foreachactions":223,"./nodes/data/model":224,"./nodes/data/modelnode":225,"./nodes/data/restnode":227,"./nodes/data/staticdata":228,"./nodes/drag":229,"./nodes/eventreceiver":230,"./nodes/eventsender":231,"./nodes/expression":232,"./nodes/globals":233,"./nodes/gyroscope":234,"./nodes/inverter":235,"./nodes/javascript":236,"./nodes/javascript2":237,"./nodes/numberblend":238,"./nodes/numberremapper":239,"./nodes/or":240,"./nodes/pagenavigation":241,"./nodes/pagenavigationback":242,"./nodes/receivemessage":243,"./nodes/reload":244,"./nodes/screenresolution":245,"./nodes/sendmessage":246,"./nodes/signaltoindex":247,"./nodes/states":248,"./nodes/stringformat":249,"./nodes/stringmapper":250,"./nodes/stringselector":251,"./nodes/substring":252,"./nodes/switch":253,"./nodes/timer":254,"./nodes/touchposition":255,"./nodes/transition":256,"./nodes/uniqueid":257,"./nodes/valuechanged":258,"./nodes/variables/boolean":259,"./nodes/variables/color":260,"./nodes/variables/number":261,"./nodes/variables/string":262,"./nodes/velocity":264,"./nodes/visual/circle":265,"./nodes/visual/flowlayout":266,"./nodes/visual/group":267,"./nodes/visual/image":268,"./nodes/visual/page":270,"./nodes/visual/pages":271,"./nodes/visual/rectangle":272,"./nodes/visual/scrollview":274,"./nodes/visual/stacklayout":275,"./nodes/visual/text":276,"./nodes/visual/textinput":277,"./nodes/websocket":279,"./projectpatchers":283,"./projectsettings":284,"./services/mqtt-connection":285,"./services/pubsub":286,"./services/services":287,"./uiengine/renderers/renderer-canvas2d":318,"./uiengine/renderers/renderer-dom":319,"./uiengine/renderers/renderer-webgl":320,"./uiengine/uiengine":336,"./useragent-utils":337,lodash:148}],196:[function(a,b,c){"use strict";var d={easeOutQuartic:function(a,b,c){return c--,-(b-a)*(c*c*c*c-1)+a},easeInQuartic:function(a,b,c){return(b-a)*(c*c*c*c)+a},easeInOutQuartic:function(a,b,c){return c*=2,c<1?(b-a)/2*c*c*c*c+a:(c-=2,-(b-a)/2*(c*c*c*c-2)+a)},easeOutCubic:function(a,b,c){return c--,(b-a)*(c*c*c+1)+a},easeInCubic:function(a,b,c){return(b-a)*(c*c*c)+a},easeInOutCubic:function(a,b,c){return c*=2,c<1?(b-a)/2*c*c*c+a:(c-=2,(b-a)/2*(c*c*c+2)+a)},easeOutQuadratic:function(a,b,c){return-(b-a)*c*(c-2)+a},easeInQuadratic:function(a,b,c){return(b-a)*(c*c)+a},easeInOutQuadratic:function(a,b,c){return c*=2,c<1?(b-a)/2*c*c+a:(c-=1,-(b-a)/2*(c*(c-2)-1)+a)},linear:function(a,b,c){return a+(b-a)*c}};d.easeIn=d.easeInCubic,d.easeOut=d.easeOutCubic,d.easeInOut=d.easeInOutCubic,b.exports=d},{}],197:[function(a,b,c){"use strict";function d(a){var b=!1;return function(c){c=!!c,c&&b===!1&&a.valueChangedToTrue.call(this),b=c}}b.exports={createSetter:d}},{}],198:[function(a,b,c){"use strict";function d(a){var b=a||{};e.call(this),this.ws=a&&a.webSocketClass||WebSocket,this.reconnectOnClose=!0,this.forceDebugger=b.forceDebugger||"undefined"!=typeof document&&document.location.href.indexOf("forceDebugger=true")!==-1}var e=a("./eventsender"),f=a("./services/services"),g=a("./guid");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.isRunningLocally=function(){var a="undefined"!=typeof document&&("localhost"===document.location.hostname||"127.0.0.1"===document.location.hostname);return a},d.prototype.connect=function(a){this.socket=new this.ws(a);var b=this;this.socket.addEventListener("open",function(){b.clientId=g(),b.socket.send(JSON.stringify({cmd:"register",type:"viewer",clientId:b.clientId})),b.emit("connected")}),this.socket.addEventListener("close",function(){b.reconnectOnClose&&b.reconnect(a),b.emit("connectionClosed")}),this.socket.addEventListener("error",function(c){console.log("Editor connection error, trying to reconnect"),b.reconnect(a)}),this.socket.addEventListener("message",function(a){var c,d=JSON.parse(a.data);"registered"===d.cmd||("export"===d.cmd?(c=JSON.parse(d.content),"full"===d.type&&b.emit("exportDataFull",c)):"hoverStart"===d.cmd?b.emit("hoverStart",d.content.id):"hoverEnd"===d.cmd?b.emit("hoverEnd",d.content.id):"refresh"===d.cmd?b.emit("reload"):"inspectStart"===d.cmd?b.emit("inspectStart"):"inspectEnd"===d.cmd?b.emit("inspectEnd"):"capture"===d.cmd?b.isRunningLocally()&&(c=JSON.parse(d.content),b.sendThumbnailCapture(c.width,c.height)):"connectionInspectors"===d.cmd?(b.isRunningLocally()||b.forceDebugger)&&(c=JSON.parse(d.content),b.emit("connectionInspectorsUpdated",c.connectionsToInspect)):"debuggingEnabled"===d.cmd?(b.isRunningLocally()||b.forceDebugger)&&(c=JSON.parse(d.content),b.emit("debuggingEnabledChanged",c.enabled)):"modelUpdate"===d.cmd?b.emit("modelUpdate",d.content):"publish"===d.cmd?f.pubsub.routeMessage(d):console.log("Command not implemented",d))})},d.prototype.reconnect=function(a){var b=this;setTimeout(function(){b.connect(a)},2e3)},d.prototype.isConnected=function(){return void 0!==this.socket&&this.socket.readyState===this.ws.OPEN},d.prototype.send=function(a){this.isConnected()!==!1&&this.socket.send(JSON.stringify(a))},d.prototype.sendInspectId=function(a){this.send({cmd:"select",type:"viewer",content:JSON.stringify({id:a})})},d.prototype.sendPulsingConnections=function(a){var b=[];Object.keys(a).forEach(function(c){var d=a[c];b=b.concat(d.connections)}),this.send({cmd:"connectiondebugpulse",type:"viewer",content:JSON.stringify({connectionsToPulse:b})})},d.prototype.sendConnectionValues=function(a){this.send({cmd:"connectionvalue",type:"viewer",content:JSON.stringify({connections:a})})},d.prototype.sendDynamicPorts=function(a,b){this.send({cmd:"instanceports",type:"viewer",content:JSON.stringify({nodeid:a,ports:b})})},d.prototype.sendThumbnailCapture=function(a,b){var c=this;this.emit("captureScreenShot",{width:a,height:b,callback:function(a){a&&c.send({cmd:"captured",type:"viewer",content:JSON.stringify({data:a})})}})},d.prototype.sendWarning=function(a,b,c,d){this.send({cmd:"showwarning",type:"viewer",content:JSON.stringify({componentName:a,nodeId:b,key:c,warning:d})})},d.prototype.clearWarnings=function(a,b){this.send({cmd:"clearwarnings",type:"viewer",content:JSON.stringify({componentName:a,nodeId:b})})},d.prototype.sendPatches=function(a){this.send({cmd:"patchproject",type:"viewer",content:JSON.stringify(a)})},d.prototype.requestFullExport=function(){this.send({cmd:"register",type:"viewer"})};var h={};d.prototype.sendServiceRequest=function(a,b){a.token=g(),a.clientId=this.clientId,h[a.token]=b,this.send(a)},d.prototype.close=function(){this.reconnectOnClose=!1,this.isConnected()!==!1&&this.socket.close()},b.exports=d},{"./eventsender":200,"./guid":202,"./services/services":287}],199:[function(a,b,c){"use strict";function d(a,b,c){function d(b,c){var d={},f={};c.forEach(function(a){a&&"outputs"===a.plug&&(a.plug="output"),"input"!==a.plug&&"input/output"!==a.plug||(d[a.name]=a),"output"!==a.plug&&"input/output"!==a.plug||(f[a.name]=a)});var h=Object.keys(b.getInputPorts()),i=e.difference(h,Object.keys(d)),j=e.difference(Object.keys(d),h);i.forEach(b.removeInputPortWithName.bind(b)),j.forEach(function(c){b.addInputPort(d[c]),b.parameters&&b.parameters.hasOwnProperty(c)&&g(a.rootComponent.nodeScope,b,c,b.parameters[c])});var k=Object.keys(b.getOutputPorts()),l=e.difference(k,Object.keys(f)),m=e.difference(Object.keys(f),k);l.forEach(b.removeOutputPortWithName.bind(b)),m.forEach(function(a){b.addOutputPort(f[a])})}function f(a,b,c){if(a.hasNode(b)!==!1){var d=a.getNodeMetadata(b),e=d.inputs[c];if(e)return e.type.defaultUnit?{value:e.default,unit:e.type.defaultUnit}:e.default}}function g(a,b,c,d){var e=a.getNodesWithIdRecursive(b.id);e.forEach(function(a){a.queueInput(c,d)})}var h;c.componentName&&(h=b.getComponentWithName(c.componentName)),c.port&&"outputs"===c.port.plug&&(c.port.plug="output");var i={nodeAdded:function(a){h.importEditorNodeData(a.model,a.parentId,a.childIndex)},nodeRemoved:function(a){h.removeNodeWithId(a.model.id)},connectionAdded:function(a){h.addConnection(a.model)},connectionRemoved:function(b){h.removeConnection(b.model);var c=h.getNodeWithId(b.model.targetId);if(0===h.getConnectionsToPort(c.id,b.model.targetId).length){var d=c.parameters[b.model.targetPort];void 0===d&&(d=f(a.nodeRegister,c.type,b.model.targetPort)),g(a.rootComponent.nodeScope,c,b.model.targetPort,d)}},parameterChanged:function(b){
var c=h.getNodeWithId(b.nodeId);if(void 0===c)return void console.log("parameterChanged: Unkown node id",b);var d=b.parameterValue;void 0===d&&(d=f(a.nodeRegister,c.type,b.parameterName)),c.setParameter(b.parameterName,d)},nodeAttached:function(a){h.setNodeParent(h.getNodeWithId(a.nodeId),h.getNodeWithId(a.parentId),a.childIndex)},nodeDetached:function(a){h.setNodeParent(h.getNodeWithId(a.nodeId),null)},componentAdded:function(a){b.importComponentFromEditorData(a.model)},componentRemoved:function(a){b.removeComponentWithName(a.componentName)},rootAdded:function(a){h.addRootId(a.nodeId)},portAdded:function(b){var c=h.getNodeWithId(b.nodeId);"input"!==b.port.plug&&"input/output"!==b.port.plug||(c.addInputPort(b.port),c.parameters.hasOwnProperty(b.port)&&g(a.rootComponent.nodeScope,c,b.port,c.parameters[b.port])),"output"!==b.port.plug&&"input/output"!==b.port.plug||c.addOutputPort(b.port)},portRemoved:function(a){var b=h.getNodeWithId(a.nodeId);"input"!==a.port.plug&&"input/output"!==a.port.plug||b.removeInputPortWithName(a.port.name),"output"!==a.port.plug&&"input/output"!==a.port.plug||b.removeOutputPortWithName(a.port.name)},nodePortRenamed:function(a){"input"!==a.port.plug&&"input/output"!==a.port.plug||h.renameInputPortOnNodeWithId(a.nodeId,a.oldName,a.port.name),"output"!==a.port.plug&&"input/output"!==a.port.plug||h.renameOutputPortOnNodeWithId(a.nodeId,a.oldName,a.port.name);var c=h.getNodeWithId(a.nodeId);"Component Inputs"===c.type?(h.addInputPort(a.port),b.getNodesWithType(h.name).forEach(function(b){b.component.renameInputPortOnNodeWithId(b.id,a.oldName,a.port.name)}),h.removeInputPortWithName(a.oldName)):"Component Outputs"===c.type&&(h.addOutputPort(a.port),b.getNodesWithType(h.name).forEach(function(b){b.component.renameOutputPortOnNodeWithId(b.id,a.oldName,a.port.name)}),h.removeOutputPortWithName(a.oldName))},componentPortsUpdated:function(a){d(h,a.ports)},instancePortsChanged:function(a){var b=h.getNodeWithId(a.nodeId);d(b,a.ports)},componentRenamed:function(a){b.renameComponent(a.oldName,a.newName)},settingsChanged:function(a){b.setSettings(a.settings)}};i.hasOwnProperty(c.type)?(i[c.type](c),a.scheduleFrame()):console.log("Unknown event",c)}var e=a("lodash");b.exports={handleEvent:d}},{lodash:148}],200:[function(a,b,c){"use strict";function d(){this.listeners={},this.numListeners={}}var e=a("lodash");d.prototype.on=function(a,b,c){this.listeners.hasOwnProperty(a)||(this.listeners[a]=[],this.numListeners[a]=0),this.listeners[a].push({callback:b,ref:c}),this.numListeners[a]++,this.numListeners[a]>1e3&&console.trace("too many events",a,this.numListeners[a])},d.prototype.removeListenersWithRef=function(a){var b=this.numListeners;e.forIn(this.listeners,function(c,d){var f=e.remove(c,function(b){return b.ref===a});b[d]-=f.length})},d.prototype.removeAllListeners=function(a){a?(delete this.listeners[a],delete this.numListeners[a]):(this.listeners={},this.numListeners={})},d.prototype.emit=function(a,b){var c=this.listeners[a];c&&c.forEach(function(a){a.callback.call(a.ref,b)})},b.exports=d},{lodash:148}],201:[function(a,b,c){"use strict";function d(){this.loadedFontFamilies={},this.fontCssFamiliesAdded={},this.fontCallbacks={};var a=this;["Arial","Arial Black","Courier New","Helvetica","Impact","Lucida Console","Tahoma","Times New Roman"].forEach(function(b){a.loadedFontFamilies[b]=!0})}function e(a){return a.replace(/\.[^\/.]+$/,"")}var f=a("webfontloader");d.prototype.setIsRunningInEditor=function(a){this.isRunningInEditor=a},d.prototype.loadFont=function(a){var b=e(a).split("/").pop();if(this.loadedFontFamilies[b])return void(this.fontCallbacks[b]&&this.fontCallbacks[b].forEach(function(a){a()}));if(!this.fontCssFamiliesAdded[b]){this.fontCssFamiliesAdded[b]=!0;var c=document.createElement("style");c.type="text/css",this.isRunningInEditor&&"/"!==a[0]&&(a="/"+a),c.appendChild(document.createTextNode("                    @font-face {                        font-family: '"+b+"';                        src: url('"+a+"');                    }                ")),document.head.appendChild(c);var d=this;f.load({timeout:6e5,custom:{families:[b]},fontactive:function(a){d.loadedFontFamilies[a]=!0,d.fontCallbacks[a]&&d.fontCallbacks[a].forEach(function(a){a()})}})}},d.prototype.callWhenFontIsActive=function(a,b){return this.loadedFontFamilies[a]?void b():(this.fontCallbacks[a]||(this.fontCallbacks[a]=[]),void this.fontCallbacks[a].push(b))},d.instance=new d,b.exports=d},{webfontloader:174}],202:[function(a,b,c){function d(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}b.exports=d},{}],203:[function(a,b,c){"use strict";function d(){this.mouseMoveListener=this._onMouseMove.bind(this),this.mouseDownListener=this._onMouseDown.bind(this),this.highlightedControl=void 0}function e(a,b){return a-b}function f(a){return g.some(function(b){return a instanceof b})}var g=[a("./uiengine/controls/circlecontrol"),a("./uiengine/controls/imagecontrol"),a("./uiengine/controls/rectanglecontrol"),a("./uiengine/controls/textcontrol"),a("./uiengine/controls/textinputcontrol")];d.prototype._onMouseMove=function(a){var b=this.uiEngine.hitTest(this._getTouchX(a)*this.uiEngine.renderer.viewportWidth,this._getTouchY(a)*this.uiEngine.renderer.viewportHeight);this.highlightedControl&&(this.highlightedControl.setHighlightEnabled(!1),this.highlightedControl=void 0);var c=Object.keys(b);c.sort(e);for(var d=!1,g=c.length-1;g>=0&&d===!1;g--)for(var h=b[c[g]],i=h.length-1;i>=0;i--)if(f(h[i])){this.highlightedControl=h[i],this.highlightedControl.setHighlightEnabled(!0),d=!0;break}},d.prototype._onMouseDown=function(a){0===a.button&&this.highlightedControl&&this.callback(this.highlightedControl.noodlNode.id)},d.prototype._getTouchX=function(a){var b=this.domElement.getBoundingClientRect(),c=b.right-b.left,d=a.pageX-b.left;return d/c},d.prototype._getTouchY=function(a){var b=this.domElement.getBoundingClientRect(),c=b.bottom-b.top,d=a.pageY-b.top;return d/c},d.prototype.enable=function(a,b){this.uiEngine=a,this.uiEngine.touchListener.setTouchEnabled(!1),this.domElement=a.renderer.renderers[0].rootElement,this.callback=b,this.domElement.addEventListener("mousemove",this.mouseMoveListener),this.domElement.addEventListener("mousedown",this.mouseDownListener)},d.prototype.disable=function(){this.domElement&&(this.uiEngine.touchListener.setTouchEnabled(!0),this.domElement.removeEventListener("mousemove",this.mouseMoveListener),this.domElement.removeEventListener("mousedown",this.mouseDownListener),this.domElement=void 0,this.callback=void 0,this.highlightedControl&&(this.highlightedControl.setHighlightEnabled(!1),this.highlightedControl=void 0))},b.exports=d},{"./uiengine/controls/circlecontrol":289,"./uiengine/controls/imagecontrol":293,"./uiengine/controls/rectanglecontrol":296,"./uiengine/controls/textcontrol":301,"./uiengine/controls/textinputcontrol":302}],204:[function(a,b,c){"use strict";function d(a,b){this.inputs={},this.outputs={},this.error=void 0;var c=e[a];if(!c)try{c=new Function("define","Noodl",a),e[a]=c}catch(d){this.error=d.message}if(c)try{c(this.define.bind(this),b)}catch(d){this.error=d.message}}var e={};d.prototype.define=function(a){this.inputs=a.inputs||{},this.outputs=a.outputs||{},this.setup=a.setup,this.run=a.run,this.definedObject=a},d.createFromCode=function(a,b){return new d(a,b)},d.createFromURL=function(a,b,c){var e=new window.XMLHttpRequest;e.open("GET",a,!0),e.onreadystatechange=function(){4!==this.readyState&&this.readyState!==XMLHttpRequest.DONE||c(new d(this.response,b))},e.onerror=function(){console.log("Failed to request",a)},e.send()},d.prototype.getPorts=function(){var a=[],b=this;return Object.keys(this.inputs).forEach(function(c){var d=b.inputs[c],e={name:c,plug:"input"};if("string"==typeof d)e.type={name:d},e.group="Inputs";else for(var f in d)e[f]=d[f];a.push(e)}),Object.keys(this.outputs).forEach(function(c){a.push({name:c,type:{name:b.outputs[c]},plug:"output",group:"Outputs"})}),a},b.exports=d},{}],205:[function(a,b,c){"use strict";function d(a){f.call(this),this.name=a,this.nodes={},this.connections=[],this.roots=[],this.inputPorts={},this.outputPorts={}}var e=a("./nodemodel"),f=a("./../eventsender"),g=a("lodash");d.prototype=Object.create(f.prototype),d.prototype.addNode=function(a){a.component=this,this.nodes[a.id]=a,this.emit("nodeAdded",a)},d.prototype.getNodeWithId=function(a){return this.nodes[a]},d.prototype.getAllNodes=function(){return g.values(this.nodes)},d.prototype.getNodesWithType=function(a){var b=[],c=this;return Object.keys(this.nodes).forEach(function(d){var e=c.nodes[d];e.type===a&&b.push(e)}),b},d.prototype.addConnection=function(a){this.connections.push(a),this.emit("connectionAdded",a)},d.prototype.removeConnection=function(a){var b=g.findIndex(this.connections,function(b){return g.isEqual(b,a)});this.connections.splice(b,1),this.emit("connectionRemoved",a)},d.prototype.getConnectionsFromPort=function(a,b){return this.connections.filter(function(c){return c.sourceId===a&&c.sourcePort===b})},d.prototype.getConnectionsToPort=function(a,b){return this.connections.filter(function(c){return c.targetId===a&&c.targetPort===b})},d.prototype.getConnectionsFrom=function(a){return this.connections.filter(function(b){return b.sourceId===a})},d.prototype.getConnectionsTo=function(a){return this.connections.filter(function(b){return b.targetId===a})},d.prototype.addRootId=function(a){this.roots.indexOf(a)===-1&&(this.roots.push(a),this.emit("rootAdded",a))},d.prototype.getFirstRootId=function(){return this.roots[0]},d.prototype.removeNodeWithId=function(a){for(var b=this.getNodeWithId(a);b.children.length>0;){var c=b.children[0];this.removeNodeWithId(c.id)}for(var d=this.getConnectionsTo(a).concat(this.getConnectionsFrom(a)),e=0;e<d.length;e++)this.removeConnection(d[e]);this.setNodeParent(b,null);var f=this.roots.indexOf(b.id);f!==-1&&(this.roots.splice(f,1),this.emit("rootRemoved",b.id)),this.emit("nodeRemoved",b),b.removeAllListeners(),delete this.nodes[a]},d.prototype.getAllConnections=function(){return this.connections},d.prototype.getInputPorts=function(){return this.inputPorts},d.prototype.getOutputPorts=function(){return this.outputPorts},d.prototype.addInputPort=function(a){this.inputPorts[a.name]=a,this.emit("inputPortAdded",a)},d.prototype.addOutputPort=function(a){this.outputPorts[a.name]=a,this.emit("outputPortAdded",a)},d.prototype.removeOutputPortWithName=function(a){if(this.outputPorts.hasOwnProperty(a)){var b=this.outputPorts[a];delete this.outputPorts[a],this.emit("outputPortRemoved",b)}},d.prototype.removeInputPortWithName=function(a){if(this.inputPorts.hasOwnProperty(a)){var b=this.inputPorts[a];delete this.inputPorts[a],this.emit("inputPortRemoved",b)}},d.prototype.renameInputPortOnNodeWithId=function(a,b,c){var d=this.getConnectionsToPort(a,b);d.forEach(this.removeConnection.bind(this));var e=this.getNodeWithId(a),f=g.clone(e.getInputPort(b));f&&(e.removeInputPortWithName(b),f.name=c,e.addInputPort(f)),d.forEach(function(a){a.targetPort=c}),d.forEach(this.addConnection.bind(this))},d.prototype.renameOutputPortOnNodeWithId=function(a,b,c){var d=this.getConnectionsFromPort(a,b);d.forEach(this.removeConnection.bind(this));var e=this.getNodeWithId(a),f=g.clone(e.getOutputPort(b));e.removeOutputPortWithName(b),f.name=c,e.addOutputPort(f),d.forEach(function(a){a.sourcePort=c}),d.forEach(this.addConnection.bind(this))},d.prototype.setNodeParent=function(a,b,c){a.parent&&(this.emit("nodeParentWillBeRemoved",a),a.parent.removeChild(a)),a.emit("parentUpdated",b),b&&(b.addChild(a,c),this.emit("nodeParentUpdated",a))},d.prototype.importEditorNodeData=function(a,b,c){var d=e.createFromExportData(a);this.addNode(d),b&&this.setNodeParent(d,this.getNodeWithId(b),c);var f=this;a.children&&a.children.forEach(function(a,b){f.importEditorNodeData(a,d.id,b)})},d.prototype.reset=function(){for(;this.roots.length;)this.removeNodeWithId(this.roots[0]);if(Object.keys(this.nodes).forEach(this.removeNodeWithId.bind(this)),this.nodes.length>0)throw new Error("Not all nodes were removed during a reset");if(this.connections.length>0)throw new Error("Not all connections were removed during a reset")},d.prototype.rename=function(a){var b=this.name;this.name=a,this.emit("renamed",{oldName:b,newName:a})},d.createFromExportData=function(a){var b=new d(a.name);return a.ports&&a.ports.forEach(function(a){"input"!==a.plug&&"input/output"!==a.plug||b.addInputPort(a),"output"!==a.plug&&"input/output"!==a.plug||b.addOutputPort(a)}),a.nodes&&a.nodes.forEach(b.importEditorNodeData.bind(b)),a.connections&&a.connections.forEach(b.addConnection.bind(b)),a.roots&&a.roots.forEach(b.addRootId.bind(b)),b},b.exports=d},{"./../eventsender":200,"./nodemodel":207,lodash:148}],206:[function(a,b,c){"use strict";function d(){f.call(this),this.components={},this.defaultDevice={canvasWidth:1080,canvasHeight:1920,fillMode:"aspectFit",renderer:"webgl",name:"Default Device"},this.settings=g.clone(h)}var e=a("./componentmodel"),f=a("./../eventsender"),g=a("lodash"),h={analyticsEnabled:!1,analyticsServerUrl:"http://localhost:8080"};d.prototype=Object.create(f.prototype),d.prototype.importComponentFromEditorData=function(a){var b=e.createFromExportData(a);this.addComponent(b)},d.prototype.importEditorData=function(a){a.settings&&this.setSettings(a.settings),a.components.forEach(this.importComponentFromEditorData.bind(this)),this.setRootComponentName(a.rootComponent),this.setRootNodeId(a.rootNode)},d.prototype.setRootComponentName=function(a){this.rootComponent=a,this.emit("rootComponentNameUpdated",a)},d.prototype.setRootNodeId=function(a){this.rootNode=a,this.emit("rootNodeIdChanged",a)},d.prototype.getNodesWithType=function(a){for(var b=[],c=Object.keys(this.components),d=0;d<c.length;d++){var e=this.components[c[d]];b=b.concat(e.getNodesWithType(a))}return b},d.prototype.getComponentWithName=function(a){return this.components[a]},d.prototype.getAllNodes=function(){for(var a=[],b=Object.keys(this.components),c=0;c<b.length;c++){var d=this.components[b[c]];a=a.concat(d.getAllNodes())}return a},d.prototype.addComponent=function(a){this.components[a.name]=a,this.getNodesWithType(a.name).forEach(this._addComponentPorts.bind(this)),a.getAllNodes().forEach(this._onNodeAdded.bind(this)),a.on("nodeAdded",this._onNodeAdded.bind(this),this),this.emit("componentAdded",a)},d.prototype.removeComponentWithName=function(a){if(this.components.hasOwnProperty(a)===!1)return void console.error("GraphModel: Component with name "+componentNamee+" not in graph");var b=this.components[a];b.reset(),b.removeAllListeners(),delete this.components[b.name],this.emit("componentRemoved",b)},d.prototype.renameComponent=function(a,b){if(this.components.hasOwnProperty(a)===!1)return void console.error("GraphModel: Component with name "+componentNamee+" not in graph");this.getNodesWithType(a).forEach(function(a){a.type=b});var c=this.components[a];c.rename(b),delete this.components[a],this.components[b]=c},d.prototype._addComponentPorts=function(a){if(this.components.hasOwnProperty(a.type)){var b=this.components[a.type];g.forIn(b.getInputPorts(),a.addInputPort.bind(a)),g.forIn(b.getOutputPorts(),a.addOutputPort.bind(a))}},d.prototype._onNodeAdded=function(a){this._addComponentPorts(a),this.emit("nodeAdded",a),this.emit("nodeAdded."+a.type,a)},d.prototype.reset=function(){var a=this;Object.keys(this.components).forEach(function(b){a.removeComponentWithName(b)}),this.settings=g.clone(h),this.devices={}},d.prototype.isEmpty=function(){return 0===Object.keys(this.components).length},d.prototype.setSettings=function(a){if(a.hasOwnProperty("analyticsEnabed")&&(this.settings.analyticsEnabled=a.analyticsEnabled),a.hasOwnProperty("analyticsServerUrl")&&(this.settings.analyticsServerUrl=a.analyticsServerUrl),this.settings.mqttUseExternalBroker=a.mqttUseExternalBroker,this.settings.mqttBrokerUrl=a.mqttBrokerUrl,this.settings.mqttBrokerType=a.mqttBrokerType,a.devices){this.devices={};var b=this,c=a.devices.split(",");c.forEach(function(c){b.devices[c]={fillMode:a[c+".fillMode"]||b.defaultDevice.fillMode,canvasWidth:a[c+".canvasWidth"]||b.defaultDevice.canvasWidth,canvasHeight:a[c+".canvasHeight"]||b.defaultDevice.canvasHeight,renderer:a[c+".renderer"]||b.defaultDevice.renderer,rootComponent:a[c+".rootComponent"],name:c}}),this.defaultDeviceName=c[0]}this.projectSettings=a,this.emit("settingsUpdated")},d.prototype.getSettings=function(){return this.settings},d.prototype.getDeviceSettings=function(a){return a&&this.devices.hasOwnProperty(a)!==!1||(a=this.defaultDeviceName),a?this.devices[a]:this.defaultDevice},d.prototype.getRawProjectSettings=function(){return this.projectSettings||{}},b.exports=d},{"./../eventsender":200,"./componentmodel":205,lodash:148}],207:[function(a,b,c){"use strict";function d(a,b){e.call(this),this.id=a,this.type=b,this.inputs=[],this.outputs=[],this.children=[],this.parameters={},this.inputPorts={},this.outputPorts={}}var e=a("./../eventsender");d.prototype=Object.create(e.prototype),d.prototype.setParameter=function(a,b){this.parameters[a]=b,this.emit("parameterUpdated",{name:a,value:b})},d.prototype.setParameters=function(a){var b=this;Object.keys(a).forEach(function(c){b.setParameter(c,a[c])})},d.prototype.addInputPort=function(a){this.inputPorts[a.name]=a,this.emit("inputPortAdded",a)},d.prototype.getInputPort=function(a){return this.inputPorts[a]},d.prototype.getInputPorts=function(){return this.inputPorts},d.prototype.removeInputPortWithName=function(a){if(this.inputPorts.hasOwnProperty(a)){var b=this.inputPorts[a];delete this.inputPorts[a],this.emit("inputPortRemoved",b)}},d.prototype.addOutputPort=function(a){this.outputPorts[a.name]=a,this.emit("outputPortAdded",a)},d.prototype.getOutputPort=function(a){return this.outputPorts[a]},d.prototype.getOutputPorts=function(){return this.outputPorts},d.prototype.removeOutputPortWithName=function(a){if(this.outputPorts.hasOwnProperty(a)){var b=this.outputPorts[a];delete this.outputPorts[a],this.emit("outputPortRemoved",b)}},d.prototype.addChild=function(a,b){a.parent=this,void 0===b?this.children.push(a):this.children.splice(b,0,a)},d.prototype.removeChild=function(a){a.parent=void 0;var b=this.children.indexOf(a);this.children.splice(b,1)},d.prototype.reset=function(){this.removeAllListeners()},d.createFromExportData=function(a){var b=new d(a.id,a.type);return a.parameters&&b.setParameters(a.parameters),a.ports&&a.ports.forEach(function(a){"outputs"===a.plug&&(a.plug="output"),"input"!==a.plug&&"input/output"!==a.plug||b.addInputPort(a),"output"!==a.plug&&"input/output"!==a.plug||b.addOutputPort(a)}),b},b.exports=d},{"./../eventsender":200}],208:[function(a,b,c){"use strict";function d(a){this.context=a,this._dirty=!1,this._cachedInputValues={},this._inputs={},this.numberedInputs={},this._outputs={},this._inputConnections={},this._outputList=[],this._isUpdating=!1,this._inputValuesQueue={},this._afterInputsHaveUpdatedCallbacks=[],this._internal={},this._signalsSentThisUpdate={}}function e(a){var b=a.split(" ");return b.splice(-1,1),b.join(" ")}var f=a("./outputproperty");Object.defineProperties(d.prototype,{registerInput:{value:function(a,b){if(this.hasInput(a))throw new Error("Input property "+a+" already registered");this._inputs[a]=b,b.hasOwnProperty("default")&&(this._cachedInputValues[a]=b.default)}},deregisterInput:{value:function(a){if(this.hasInput(a)===!1)throw new Error("Input property "+a+" doesn't exist");delete this._inputs[a],delete this._cachedInputValues[a]}},registerInputs:{value:function(a){for(var b in a)this.registerInput(b,a[b])}},_registerSelectors:{value:function(a){var b=this;Object.keys(a).forEach(function(c){var d=a[c],e={set:function(a){var c=a.split(" "),e=Number(c[c.length-1]);d.set.call(b,e)}};b.registerInput(c,e)})}},registerNumberedInput:{value:function(a,b){if(this.hasNumberedInput(a))throw new Error("Numbered input property "+a+" already registered");this.numberedInputs[a]=b,b.selectors&&this._registerSelectors(b.selectors)}},getInput:{value:function(a){if(this.hasInput(a)===!1)throw new Error("Node "+this.name+": Invalid input property "+a);return this._inputs[a]}},hasInput:{value:function(a){return a in this._inputs}},hasNumberedInput:{value:function(a){return this.numberedInputs.hasOwnProperty(a)}},registerInputIfNeeded:{value:function(a){this.hasInput(a)===!1&&this._isUnregisteredNumberedInput(a)&&this._registerNumberedInputInstance(a)}},_isUnregisteredNumberedInput:{value:function(a){var b=e(a);return this.numberedInputs.hasOwnProperty(b)}},_registerNumberedInputInstance:{value:function(a){var b=a.split(" "),c=b[b.length-1];if(isNaN(c))throw new Error("Numbered input with name "+a+" doesn't end with a number");c=Number(c);var d=this.numberedInputs[e(a)],f={name:d.name,set:d.createSetter.call(this,c)};this.registerInput(a,f)}},setInputValue:{value:function(a,b,c){this._cachedInputValues[a]=b;var d=this.getInput(a);c?d.set.call(this,b,c):d.set.call(this,b)}},hasOutput:{value:function(a){return a in this._outputs}},registerOutput:{value:function(a,b){if(this.hasOutput(a))throw new Error("Output property "+a+" already registered");var c=new f({owner:this,getter:b.getter,name:a});this._outputs[a]=c,this._outputList.push(c)}},deregisterOutput:{value:function(a){if(this.hasOutput(a)===!1)throw new Error("Output property "+a+" isn't registered");var b=this._outputs[a];if(b.hasConnections())throw new Error("Output property "+a+" has connections and can't be removed");delete this._outputs[a];var c=this._outputList.indexOf(b);this._outputList.splice(c,1)}},registerOutputs:{value:function(a){for(var b in a)this.registerOutput(b,a[b])}},registerOutputIfNeeded:{value:function(){}},getOutput:{value:function(a){if(this.hasOutput(a)===!1)throw new Error("Node "+this.name+" doesn't have a port named "+a);return this._outputs[a]}},connectInput:{value:function(a,b,c){if(this.hasInput(a)===!1)throw new Error("Invalid connection, input doesn't exist. Trying to connect from "+b.name+" output "+c+" to "+this.name+" input "+a);var d=b.getOutput(c);if(d.registerConnection(this,a),this._inputConnections[a]||(this._inputConnections[a]=[],this._inputValuesQueue[a]=[]),this._inputConnections[a].push(d),b._signalsSentThisUpdate[c])this.queueInput(a,!0),this.queueInput(a,!1);else{var e=d.value;void 0!==e&&this.queueInput(a,e)}this.flagDirty()}},removeInputConnection:{value:function(a,b,c){if(!this._inputConnections[a])throw new Error("Node removeInputConnection: Input doesn't exist");for(var d=this._inputConnections[a],e=0;e<d.length;e++){var f=d[e];if(f.owner.id===b&&f.name===c){d.splice(e,1);var g=f.owner.getOutput(c);g.deregisterConnection(this,a);break}}}},isInputConnected:{value:function(a){return this._inputConnections.hasOwnProperty(a)}},update:{value:function(){if(!this._isUpdating&&this._dirty!==!1){this._isUpdating=!0;for(var a,b=0;this._dirty&&b<100;){this._updateDependencies(),this._dirty=!1;for(var c=!0,d=Object.keys(this._inputValuesQueue);c;){for(c=!1,a=0;a<d.length;a++){var e=d[a],f=this._inputValuesQueue[e];if(f.length>0){var g=f.shift();null!==g&&"object"==typeof g&&g.hasOwnProperty("value")&&g.hasOwnProperty("unit")?this.setInputValue(e,g.value,g.unit):this.setInputValue(e,g),f.length>0&&(c=!0)}}var h=this._afterInputsHaveUpdatedCallbacks;for(this._afterInputsHaveUpdatedCallbacks=[],a=0;a<h.length;a++)h[a].call(this)}b++}this._isUpdating=!1}}},_updateDependencies:{value:function(){for(var a in this._inputConnections)for(var b=this._inputConnections[a],c=0;c<b.length;++c)"reference"!==b[c].type&&b[c].owner.update()}},flagDirty:{value:function(){if(!this._dirty){this._dirty=!0,this.context&&this.context.nodeIsDirty(this);for(var a=0;a<this._outputList.length;++a)this._outputList[a].flagDependeesDirty()}}},sendValue:{value:function(a,b){if(this.hasOutput(a)===!1)return void console.log("Error: Node",this.name,"doesn't have a output named",a);var c=this.getOutput(a);c.hasConnections()!==!1&&void 0!==b&&(c.sendValue(b),this.context&&this.context.connectionSentValue(c,b))}},flagOutputDirty:{value:function(a){var b=this.getOutput(a);b.hasConnections()!==!1&&this.sendValue(a,b.value)}},flagAllOutputsDirty:{value:function(a){for(var b=0;b<this._outputList.length;++b){var c=this._outputList[b];this.sendValue(c.name,c.value)}}},sendSignalOnOutput:{value:function(a){this.sendValue(a,!0),this.sendValue(a,!1),this._signalsSentThisUpdate[a]=!0,this.scheduleAfterInputsHaveUpdated(function(){this._signalsSentThisUpdate[a]=!1})}},queueInput:{value:function(a,b,c){this._inputValuesQueue[a]||(this._inputValuesQueue[a]=[]),c?this._inputValuesQueue[a].push({value:b,unit:c}):this._inputValuesQueue[a].push(b),this.flagDirty()}},scheduleAfterInputsHaveUpdated:{value:function(a){this._afterInputsHaveUpdatedCallbacks.push(a),this.flagDirty()}},setNodeModel:{value:function(a){this.model=a,a.on("parameterUpdated",this._onNodeModelParameterUpdated,this);var b=this;a.on("inputPortRemoved",function(a){b.hasInput(a.name)&&b.deregisterInput(a.name)},this),a.on("outputPortRemoved",function(a){b.hasOutput(a.name)&&b.deregisterOutput(a.name)},this)}},_onNodeDeleted:{value:function(){this.model&&(this.model.removeListenersWithRef(this),this.model=void 0)}},_onNodeModelParameterUpdated:{value:function(a){this.registerInputIfNeeded(a.name),"object"==typeof a.value&&a.value.hasOwnProperty("unit")?this.queueInput(a.name,a.value.value,a.value.unit):this.queueInput(a.name,a.value)}}}),b.exports=d},{"./outputproperty":282}],209:[function(a,b,c){"use strict";function d(a){if(a=a||{},a.runningInEditor=!!a.hasOwnProperty("runningInEditor")&&a.runningInEditor,this._dirtyNodes=[],this.callbacksAfterUpdate=[],this.eventEmitter=new e,this.eventEmitter.setMaxListeners(1e3),this.eventSenderEmitter=new e,this.eventSenderEmitter.setMaxListeners(1e4),this.globalValues={},this.globalsEventEmitter=new e,this.globalsEventEmitter.setMaxListeners(1e3),this.runningInEditor=a.runningInEditor,this.currentFrameTime=0,this.nodeRegister=new f(this),this.timerScheduler=new g(this.scheduleFrame.bind(this)),this.componentModels={},this.outputCollectionEnabled=!1,this.connectionsToPulse={},this.connectionsToPulseChanged=!1,this.connectionsToInspect={},this.inspectedConnectionValuesToSendQueue=[],this.connectionPulsingCallbackScheduled=!1,this.editorConnection=a.editorConnection,this.rootComponent=void 0,this.editorConnection&&this.editorConnection.on("connectionInspectorsUpdated",this.onConnectionInspectorsUpdated.bind(this)),a.uiEngineClass){var b=a.uiEngineClass;this.uiEngine=new b(this.timerScheduler,document.body),this.uiEngine.eventSender.on("requestFrame",this.scheduleFrame.bind(this))}}var e=a("events").EventEmitter,f=a("./noderegister"),g=a("./timerscheduler");d.prototype.setRootComponent=function(a){this.rootComponent=a,a.getVisualRoot()&&this.uiEngine.root.addChild(a.getVisualRoot()._internal.uiControl)},d.prototype.onConnectionInspectorsUpdated=function(a){var b={};a.forEach(function(a){var c=a.fromId+a.fromProperty;b[c]=a}),this.connectionsToInspect=b,this.sendConnectionsToInspectValues()},d.prototype.layout=function(){this.uiEngine&&this.uiEngine.layout()},d.prototype.update=function(){for(var a,b,c=!0,d=0;c&&d<10;){this.layout();var e=this._dirtyNodes;for(this._dirtyNodes=[],a=0,b=e.length;a<b;++a)e[a].update();var f=this.callbacksAfterUpdate;for(this.callbacksAfterUpdate=[],a=0,b=f.length;a<b;a++)f[a]();this.layout(),c=this.callbacksAfterUpdate.length>0||this._dirtyNodes.length>0,d++}this.timerScheduler.hasPendingTimers()&&(this.scheduleFrame(),this.timerScheduler.runTimers(this.currentFrameTime)),this.flushConnectionsToInspect()},d.prototype.flushConnectionsToInspect=function(){this.connectionsToPulseChanged&&(this.connectionsToPulseChanged=!1,this.editorConnection.sendPulsingConnections(this.connectionsToPulse)),this.inspectedConnectionValuesToSendQueue.length>0&&(this.editorConnection.sendConnectionValues(this.inspectedConnectionValuesToSendQueue),this.inspectedConnectionValuesToSendQueue=[])},d.prototype.reset=function(){this.eventEmitter.emit("applicationDataReloaded");var a=this.eventEmitter;["frameStart","frameEnd"].forEach(function(b){a.removeAllListeners(b)}),this.globalValues={},this._dirtyNodes.length=0,this.callbacksAfterUpdate.length=0,this.timerScheduler.runningTimers=[],this.timerScheduler.newTimers=[],this.rootComponent=void 0,this.clearAllConnectionInspections()},d.prototype.nodeIsDirty=function(a){this._dirtyNodes.push(a),this.scheduleFrame()},d.prototype.scheduleFrame=function(){this.eventEmitter.emit("scheduleFrame")},d.prototype.scheduleAfterUpdate=function(a){this.callbacksAfterUpdate.push(a),this.scheduleFrame()},d.prototype.scheduleNextFrame=function(a){this.eventEmitter.once("frameStart",a),this.scheduleFrame()},d.prototype.setGlobalValue=function(a,b){this.globalValues[a]=b,this.globalsEventEmitter.emit(a)},d.prototype.reloadApplication=function(){this.eventEmitter.emit("reloadApplication")},d.prototype.registerComponentModel=function(a){if(this.componentModels.hasOwnProperty(a.name))throw new Error("Duplicate component name "+a.name);this.componentModels[a.name]=a;var b=this;a.on("renamed",function(c){delete b.componentModels[c.oldName],b.componentModels[c.newName]=a},this)},d.prototype.deregisterComponentModel=function(a){this.componentModels.hasOwnProperty(a.name)&&(this.componentModels[a.name].removeListenersWithRef(this),delete this.componentModels[a.name])},d.prototype.getComponentModel=function(a){if(!a)throw new Error("Component instance must have a name");if(this.componentModels.hasOwnProperty(a)===!1)throw new Error("Unknown component "+a);return this.componentModels[a]},d.prototype.hasComponentModelWithName=function(a){return this.componentModels.hasOwnProperty(a)},d.prototype.createComponentInstanceNode=function(b){var c=this.getComponentModel(b),d=a("./nodes/componentinstance"),e=new d(this);return e.name=b,e.setComponentModel(c),e},d.prototype._sendConnectionValue=function(a,b){if(this.connectionsToInspect.hasOwnProperty(a.id)&&this.inspectedConnectionValuesToSendQueue.push({id:a.id,value:b}),this.connectionsToPulse.hasOwnProperty(a.id))return void(this.connectionsToPulse[a.id].timestamp="undefined"!=typeof window?window.performance.now():+new Date);var c=[];a.connections.forEach(function(b){c.push(a.owner.id+a.name+b.node.id+b.inputPortName)}),this.connectionsToPulse[a.id]={timestamp:"undefined"!=typeof window?window.performance.now():+new Date,connections:c},this.connectionsToPulseChanged=!0,this.connectionPulsingCallbackScheduled===!1&&(this.connectionPulsingCallbackScheduled=!0,setTimeout(this.clearOldConnectionPulsing.bind(this),100))},d.prototype.connectionSentValue=function(a,b){this.editorConnection&&this.editorConnection.isConnected()&&this.outputCollectionEnabled&&this._sendConnectionValue(a,b)},d.prototype.clearAllConnectionInspections=function(){this.connectionsToInspect={},this.connectionsToPulse={},this.editorConnection.sendPulsingConnections(this.connectionsToPulse)},d.prototype.clearOldConnectionPulsing=function(){this.connectionPulsingCallbackScheduled=!1;var a="undefined"!=typeof window?window.performance.now():+new Date,b=this,c=Object.keys(this.connectionsToPulse);c.forEach(function(c){var d=b.connectionsToPulse[c];a-d.timestamp>100&&(b.connectionsToPulseChanged=!0,delete b.connectionsToPulse[c])}),this.connectionsToPulseChanged&&(this.connectionsToPulseChanged=!1,this.editorConnection.sendPulsingConnections(this.connectionsToPulse)),Object.keys(this.connectionsToPulse).length>0&&(this.connectionPulsingCallbackScheduled=!0,setTimeout(this.clearOldConnectionPulsing.bind(this),100))},d.prototype.sendConnectionsToInspectValues=function(){var a=this,b=[];Object.keys(this.connectionsToInspect).forEach(function(c){var d=a.connectionsToInspect[c],e=a.rootComponent.nodeScope.getNodesWithIdRecursive(d.toId);if(e.length>0){var f=e[e.length-1],g=f._cachedInputValues[d.toProperty];"object"==typeof g&&"Node"===g.constructor.name&&(g="<Node> "+g.name),b.push({id:c,value:g
})}}),b.length>0&&this.editorConnection.sendConnectionValues(b)},d.prototype.setOutputCollectionEnabled=function(a){this.outputCollectionEnabled=a,a&&this.sendConnectionsToInspectValues()},d.prototype.sendGlobalEventFromEventSender=function(a,b){this.eventSenderEmitter.emit(a,b),this.sessionRecorder&&this.sessionRecorder.appendEvent(a)},d.prototype.setSessionRecorder=function(a){this.sessionRecorder=a},b.exports=d},{"./noderegister":212,"./nodes/componentinstance":217,"./timerscheduler":288,events:8}],210:[function(a,b,c){"use strict";function d(a,b,c,d){if(a.hasOwnProperty(c))throw new Error("Input property "+c+" already registered");d.set&&(a[c]={set:d.set}),d.setUnitType&&(a[c].setUnitType=d.setUnitType),b.inputs[c]={displayName:d.displayName,editorName:d.editorName,group:d.group,type:d.type,default:d.default,index:d.index,exportToEditor:!d.hasOwnProperty("exportToEditor")||d.exportToEditor,inputPriority:d.inputPriority||0},d.valueChangedToTrue&&(b.inputs[c].type={name:"boolean",allowConnectionsOnly:!0})}function e(a,b,c,d){if(a.hasOwnProperty(c))throw new Error("Input property "+c+" already registered");a[c]={createSetter:d.createSetter},b.numberedInputs[c]={displayPrefix:d.displayPrefix,group:d.group,name:d.name},d.selectors&&(b.numberedInputs[c].selectors={},a[c].selectors={},Object.keys(d.selectors).forEach(function(e){var f=d.selectors[e];b.numberedInputs[c].selectors[e]={displayName:f.displayName,editorName:f.editorName,group:f.group},a[c].selectors[e]={set:f.set}}))}function f(a,b,c){Object.keys(c).forEach(function(e){d(a,b,e,c[e])})}function g(a,b){Object.keys(b).forEach(function(c){var d=b[c];a.outputs[c]={displayName:d.displayName,editorName:d.editorName,group:d.group,type:d.type,index:d.index,exportToEditor:!d.hasOwnProperty("exportToEditor")||d.exportToEditor}})}function h(a,b){Object.keys(b).forEach(function(c){a[c]=b[c].default})}function i(a){function b(a){k.call(this,a)}if(!a.category)throw new Error("Node must have a category");if(!a.name)throw new Error("Node must have a name");var c={inputs:{},outputs:{},numberedInputs:{},category:a.category,dynamicports:a.dynamicports,allowChildren:a.allowChildren,allowChildrenWithCategory:a.allowChildrenWithCategory,allowAsChild:a.allowAsChild,panels:a.panels,color:a.color,usePortAsLabel:a.usePortAsLabel,portLabelTruncationMode:a.portLabelTruncationMode,name:a.name,displayNodeName:a.displayNodeName,deprecated:a.deprecated,haveComponentPorts:a.haveComponentPorts,version:a.version};a._internal=a._internal||{},a.prototypeExtensions=a.prototypeExtensions||{},a.inputs=a.inputs||{},a.outputs=a.outputs||{},a.numberedInputs=a.numberedInputs||{},a.initialize=a.initialize||function(){};var d={},i={};f(d,c,a.inputs),g(c,a.outputs),Object.keys(a.numberedInputs).forEach(function(b){e(i,c,b,a.numberedInputs[b])}),Object.keys(a.prototypeExtensions).forEach(function(b){a.prototypeExtensions[b].value||(a.prototypeExtensions[b]={value:a.prototypeExtensions[b]})}),b.prototype=Object.create(k.prototype,a.prototypeExtensions),Object.defineProperty(b.prototype,"name",{value:a.name});var j=function(e){var f=new b(e);return f._inputs=Object.create(d),Object.keys(a.inputs).forEach(function(b){var c=a.inputs[b];c.valueChangedToTrue&&(f._inputs[b]={set:l.createSetter({valueChangedToTrue:c.valueChangedToTrue})})}),Object.keys(a.outputs).forEach(function(b){var c=a.outputs[b];"signal"===c.type?f.registerOutput(b,{getter:function(){return!1}}):f.registerOutput(b,c)}),Object.keys(i).forEach(function(a){f.registerNumberedInput(a,i[a])}),h(f._cachedInputValues,c.inputs),a.initialize.call(f),f};return j.metadata=c,j}function j(a,b){for(var c in b)if("initialize"===c&&a.initialize){var d=a.initialize;a.initialize=function(){d.call(this),b.initialize.call(this)}}else b[c]&&b[c].constructor===Object?a[c]=j(a[c]||{},b[c]):a[c]=b[c];return a}var k=a("./node"),l=a("./edgetriggeredinput");b.exports={defineNode:i,extend:j}},{"./edgetriggeredinput":197,"./node":208}],211:[function(a,b,c){"use strict";function d(a){var b={typecasts:[{from:"boolean",to:["number","string","signal"]},{from:"number",to:["boolean","string"]},{from:"string",to:["number","boolean","image","color"]},{from:"signal",to:["boolean","number"]},{from:"image",to:[]},{from:"color",to:[]},{from:"enum",to:[]},{from:"object",to:[]},{from:"reference",to:[]},{from:"font",to:[]}],dynamicports:[{type:"conditionalports",name:"basic"},{type:"expand",name:"basic"},{type:"portchannel",name:"event-sender-channel",channelPortname:"channelName",typename:"Event Sender",ignorePorts:["channelName","sendEvent","propagation"]},{type:"numbered",name:"simple-number",port:{type:"number"}},{type:"numbered",name:"simple-boolean",port:{type:"boolean"}},{type:"numbered",name:"simple-string",port:{type:"string"}},{type:"numbered",name:"simple-color",port:{type:"color"}}],colors:{nodes:{component:{base:"#6e3599",baseHighlighted:"#8440b8",header:"#6e3599",headerHighlighted:"#8440b8",outline:"#6e3599",outlineHighlighted:"#b58900",text:"#ffffff"},visual:{base:"#2a4e6e",baseHighlighted:"#376690",header:"#2a4e6e",headerHighlighted:"#376690",outline:"#2a4e6e",outlineHighlighted:"#b58900",text:"#ffffff"},data:{base:"#6d8241",baseHighlighted:"#2f8d22",header:"#6d8241",headerHighlighted:"#2f8d22",outline:"#6d8241",outlineHighlighted:"#b58900",text:"#ffffff"},javascript:{base:"#a24176",baseHighlighted:"#ab5484",header:"#a24176",headerHighlighted:"#ab5484",outline:"#ab5484",outlineHighlighted:"#d57bab",text:"#ffffff"},default:{base:"#3e434e",baseHighlighted:"#505768",header:"#3e434e",headerHighlighted:"#505768",outline:"#3e434e",outlineHighlighted:"#b58900",text:"#ffffff"}},connections:{signal:{normal:"#468c8c",highlighted:"#73babb",pulsing:"#92d9d8"},default:{normal:"#916311",highlighted:"#ffa300",pulsing:"#ffe85d"}}},nodetypes:[{name:"Component Children",color:"component",panels:"none",allowAsChild:!0,category:"Visual",haveComponentChildren:["Visual"]}]},c=Object.keys(a._constructors);return c.forEach(function(c){function d(a,b){var c={name:a,type:b.type,plug:"output"};b.group&&(c.group=b.group),b.displayName&&(c.displayName=b.displayName),b.editorName&&(c.editorName=b.editorName),f.ports.push(c)}var e=a._constructors[c].metadata,f={name:c};b.nodetypes.push(f),e.version&&(f.version=e.version),e.displayNodeName&&(f.displayNodeName=e.displayNodeName),e.deprecated&&(f.deprecated=!0),e.haveComponentPorts&&(f.haveComponentPorts=!0),"Visual"===e.category&&(f.allowAsChild=!0,f.allowAsExportRoot=!0,f.color="visual"),e.allowChildren&&(f.allowChildrenWithCategory=["Visual"],f.color="visual"),e.allowChildrenWithCategory&&(f.allowChildrenWithCategory=e.allowChildrenWithCategory),e.allowAsChild&&(f.allowAsChild=!0),f.category=e.category,e.panels&&(f.panels=e.panels),e.usePortAsLabel&&(f.usePortAsLabel=e.usePortAsLabel,f.portLabelTruncationMode=e.portLabelTruncationMode),e.color&&(f.color=e.color),e.dynamicports&&(f.dynamicports=e.dynamicports),f.ports=[];var g=[],h={},i={};e.dynamicports&&(e.dynamicports.filter(function(a){return"conditionalports/basic"===a.name}).forEach(function(a){a.ports.forEach(function(a){i[a.plug+"/"+a.name]=!0})}),e.dynamicports.filter(function(a){return void 0!==a.channelPort}).forEach(function(a){i[a.channelPort.plug+"/"+a.channelPort.name]=!0})),e.numberedInputs&&Object.keys(e.numberedInputs).forEach(function(a){var b=e.numberedInputs[a],c={name:b.name,prefix:a};b.displayPrefix&&(c.displayPrefix=b.displayPrefix);var d={plug:"input"};if(b.group&&(d.group=b.group),c.port=d,b.selectors){var f=[];Object.keys(b.selectors).forEach(function(a){var c=b.selectors[a];h[a]=!0;var d={name:a,plug:"input"};c.displayName&&(d.displayName=c.displayName),c.editorName&&(d.editorName=c.editorName),c.group&&(d.group=c.group),d.allowEditOnly=!0,f.push(d)}),c.selectors=f}g.push(c)}),g.length&&(f.dynamicports=g),Object.keys(e.inputs).forEach(function(a){if(!h.hasOwnProperty("input/"+a)&&!i.hasOwnProperty("input/"+a)){var b=e.inputs[a];if(b.exportToEditor!==!1){var c={name:a,type:b.type,plug:"input"};b.group&&(c.group=b.group),b.displayName&&(c.displayName=b.displayName),b.editorName&&(c.editorName=b.editorName),void 0!==b.default&&(c.default=b.default),b.hasOwnProperty("index")&&(c.index=b.index),f.ports.push(c)}}}),Object.keys(e.outputs).forEach(function(a){if(!h.hasOwnProperty("output/"+a)&&!i.hasOwnProperty("output/"+a)){var b=e.outputs[a];d(a,b)}})}),b}b.exports=d},{}],212:[function(a,b,c){"use strict";function d(a){this._constructors={},this.context=a}d.prototype.register=function(a){var b=a.metadata.name;if(this._constructors.hasOwnProperty(b))throw new Error("Node with name "+b+" already registered");this._constructors[b]=a},d.prototype.createNode=function(a){if(this._constructors.hasOwnProperty(a)===!1)throw new Error("Unknown node type with name "+a);return this._constructors[a](this.context)},d.prototype.getNodeMetadata=function(a){if(this._constructors.hasOwnProperty(a)===!1)throw new Error("Unknown node type with name "+a);return this._constructors[a].metadata},d.prototype.hasNode=function(a){return this._constructors.hasOwnProperty(a)},b.exports=d},{}],213:[function(a,b,c){"use strict";function d(a){return!a}var e=a("../nodedefinition");b.exports=e.defineNode({name:"And",category:"Logic",initialize:function(){this._internal.inputs=[]},numberedInputs:{input:{name:"numbered/simple-boolean",displayPrefix:"Input",createSetter:function(a){return this._internal.inputs[a]=!1,function(b){this._internal.inputs[a]!==b&&(this._internal.inputs[a]=b,this.flagOutputDirty("result"))}}}},outputs:{result:{type:"boolean",displayName:"Result",getter:function(){var a=this._internal.inputs;return a.length>0&&a.some(d)===!1}}}})},{"../nodedefinition":210}],214:[function(a,b,c){"use strict";function d(a){this.name=a.name,this.startValue=0,this.endValue=0,this.currentValue=void 0,this.startMode="implicit",this.ease=a.ease,this.node=a.node,this.hasSampledStartValue=!1;var b=this;this.animation=a.node.context.timerScheduler.createTimer({startValue:0,endValue:0,onRunning:function(a){var c=b.ease(this.startValue,this.endValue,a);b.setCurrentValue(c)}}),this.animation.startValue=0,this.animation.endValue=0}var e=(a("../node"),a("../nodedefinition")),f=a("../easecurves"),g=a("bezier-easing");Object.defineProperties(d.prototype,{setCurrentValue:{value:function(a){this.currentValue=a,this.node.flagOutputDirty(this.name)}},play:{value:function(a,b){if(void 0===a&&(console.log("Animation warning, start value is undefined"),a=0),void 0===b)return void console.error("Animation error, start:",a,"end:",b);var c=this.animation;c.startValue=a,this.setCurrentValue(a),c.endValue=b,c.duration=this.node._internal.duration,c.start()}},playToEnd:{value:function(){this.hasConnections()!==!1&&(this.updateStartValue(),this.play(this.getTargetsCurrentValue(),this.endValue))}},playToStart:{value:function(){this.hasConnections()!==!1&&(this.updateStartValue(),this.play(this.getTargetsCurrentValue(),this.startValue))}},replayToEnd:{value:function(){this.hasConnections()!==!1&&(this.updateStartValue(),this.play(this.startValue,this.endValue))}},replayToStart:{value:function(){this.hasConnections()!==!1&&this.play(this.endValue,this.startValue)}},hasConnections:{value:function(){return this.node.getOutput(this.name).hasConnections()}},getTargetsCurrentValue:{value:function(){var a=this.node.getOutput(this.name).connections;return a[0].node._cachedInputValues[a[0].inputPortName]}},updateStartValue:{value:function(){"implicit"!==this.startMode||this.hasSampledStartValue||(this.hasSampledStartValue=!0,this.startValue=this.getTargetsCurrentValue())}},stop:{value:function(){this.animation.stop(),this.setCurrentValue(void 0)}},jumpToStart:{value:function(){this.animation.stop(),this.setCurrentValue(this.startValue)}},jumpToEnd:{value:function(){this.animation.stop(),this.setCurrentValue(this.endValue)}}});var h=[{value:"easeOut",label:"Ease Out"},{value:"easeIn",label:"Ease In"},{value:"linear",label:"Linear"},{value:"easeInOut",label:"Ease In Out"},{value:"cubicBezier",label:"Cubic Bezier"}],i=300,j={name:"Animation",category:"Animation",initialize:function(){var a=this._internal;a.duration=i,a.ease=f.easeOut,a._isPlayingToEnd=!1,a.animations=[],a.cubicBezierPoints=[0,0,0,0],a.cubicBezierFunction=void 0;var b=this;a.animation=this.context.timerScheduler.createTimer({onFinish:function(){a._isPlayingToEnd===!1?b.sendSignalOnOutput("hasReachedStart"):b.sendSignalOnOutput("hasReachedEnd")}})},inputs:{duration:{index:0,type:"number",displayName:"Duration (ms)",group:"Animation Properties",default:i,set:function(a){this._internal.duration=a}},easingCurve:{index:10,type:{name:"enum",enums:h},group:"Animation Properties",displayName:"Easing Curve",default:"easeOut",set:function(a){var b;"cubicBezier"===a?(this.updateCubicBezierFunction(),b=this._internal.cubicBezierFunction):b=f[a],this._internal.ease=b}},playToEnd:{index:20,group:"Play",displayName:"To End",editorName:"Play To End",valueChangedToTrue:function(){this._internal._isPlayingToEnd=!0;var a=this._internal.animation,b=this._internal.animations,c=this;this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].playToEnd()})}},playToStart:{index:21,group:"Play",displayName:"To Start",editorName:"Play To Start",valueChangedToTrue:function(){this._internal._isPlayingToEnd=!1;var a=this._internal.animation,b=this._internal.animations,c=this;this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].playToStart()})}},replayToEnd:{index:22,group:"Play",displayName:"From Start To End",editorName:"Play From Start To End",valueChangedToTrue:function(){var a=this._internal.animation,b=this._internal.animations,c=this;this._internal._isPlayingToEnd=!0,this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].replayToEnd()})}},replayToStart:{index:23,group:"Play",displayName:"From End To Start",editorName:"Play From End To Start",valueChangedToTrue:function(){this._internal._isPlayingToEnd=!1;var a=this._internal.animation,b=this._internal.animations,c=this;this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].replayToStart()})}},stop:{index:60,group:"Instant Actions",displayName:"Stop",valueChangedToTrue:function(){var a=this._internal.animation,b=this._internal.animations;a.stop();for(var c=0;c<b.length;c++)b[c].stop()}},jumpToStart:{index:61,group:"Instant Actions",displayName:"Jump To Start",valueChangedToTrue:function(){for(var a=this._internal.animations,b=0;b<a.length;b++)a[b].jumpToStart();this.sendSignalOnOutput("hasReachedStart")}},jumpToEnd:{index:62,group:"Instant Actions",displayName:"Jump To End",valueChangedToTrue:function(){for(var a=this._internal.animations,b=0;b<a.length;b++)a[b].jumpToEnd();this.sendSignalOnOutput("hasReachedEnd")}},cubicBezierP1X:{set:function(a){this._internal.cubicBezierPoints[0]=Math.min(1,Math.max(0,a)),this.updateCubicBezierFunction()}},cubicBezierP1Y:{set:function(a){this._internal.cubicBezierPoints[1]=a,this.updateCubicBezierFunction()}},cubicBezierP2X:{set:function(a){this._internal.cubicBezierPoints[2]=Math.min(1,Math.max(0,a)),this.updateCubicBezierFunction()}},cubicBezierP2Y:{set:function(a){this._internal.cubicBezierPoints[3]=a,this.updateCubicBezierFunction()}}},outputs:{hasReachedStart:{type:"signal",group:"Signals",displayName:"Has Reached Start"},hasReachedEnd:{type:"signal",group:"Signals",displayName:"Has Reached End"}},dynamicports:[{name:"conditionalports/basic",condition:"easingCurve = cubicBezier",ports:[{name:"cubicBezierP1X",displayName:"P1 X",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:11},{name:"cubicBezierP1Y",displayName:"P1 Y",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:12},{name:"cubicBezierP2X",displayName:"P2 X",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:13},{name:"cubicBezierP2Y",displayName:"P2 Y",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:14}]},{name:"expand/basic",indexStep:100,template:[{name:"{{portname}}.startMode",type:{name:"enum",enums:[{value:"explicit",label:"Explicit"},{value:"implicit",label:"Implicit"}],allowEditOnly:!0},plug:"input",group:"{{portname}} Animation",displayName:"Start Mode",default:"implicit",index:1e3},{name:"{{portname}}.endValue",type:"number",plug:"input",group:"{{portname}} Animation",displayName:"End Value",editorName:"End Value | {{portname}} ",default:0,index:1002}]},{name:"expand/basic",condition:"'{{portname}}.startMode' = explicit",indexStep:100,template:[{name:"{{portname}}.startValue",plug:"input",type:"number",displayName:"Start Value",editorName:"Start Value | {{portname}}",group:"{{portname}} Animation",default:0,index:1001}]}],panels:[{name:"PortEditor",title:"Animations",plug:"output",type:{name:"number"},group:"Animation Values"}],prototypeExtensions:{updateCubicBezierFunction:{value:function(){var a=this._internal.cubicBezierPoints,b=g(a);this._internal.cubicBezierFunction=function(a,c,d){return f.linear(a,c,b.get(d))},this._internal.ease=this._internal.cubicBezierFunction}},_registerAnimationGroup:{value:function(a){var b=new d({node:this,ease:this._internal.ease,name:a});this._internal.animations.push(b);var c={};c[a+".startMode"]={set:function(a){b.startMode=a}},c[a+".startValue"]={default:0,set:function(a){b.startValue=a}},c[a+".endValue"]={default:0,set:function(a){b.endValue=a}},this.registerInputs(c),this.registerOutput(a,{getter:function(){return b.currentValue}})}},registerInputIfNeeded:{value:function(a){if(!this.hasInput(a)){var b=a.indexOf("."),c=a.substr(0,b);this.hasOutput(c)||this._registerAnimationGroup(c)}}},registerOutputIfNeeded:{value:function(a){this.hasOutput(a)||this._registerAnimationGroup(a)}}}};b.exports=e.defineNode(j)},{"../easecurves":196,"../node":208,"../nodedefinition":210,"bezier-easing":2}],215:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a,b){for(var c=0;c<3;++c){var d=1+2*c;a[c]=parseInt(b.substring(d,d+2),16)}}function f(a){var b=a.toString(16);return 1==b.length?"0"+b:b}function g(a){return"#"+f(a[0])+f(a[1])+f(a[2])}var h=a("../easecurves"),i=[0,0,0],j=[0,0,0],k=[0,0,0],l={name:"Color Blend",category:"Interpolation",initialize:function(){var a=this._internal;a.resultColor="#000000",a.blendValue=0,a.colors=[]},numberedInputs:{color:{name:"numbered/simple-color",displayPrefix:"Color",createSetter:function(a){return function(b){this._internal.colors[a]=b,this.updateColor()}}}},inputs:{blendValue:{type:"number",displayName:"Blend Value",default:0,set:function(a){this._internal.blendValue=a,this.updateColor()}}},outputs:{result:{type:"color",displayName:"Result",getter:function(){return this._internal.resultColor}}},prototypeExtensions:{updateColor:function(){function a(a){return b[a]?b[a]:"#000000"}var b=this._internal.colors;if(0!==b.length){var c=d(0,b.length-1,this._internal.blendValue),f=Math.floor(c),l=c-f;0===l?this._internal.resultColor=a(f):(e(i,a(f)),e(j,a(f+1)),k[0]=Math.floor(h.linear(i[0],j[0],l)),k[1]=Math.floor(h.linear(i[1],j[1],l)),k[2]=Math.floor(h.linear(i[2],j[2],l)),this._internal.resultColor=g(k)),this.flagOutputDirty("result")}}}};b.exports={node:l}},{"../easecurves":196}],216:[function(a,b,c){"use strict";b.exports={node:{name:"Component Inputs",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Inputs",plug:"output",type:{name:"*"},canArrangeInGroups:!0},{name:"PropertyEditor",hidden:!0}],color:"component",haveComponentPorts:!0,category:"Component Utilities",initialize:function(){this._internal.outputs={}},prototypeExtensions:{registerOutputIfNeeded:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:function(){return this.nodeScope.componentOwner._internal.inputValues[a]}})}}}}},{}],217:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.nodeScope=new f(a,this),this._internal.childRoot=null,this._internal.componentOutputValues={},this._internal.componentOutputs=[],this._internal.componentInputs=[],this._internal.inputValues={}}var e=a("../node"),f=a("../nodescope"),g=a("lodash");d.prototype=Object.create(e.prototype,{setComponentModel:{value:function(a){this.model=a;var b=this;this.nodeScope.setComponentModel(a),this._internal.componentInputs=this.nodeScope.getNodesWithType("Component Inputs"),this._internal.componentOutputs=this.nodeScope.getNodesWithType("Component Outputs"),g.values(a.getInputPorts()).forEach(this.registerComponentInputPort.bind(this)),g.values(a.getOutputPorts()).forEach(this.registerComponentOutputPort.bind(this)),a.roots&&a.roots.length>0&&this.setRoot(a.roots[0]),a.on("rootAdded",function(a){b._internal.root||b.setRoot(a)},this),a.on("rootRemoved",function(c){if(b._internal.root&&b._internal.root.id===c){var d=b._internal.visualParent;b.resetRoot();var e=a.getFirstRootId();e&&this.nodeScope.hasNodeWithId(e)&&(b.setRoot(a.getFirstRootId()),d&&d.addChild(b))}},this),a.on("inputPortAdded",this.registerComponentInputPort.bind(this),this),a.on("outputPortAdded",this.registerComponentOutputPort.bind(this),this),a.on("inputPortRemoved",function(a){b.hasInput(a.name)&&b.deregisterInput(a.name)},this),a.on("outputPortRemoved",function(a){this.hasOutput(a.name)&&b.deregisterOutput(a.name)},this),a.on("nodeAdded",function(a){"Component Inputs"===a.type?b._internal.componentInputs.push(b.nodeScope.getNodeWithId(a.id)):"Component Outputs"===a.type&&b._internal.componentOutputs.push(b.nodeScope.getNodeWithId(a.id))},this),a.on("nodeRemoved",function(a){"Component Inputs"===a.type?g.remove(b._internal.componentInputs,{id:a.id}):"Component Outputs"===a.type&&g.remove(b._internal.componentOutputs,{id:a.id})},this),a.on("renamed",function(a){b.name=a.newName},this)}},_onNodeDeleted:{value:function(){this.model&&(this.model.removeListenersWithRef(this),this.model=void 0),this.nodeScope.reset()}},registerComponentInputPort:{value:function(a){this.registerInput(a.name,{set:function(b,c){c?this._internal.inputValues[a.name]={value:b,unit:c}:this._internal.inputValues[a.name]=b,this._internal.componentInputs.forEach(function(b){b.registerOutputIfNeeded(a.name),b.flagOutputDirty(a.name)})}})}},registerComponentOutputPort:{value:function(a){this.registerOutput(a.name,{getter:function(){return this._internal.componentOutputValues[a.name]}})}},setOutputFromComponentOutput:{value:function(a,b){this.hasOutput(a)!==!1&&(this._internal.componentOutputValues[a]=b,this.flagOutputDirty(a))}},setRoot:{value:function(a){if(!a)throw Error("id must be set");var b=this.nodeScope.getNodeWithId(a);if(b.getVisualRoot){this._internal.root&&this.resetRoot(),this._internal.root=b;var c=b.getVisualRoot();c&&(c._internal.visualParent&&c._internal.visualParent.removeChild(this._internal.root),void 0===c.componentIds&&(c.componentIds=[]),c.componentIds.indexOf(this.id)===-1&&c.componentIds.push(this.id))}}},resetRoot:{value:function(){this._internal.visualParent&&this._internal.visualParent.removeChild(this);var a=this._internal.root.getVisualRoot();if(this._internal.root=void 0,a&&a.componentIds){var b=a.componentIds.indexOf(this.id);b!==-1&&a.componentIds.splice(b,1)}}},setChildRoot:{value:function(a){var b=this._internal.childRoot,c=a;if(this._internal.childRoot=c,this.model.children){var d=this.parentNodeScope,e=this.model.children.map(function(a){return d.getNodeWithId(a.id)});if(b)for(var f=0;f<e.length;f++)b.isChild(e[f])&&b.removeChild(e[f]);if(c)for(var f=0;f<e.length;f++){var g=e[f],h=g.model.parent.children.indexOf(g.model);this.addChild(g,h)}}}},getChildRootIndex:{value:function(){if(!this._internal.childRoot||!this._internal.childRoot.model||!this._internal.childRoot.model.children)return 0;for(var a=this._internal.childRoot.model.children,b=0;b<a.length;b++)if("Component Children"===a[b].type)return b;return 0}},getChildRoot:{value:function(){return this._internal.childRoot?this._internal.childRoot:this._internal.root.getChildRoot()}},getVisualRoot:{value:function(){if(this._internal.root)return this._internal.root.getVisualRoot()}},addChild:{value:function(a,b){this.getChildRoot().addChild(a,b+this.getChildRootIndex())}},flagDirty:{value:function(){if(!this._dirty){e.prototype.flagDirty.call(this);for(var a=this._internal.componentInputs,b=0,c=a.length;b<c;b++)a[b].flagDirty();this._internal.componentOutputs.forEach(function(a){a.flagDirty()})}}},setHighlightEnabled:{value:function(a){var b=this.getVisualRoot();b&&b.setHighlightEnabled&&b.setHighlightEnabled(a)}},update:{value:function(){e.prototype.update.call(this),this._internal.componentOutputs.forEach(function(a){a.update()})}}}),d.prototype.constructor=d,b.exports=d},{"../node":208,"../nodescope":280,lodash:148}],218:[function(a,b,c){"use strict";b.exports={node:{category:"Component Utilities",name:"Component Outputs",panels:[{name:"PortEditor",context:["select","connectTo"],title:"Outputs",plug:"input",type:{name:"*"},canArrangeInGroups:!0},{name:"PropertyEditor",hidden:!0}],color:"component",haveComponentPorts:!0,prototypeExtensions:{registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:function(b){this.nodeScope.componentOwner.setOutputFromComponentOutput(a,b)}})}}}}},{}],219:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Counter",category:"Math",initialize:function(){this._internal.currentValue=0,this._internal.startValue=0,this._internal.startValueSet=!1,this._internal.limitsEnabled=!1,this._internal.limitsMin=0,this._internal.limitsMax=0},inputs:{increase:{displayName:"Increase Count",valueChangedToTrue:function(){this._internal.limitsEnabled&&this._internal.currentValue>=this._internal.limitsMax||(this._internal.currentValue++,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},decrease:{displayName:"Decrease Count",valueChangedToTrue:function(){this._internal.limitsEnabled&&this._internal.currentValue<=this._internal.limitsMin||(this._internal.currentValue--,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},reset:{displayName:"Reset To Start",valueChangedToTrue:function(){0!==this.currentValue&&(this._internal.currentValue=this._internal.startValue,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},startValue:{type:"number",displayName:"Start Value",default:0,set:function(a){this._internal.startValue=Number(a),this._internal.startValueSet===!1&&(this._internal.startValueSet=!0,this._internal.currentValue=this._internal.startValue,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},limitsMin:{type:{name:"number"},displayName:"Min Value",group:"Limits",default:0,set:function(a){this._internal.limitsMin=Number(a)}},limitsMax:{type:{name:"number"},displayName:"Max Value",group:"Limits",default:0,set:function(a){this._internal.limitsMax=Number(a)}},limitsEnabled:{type:{name:"boolean"},displayName:"Limits Enabled",group:"Limits",default:!1,set:function(a){this._internal.limitsEnabled=!!a}}},outputs:{currentCount:{displayName:"Current Count",type:"number",getter:function(){return this._internal.currentValue}},countChanged:{displayName:"Count Changed",type:"signal"}}})},{"../nodedefinition":210}],220:[function(a,b,c){"use strict";function d(){this.items=[]}var e=a("./model"),f=a("lodash"),g={};d.get=function(a){return void 0===a&&(a=e.guid()),g[a]||(g[a]=new d),g[a]},d.exists=function(a){return void 0!==g[a]},d.prototype.on=function(a,b){this.listeners||(this.listeners={}),this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(b)},d.prototype.off=function(a,b){if(this.listeners&&this.listeners[a]){var c=this.listeners[a].indexOf(b);c!==-1&&this.listeners[a].splice(c,1)}},d.prototype.notify=function(a,b){if(this.listeners&&this.listeners[a])for(var c=f.clone(this.listeners[a]),d=0;d<c.length;d++)c[d](b)},d.prototype.set=function(a){function b(a){for(var b={},c=a.length,d=0;d<c;d++){var e=a[d];b[e.getId()]=e}return b}var c,f;if(a!==this){var a=a instanceof d?a.items:a,g=[];for(c=a.length,f=0;f<c;f++){var h=a[f];h instanceof e?g.push(h):g.push(e.create(h))}var i=this.items,j=b(i),k=b(g);for(c=i.length,f=0;f<c;f++)k.hasOwnProperty(i[f].getId())||(this.removeAtIndex(f),f--,c--);for(f=0;f<Math.min(i.length,g.length);f++)i[f]!==g[f]&&(j.hasOwnProperty(g[f].getId())&&this.remove(g[f]),this.addAtIndex(g[f],f));for(f=i.length;f<g.length;f++)this.add(g[f])}},d.prototype.contains=function(a){return this.items.indexOf(a)!==-1},d.prototype.add=function(a){this.contains(a)||(this.items.push(a),this.notify("add",{item:a}),this.notify("change"),a.notify("add",{collection:this}))},d.prototype.addAtIndex=function(a,b){this.contains(a)||(this.items.splice(b,0,a),this.notify("add",{item:a,index:b}),this.notify("change"),a.notify("add",{collection:this,index:b}))},d.prototype.removeAtIndex=function(a){var b=this.items[a];this.items.splice(a,1),this.notify("remove",{item:b,index:a}),this.notify("change"),b.notify("remove",{collection:this})},d.prototype.remove=function(a){var b=this.items.indexOf(a);b!==-1&&this.removeAtIndex(b)},d.prototype.size=function(){return this.items.length},d.prototype.get=function(a){return this.items[a]},d.prototype.each=function(a){for(var b=0;b<this.items.length;b++)a(this.items[b],b)},b.exports=d},{"./model":224,lodash:148}],221:[function(a,b,c){"use strict";var d=a("../../nodedefinition"),e=a("../../node"),f=a("./model"),g=a("./collection"),h=a("./persisthelper");h.setDeltaHandlerForType("collection",function(a,b){for(var c=g.get(a),d=0,e=b.removed.length;d<e;d++){var h=b.removed[d];c.remove(f.get(h))}for(var d=0,e=b.added.length;d<e;d++){var i,j=b.added[d];i=f.exists(j.id)?f.get(j.id):f.create(j),c.add(i)}}),h.setInitialFetchHandlerForType("collection",function(a,b){var c=g.get(a);if(c){for(var d=[],e=0,h=b.length;e<h;e++){var i,j=b[e];i=f.exists(j.id)?f.get(j.id):f.create(j),d.push(i)}c.set(d)}});var i={name:"Collection",category:"Data",usePortAsLabel:"collectionId",color:"data",dynamicports:[{name:"conditionalports/basic",condition:"persistType = local OR persistType = global",ports:[{name:"persist",plug:"input",type:"signal",displayName:"Persist",group:"Persistence"},{name:"fetch",plug:"input",type:"signal",displayName:"Fetch",group:"Persistence"},{name:"persistWorking",plug:"output",type:"boolean",displayName:"In Progress",group:"Persistence"},{name:"persistSuccess",plug:"output",type:"signal",displayName:"Persist Success",group:"Persistence"},{name:"persistFailure",plug:"output",type:"signal",displayName:"Persist Failure",group:"Persistence"},{name:"fetchSuccess",plug:"output",type:"signal",displayName:"Fetch Success",group:"Persistence"},{name:"fetchFailure",plug:"output",type:"signal",displayName:"Fetch Failure",group:"Persistence"}]}],initialize:function(){var a=this,b=!1;this._internal.collectionChangedCallback=function(){b||(b=!0,a.scheduleAfterInputsHaveUpdated(function(){a.sendSignalOnOutput("modified"),a.flagOutputDirty("count"),b=!1}))},this._internal.copySourceItemsCallback=function(){a.copySourceItems()},this._internal.persistHelper=new h({scheduleFunction:this.scheduleAfterInputsHaveUpdated.bind(this),onPersistDataNeeded:function(){var b=a._internal.collection;if(b){var c=[];return b.each(function(a){c.push(a.getId())}),c}},onPersistSuccess:function(){a.sendSignalOnOutput("persistSuccess")},onPersistFailure:function(){a.sendSignalOnOutput("persistFailure")},onFetchSuccess:function(b){var c=a._internal.collection;if(c){for(var d=[],e=0,g=b.length;e<g;e++){var h,i=b[e];h=f.exists(i.id)?f.get(i.id):f.create(i),d.push(h)}c.set(d)}a.sendSignalOnOutput("fetchSuccess")},onFetchFailure:function(){a.sendSignalOnOutput("fetchFailure")},onWorkingChanged:function(){a.flagOutputDirty("persistWorking")}})},inputs:{collectionId:{type:"string",displayName:"Id",group:"General",set:function(a){this.setCollectionID(a)}},items:{
type:"collection",group:"Modify",displayName:"Items",set:function(a){a&&a!==this._internal.sourceItems&&(this.bindSourceCollection(a),this.scheduleCopySourceItems())}},modifyId:{type:{name:"string",allowConnectionsOnly:!0},displayName:"Item Id",group:"Modify",set:function(a){this._internal.modifyId=a}},add:{displayName:"Add",group:"Modify",valueChangedToTrue:function(){var a=this,b=this._internal;this.scheduleAfterInputsHaveUpdated(function(){if(b.modifyId){var c=f.get(b.modifyId);b.collection.add(c),"sync"===a._internal.persistHelper.persistType&&a._internal.persistHelper.schedulePersist()}})}},remove:{displayName:"Remove",group:"Modify",valueChangedToTrue:function(){var a=this,b=this._internal;this.scheduleAfterInputsHaveUpdated(function(){if(b.modifyId){var c=f.get(b.modifyId);b.collection.remove(c),"sync"===a._internal.persistHelper.persistType&&a._internal.persistHelper.schedulePersist()}})}},clear:{displayName:"Clear",group:"Modify",valueChangedToTrue:function(){var a=this,b=this._internal;this.scheduleAfterInputsHaveUpdated(function(){b.collection.set([]),a.sendSignalOnOutput("modified"),"sync"===a._internal.persistHelper.persistType&&a._internal.persistHelper.schedulePersist()})}},persistType:{displayName:"Type",group:"Persistence",type:{name:"enum",enums:[{value:"none",label:"None"},{value:"local",label:"Local"},{value:"global",label:"Global"},{value:"sync",label:"Sync"}]},default:"none",set:function(a){this._internal.persistHelper.setPersistType(a)}},persist:{displayName:"Persist",group:"Persistence",valueChangedToTrue:function(){this._internal.persistHelper.schedulePersist()}},fetch:{displayName:"Fetch",group:"Persistence",valueChangedToTrue:function(){this._internal.persistHelper.scheduleFetch()}}},outputs:{id:{type:"string",displayName:"Id",group:"General",getter:function(){return this._internal.name}},items:{type:"collection",displayName:"Items",group:"General",getter:function(){return this._internal.collection}},count:{type:"number",displayName:"Count",group:"General",getter:function(){return this._internal.collection?this._internal.collection.size():0}},modified:{group:"Events",type:"signal",displayName:"Modified"},persistWorking:{displayName:"In Progress",group:"Persistence",type:"boolean",getter:function(){return this._internal.persistHelper.isWorking()}},persistSuccess:{displayName:"Persist Success",group:"Persistence",type:"signal"},persistFailure:{displayName:"Persist Failure",group:"Persistence",type:"signal"},fetchSuccess:{displayName:"Fetch Success",group:"Persistence",type:"signal"},fetchFailure:{displayName:"Fetch Failure",group:"Persistence",type:"signal"}},prototypeExtensions:{setCollectionID:function(a){this._internal.name=a,this.setCollection(g.get(a)),this.flagOutputDirty("id"),this._internal.persistHelper.setId("collection/"+a)},setCollection:function(a){this.bindCollection(a),this.flagOutputDirty("items"),this.flagOutputDirty("count")},unbindSourceCollection:function(){var a=this._internal;a.sourceItems&&a.sourceItems instanceof g&&(a.sourceItems.off("change",this._internal.copySourceItemsCallback),a.sourceItems=void 0)},bindSourceCollection:function(a){var b=this._internal;this.unbindSourceCollection(),b.sourceItems=a,a instanceof g&&a.on("change",this._internal.copySourceItemsCallback)},unbindCurrentCollection:function(){var a=this._internal.collection;a&&(a.off("change",this._internal.collectionChangedCallback),this._internal.collection=void 0)},bindCollection:function(a){this.unbindCurrentCollection(),this._internal.collection=a,a.on("change",this._internal.collectionChangedCallback)},_onNodeDeleted:function(){e.prototype._onNodeDeleted.call(this),this.unbindCurrentCollection()},scheduleCopySourceItems:function(){var a=this._internal;a.hasScheduledCopySourceItems||(a.hasScheduledCopySourceItems=!0,this.scheduleAfterInputsHaveUpdated(this.copySourceItems.bind(this)))},copySourceItems:function(){var a=this._internal;a.hasScheduledCopySourceItems=!1,(a.collection||void 0!==a.idType&&"explicit"!==a.idType)&&(a.collection||"unique"!==a.idType||this.newCollectionID(),a.collection.set(a.sourceItems))}}},j=d.defineNode(i);b.exports=j},{"../../node":208,"../../nodedefinition":210,"./collection":220,"./model":224,"./persisthelper":226}],222:[function(a,b,c){"use strict";var d=a("../../nodedefinition"),e=a("../../node"),f=a("../../guid"),g="// model item is available in item variable\n// set the component variable to the name of the desired component for this\n// item. Component name must start with a '/'.\ncomponent = '/MyComponent';",h={name:"For Each",color:"data",category:"Visual",dynamicports:[{name:"conditionalports/basic",condition:"templateType = explicit OR templateType NOT SET",ports:[{name:"template",plug:"input",type:"component",displayName:"Component",group:"Appearance"}]},{name:"conditionalports/basic",condition:"templateType = dynamic",ports:[{name:"templateScript",plug:"input",type:{name:"string",codeeditor:"javascript",allowEditOnly:!0},displayName:"Script",default:g,group:"Appearance"}]}],initialize:function(){this._internal.itemNodes=[];var a=this;this._internal.onAddItem=function(b){a.addItem(b.item,b.index)},this._internal.onRemoveItem=function(b){a.removeItem(b.item)}},inputs:{items:{group:"Data",displayName:"Items",type:{name:"collection",allowConnectionsOnly:!0},set:function(a){a&&a!==this._internal.items&&(this.bindCollection(a),this.scheduleRefresh())}},templateType:{group:"Appearance",displayName:"Template Type",type:{name:"enum",enums:[{label:"Explicit",value:"explicit"},{label:"Dynamic",value:"dynamic"}]},default:"explicit",set:function(a){this._internal.templateType=a,this.scheduleRefresh()}},template:{set:function(a){this._internal.template=a,this.scheduleRefresh()}},templateScript:{set:function(a){try{this._internal.templateFunction=new Function("item","var component;"+a+";return component;")}catch(b){console.log(b),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"foreach-syntax-warning",{message:"<strong>Syntax</strong>: "+b.message})}this.scheduleRefresh()}},refresh:{group:"Appearance",displayName:"Refresh",type:"signal",valueChangedToTrue:function(){this.scheduleRefresh()}}},prototypeExtensions:{updateTarget:function(a){this._internal.target=a?this.nodeScope.getNodeWithId(a):void 0,this.scheduleRefresh()},setNodeModel:function(a){e.prototype.setNodeModel.call(this,a),a.parent&&this.updateTarget(a.parent.id);var b=this;a.on("parentUpdated",function(a){b.updateTarget(a?a.id:void 0)},this)},scheduleRefresh:function(){var a=this,b=this._internal;b.hasScheduledRefresh||(b.hasScheduledRefresh=!0,this.scheduleAfterInputsHaveUpdated(function(){a.refresh()}))},unbindCurrentCollection:function(){var a=this._internal.items;a&&(a.off("add",this._internal.onAddItem),a.off("remove",this._internal.onRemoveItem),this._internal.collection=void 0)},bindCollection:function(a){var b=this._internal;this.unbindCurrentCollection(),a.on("add",this._internal.onAddItem),a.on("remove",this._internal.onRemoveItem),b.items=a},getTemplateForModel:function(a){var b=this._internal;if(void 0===b.templateType||"explicit"===b.templateType)return b.template;if(b.templateFunction){try{var c=b.templateFunction(a)}catch(d){console.log(d),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"foreach-dynamic-warning",{message:"<strong>Dynamic template</strong>: "+d.message})}return c}},addItem:function(a,b){var c=this._internal,d=this.getTemplateForModel(a);if(d){var e=this.nodeScope.createNode(d,f());e._forEachModel=a;var g=e.nodeScope.getNodesWithType("For Each Actions");if(g&&g.length>0)for(var h=0;h<g.length;h++)g[h].setItemId(a.getId()),g[h].signalAdded();c.itemNodes.push(e),c.target.addChild(e,b)}},removeItem:function(a){function b(){var b=c.target._internal.children;for(var d in b){var e=b[d];if(e._forEachModel===a&&!e._forEachRemoveInProgress)return e}}var c=this._internal,d=b();if(d){var e=d.nodeScope.getNodesWithType("For Each Actions");e&&e.length>0?(d._forEachRemoveInProgress=!0,e[0].tryRemove(function(){c.target.removeChild(d),c.target.nodeScope.deleteNode(d)})):(c.target.removeChild(d),c.target.nodeScope.deleteNode(d));var f=c.itemNodes.indexOf(d);f!==-1&&c.itemNodes.splice(f,1)}},refresh:function(){var a=this._internal;if(a.hasScheduledRefresh=!1,(a.template||a.templateFunction)&&a.items&&a.target){for(var b=0;b<a.itemNodes.length;b++)a.target.removeChild(a.itemNodes[b]);a.itemNodes=[];for(var b=0;b<a.items.size();b++){var c=a.items.get(b);this.addItem(c)}}},_onNodeDeleted:function(){e.prototype._onNodeDeleted.call(this),this.unbindCurrentCollection()}}};b.exports=d.defineNode(h)},{"../../guid":202,"../../node":208,"../../nodedefinition":210}],223:[function(a,b,c){"use strict";var d={name:"For Each Actions",displayNodeName:"For Each Item",category:"Data",color:"data",inputs:{removeCompleted:{type:{name:"boolean",allowConnectionsOnly:!0},displayName:"Remove Completed",group:"Events",valueChangedToTrue:function(){this._internal.removeCompletedCallback&&this._internal.removeCompletedCallback()}}},outputs:{added:{type:"signal",displayName:"Added",group:"Events"},tryRemove:{type:"signal",displayName:"Try Remove",group:"Events"},itemId:{type:"string",displayName:"Item Id",group:"General",getter:function(){return this._internal.itemId}}},prototypeExtensions:{setItemId:function(a){this._internal.itemId=a,this.flagOutputDirty("itemId")},signalAdded:function(){this.sendSignalOnOutput("added")},tryRemove:function(a){this.getOutput("tryRemove").hasConnections()?(this._internal.removeCompletedCallback=a,this.sendSignalOnOutput("tryRemove")):a()}}};b.exports={node:d}},{}],224:[function(a,b,c){function d(a,b){this.id=a,this.data=b}var e=a("lodash"),f={};d.get=function(a){return void 0===a&&(a=d.guid()),f[a]||(f[a]=new d(a,{})),f[a]},d.create=function(a){var b=a?a:{},c=d.get(b.id);for(var e in b)"id"!==e&&c.set(e,b[e]);return c},d.exists=function(a){return void 0!==f[a]},d.guid=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},d.prototype.on=function(a,b){this.listeners||(this.listeners={}),this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(b)},d.prototype.off=function(a,b){if(this.listeners&&this.listeners[a]){var c=this.listeners[a].indexOf(b);c!==-1&&this.listeners[a].splice(c,1)}},d.prototype.notify=function(a,b){if(this.listeners&&this.listeners[a])for(var c=e.clone(this.listeners[a]),d=0;d<c.length;d++)c[d](b)},d.prototype.setAll=function(a){for(var b in a)if("id"!==b&&this.data[b]!==a[b]){var c=this.data[b];this.data[b]=a[b],this.notify("change",{name:b,value:a[b],old:c})}},d.prototype.set=function(a,b,c){if(c&&c.resolve&&a.indexOf(".")!==-1){for(var e=a.split("."),f=this,g=0;g<e.length-1;g++){var h=f.get(e[g]);if(!(h instanceof d))return;f=h}return void f.set(e[e.length-1],b)}var i=this.data[a];this.data[a]=b,i!==b&&(!c||!c.silent)&&this.notify("change",{name:a,value:b,old:i})},d.prototype.getId=function(){return this.id},d.prototype.get=function(a,b){if(b&&b.resolve&&a.indexOf(".")!==-1){for(var c=a.split("."),e=this,f=0;f<c.length-1;f++){var g=e.get(c[f]);if(!(g instanceof d))return;e=g}return e.get(c[c.length-1])}return this.data[a]},b.exports=d},{lodash:148}],225:[function(a,b,c){"use strict";function d(a){return this._internal.model?this._internal.model.get(a,{resolve:!0}):void 0}function e(a,b){this._internal.inputValues[a]=b}function f(a,b,c){var d=[];b=b?b.split(","):void 0;for(var e in b){var f=b[e];d.push({type:{name:"*",allowConnectionsOnly:!0},plug:"input/output",group:"Properties",name:f})}var g=JSON.stringify(d);j[a]!==g&&(j[a]=g,c.sendDynamicPorts(a,d))}var g=a("./model"),h=(a("../../edgetriggeredinput"),a("../../node")),i=a("./persisthelper"),j={};i.setDeltaHandlerForType("model",function(a,b){var c=g.get(a);for(var d in b)c.set(d,b[d])}),i.setInitialFetchHandlerForType("model",function(a,b){var c=g.get(a);c&&c.setAll(b)});var k={name:"Model",category:"Data",usePortAsLabel:"modelId",color:"data",dynamicports:[{name:"conditionalports/basic",condition:"persistType = local OR persistType = global",ports:[{name:"persist",plug:"input",type:"signal",displayName:"Persist",group:"Persistence"},{name:"fetch",plug:"input",type:"signal",displayName:"Fetch",group:"Persistence"},{name:"persistWorking",plug:"output",type:"boolean",displayName:"In Progress",group:"Persistence"},{name:"persistSuccess",plug:"output",type:"signal",displayName:"Persist Success",group:"Persistence"},{name:"persistFailure",plug:"output",type:"signal",displayName:"Persist Failure",group:"Persistence"},{name:"fetchSuccess",plug:"output",type:"signal",displayName:"Fetch Success",group:"Persistence"},{name:"fetchFailure",plug:"output",type:"signal",displayName:"Fetch Failure",group:"Persistence"}]}],initialize:function(){var a=this._internal;a.inputValues={};var b=this;this._internal.onModelChangedCallback=function(a){b.hasOutput(a.name)&&b.flagOutputDirty(a.name)},this._internal.persistHelper=new i({scheduleFunction:this.scheduleAfterInputsHaveUpdated.bind(this),onPersistDataNeeded:function(){for(var c in a.inputValues)a.model.set(c,a.inputValues[c],{resolve:!0});return b.sendSignalOnOutput("stored"),a.model.data},onPersistSuccess:function(){b.sendSignalOnOutput("persistSuccess")},onPersistFailure:function(){b.sendSignalOnOutput("persistFailure")},onFetchSuccess:function(c){a.model.setAll(c),b.sendSignalOnOutput("fetchSuccess")},onFetchFailure:function(){b.sendSignalOnOutput("fetchFailure")},onWorkingChanged:function(){b.flagOutputDirty("persistWorking")}})},outputs:{id:{type:"string",displayName:"Id",group:"General",getter:function(){return this._internal.model?this._internal.model.getId():void 0}},stored:{type:"signal",displayName:"Stored",group:"Events"},persistWorking:{displayName:"In Progress",group:"Persistence",type:"boolean",getter:function(){return this._internal.persistHelper.isWorking()}},persistSuccess:{displayName:"Persist Success",group:"Persistence",type:"signal"},persistFailure:{displayName:"Persist Failure",group:"Persistence",type:"signal"},fetchSuccess:{displayName:"Fetch Success",group:"Persistence",type:"signal"},fetchFailure:{displayName:"Fetch Failure",group:"Persistence",type:"signal"}},inputs:{modelId:{type:"string",displayName:"Id",group:"General",set:function(a){this.setModelID(a)}},properties:{type:{name:"stringlist",allowEditOnly:!0},displayName:"Properties",group:"Properties",set:function(a){}},store:{displayName:"Store",group:"Actions",valueChangedToTrue:function(){this.scheduleStore()}},clear:{displayName:"Clear",group:"Actions",valueChangedToTrue:function(){var a=this._internal;if(a.model)for(var b in a.inputValues)a.model.set(b,void 0,{resolve:!0})}},persistType:{displayName:"Type",group:"Persistence",type:{name:"enum",enums:[{value:"none",label:"None"},{value:"local",label:"Local"},{value:"global",label:"Global"},{value:"sync",label:"Sync"}]},default:"none",set:function(a){this._internal.persistHelper.setPersistType(a)}},persist:{displayName:"Persist",group:"Persistence",valueChangedToTrue:function(){this._internal.persistHelper.schedulePersist()}},fetch:{displayName:"Fetch",group:"Persistence",valueChangedToTrue:function(){this._internal.persistHelper.scheduleFetch()}}},prototypeExtensions:{scheduleStore:function(){if(!this.hasScheduledStore){this.hasScheduledStore=!0;var a=this._internal;this.scheduleAfterInputsHaveUpdated(function(){if(this.hasScheduledStore=!1,a.model){for(var b in a.inputValues)a.model.set(b,a.inputValues[b],{resolve:!0});this.sendSignalOnOutput("stored"),"sync"===this._internal.persistHelper.persistType&&this._internal.persistHelper.schedulePersist()}})}},setModelID:function(a){var b=g.get(a);this.setModel(b),this._internal.persistHelper.setId("model/"+a)},setModel:function(a){this._internal.model&&this._internal.model.off("change",this._internal.onModelChangedCallback),this._internal.model=a,this.flagOutputDirty("id"),a.on("change",this._internal.onModelChangedCallback);for(var b in a.data)this.hasOutput(b)&&this.flagOutputDirty(b)},_onNodeDeleted:function(){h.prototype._onNodeDeleted.call(this),this._internal.model&&this._internal.model.off("change",this._internal.onModelChangedCallback),this._internal.persistHelper.unsubscribe()},registerOutputIfNeeded:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:d.bind(this,a)})},registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:e.bind(this,a)})}}};b.exports={node:k,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Model",function(b){b.parameters.properties&&f(b.id,b.parameters.properties,a.editorConnection),b.on("parameterUpdated",function(c){"properties"===c.name&&f(b.id,b.parameters.properties,a.editorConnection)})})}}},{"../../edgetriggeredinput":197,"../../node":208,"./model":224,"./persisthelper":226}],226:[function(a,b,c){"use strict";function d(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}function e(a){var b=a.topic.substring("ndl/persist/getaccepted/".length);if(m[b]===a.payload.clientToken){var c=b.split("/")[0],d=b.substring(c.length+1);n[c](d,a.payload.data)}}function f(a){m[a]||(k.pubsub.subscribe("ndl/persist/getaccepted/"+a,e),m[a]=d(),k.pubsub.publish("ndl/persist/get/"+a,{clientToken:m[a]}))}function g(){o||(o=!0,k.pubsub.on("connected",function(){for(var a in m)k.pubsub.publish("ndl/persist/get/"+a,{clientToken:m[a]})}))}function h(a){var b=a.topic.substring("ndl/persist/delta/".length);if(p[b]){var c=b.split("/")[0],d=b.substring(c.length+1);q[c](d,a.payload.delta)}}function i(a){p[a]?p[a].cnt++:(p[a]={cnt:1},k.pubsub.subscribe("ndl/persist/delta/"+a,h))}function j(a){p[a]&&(p[a].cnt--,0===p[a].cnt&&(k.pubsub.unsubscribe("ndl/persist/delta/"+a,h),delete p[a],delete m[a]))}var k=a("../../services/services"),l=function(a){for(var b in a)this[b]=a[b];this.hasScheduled={},g()},m={},n={};l.setInitialFetchHandlerForType=function(a,b){n[a]=b};var o=!1,p={},q={};l.setDeltaHandlerForType=function(a,b){q[a]=b},l.prototype.setId=function(a){this.id=a;var b=this;this.schedule("subscribeToPersistService",function(){b.subscribeToPersistService()})},l.prototype.isWorking=function(){return!!this.persistWorking},l.prototype.setPersistType=function(a){this.persistType=a;var b=this;this.schedule("subscribeToPersistService",function(){b.subscribeToPersistService()})},l.prototype.schedule=function(a,b){var c=this;this.hasScheduled[a]||(this.hasScheduled[a]=!0,this.scheduleFunction(function(){b(),c.hasScheduled[a]=!1}))},l.prototype.unsubscribe=function(){this.lastSubscribedId&&(k.pubsub.unsubscribe("ndl/persist/updateaccepted/"+this.lastSubscribedId,this.messageHandler),k.pubsub.unsubscribe("ndl/persist/updaterejected/"+this.lastSubscribedId,this.messageHandler),k.pubsub.unsubscribe("ndl/persist/getaccepted/"+this.lastSubscribedId,this.messageHandler),k.pubsub.unsubscribe("ndl/persist/getrejected/"+this.lastSubscribedId,this.messageHandler),j(this.lastSubscribedId))},l.prototype.handleMessage=function(a){0===a.topic.indexOf("ndl/persist/updateaccepted/")?a.payload.clientToken===this.persistUpdateClientToken&&(this.persistWorking=!1,this.onWorkingChanged(this.persistWorking),this.onPersistSuccess()):0===a.topic.indexOf("ndl/persist/updaterejected/")?a.payload.clientToken===this.persistUpdateClientToken&&(this.persistWorking=!1,this.onWorkingChanged(this.persistWorking),this.onPersistFailure()):0===a.topic.indexOf("ndl/persist/getaccepted/")?a.payload.clientToken===this.persistGetClientToken&&(this.persistWorking=!1,this.onWorkingChanged(this.persistWorking),this.onFetchSuccess(a.payload.data)):0===a.topic.indexOf("ndl/persist/getrejected/")&&a.payload.clientToken===this.persistGetClientToken&&(this.persistWorking=!1,this.onWorkingChanged(this.persistWorking),this.onFetchFailure())},l.prototype.subscribeToPersistService=function(){var a=""!==this.id?this.id:void 0;"global"!==this.persistType&&"sync"!==this.persistType||this.lastSubscribedId!==a&&(this.unsubscribe(),this.lastSubscribedId=a,void 0!==a&&("global"!==this.persistType&&"sync"!==this.persistType||(this.messageHandler=this.handleMessage.bind(this),k.pubsub.subscribe("ndl/persist/updateaccepted/"+a,this.messageHandler),k.pubsub.subscribe("ndl/persist/updaterejected/"+a,this.messageHandler),k.pubsub.subscribe("ndl/persist/getaccepted/"+a,this.messageHandler),k.pubsub.subscribe("ndl/persist/getrejected/"+a,this.messageHandler),"sync"===this.persistType&&(i(a),f(a)))))},l.prototype.schedulePersist=function(){var a=this;this.schedule("schedulePersist",function(){a.persistData(a.onPersistDataNeeded())})},l.prototype.persistData=function(a){if(a){var b=this.persistType,c=this.id;if("local"===b)try{localStorage["noodl-model-"+c]=JSON.stringify(a),this.onPersistSuccess()}catch(e){this.onPersistFailure()}else"global"!==b&&"sync"!==b||(this.persistUpdateClientToken=d(),k.pubsub.publish("ndl/persist/update/"+c,{data:a,clientToken:this.persistUpdateClientToken}),this.persistWorking=!0,this.onWorkingChanged(this.persistWorking))}},l.prototype.scheduleFetch=function(){var a=this;this.schedule("scheduleFetch",function(){a.fetchData()})},l.prototype.fetchData=function(){var a=this.persistType,b=this.id;if("local"===a)try{var c=localStorage["noodl-model-"+b],e=JSON.parse(c?c:"{}");this.onFetchSuccess(e)}catch(f){this.onFetchFailure()}else"global"!==a&&"sync"!==a||(this.persistGetClientToken=d(),k.pubsub.publish("ndl/persist/get/"+b,{clientToken:this.persistGetClientToken}),this.persistWorking=!0,this.onWorkingChanged(this.persistWorking))},b.exports=l},{"../../services/services":287}],227:[function(a,b,c){"use strict";function d(a){return this._internal.responseOutputs[a]}function e(a,b){this._internal.requestInputs[a]=b}function f(a,b){function c(a){for(var b=0;b<d.length;b++)if(d[b].name===a)return!0;return!1}if(a.parameters){var d=[];if(a.parameters.resource){var e=a.parameters.resource.match(/\{[A-Za-z0-9_]*\}/g);for(var f in e){var h=e[f],i=h.replace("{","").replace("}","");d.push({name:i,type:"string",plug:"input",group:"Inputs"})}}if(a.parameters.externalFile&&"yes"===a.parameters.useExternalFile){var j=a.parameters.externalFile,k=void 0!==b;k&&"/"!==j[0]&&(j="/"+j),g.createFromURL(j,null,function(e){e.getPorts().forEach(function(a){c(a.name)||d.push(a)}),b.sendDynamicPorts(a.id,d)})}else if(a.parameters.code){var l=g.createFromCode(a.parameters.code,null);l.getPorts().forEach(function(a){c(a.name)||d.push(a)}),b.sendDynamicPorts(a.id,d)}}}var g=(a("../../nodedefinition"),a("../../node"),a("../../guid"),a("../../javascriptnodeparser")),h=a("xml2js"),i="define({\n\t// The input ports of the REST node, name of input and type\n\tinputs:{\n\t    //ExampleInput:'number',\n\t},\n\t\n\t// The output ports of the REST node, name of output and type\n\toutputs:{\n\t    //ExampleOutput:'string',\n\t},\n\t\n\t//Add custom code to setup the request object before the request\n\t//is made.\n\t//\n\t//*request.resource     contains the resource path of the request.\n\t//*request.method       contains the method, GET, POST, PUT or DELETE.\n\t//*request.headers      is a map where you can add additional headers.\n\t//*request.parameters   is a map the parameters that will be appended\n\t//                      to the url.\n\t//*request.content      contains the content of the request as a javascript\n\t//                      object.\n\t//\n\t// The inputs and outputs maps can also be accessed via *this.inputs and\n\t// *this.outputs.\n\trequest:function(inputs,request) {\n\t},\n\t\n\t// Add custom code to convert the response content to outputs\n\t//\n\t//*response.status    The status code of the response\n\t//*response.content   The content of the response as a javascript\n\t//                    object.\n\t//*response.request   The request object that resulted in the response.\n\t//\n\t// The inputs and outputs maps can also be accessed via *this.inputs and\n\t// *this.outputs.\n\tresponse:function(outputs,response) {\n\t}\n})\n",j="//Add prototype backend code to response to the request\n//\n//*context.request                      contains the request object as passed from the\n//                                      request script.\n//*context.sendResponse(status,content) should be called to send a response back\n//                                      to the request script with status code\n//                                      and a javascript object with the content\n//                                      of the response.\ncontext.sendResponse(200,{result:'success'});\n",k={name:"REST",category:"Data",color:"data",initialize:function(){this._internal.requestInputs={},this._internal.responseOutputs={},this._internal.backendProperties={},this._internal.hasPendingFetch=!1,this._internal.useExternalFile=!1},dynamicports:[{name:"conditionalports/basic",condition:"backendType = external OR backendType NOT SET",ports:[{name:"backendEndpoint",plug:"input",type:{name:"string",allowEditOnly:!0},displayName:"Endpoint",group:"Backend"}]},{name:"conditionalports/basic",condition:"backendType = prototype",ports:[{name:"backendScript",plug:"input",type:{name:"string",codeeditor:"javascript",allowEditOnly:!0},displayName:"Script",default:j,group:"Backend"}]},{name:"conditionalports/basic",condition:"useExternalFile = no OR useExternalFile NOT SET",ports:[{name:"code",displayName:"Script",group:"Request",plug:"input",type:{name:"string",allowEditOnly:!0,codeeditor:"javascript"},default:i}]},{name:"conditionalports/basic",condition:"useExternalFile = yes",ports:[{name:"externalFile",displayName:"File Path",group:"Request",plug:"input",type:{name:"source",allowEditOnly:!0}}]}],inputs:{resource:{type:"string",displayName:"Resource",group:"Request",default:"/",set:function(a){this._internal.resource=a}},method:{type:{name:"enum",enums:[{label:"GET",value:"GET"},{label:"POST",value:"POST"},{label:"DELETE",value:"DELETE"},{label:"PUT",value:"PUT"}]},displayName:"Method",group:"Request",default:"GET",set:function(a){this._internal.method=a}},useExternalFile:{type:{name:"enum",enums:[{value:"yes",label:"Yes"},{value:"no",label:"No"}],allowEditOnly:!0},default:"no",displayName:"Use External File",group:"Request",set:function(a){this._internal.isWaitingForExternalFileToLoad="yes"===a,this._internal.useExternalFile="yes"===a}},code:{set:function(a){a&&this.scheduleAfterInputsHaveUpdated(function(){if(this._internal.useExternalFile===!1){var b=g.createFromCode(a,this.nodeScope.noodlJavascriptAPI);this._onCodeParsed(b)}})}},externalFile:{set:function(a){if(this._internal.useExternalFile!==!1){this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a);var b=this;g.createFromURL(a,this.nodeScope.noodlJavascriptAPI,function(a){b._internal.isWaitingForExternalFileToLoad=!1,b._onCodeParsed(a),b._internal.hasPendingFetch===!0&&(b._internal.hasPendingFetch=!1,b.doFetch())})}}},fetch:{type:"boolean",displayName:"Fetch",group:"Actions",valueChangedToTrue:function(){this.scheduleFetch()}},cancel:{type:"boolean",displayName:"Cancel",group:"Actions",valueChangedToTrue:function(){this.cancelFetch()}},backendType:{type:{name:"enum",enums:[{label:"External",value:"external"},{label:"Prototype",value:"prototype"}],allowEditOnly:!0},displayName:"Backend type",group:"Backend",default:"external",set:function(a){this._internal.backendType=a}}},outputs:{fetching:{type:"boolean",displayName:"Fetching",group:"Status",getter:function(){return!!this._internal.fetching}},started:{type:"signal",displayName:"Started",group:"Signals"},completed:{type:"signal",displayName:"Completed",group:"Signals"},statusOK:{type:"signal",displayName:"Status OK",group:"Signals"},statusFail:{type:"signal",displayName:"Status Fail",group:"Signals"}},prototypeExtensions:{_onCodeParsed:function(a){if(this.context.editorConnection&&(this.context.editorConnection.clearWarnings(this.nodeScope.componentOwner.name,this.id),a.error&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-parse-waring",{message:a.error})),!a.error){var b=this;Object.keys(a.outputs).forEach(function(a){b.registerOutputIfNeeded(a)}),this._internal.requestFunction=a.definedObject.request,this._internal.responseFunction=a.definedObject.response}},registerOutputIfNeeded:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:d.bind(this,a)})},registerInputIfNeeded:function(a){var b=this;this.hasInput(a)||(0===a.indexOf("backend")?this.registerInput(a,{set:function(c){b._internal.backendProperties[a]=c}}):this.registerInput(a,{set:e.bind(this,a)}))},scheduleFetch:function(){var a=this._internal;a.hasScheduledFetch||(a.hasScheduledFetch=!0,this.scheduleAfterInputsHaveUpdated(this.doFetch.bind(this)))},doResponse:function(a,b,c){if(this._internal.responseFunction){var d={inputs:this._internal.requestInputs,outputs:this._internal.responseOutputs};this._internal.responseFunction.apply(d,[this._internal.responseOutputs,{status:a,content:b,request:c}])}for(var e in this._internal.responseOutputs)this.hasOutput(e)&&this.flagOutputDirty(e);200===a?this.sendSignalOnOutput("statusOK"):this.sendSignalOnOutput("statusFail"),this._internal.fetching=!1,this.flagOutputDirty("fetching"),this.sendSignalOnOutput("completed")},doExternalFetch:function(a){var b=this,c=new window.XMLHttpRequest,d=this._internal.backendProperties.backendEndpoint+a.resource;if(Object.keys(a.parameters).length>0){d+="?";for(var e in a.parameters)d+=e+"="+a.parameters[e]+"&"}c.open(a.method,window.encodeURI(d),!0);for(var f in a.headers)c.setRequestHeader(f,a.headers[f]);c.onreadystatechange=function(){var c=(this.response,!1);if(4===this.readyState||this.readyState===XMLHttpRequest.DONE){var d=this.status,e=this.getResponseHeader("content-type"),f=this.response;e&&(e=e.toLowerCase(),e.indexOf("/json")!==-1?(b.doResponse(d,JSON.parse(f),a),c=!0):e.indexOf("/xml")!==-1&&(h.parseString(f,function(c,e){b.doResponse(d,c?f:e,a)}),c=!0)),c===!1&&b.doResponse(d,f,a)}},c.onerror=function(){console.log("REST: Failed to request",d)},a.content?(c.setRequestHeader("Content-Type","application/json"),c.send(JSON.stringify(a.content))):c.send()},doPrototypeFetch:function(a){var b=this,c=this._internal.backendProperties.backendScript,d=new Function("context",c),e={request:a,sendResponse:function(c,d){b.doResponse(c,d,a)}};d(e)},doFetch:function(){if(this._internal.hasScheduledFetch=!1,this._internal.useExternalFile===!0&&this._internal.isWaitingForExternalFileToLoad===!0)return void(this._internal.hasPendingFetch=!0);this.sendSignalOnOutput("started"),this._internal.fetching=!0,this.flagOutputDirty("fetching");var a=this._internal.resource;for(var b in this._internal.requestInputs)a=a.replace("{"+b+"}",this._internal.requestInputs[b]);var c={resource:a,headers:{},method:void 0!==this._internal.method?this._internal.method:"GET",parameters:{}};if(this._internal.requestFunction){var d={inputs:this._internal.requestInputs,outputs:this._internal.responseOutputs};this._internal.requestFunction.apply(d,[this._internal.requestInputs,c])}void 0===this._internal.backendType||"external"===this._internal.backendType?this.doExternalFetch(c):this.doPrototypeFetch(c)}}};b.exports={node:k,setup:function(a,b){a.editorConnection&&b.on("nodeAdded.REST",function(b){f(b,a.editorConnection),b.on("parameterUpdated",function(c){f(b,a.editorConnection)})})}}},{"../../guid":202,"../../javascriptnodeparser":204,"../../node":208,"../../nodedefinition":210,xml2js:177}],228:[function(a,b,c){"use strict";function d(a,b){b=b||",";for(var c,d=new RegExp("(\\"+b+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+b+"\\r\\n]*))","gi"),e=[[]],f=null;(f=d.exec(a))&&c!==d.lastIndex;){c=d.lastIndex;var g=f[1];g.length&&g!==b&&e.push([]);var h;h=f[2]?f[2].replace(new RegExp('""',"g"),'"'):f[3],e[e.length-1].push(h)}return e}var e=a("../../nodedefinition"),f=a("./collection"),g={name:"Static Data",category:"Data",
color:"data",dynamicports:[{name:"conditionalports/basic",condition:"type = csv OR type NOT SET",ports:[{name:"csv",plug:"input",type:{name:"string",codeeditor:"text"},displayName:"CSV",group:"General"}]},{name:"conditionalports/basic",condition:"type = json",ports:[{name:"json",plug:"input",type:{name:"string",codeeditor:"json"},displayName:"JSON",group:"General"}]}],inputs:{type:{type:{name:"enum",enums:[{label:"CSV",value:"csv"},{label:"JSON",value:"json"}]},displayName:"Type",group:"General",default:"csv",set:function(a){this._internal.type=a}},csv:{set:function(a){this._internal.csv=a,this.scheduleParseData()}},json:{set:function(a){this._internal.json=a,this.scheduleParseData()}}},outputs:{items:{type:"collection",displayName:"Items",group:"General",getter:function(){return this._internal.collection}}},prototypeExtensions:{scheduleParseData:function(){var a=this._internal;a.hasScheduledParseData||(a.hasScheduledParseData=!0,this.scheduleAfterInputsHaveUpdated(this.parseData.bind(this)))},parseData:function(){var a=this._internal;if(a.hasScheduledParseData=!1,a.collection||(a.collection=f.get()),void 0===a.type||"csv"===a.type){for(var b=d(a.csv),c=[],e=b[0],g=1;g<b.length;g++){for(var h=b[g],i={},j=0;j<e.length;j++)i[e[j]]=h[j];c.push(i)}a.collection.set(c),this.flagOutputDirty("items")}else if("json"===a.type){var c=JSON.parse(a.json);a.collection.set(c),this.flagOutputDirty("items")}}}};b.exports=e.defineNode(g)},{"../../nodedefinition":210,"./collection":220}],229:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a){var b=this._internal.snapPositions.length-1;return this._internal.snapPositions.some(function(c,d){return c>a&&(b=d-1,!0)}),b}function f(a){this._internal.currentSnappedIndex!==a&&(this._internal.currentSnappedIndex=a,this.flagOutputDirty("currentIndex"))}function g(a,b,c){var e=b+(c>0?1:-1);return e=d(0,a.length-1,e)}function h(a,b,c,e){var f=.5,g=.02,h=50,i=a.length-1,j=Math.abs(c-a[b]),k=Math.abs(e);if(j<h&&k<f)return b;for(var l=0;l<a.length;++l){if(j=Math.abs(c-a[l]),j<h&&k<g){i=l,e>0&&i--;break}if(a[l]>c){i=l-1;break}}return e>0&&i++,d(0,a.length-1,i)}function i(a,b,c){var d;if("none"!==this._internal.snapBehavior){d="everyPosition"===this._internal.snapBehavior?g(this._internal.snapPositions,a,c):h(this._internal.snapPositions,this._internal.currentSnappedIndex,b,c);var e=this._internal.snapAnimation;e.startPosition=b,e.endPosition=this._internal.snapPositions[d],e.start(),f.call(this,d)}}function j(a){var b=a;this._internal.clampEnabled===!0&&(b=d(this._internal.clampMin,this._internal.clampMax,a)),0===this._internal.dragGestureRecognizer.axis?this._internal.target.setPositionX(b):this._internal.target.setPositionY(b)}function k(){var a=this._internal.target._internal.uiControl;return 0===this._internal.dragGestureRecognizer.axis?a.positionX:a.positionY}function l(a,b){if(a._internal.dragEnabled!==!1){var c=a._internal.dragGestureRecognizer.onTouch(b);return a._internal.track?c:void 0}}var m=(a("../node"),a("../nodedefinition")),n=a("../easecurves"),o={name:"Drag",category:"Interaction",initialize:function(){var a=this,b=this._internal;b.snapPositions=[0],b.target=void 0,b.track=!0,b.startSnapIndex=0,b.currentSnappedIndex=0,b.snapBehavior="none",b.dragEnabled=!0,b.dragRatio=1,b.snapDuration=300,b.clampMin=0,b.clampMax=0,b.clampEnabled=!1,b.snapAnimation=this.context.timerScheduler.createTimer({duration:b.snapDuration,ease:n.easeOut,startPosition:0,endPosition:0,onRunning:function(b){j.call(a,this.ease(this.startPosition,this.endPosition,b))}}),b.controlStart=0,b.indexOnDragStart=0,b.snapIndex=0,b.dragGestureRecognizer={},b.dragGestureRecognizer=this.context.uiEngine.createDragGestureRecognizer({axis:0,threshold:5,onDragStart:function(){b.snapAnimation.stop(),a.sendSignalOnOutput("dragStart"),b.controlStart=k.call(a),b.indexOnDragStart=e.call(a,b.controlStart)},onDrag:function(){var c=b.controlStart+this.dragDistance*b.dragRatio;if("none"!==b.snapBehavior){var e=b.snapPositions[0],f=b.snapPositions[b.snapPositions.length-1];c=d(e,f,c)}j.call(a,c)},onDragEnd:function(){a.sendSignalOnOutput("dragEnd"),i.call(a,b.indexOnDragStart,k.call(a),this.velocity)}})},inputs:{target:{type:"reference",displayName:"Target",group:"Target Node",set:function(a){if(this._internal.target&&(this._internal.target.removeTouchHandlersWithId(this),this._internal.target=void 0),a){var b=a.getVisualRoot();if(!b._internal.uiControl)throw new Error("target must be a visual node, not a "+b.name);this._internal.target=b,this._internal.target.addTouchHandler(l.bind(null,this),this);var c=this;this.context.scheduleAfterUpdate(function(){"none"!==c._internal.snapBehavior&&j.call(c,c._internal.snapPositions[c._internal.startSnapIndex])})}}},axis:{type:{name:"enum",enums:[{value:"0",label:"Horizontal"},{value:"1",label:"Vertical"}]},default:"0",displayName:"Drag Direction",group:"Drag Behavior",set:function(a){this._internal.dragGestureRecognizer.axis=Number(a)}},snapBehavior:{type:{name:"enum",enums:[{value:"none",label:"None"},{value:"everyPosition",label:"Every Position"},{value:"closestPosition",label:"Closest Position"}]},default:"none",group:"Drag Behavior",displayName:"Snap Behavior",set:function(a){this._internal.snapBehavior=a}},track:{type:"boolean",displayName:"Track Touch",group:"Drag Behavior",default:!0,set:function(a){this._internal.track=a}},dragThreshold:{type:{name:"number",allowEditOnly:!0},displayName:"Drag Threshold",group:"Drag Behavior",default:5,set:function(a){this._internal.dragGestureRecognizer.threshold=a}},dragEnabled:{type:{name:"boolean"},displayName:"Drag Enabled",group:"Drag Behavior",default:!0,set:function(a){this._internal.dragEnabled=!!a}},dragRatio:{type:"number",displayName:"Drag Ratio",default:1,group:"Drag Behavior",set:function(a){this._internal.dragRatio=Number(a)}},"snapToIndex.index":{type:"number",displayName:"Index",group:"Snap To Index",default:0,set:function(a){a===!0?a=1:a===!1&&(a=0),this._internal.snapIndex=Math.floor(a)}},"snapToIndex.duration":{type:"number",displayName:"Duration",editorName:"Duration|Snap To Index",group:"Snap To Index",default:300,set:function(a){this._internal.snapDuration=a}},"snapToIndex.do":{group:"Snap To Index",displayName:"Do",editorName:"Do|Snap To Index",valueChangedToTrue:function(){var a=this._internal.snapAnimation,b=this;this.scheduleAfterInputsHaveUpdated(function(){a.startPosition=k.call(b),a.endPosition=b._internal.snapPositions[b._internal.snapIndex],a.duration=b._internal.snapDuration,a.start(),f.call(b,b._internal.snapIndex)})}},"clampDragPosition.min":{type:{name:"number"},displayName:"Start",group:"Constrain",default:0,set:function(a){this._internal.clampMin=a}},"clampDragPosition.max":{type:{name:"number"},displayName:"End",group:"Constrain",default:0,set:function(a){this._internal.clampMax=a}},"clampDragPosition.enabled":{type:{name:"boolean"},displayName:"Constrain",group:"Constrain",default:!1,set:function(a){this._internal.clampEnabled=a}}},numberedInputs:{position:{name:"numbered/simple-number",displayPrefix:"Position",group:"Snap Positions",createSetter:function(a){return function(b){this._internal.snapPositions[a]=b}},selectors:{startAt:{displayName:"Start At",group:"Snap Positions",set:function(a){var b=this._internal;b.startSnapIndex=a,f.call(this,a),b.target&&a<b.snapPositions.length&&j.call(this,b.snapPositions[b.startSnapIndex])}}}}},outputs:{dragStart:{group:"Signals",type:"signal",displayName:"Drag Started"},dragEnd:{group:"Signals",type:"signal",displayName:"Drag Ended"},currentIndex:{group:"Current State",type:"number",displayName:"Current Index",getter:function(){return this._internal.currentSnappedIndex}}}};b.exports=m.defineNode(o)},{"../easecurves":196,"../node":208,"../nodedefinition":210}],230:[function(a,b,c){"use strict";var d={name:"Event Receiver",category:"Events",usePortAsLabel:"channelName",color:"component",initialize:function(){var a=this._internal;a.outputValues={},a.outputNames=[],a.eventReceived=!1,a._isEnabled=!0,a.channelName=""},dynamicports:[{name:"portchannel/event-sender-channel",channelPort:{name:"channelName",displayName:"Channel",plug:"input"},port:{type:"*",plug:"output",allowConnectionOnly:!0}}],inputs:{enabled:{displayName:"Enabled",type:"boolean",default:!0,set:function(a){this._internal._isEnabled=!!a}},channelName:{set:function(a){this._internal.onEventReceivedCallback&&(this.context.eventSenderEmitter.removeListener(this._internal.channelName,this._internal.onEventReceivedCallback),this._internal.onEventReceivedCallback=null),this._internal.channelName=a,this.registerListenersForChannel(a)}}},outputs:{eventReceived:{displayName:"Event Received",type:"signal"}},prototypeExtensions:{registerOutputIfNeeded:function(a){if(!this.hasOutput(a)){var b=this;this._internal.outputNames.push(a),this.registerOutput(a,{getter:function(){return b._internal.outputValues[a]}})}},handleEvent:function(a){if(this._internal._isEnabled!==!1){this.sendSignalOnOutput("eventReceived");for(var b in a)this.hasOutput(b)&&(this._internal.outputValues[b]=a[b],this.flagOutputDirty(b))}},onEventReceived:function(a){this.handleEvent(a)},registerListenersForChannel:function(a){var b=this.context.eventSenderEmitter;this._internal.onEventReceivedCallback=this.onEventReceived.bind(this),b.on(a,this._internal.onEventReceivedCallback);var c=this;this.context.eventEmitter.once("applicationDataReloaded",function(){c._internal.onEventReceivedCallback&&b.removeListener(a,c._internal.onEventReceivedCallback)})},getChannelName:function(){return this._internal.channelName}}};b.exports={node:d}},{}],231:[function(a,b,c){"use strict";var d={name:"Event Sender",category:"Events",usePortAsLabel:"channelName",color:"component",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Inputs",plug:"input",type:{name:"*",allowConnectionOnly:!0}}],initialize:function(){this._internal.inputValues={},this._internal.channelName="",this._internal.propagation="global"},inputs:{sendEvent:{displayName:"Send Event",valueChangedToTrue:function(){var a=this;this.scheduleAfterInputsHaveUpdated(function(){"global"===a._internal.propagation?a.context.sendGlobalEventFromEventSender(a._internal.channelName,a._internal.inputValues):a.nodeScope.sendEventFromThisScope(a._internal.channelName,a._internal.inputValues,a._internal.propagation)})}},channelName:{type:{name:"string",allowEditOnly:!0},default:"",group:"Settings",displayName:"Channel Name",set:function(a){this._internal.channelName=a,this._internal.inputValues._channelName=a}},propagation:{type:{name:"enum",enums:[{value:"global",label:"Global"},{value:"parent",label:"Parent"},{value:"children",label:"Children"}]},default:"global",group:"Settings",displayName:"Propagation",set:function(a){this._internal.propagation=a}}},prototypeExtensions:{registerInputIfNeeded:{value:function(a){if(!this.hasInput(a)){var b=this;this.registerInput(a,{set:function(c){b._internal.inputValues[a]=c}})}}}}};b.exports={node:d}},{}],232:[function(a,b,c){"use strict";function d(a,b){function c(){return a.apply(this,b)}return c.prototype=a.prototype,new c}function e(a){function b(a){l.indexOf(a)===-1&&(d.some(function(b){return b===a})||d.push(a))}function c(a){"Identifier"!==a.type||a.raw?"ConditionalExpression"===a.type?(c(a.test),c(a.consequent),c(a.alternate)):"MemberExpression"===a.type?c(a.object):"CallExpression"===a.type?(c(a.callee),a.arguments.forEach(c)):"UnaryExpression"===a.type?c(a.argument):"BinaryExpression"!==a.type&&"LogicalExpression"!==a.type||(c(a.left),c(a.right)):b(a.name)}var d=[];try{var e=h(a);c(e)}catch(f){d=[]}return d}function f(a,b,c){var d=e(b),f=d.map(function(a){return{name:a,type:"number",plug:"input"}});c.sendDynamicPorts(a,f)}var g=(a("../node"),a("lodash")),h=a("jsep"),i={name:"Expression",category:"Math",usePortAsLabel:"expression",initialize:function(){var a=this._internal;a.scope={},a.hasScheduledEvaluation=!1,a.code=void 0,a.cachedValue=0,a.currentExpression="",a.compiledFunction=void 0,a.inputNames=[],a.inputValues=[]},inputs:{expression:{inputPriority:1,type:{name:"string",allowEditOnly:!0},displayName:"Expression",set:function(a){var b=this._internal;b.currentExpression=j+"return ("+a+");",b.compiledFunction=void 0;var c=e(a),d=g.difference(c,b.inputNames),f=g.difference(b.inputNames,c),h=this;f.forEach(function(a){h.deregisterInput(a),delete b.scope[a]}),d.forEach(function(a){h.registerInput(a,{set:function(c){b.scope[a]=c,this._scheduleEvaluateExpression()}}),b.scope[a]=0,h._cachedInputValues[a]=0}),b.inputNames=Object.keys(b.scope),this._scheduleEvaluateExpression()}}},outputs:{result:{type:"number",displayName:"Result",getter:function(){return this._internal.currentExpression?this._internal.cachedValue:0}}},prototypeExtensions:{_scheduleEvaluateExpression:{value:function(){var a=this._internal;a.hasScheduledEvaluation===!1&&(a.hasScheduledEvaluation=!0,this.flagDirty(),this.scheduleAfterInputsHaveUpdated(function(){var b=a.cachedValue;a.cachedValue=this._calculateExpression(),b!==a.cachedValue&&this.flagOutputDirty("result"),a.hasScheduledEvaluation=!1}))}},_calculateExpression:{value:function(){var a=this._internal;a.compiledFunction||(a.compiledFunction=this._compileFunction());for(var b=0;b<a.inputNames.length;++b){var c=a.scope[a.inputNames[b]];a.inputValues[b]=c}try{return a.compiledFunction.apply(null,a.inputValues)}catch(d){console.error("Error in expression:",d.message)}return 0}},_compileFunction:{value:function(){var a=this._internal.currentExpression,b=Object.keys(this._internal.scope),c=a+b.join(" ");if(k.hasOwnProperty(c)===!1){b.push(a);try{k[c]=d(Function,b)}catch(e){console.error("Failed to compile JS function",e.message)}}return k[c]}}}},j=["var min = Math.min,    max = Math.max,    cos = Math.cos,    sin = Math.sin,    tan = Math.tan,    sqrt = Math.sqrt,    pi = Math.PI,    round = Math.round,    floor = Math.floor,    ceil = Math.ceil,    abs = Math.abs,    random = Math.random;"].join(""),k={},l=["min","max","cos","sin","tan","sqrt","pi","round","floor","ceil","abs","random","Math","window","document"];b.exports={node:i,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Expression",function(b){b.parameters.expression&&f(b.id,b.parameters.expression,a.editorConnection),b.on("parameterUpdated",function(c){"expression"===c.name&&f(b.id,b.parameters.expression,a.editorConnection)})})}}},{"../node":208,jsep:12,lodash:148}],233:[function(a,b,c){"use strict";var d={name:"Globals",category:"Utilities",color:"component",panels:[{name:"PortEditor",context:["select","connectTo","connectFrom"],title:"Globals",plug:"input/output",type:{name:"*"}}],prototypeExtensions:{_newOutputValueReceived:{value:function(a){this._cachedInputValues[a]=this.context.globalValues[a],this.flagOutputDirty(a)}},registerInputIfNeeded:{value:function(a){var b=this;this.hasInput(a)||this.registerInput(a,{set:b.context.setGlobalValue.bind(b.context,a)})}},registerOutputIfNeeded:{value:function(a){if(!this.hasOutput(a)){var b=this._newOutputValueReceived.bind(this,a),c=this.context.globalsEventEmitter;c.on(a,b),this.context.eventEmitter.once("applicationDataReloaded",function(){c.removeListener(a,b)}),this.registerOutput(a,{getter:function(){return this.context.globalValues[a]}})}}}}};b.exports={node:d}},{}],234:[function(a,b,c){"use strict";function d(a){a.alpha!==this._internal.alpha&&(this._internal.alpha=a.alpha,this.flagOutputDirty("rotationZ")),a.beta!==this._internal.beta&&(this._internal.beta=a.beta,this.flagOutputDirty("rotationX")),a.gamma!==this._internal.gamma&&(this._internal.gamma=a.gamma,this.flagOutputDirty("rotationY"))}var e=a("../nodedefinition"),f={name:"Gyroscope",displayNodeName:"Device Orientation",category:"Sensors",initialize:function(){this._internal.alpha=0,this._internal.beta=0,this._internal.gamma=0;var a=d.bind(this);window.addEventListener("deviceorientation",a),this.context.eventEmitter.once("applicationDataReloaded",function(){window.removeEventListener("deviceorientation",a)})},outputs:{rotationX:{type:"number",displayName:"Rotation X",getter:function(){return-this._internal.beta}},rotationY:{type:"number",displayName:"Rotation Y",getter:function(){return this._internal.gamma}},rotationZ:{type:"number",displayName:"Rotation Z",getter:function(){return-this._internal.alpha}}}};b.exports=e.defineNode(f)},{"../nodedefinition":210}],235:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e={name:"Inverter",category:"Math",initialize:function(){this._internal.currentValue=!1},inputs:{value:{type:{name:"boolean"},displayName:"Value",set:function(a){this._internal.currentValue=a,this.flagOutputDirty("result")}}},outputs:{result:{type:"boolean",displayName:"Result",getter:function(){return!this._internal.currentValue}}}};b.exports=d.defineNode(e)},{"../nodedefinition":210}],236:[function(a,b,c){"use strict";function d(){return this._internal.isFirstFrame?void(this._internal.isFirstFrame=!1):(this._evaluateFunction(),this.context.nodeIsDirty(this),void this.flagDirty())}function e(a,b){this._internal.needsToEval=!0,this._internal.inputValues[a]=b,this.flagDirty()}function f(a){return this._internal.needsToEval&&this._evaluateFunction(),this._internal.outputValues[a]}var g=a("../nodedefinition"),h=a("../node"),i={};b.exports=g.defineNode({name:"Javascript",category:"Javascript",displayNodeName:"Javascript (Deprecated)",deprecated:!0,panels:[{name:"PortEditor",context:["select"],title:"Inputs",plug:"input",type:{name:"*"}},{name:"PortEditor",context:["select"],title:"Outputs",plug:"output",type:{name:"*"}}],initialize:function(){var a=this._internal;a.inputValues={},a.outputValues={},a.needsToEval=!1;var b=this;a.userFunctionScope={flagOutputDirty:function(a){if(!a)throw new Error("Output port name must be specified");b.flagOutputDirty(a)}},a.isFirstFrame=!0,a.onFrameStart=d.bind(this)},inputs:{code:{type:{name:"string",allowEditOnly:!0,codeeditor:"javascript"},displayName:"code",group:"Code",set:function(a){i[a]||(i[a]=new Function("inputs","outputs",a)),this._internal.userFunction=i[a],this._internal.needsToEval=!0}},runEveryFrame:{type:"boolean",displayName:"Run Every Frame",group:"Settings",set:function(a){a=!!a;var b=this.context.eventEmitter;a===!0?b.on("frameStart",this._internal.onFrameStart):b.removeListener("frameStart",this._internal.onFrameStart)}}},prototypeExtensions:{update:{value:function(){this._dirty===!1||this._isUpdating||(h.prototype.update.call(this),this._internal.needsToEval&&(this._evaluateFunction(),this.flagDirty()))}},registerInputIfNeeded:{value:function(a){this.hasInput(a)||this.registerInput(a,{set:e.bind(this,a)})}},registerOutputIfNeeded:{value:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:f.bind(this,a)})}},_evaluateFunction:{value:function(){var a=this._internal;a.userFunction.call(a.userFunctionScope,a.inputValues,a.outputValues),a.needsToEval=!1}},flagDirty:{value:function(){for(var a in this._internal.outputValues)this.flagOutputDirty(a);h.prototype.flagDirty.call(this)}}}})},{"../node":208,"../nodedefinition":210}],237:[function(a,b,c){"use strict";function d(){for(var a in this._internal.dirtyOutputs)this.flagOutputDirty(a);this._internal.dirtyOutputs={}}function e(){this._internal.setupScheduled||(this._internal.setupScheduled=!0,this.scheduleAfterInputsHaveUpdated(function(){this._callSetupFunction(),this._internal.setupScheduled=!1,d.call(this)}))}function f(){this._internal.runScheduled||(this._internal.runScheduled=!0,this.scheduleAfterInputsHaveUpdated(function(){this._callRunFunction(),this._internal.runScheduled=!1,d.call(this)}))}function g(){this._internal.runNextFrame=!1,f.call(this)}function h(a,b){this._internal.inputValues[a]=b,this._internal.hasParsedCode===!0&&f.call(this)}function i(a){return this._internal.outputValues[a]}function j(a,b){function c(b){b.error?d.sendWarning(a.component.name,a.id,"js-parse-waring",{message:b.error}):d.sendDynamicPorts(a.id,b.getPorts())}var d=b.editorConnection;if(a.parameters)if(a.parameters.externalFile&&"yes"===a.parameters.useExternalFile){var e=a.parameters.externalFile;b.runningInEditor&&"/"!==e[0]&&(e="/"+e),l.createFromURL(e,null,c)}else if(a.parameters.code){var f=l.createFromCode(a.parameters.code,null);c(f)}}var k=a("../node"),l=a("../javascriptnodeparser"),m=["define({","    inputs: {",'        inputValue: "number"',"    },","    outputs: {",'        outputValue: "number"',"    },","    setup: function(inputs, outputs) {","","    },","    run: function(inputs, outputs) {","","    }","});"].join("\n"),n={name:"Javascript2",displayNodeName:"Javascript",category:"Javascript",color:"javascript",initialize:function(){var a=this._internal;a.inputValues={},a.outputValues={},a.outputProperties={},a.dirtyOutputs={},a.runScheduled=!1,a.setupScheduled=!1,a.runNextFrameScheduled=!1,a.isWaitingForExternalFileToLoad=!1,a.useExternalFile=!1,a.runFunction=void 0,a.setupFunction=void 0,a.hasParsedCode=!1;var b=this;a.userFunctionScope={flagOutputDirty:function(c){if(!c)throw new Error("Output port name must be specified");b.flagOutputDirty(c),a.dirtyOutputs.hasOwnProperty(c)&&delete a.dirtyOutputs[c]},runNextFrame:function(){a.runNextFrameScheduled||(a.runNextFrameScheduled=!0,b.context.scheduleNextFrame(function(){a.runNextFrameScheduled=!1,f.call(b)}))},sendSignalOnOutput:function(c){a.outputValues[c]=!0,b.flagOutputDirty(c),a.outputValues[c]=!1,b.flagOutputDirty(c)}},a.onFrameStart=g.bind(this)},dynamicports:[{name:"conditionalports/basic",condition:"useExternalFile = no OR useExternalFile NOT SET",ports:[{name:"code",displayName:"Code",group:"Code",plug:"input",type:{name:"string",allowEditOnly:!0,codeeditor:"javascript"},default:m}]},{name:"conditionalports/basic",condition:"useExternalFile = yes",ports:[{name:"externalFile",displayName:"File Path",group:"Code",plug:"input",type:{name:"source",allowEditOnly:!0}}]}],inputs:{useExternalFile:{type:{name:"enum",enums:[{value:"yes",label:"Yes"},{value:"no",label:"No"}],allowEditOnly:!0},default:"no",displayName:"Use External File",group:"Code",set:function(a){this._internal.isWaitingForExternalFileToLoad="yes"===a,this._internal.useExternalFile="yes"===a}},code:{set:function(a){if(a){var b=this;this.scheduleAfterInputsHaveUpdated(function(){if(this._internal.useExternalFile===!1){var c=l.createFromCode(a,b.nodeScope.noodlJavascriptAPI);b._onCodeParsed(c)}})}}},externalFile:{set:function(a){if(this._internal.useExternalFile!==!1){this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a);var b=this;l.createFromURL(a,this.nodeScope.noodlJavascriptAPI,function(a){b._internal.isWaitingForExternalFileToLoad=!1,b._onCodeParsed(a)})}}}},prototypeExtensions:{update:function(){this._internal.isWaitingForExternalFileToLoad===!0?this._dirty=!1:k.prototype.update.call(this)},_onCodeParsed:function(a){if(this.context.editorConnection&&(this.context.editorConnection.clearWarnings(this.nodeScope.componentOwner.name,this.id),a.error?this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-parse-waring",{message:a.error}):this.context.editorConnection.sendDynamicPorts(this.id,a.getPorts())),!a.error){var b=this;Object.keys(a.outputs).forEach(function(a){b.registerOutputIfNeeded(a)}),this._internal.setupFunction=a.setup,this._internal.runFunction=a.run,this._internal.setupFunction&&e.call(this),this._internal.runFunction&&f.call(this),this._internal.hasParsedCode=!0}},registerInputIfNeeded:function(a){this.hasInput(a)||(this._internal.inputValues[a]=void 0,this.registerInput(a,{set:h.bind(this,a)}))},registerOutputIfNeeded:function(a){if(!this.hasOutput(a)){var b=this;Object.defineProperty(this._internal.outputProperties,a,{set:function(c){b._internal.outputValues[a]=c,b._internal.dirtyOutputs[a]=!0,b.context.scheduleFrame()},get:function(){return b._internal.outputValues[a]}}),this.registerOutput(a,{getter:i.bind(this,a)})}},_callRunFunction:function(){var a=this._internal;if(a.runFunction)try{a.runFunction.call(a.userFunctionScope,a.inputValues,a.outputProperties)}catch(b){console.log("Error in JS node run code.",Object.getPrototypeOf(b).constructor.name+": "+b.message),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-run-waring",{message:"<strong>run</strong>: "+b.message})}},_callSetupFunction:function(){var a=this._internal;if(a.setupFunction)try{a.setupFunction.call(a.userFunctionScope,a.inputValues,a.outputProperties)}catch(b){console.log("Error in JS node setup code.",Object.getPrototypeOf(b).constructor.name+": "+b.message),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-setup-waring",{message:"<strong>setup</strong>: "+b.message})}}}};b.exports={node:n,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Javascript2",function(b){j(b,a),b.on("parameterUpdated",function(c){j(b,a)})})}}},{"../javascriptnodeparser":204,"../node":208}],238:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e=a("../easecurves");b.exports=d.defineNode({name:"Number Blend",category:"Interpolation",initialize:function(){var a=this._internal;a.inputs=[],a.blendValue=0,a.result=0,a.clamp=!1},prototypeExtensions:{updateResult:function(){var a=this._internal.inputs;if(0===a.length)return 0;var b=Math.floor(this._internal.blendValue),c=this._internal.blendValue-b;b>=a.length-1?this._internal.clamp?(b=a.length-1,c=0):(c+=b-(a.length-1),b=a.length-1):b<=0&&(this._internal.clamp?(b=0,c=0):(c+=b,b=0)),0===c||1===a.length?this._internal.result=a[b]:b===a.length-1&&c>0?this._internal.result=e.linear(a[b-1],a[b],c+1):this._internal.result=e.linear(a[b],a[b+1],c),this.flagOutputDirty("result")}},numberedInputs:{input:{name:"numbered/simple-number",displayPrefix:"Number",createSetter:function(a){var b=this._internal.inputs;return b[a]=0,function(c){b[a]!==c&&(b[a]=c,this.updateResult())}}}},inputs:{blendValue:{type:"number",displayName:"Blend Value",default:0,set:function(a){this._internal.blendValue=a,this.updateResult()}},clamp:{type:"boolean",displayName:"Clamp",default:!1,set:function(a){this._internal.clamp=!!a,this.updateResult()}}},outputs:{result:{type:"number",displayName:"Result",getter:function(){return this._internal.result}}}})},{"../easecurves":196,"../nodedefinition":210}],239:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Number Remapper",category:"Math",initialize:function(){var a=this._internal;a._currentInputValue=0,a._remappedValue=0,a._minInputValue=0,a._maxInputValue=0,a._minOutputValue=0,a._maxOutputValue=1,a._clampOutput=!0},inputs:{inputValue:{group:"Value to Remap",type:{name:"number",allowConnectionOnly:!0},default:0,displayName:"Input Value",set:function(a){this._internal._currentInputValue=a,this._calculateNewOutputValue()}},minInputValue:{group:"Input Parameters",type:{name:"number"},default:0,displayName:"Input Minimum",set:function(a){this._internal._minInputValue=a,this._calculateNewOutputValue()}},maxInputValue:{group:"Input Parameters",type:{name:"number"},default:0,displayName:"Input Maximum",set:function(a){this._internal._maxInputValue=a,this._calculateNewOutputValue()}},minOutputValue:{group:"Output Parameters",type:{name:"number"},default:0,displayName:"Output Minimum",set:function(a){this._internal._minOutputValue=a,this._calculateNewOutputValue()}},maxOutputValue:{group:"Output Parameters",type:{name:"number"},default:1,displayName:"Output Maximum",set:function(a){this._internal._maxOutputValue=a,this._calculateNewOutputValue()}},clamp:{group:"Output Parameters",type:{name:"boolean",allowEditOnly:!0},default:!0,displayName:"Clamp Output",set:function(a){this._internal._clampOutput=!!a,this._calculateNewOutputValue()}}},outputs:{remappedValue:{type:"number",displayName:"Remapped Value",group:"Outputs",getter:function(){return this._internal._remappedValue}}},prototypeExtensions:{_calculateNewOutputValue:{value:function(){var a,b=this._internal;a=b._maxInputValue===b._minInputValue?0:(b._currentInputValue-b._minInputValue)/(b._maxInputValue-b._minInputValue),b._clampOutput&&(a=Math.max(0,Math.min(1,a))),b._remappedValue=b._minOutputValue+a*(b._maxOutputValue-b._minOutputValue),this.flagOutputDirty("remappedValue")}}}})},{"../nodedefinition":210}],240:[function(a,b,c){"use strict";function d(a){return!!a}var e=a("../nodedefinition");b.exports=e.defineNode({name:"Or",category:"Logic",initialize:function(){this._internal.inputs=[]},numberedInputs:{input:{name:"numbered/simple-boolean",displayPrefix:"Input",createSetter:function(a){return function(b){this._internal.inputs[a]!==b&&(this._internal.inputs[a]=b,this.flagOutputDirty("result"))}}}},outputs:{result:{type:"boolean",displayName:"Result",getter:function(){return this._internal.inputs.some(d)}}}})},{"../nodedefinition":210}],241:[function(a,b,c){"use strict";function d(a){for(var b=a.getNodesWithTypeRecursive("Page");0===b.length&&a.componentOwner;)a=a.componentOwner.parentNodeScope,b=a.getNodesWithTypeRecursive("Page");var c=b[0];return c._internal.pagesNode}var e=a("../nodedefinition"),f=a("lodash"),g=a("../node");b.exports=e.defineNode({name:"Page Navigation",category:"Navigation",initialize:function(){this._internal.inputValues={},this._internal.portUpdateScheduled=!1,this._internal.targetPagesNode=null,this._internal.resetPageStack=!1},inputs:{navigate:{displayName:"Navigate To Page",group:"Navigation",valueChangedToTrue:function(){this.scheduleAfterInputsHaveUpdated(this._doNavigation.bind(this))}},destination:{displayName:"Destination",group:"Navigation",type:"component",set:function(a){var b=this._internal;if(b.destinationComponentModel&&(b.destinationComponentModel.removeListenersWithRef(this),b.destinationComponentModel=void 0),this.context.hasComponentModelWithName(a)!==!1){b.destinationComponentModel&&b.destinationComponentModel.removeListenersWithRef(this),b.destinationComponentName=a;var c=this.context.getComponentModel(a);b.destinationComponentModel=c,this.updateDestinationPagePorts(c),c.on("inputPortAdded",this.scheduleUpdateDestinationPagePorts.bind(this,c),this),c.on("inputPortRemoved",this.scheduleUpdateDestinationPagePorts.bind(this,c),this)}}},targetPages:{displayName:"Pages Target",group:"Navigation",type:"reference",set:function(a){this._internal.targetPagesNode=a}},resetPageStack:{displayName:"Reset history",group:"Navigation",default:!1,type:"boolean",set:function(a){this._internal.resetPageStack=!!a}}},prototypeExtensions:{_doNavigation:function(){var a=this._internal;if(a.destinationComponentName){var b=a.destinationComponentModel.getInputPorts();for(var c in a.inputValues)b.hasOwnProperty(c)===!1&&delete a.inputValues[c];var e=this._internal.targetPagesNode,f=e?e:d(this.nodeScope);this._internal.resetPageStack?f.resetTo(a.destinationComponentName,a.inputValues):f.navigateTo(a.destinationComponentName,a.inputValues)}},_onNodeDeleted:function(){g.prototype._onNodeDeleted.call(this);var a=this._internal;a.destinationComponentModel&&a.destinationComponentModel.removeListenersWithRef(this)},registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:function(b){this._internal.inputValues[a]=b}})},scheduleUpdateDestinationPagePorts:function(a){if(!this._internal.portUpdateScheduled){this._internal.portUpdateScheduled=!0;var b=this;this.context.scheduleAfterUpdate(function(){b.updateDestinationPagePorts(a),b._internal.portUpdateScheduled=!1})}},updateDestinationPagePorts:function(a){var b=f.values(a.getInputPorts()).map(function(a){return{name:a.name,plug:"input",type:a.type,group:"Destination Page Inputs"}});this.context.editorConnection.sendDynamicPorts(this.id,b)}}})},{"../node":208,"../nodedefinition":210,lodash:148}],242:[function(a,b,c){"use strict";function d(a){for(var b=a.getNodesWithTypeRecursive("Page");0===b.length&&a.componentOwner;)a=a.componentOwner.parentNodeScope,b=a.getNodesWithTypeRecursive("Page");var c=b[0];return c._internal.pagesNode;
}var e=a("../nodedefinition");b.exports=e.defineNode({name:"Page Navigation Back",category:"Navigation",inputs:{back:{displayName:"Back",group:"Navigation",valueChangedToTrue:function(){var a=d(this.nodeScope);a.back()}}}})},{"../nodedefinition":210}],243:[function(a,b,c){"use strict";function d(a,b,c){for(var e in a){var f=c+e;"object"!=typeof a[e]||null===a[e]||Array.isArray(a[e])?b.push({key:f,value:a[e]}):d(a[e],b,f+".")}}function e(a,b){this._internal.topicComponents[a]=b,this.scheduleSubscribe()}function f(a){return this._internal.outputValues[a]}function g(a,b,c){var d=b.match(/\{([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\}/g),e=[];for(var f in d)e.push({name:d[f].replace(/(\{|\})/g,""),group:"Topic components",plug:"input",type:"*"});var g=b.match(/\+([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\+/g);for(var f in g)e.push({name:g[f].replace(/\+/g,""),group:"Topic components",plug:"output",type:"*"});c.sendDynamicPorts(a,e)}var h=a("../services/services"),i=a("../node"),j={name:"Receive Message",category:"Messages",usePortAsLabel:"topic",color:"component",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Payload",plug:"outputs",group:"Payload",type:{name:"*",allowConnectionOnly:!0}}],initialize:function(){var a=this._internal;a.payload={},a.messageReceived=!1,a.isEnabled=!0,a.topic="",a.topicComponents={},a.outputValues={},a.outputList=[]},inputs:{enabled:{displayName:"Enabled",type:"boolean",default:!0,set:function(a){this._internal.isEnabled=!!a}},topic:{displayName:"Topic",type:"string",default:"",set:function(a){this._internal.topic=a,this.scheduleSubscribe()}}},outputs:{messageReceived:{displayName:"Received",type:"signal"}},prototypeExtensions:{_onNodeDeleted:function(){i.prototype._onNodeDeleted.call(this),this.subscription&&(h.pubsub.unsubscribe(this.subscription.topic,this.subscription.subscriber),this.subscription=void 0)},registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:e.bind(this,a)})},registerOutputIfNeeded:function(a){this.hasOutput(a)||(this._internal.outputList.push(a),this.registerOutput(a,{getter:f.bind(this,a)}))},computeTopic:function(){var a=this._internal.topic,b=this._internal.topicComponents;for(var c in b)a=a.replace("{"+c+"}",b[c]);return a.replace(/\+([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\+/g,"+")},handleMessage:function(a){if(this._internal.isEnabled!==!1){for(var b=this._internal.topic.split("/"),c=a.topic.split("/"),e=0;e<c.length;e++){var f=b[e];if("+"===f[0]&&"+"===f[f.length-1]){var g=f.substring(1,f.length-1);this._internal.outputValues[g]=c[e],this.flagOutputDirty(g)}}var h=[],i=a.payload;if("object"==typeof i)d(i,h,"");else{var j=this.model.outputPorts,k=Object.keys(j).sort(function(a,b){return j[a].index-j[b].index});i.split(",").forEach(function(a,b){h.push({key:k[b],value:a})})}for(var e=0;e<h.length;e++){var l=h[e];this._internal.outputValues[l.key]=l.value,this.hasOutput(l.key)&&this.flagOutputDirty(l.key)}this.sendSignalOnOutput("messageReceived"),this.context.scheduleFrame()}},onMessageReceived:function(a){this.handleMessage(a)},scheduleSubscribe:function(){var a=this;this._internal.subscribeScheduled||(this._internal.subscribeScheduled=!0,this.scheduleAfterInputsHaveUpdated(function(){a._internal.subscribeScheduled=!1,a.subscribe()}))},subscribe:function(){this.subscription&&(h.pubsub.unsubscribe(this.subscription.topic,this.subscription.subscriber),this.subscription=void 0);var a=this.computeTopic();if(a){var b=this.onMessageReceived.bind(this);this.subscription={topic:a,subscriber:b},h.pubsub.subscribe(a,b),this.context.eventEmitter.once("applicationDataReloaded",function(){h.pubsub.unsubscribe(a,b)})}}}};b.exports={node:j,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Receive Message",function(b){b.parameters.topic&&g(b.id,b.parameters.topic,a.editorConnection),b.on("parameterUpdated",function(c){"topic"===c.name&&g(b.id,b.parameters.topic,a.editorConnection)})})}}},{"../node":208,"../services/services":287}],244:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Reload",category:"Utilities",inputs:{reload:{displayName:"Reload",valueChangedToTrue:function(){this.context.reloadApplication()}}}})},{"../nodedefinition":210}],245:[function(a,b,c){"use strict";var d={name:"Screen Resolution",category:"Utilities",initialize:function(){var a=this;this.context.uiEngine.on("viewportSizeChanged",this._viewportSizeChanged.bind(this),this),this.context.eventEmitter.once("applicationDataReloaded",function(){a.context.uiEngine.removeListenersWithRef(a)}),this._viewportSizeChanged(this.context.uiEngine.getViewportSize())},outputs:{width:{type:"number",displayName:"Width",getter:function(){return this._internal.width}},height:{type:"number",displayName:"Height",getter:function(){return this._internal.height}},aspectRatio:{type:"number",displayName:"Aspect Ratio",getter:function(){return this._internal.width/this._internal.height}}},prototypeExtensions:{_viewportSizeChanged:function(a){this._internal.width=a.width,this._internal.height=a.height,this.flagAllOutputsDirty()}}};b.exports={node:d}},{}],246:[function(a,b,c){"use strict";function d(){return"undefined"!=typeof window?window.performance.now():+new Date}function e(a,b,c){return a.length>0&&(a+=","),a+=c}function f(a,b,c){for(var d=b.split("."),e=0;e<d.length-1;e++)a[d[e]]||(a[d[e]]={}),a=a[d[e]];return a[d[d.length-1]]=c,a}function g(a,b){this._internal.inputValues[a]=b,this._internal.publishOnInputsChanged&&this.schedulePublish()}function h(a,b,c){var d=b.match(/\{([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\}/g),e=[];for(var f in d)e.push({name:d[f].replace(/(\{|\})/g,""),group:"Topic components",plug:"input",type:"*"});c.sendDynamicPorts(a,e)}var i=a("../services/services"),j={name:"Send Message",category:"Messages",usePortAsLabel:"topic",color:"component",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Payload",plug:"input",group:"Payload",type:{name:"*",allowConnectionOnly:!0}}],initialize:function(){this._internal.payload={},this._internal.topic="",this._internal.inputValues={},this._internal.topicComponentsMap={},this._internal.hasScheduledPublish=!1,this._internal.publishOnInputsChanged=!1,this._internal.rateLimitEnabled=!1,this._internal.maxMessagesPerSecond=10,this._internal.lastPublishTime=0,this._internal.format="json"},dynamicports:[{name:"conditionalports/basic",condition:"rateLimit = true",ports:[{name:"maxMessagesPerSecond",type:"number",default:10,displayName:"Messages / Sec",group:"Rate Limit",plug:"input"}]}],inputs:{send:{displayName:"Send",valueChangedToTrue:function(){this.schedulePublish()}},topic:{type:{name:"string"},default:"",displayName:"Topic",group:"General",set:function(a){this._internal.topic=a;var b=a.match(/\{([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\}/g);for(var c in b)this._internal.topicComponentsMap[b[c].replace(/(\{|\})/g,"")]=!0}},format:{type:{name:"enum",enums:[{value:"json",label:"JSON"},{value:"csv",label:"CSV"}]},displayName:"Format",group:"General",default:"json",set:function(a){this._internal.format=a}},publishOnInputsChanged:{type:"boolean",default:!1,displayName:"Send On Change",group:"General",set:function(a){this._internal.publishOnInputsChanged=!!a}},rateLimit:{type:"boolean",default:!1,displayName:"Rate Limit",group:"Rate Limit",set:function(a){this._internal.rateLimitEnabled=!!a}},maxMessagesPerSecond:{set:function(a){this._internal.maxMessagesPerSecond=Number(a)}}},prototypeExtensions:{registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:g.bind(this,a)})},computeTopic:function(){var a=this._internal.topic,b=this._internal.topicComponentsMap,c=this._internal.inputValues;for(var d in b)a=a.replace("{"+d+"}",c[d]);return a},schedulePublish:function(){if(!this._internal.hasScheduledPublish){if(this._internal.rateLimitEnabled){clearTimeout(this._internal.rateLimitTimeoutId);var a=d(),b=1e3/this._internal.maxMessagesPerSecond,c=a-this._internal.lastPublishTime;if(c<b)return void(this._internal.rateLimitTimeoutId=setTimeout(this.schedulePublish.bind(this),b-c))}this._internal.hasScheduledPublish=!0,this.scheduleAfterInputsHaveUpdated(function(){this._internal.hasScheduledPublish=!1;var a,b,c=this.computeTopic(),g=this._internal.inputValues,h=this._internal.topicComponentsMap;"csv"===this._internal.format?(b=e,a=""):(b=f,a={});for(var j in g)h[j]||(a=b(a,j,g[j]));i.pubsub.publish(c,a),this._internal.lastPublishTime=d()})}}}};b.exports={node:j,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Send Message",function(b){b.parameters.topic&&h(b.id,b.parameters.topic,a.editorConnection),b.on("parameterUpdated",function(c){"topic"===c.name&&h(b.id,b.parameters.topic,a.editorConnection)})})}}},{"../services/services":287}],247:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e=a("../edgetriggeredinput");b.exports=d.defineNode({name:"Signal To Index",category:"Logic",initialize:function(){this._internal.currentIndex=0},numberedInputs:{input:{name:"numbered/simple-boolean",displayPrefix:"Signal",createSetter:function(a){return e.createSetter({valueChangedToTrue:this.onValueChangedToTrue.bind(this,a)})},selectors:{startIndex:{displayName:"Start Index",set:function(a){this._internal.currentIndex=a,this.flagOutputDirty("index")}}}}},outputs:{index:{displayName:"Index",type:"number",getter:function(){return this._internal.currentIndex}},signalTriggered:{displayName:"Signal Triggered",type:"signal"}},prototypeExtensions:{onValueChangedToTrue:function(a){this.sendSignalOnOutput("signalTriggered"),this._internal.currentIndex!==a&&(this._internal.currentIndex=a,this.flagOutputDirty("index"))}}})},{"../edgetriggeredinput":197,"../nodedefinition":210}],248:[function(a,b,c){"use strict";function d(a,b,c){var d=b.states,e=b.values,f=[];e=e?e.split(","):void 0;for(var g in e){var j=e[g];f.push({type:{name:"number",allowConnectionsOnly:!0},plug:"output",group:"Values",name:j})}d=d?d.split(","):void 0,d&&d.forEach(function(a){e&&e.forEach(function(b){f.push({plug:"input",type:"number",group:a+" Values",name:"value-"+a+"-"+b,displayName:b,editorName:a+"|"+b})}),f.push({plug:"input",type:{name:"enum",enums:[{value:"easeOut",label:"Ease Out"},{value:"easeIn",label:"Ease In"},{value:"linear",label:"Linear"},{value:"easeInOut",label:"Ease In Out"},{value:"cubicBezier",label:"Cubic Bezier"}]},default:"easeOut",displayName:"Easing Curve",group:a+" Transition",name:"transition-"+a}),"cubicBezier"===b["transition-"+a]&&(f=f.concat([{name:"cubicBezierP1X-"+a,editorName:a+"|P1 X",displayName:"P1 X",group:a+" Transition",plug:"input",type:"number",default:0},{name:"cubicBezierP1Y-"+a,editorName:a+"|P1 Y",displayName:"P1 Y",group:a+" Transition",plug:"input",type:"number",default:0},{name:"cubicBezierP2X-"+a,editorName:a+"|P2 X",displayName:"P2 X",group:a+" Transition",plug:"input",type:"number",default:0},{name:"cubicBezierP2Y-"+a,editorName:a+"|P2 Y",displayName:"P2 Y",group:a+" Transition",plug:"input",type:"number",default:0}])),f.push({plug:"input",type:"number",default:h,displayName:"Duration",group:a+" Transition",name:"duration-"+a}),f.push({plug:"input",type:{name:"boolean",allowConnectionsOnly:!0},displayName:"To "+a,name:"to-"+a,group:"Go to state"}),f.push({plug:"output",type:"boolean",displayName:"At "+a,name:"at-"+a,group:"Current state"}),f.push({plug:"output",type:"boolean",displayName:"Has Reached "+a,name:"reached-"+a,group:"Current state"})}),d&&f.push({plug:"input",type:{name:"enum",enums:d},group:"States",displayName:"Start at",name:"startState",default:d[0]});var k=JSON.stringify(f);i[a]!==k&&(i[a]=k,c.sendDynamicPorts(a,f))}var e=a("../edgetriggeredinput"),f=a("../easecurves"),g=a("bezier-easing"),h=300,i={},j={name:"States",category:"Animation",initialize:function(){var a=this,b=this._internal;b.currentValues={},b.stateParameters={},b.startValues={},b.bezierEaseCurves={},b.valuesAreInitialised=!1,b.animation=this.context.timerScheduler.createTimer({duration:h,ease:f.easeOut,onStart:function(){},onRunning:function(c){var d=this.ease(0,1,c),e=b.values,f=b.currentValues,g=b.stateParameters,h="value-"+b.state+"-",i=b.startValues;for(var j in e){var k=e[j];f[k]=i[k]*(1-d)+(g[h+k]||0)*d,a.flagOutputDirty(k)}},onFinish:function(){var c="reached-"+b.state;a.hasOutput(c)&&a.sendSignalOnOutput(c)}})},inputs:{states:{type:{name:"stringlist",allowEditOnly:!0},displayName:"States",group:"States",set:function(a){if(this._internal.states=a?a.split(","):[],this._internal.states.length>0){var b=this;this.scheduleAfterInputsHaveUpdated(function(){b._internal.scheduledToGoToState||b.goToState(b._internal.states[0])})}}},values:{type:{name:"stringlist",allowEditOnly:!0},displayName:"Values",group:"Values",set:function(a){var b=this._internal;b.values=a.split(",");for(var c in b.values)this.registerOutputIfNeeded(b.values[c])}},toggle:{group:"Go to state",displayName:"Toggle",valueChangedToTrue:function(){var a=this._internal,b=this;if(a.states){var c=a.states.indexOf(a.state),d=(c+1)%a.states.length;this._internal.scheduledToGoToState=a.states[d],this.scheduleAfterInputsHaveUpdated(function(){b.goToState(a.states[d])})}}},currentState:{type:{name:"string",allowConnectionsOnly:!0},displayName:"Current State",group:"Go to state",set:function(a){var b=this,c=this._internal;c.states&&c.states.indexOf(a)!==-1&&(c.scheduledToGoToState=a,this.scheduleAfterInputsHaveUpdated(function(){b.goToState(a)}))}}},outputs:{currentState:{type:"string",displayName:"Current State",group:"Current State",getter:function(){return this._internal.state}},stateChanged:{type:"signal",displayName:"State Changed",group:"Current State"}},prototypeExtensions:{registerOutputIfNeeded:function(a){var b=this._internal;this.hasOutput(a)||this.registerOutput(a,{getter:function(){return b.currentValues[a]}})},registerInputIfNeeded:function(a){var b=this,c=this._internal;if(!this.hasInput(a))if(0===a.indexOf("to-")){var d=a.substring(3);this.registerInput(a,{set:e.createSetter({valueChangedToTrue:function(){this._internal.scheduledToGoToState=d,this.scheduleAfterInputsHaveUpdated(function(){b.goToState(d)})}})})}else if("startState"===a)this.registerInput(a,{set:function(a){this._internal.scheduledToGoToState=a,this.scheduleAfterInputsHaveUpdated(function(){b.goToState(a)})}});else if(0===a.indexOf("value-")){var f=a.split("-"),d=f[1],g=f[2];this.registerInput(a,{set:function(e){c.stateParameters[a]=e,c.state===d&&(c.currentValues[g]=e,b.flagOutputDirty(g))}})}else if(0===a.search(/duration-/g))this.registerInput(a,{set:function(b){c.stateParameters[a]=b}});else if(0===a.search(/transition-/g)){var d=a.substring(11);this.registerInput(a,{set:function(b){c.stateParameters[a]=b,"cubicBezier"===b&&this.updateCubicBezierFunction(d)}})}else if(0===a.search(/cubicBezierP[1-2][X-Y]-/g)){var d=a.substring(15);this.registerInput(a,{set:function(b){c.stateParameters[a]=b,this.updateCubicBezierFunction(d)}})}},updateCubicBezierFunction:function(a){var b=[],c=this._internal;["1X","1Y","2X","2Y"].forEach(function(d,e){var f=c.stateParameters["cubicBezierP"+d+"-"+a]||0;e%2===0&&(f=Math.min(1,Math.max(0,f))),b.push(f)});var d=g(b);c.bezierEaseCurves[a]=function(a,b,c){return f.linear(a,b,d.get(c))}},jumpToState:function(a){var b=this._internal;if(b.states&&(a||(a=b.states[0]),b.state!==a)){b.animation.stop();var c="value-"+a+"-";for(var d in b.values){var e=b.values[d];b.currentValues[e]=b.stateParameters[c+e]||0,this.flagOutputDirty(e)}b.valuesAreInitialised=!0,b.state=a,this.sendSignalOnOutput("stateChanged"),this.updateAtStatePorts(),this.flagOutputDirty("currentState")}},goToState:function(a){var b=this._internal;if(b.states&&(a||(a=b.states[0]),b.state!==a))if(this._internal.scheduledToGoToState=void 0,b.valuesAreInitialised){for(var c in b.values){var d=b.values[c];b.startValues[d]=b.currentValues[d]}var e=b.stateParameters["transition-"+a]||"easeOut";b.animation.ease="cubicBezier"===e?b.bezierEaseCurves[a]:f[e];var g="duration-"+a;b.animation.duration=b.stateParameters.hasOwnProperty(g)?b.stateParameters[g]:h,b.animation.start(),b.state=a,this.sendSignalOnOutput("stateChanged"),this.updateAtStatePorts(),this.flagOutputDirty("currentState")}else this.jumpToState(a)},updateAtStatePorts:function(){var a=this._internal,b=a.states;for(var c in b){var d=b[c],e="at-"+d;a.currentValues[e]=a.state===d,this.hasOutput(e)&&this.flagOutputDirty(e)}}}};b.exports={node:j,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.States",function(b){b.parameters.states&&d(b.id,b.parameters,a.editorConnection),b.on("parameterUpdated",function(c){"states"!==c.name&&"values"!==c.name&&"transition-"!==c.name.substring(0,11)||d(b.id,b.parameters,a.editorConnection)})})}}},{"../easecurves":196,"../edgetriggeredinput":197,"bezier-easing":2}],249:[function(a,b,c){"use strict";function d(a,b){this._internal.inputValues[a]=b,this._internal.resultDirty=!0,this.flagOutputDirty("formatted")}function e(a,b,c){var d=b.match(/\{[A-Za-z0-9_]*\}/g),e=[];for(var f in d){var g=d[f],h=g.replace("{","").replace("}","");e.push({name:h,type:"*",plug:"input"})}c.sendDynamicPorts(a,e)}var f={name:"String Format",category:"String Manipulation",initialize:function(){var a=this._internal;a.format="",a.cachedResult="",a.resultDirty=!1,a.inputValues={}},inputs:{format:{type:{name:"string",multiline:!0},displayName:"Format",set:function(a){this._internal.format=a,this._internal.resultDirty=!0,this.flagOutputDirty("formatted")}}},outputs:{formatted:{type:"string",displayName:"Formatted",getter:function(){var a=this._internal;if(a.resultDirty){var b=a.format,c=a.format.match(/\{[A-Za-z0-9_]*\}/g),d=[];c&&(d=c.map(function(a){return a.replace("{","").replace("}","")})),d.forEach(function(c){var d=a.inputValues[c];b=b.replace("{"+c+"}",void 0!==d?d:"")}),a.cachedResult=b,a.resultDirty=!1}return a.cachedResult}}},prototypeExtensions:{registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:d.bind(this,a)})}}};b.exports={node:f,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.String Format",function(b){b.parameters.format&&e(b.id,b.parameters.format,a.editorConnection),b.on("parameterUpdated",function(c){"format"===c.name&&e(b.id,b.parameters.format,a.editorConnection)})})}}},{}],250:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"String Mapper",category:"Utilities",initialize:function(){this._internal.inputs=[],this._internal.mappings=[]},numberedInputs:{input:{name:"numbered/simple-string",displayPrefix:"Input",group:"Inputs",index:11,createSetter:function(a){return function(b){b=b.toString(),this._internal.inputs[a]=b,this.scheduleMapping()}}},output:{name:"numbered/simple-string",displayPrefix:"Mapping",index:12,group:"Mappings",createSetter:function(a){return function(b){b=b.toString(),this._internal.mappings[a]=b,this.scheduleMapping()}}}},inputs:{inputString:{type:{name:"string"},index:1,displayName:"Input String",set:function(a){this._internal.currentInputString=a,this.scheduleMapping()}},defaultMapping:{type:"string",displayName:"Default",index:10,group:"Mappings",set:function(a){this._internal.defaultMapping=a,this.scheduleMapping()}}},outputs:{mappedString:{type:"string",displayName:"Mapped String",group:"Value",getter:function(){return this._internal.mappedString}}},prototypeExtensions:{doMapping:function(){this._internal.hasScheduledFetch=!1;var a=this._internal.inputs.indexOf(this._internal.currentInputString);a!==-1?this._internal.mappedString=this._internal.mappings[a]:this._internal.mappedString=this._internal.defaultMapping,this.flagOutputDirty("mappedString")},scheduleMapping:function(){var a=this._internal;a.hasScheduledFetch||(a.hasScheduledFetch=!0,this.scheduleAfterInputsHaveUpdated(this.doMapping.bind(this)))}}})},{"../nodedefinition":210}],251:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"String Selector",category:"Utilities",initialize:function(){this._internal.inputs=[],this._internal.currentSelectedIndex=0,this._internal.indexChanged=!1},numberedInputs:{input:{name:"numbered/simple-string",displayPrefix:"Input",group:"Inputs",createSetter:function(a){return function(b){b=b.toString(),this._internal.inputs[a]=b,this._internal.currentSelectedIndex===a&&this.flagOutputDirty("currentValue")}}}},inputs:{index:{type:{name:"number"},displayName:"Index",default:0,set:function(a){a|=0,this._internal.currentSelectedIndex=a,this.flagOutputDirty("currentValue"),this.sendSignalOnOutput("indexChanged")}}},outputs:{currentValue:{type:"string",displayName:"Current Value",group:"Value",getter:function(){return this._internal.inputs[this._internal.currentSelectedIndex]}},indexChanged:{type:"signal",displayName:"Index Changed",group:"Signals"}}})},{"../nodedefinition":210}],252:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Substring",category:"String Manipulation",initialize:function(){var a=this._internal;a.startIndex=0,a.endIndex=-1,a.cachedResult="",a.inputString="",a.resultDirty=!1},inputs:{start:{type:"number",displayName:"Start",default:0,set:function(a){this._internal.startIndex=a,this._internal.resultDirty=!0,this.flagOutputDirty("result")}},end:{type:"number",displayName:"End",default:0,set:function(a){this._internal.endIndex=a,this._internal.resultDirty=!0,this.flagOutputDirty("result")}},string:{type:{name:"string"},displayName:"String",default:"",set:function(a){a=a.toString(),this._internal.inputString=a,this._internal.resultDirty=!0,this.flagOutputDirty("result")}}},outputs:{result:{type:"string",displayName:"Result",getter:function(){var a=this._internal;return a.resultDirty&&(a.endIndex===-1?a.cachedResult=a.inputString.substr(a.startIndex):a.cachedResult=a.inputString.substr(a.startIndex,a.endIndex-a.startIndex),a.resultDirty=!1),a.cachedResult}}}})},{"../nodedefinition":210}],253:[function(a,b,c){"use strict";var d={name:"Switch",category:"Logic",initialize:function(){this._internal.state=!1,this._internal.initialized=!1},inputs:{on:{displayName:"On",group:"Change State",valueChangedToTrue:function(){this._internal.state!==!0&&(this._internal.state=!0,this.flagOutputDirty("state"),this.emitSignals())}},off:{displayName:"Off",group:"Change State",valueChangedToTrue:function(){this._internal.state!==!1&&(this._internal.state=!1,this.flagOutputDirty("state"),this.emitSignals())}},flip:{displayName:"Flip",group:"Change State",valueChangedToTrue:function(){this._internal.state=!this._internal.state,this.flagOutputDirty("state"),this.emitSignals()}},onFromStart:{type:"boolean",displayName:"Start State",group:"Start State",default:!1,set:function(a){a&&!this._internal.initialized&&(this._internal.state=!0,this.flagOutputDirty("state"),this._internal.initialized=!0,this.emitSignals())}}},outputs:{state:{type:"boolean",displayName:"Current State",getter:function(){return this._internal.state}},switchedToOn:{displayName:"Switched To On",type:"signal",group:"Signals"},switchedToOff:{displayName:"Switched To Off",type:"signal",group:"Signals"}},prototypeExtensions:{emitSignals:function(){this._internal.state===!0?this.sendSignalOnOutput("switchedToOn"):this.sendSignalOnOutput("switchedToOff")}}};b.exports={node:d}},{}],254:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Timer",category:"Utilities",initialize:function(){var a=this;this._internal._animation=this.context.timerScheduler.createTimer({duration:0,onStart:function(){a.sendSignalOnOutput("timerStarted")},onFinish:function(){a.sendSignalOnOutput("timerFinished")}})},inputs:{start:{displayName:"Start",valueChangedToTrue:function(){this._internal._animation._isRunning===!1&&this._internal._animation.start()}},restart:{displayName:"Restart",valueChangedToTrue:function(){this._internal._animation.start()}},duration:{type:"number",displayName:"Duration",default:0,set:function(a){this._internal._animation.duration=a}},startDelay:{type:"number",displayName:"Start Delay",default:0,set:function(a){this._internal._animation.delay=a}},stop:{displayName:"Stop",valueChangedToTrue:function(){this._internal._animation.stop()}}},outputs:{timerStarted:{type:"signal",displayName:"Started"},timerFinished:{type:"signal",displayName:"Finished"}}})},{"../nodedefinition":210}],255:[function(a,b,c){"use strict";var d=a("../node"),e={name:"Touch Position",category:"Interaction",initialize:function(){this._internal.x=0,this._internal.y=0,this.context.uiEngine.on("touchEvent",this.onTouchEvent.bind(this),this)},outputs:{x:{type:"number",displayName:"Position X",getter:function(){return this._internal.x}},y:{type:"number",displayName:"Position Y",getter:function(){return this._internal.y}}},prototypeExtensions:{_onNodeDeleted:function(){d.prototype._onNodeDeleted.call(this),this.context.uiEngine.removeListenersWithRef(this)},onTouchEvent:function(a){this._internal.x!==a.x&&(this._internal.x=a.x,this.flagOutputDirty("x")),this._internal.y!==a.y&&(this._internal.y=a.y,this.flagOutputDirty("y"))}}};b.exports={node:e}},{"../node":208}],256:[function(a,b,c){"use strict";function d(a){var b=this._internal._animation;b.stop(),b.startValue=a,this.scheduleAfterInputsHaveUpdated(function(){b.endValue!==a&&b.start()}),this._internal.currentNumber=a,this.flagOutputDirty("currentValue")}var e=a("../nodedefinition"),f=a("../easecurves"),g=300,h={name:"Transition",category:"Animation",initialize:function(){var a=this,b=this._internal;b.currentNumber=0,b.numberInitialized=!1,b.animationStarted=!1,b.setCurrentNumberEnabled=!1,b.overrideValue=0,b._animation=this.context.timerScheduler.createTimer({duration:g,startValue:0,endValue:0,ease:f.easeOut,onStart:function(){b.animationStarted=!0},onRunning:function(c){b.currentNumber=this.ease(this.startValue,this.endValue,c),a.flagOutputDirty("currentValue")},onFinish:function(){a.sendSignalOnOutput("atTargetValue")}})},inputs:{targetValue:{type:{name:"number"},displayName:"Value",group:"Target Value",default:void 0,set:function(a){if(a===!0?a=1:a===!1&&(a=0),a=Number(a),!isNaN(a)){var b=this._internal;return b.numberInitialized===!1?(b.currentNumber=a,b.numberInitialized=!0,b._animation.endValue=a,void this.flagOutputDirty("currentValue")):void(a!==b._animation.endValue&&(b._animation.startValue=b.currentNumber,b._animation.endValue=a,b._animation.start()))}}},"overrideCurrentValue.value":{type:{name:"number"},group:"Override Value",displayName:"Value",editorName:"Value|Override Value",set:function(a){this._internal.overrideValue=a}},"overrideCurrentValue.do":{group:"Override Value",displayName:"Do",editorName:"Do|Override Value",valueChangedToTrue:function(){d.call(this,this._internal.overrideValue)}},duration:{type:"number",group:"Parameters",displayName:"Duration",default:g,set:function(a){this._internal._animation.duration=a}},delay:{type:"number",group:"Parameters",displayName:"Delay",default:0,set:function(a){this._internal._animation.delay=a}},easingCurve:{type:{name:"enum",enums:[{value:"easeOut",label:"Ease Out"},{value:"easeIn",label:"Ease In"},{value:"linear",label:"Linear"},{value:"easeInOut",label:"Ease In Out"}]},default:"easeOut",displayName:"Easing Curve",group:"Parameters",set:function(a){this._internal._animation.ease=f[a]}}},outputs:{currentValue:{type:"number",displayName:"Current Value",group:"Current State",getter:function(){return this._internal.currentNumber}},atTargetValue:{type:"signal",displayName:"At Target Value",group:"Signals"}}};b.exports=e.defineNode(h)},{"../easecurves":196,"../nodedefinition":210}],257:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e=d.defineNode({name:"Unique Id",category:"String Manipulation",initialize:function(){var a=this._internal;a.guid=this.guid()},inputs:{new:{displayName:"New",valueChangedToTrue:function(){var a=this._internal;a.guid=this.guid(),this.flagOutputDirty("guid")}}},outputs:{guid:{type:"string",displayName:"Id",getter:function(){var a=this._internal;return a.guid}}},prototypeExtensions:{guid:function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}}});b.exports=e},{"../nodedefinition":210}],258:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Value Changed",category:"Logic",initialize:function(){this._internal.lastValue=void 0},inputs:{value:{type:"*",displayName:"Input",set:function(a){this._internal.lastValue!==a&&(this.sendSignalOnOutput("valueChanged"),this._internal.lastValue=a)}}},outputs:{valueChanged:{type:"signal",displayName:"Value Changed"}}})},{"../nodedefinition":210}],259:[function(a,b,c){"use strict";var d=a("./variablebase"),e=d.createDefinition({name:"Boolean",startValue:!1,type:{name:"boolean"},cast:function(a){return Boolean(a)}});b.exports={node:e}},{"./variablebase":263}],260:[function(a,b,c){"use strict";var d=a("./variablebase"),e=a("../../nodedefinition");b.exports=e.defineNode(d.createDefinition({name:"Color",startValue:"#f1f2f4",type:{name:"color"},cast:function(a){return a}}))},{"../../nodedefinition":210,"./variablebase":263}],261:[function(a,b,c){"use strict";var d=a("./variablebase"),e=d.createDefinition({name:"Number",startValue:0,type:{name:"number"},cast:function(a){return Number(a)}});b.exports={node:e}},{"./variablebase":263}],262:[function(a,b,c){"use strict";var d=a("./variablebase"),e=a("../../nodedefinition"),f=d.createDefinition({name:"String",startValue:"",type:{name:"string"},cast:function(a){return a.toString()}});e.extend(f,{outputs:{length:{type:"number",displayName:"Length",getter:function(){return this._internal.currentValue.length}}}}),b.exports=e.defineNode(f)},{"../../nodedefinition":210,"./variablebase":263}],263:[function(a,b,c){"use strict";function d(a){return{name:a.name,category:"Variables",initialize:function(){this._internal.currentValue=a.startValue,this._internal.latestValue=0},inputs:{value:{type:a.type,displayName:"Value",default:a.startValue,set:function(a){this.isInputConnected("saveValue")===!1?this.setValueTo(a):this._internal.latestValue=a}},saveValue:{displayName:"Save Value",valueChangedToTrue:function(){this.scheduleAfterInputsHaveUpdated(function(){this.setValueTo(this._internal.latestValue)})}}},outputs:{savedValue:{type:a.type.name,displayName:"Saved Value",getter:function(){return this._internal.currentValue}}},prototypeExtensions:{setValueTo:function(b){b=a.cast(b),this._internal.currentValue=b,this.flagAllOutputsDirty()}}}}b.exports={createDefinition:d}},{}],264:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Velocity",category:"Math",initialize:function(){var a=this._internal;a.oldValue=0,a.sampledAtTime=0,a.velocity=0},inputs:{value:{type:"number",displayName:"Value",set:function(a){var b=this._internal;if(0===b.sampledAtTime)return b.oldValue=a,void(b.sampledAtTime=this.context.currentFrameTime);if(this.context.currentFrameTime!==b.sampledAtTime){var c=this.context.currentFrameTime-b.sampledAtTime;b.velocity=(a-b.oldValue)/c,b.sampledAtTime=this.context.currentFrameTime,b.oldValue=a,this.flagOutputDirty("velocity")}}}},outputs:{velocity:{type:"number",displayName:"Velocity",getter:function(){return this._internal.velocity}}}})},{"../nodedefinition":210}],265:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f="#f0f0f0",g=d.createDefinition({defaultSizeEnum:"explicit",defaultSizeUnit:"px",defaultWidth:200,defaultHeight:200,defaultColor:f,createControl:function(a){var b=a.createCircleControl();return b.setWidth(200),b.setColor(f),b}});delete g.inputs.height,g.inputs.width.displayName="Size",g.inputs.width.type.units=["px"],e.extend(g,{name:"Circle",inputs:{solid:{index:3004,type:"boolean",displayName:"Solid",group:"Appearance",default:!0,set:function(a){this._internal.uiControl.setSolid(!!a)}},lineWidth:{index:3005,type:"number",displayName:"Line Width",group:"Appearance",default:1,set:function(a){
this._internal.uiControl.setLineWidth(a)}},blur:{index:3006,displayName:"Blur Length",group:"Appearance",type:"number",default:0,set:function(a){this._internal.uiControl.setBlur(a)}},arcAngle:{index:3007,displayName:"Arc Angle",group:"Appearance",type:"number",default:360,set:function(a){this._internal.uiControl.setArcAngle(a*Math.PI/180)}},image:{index:3500,displayName:"Image Path",group:"Image Properties",type:{name:"image"},set:function(a){"string"==typeof a&&this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a),this._internal.uiControl.setImagePath(a)}}}}),b.exports={node:g}},{"../../nodedefinition":210,"./renderable":273}],266:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=a("../../nodedefinition"),f=d.createDefinition({name:"Flow Layout",hasOrientation:!0,createControl:function(a){return a.createFlowLayoutControl()}});e.extend(f,{inputs:{verticalItemSpacing:{index:2501,group:"Layout",displayName:"V. Spacing",type:"number",default:0,set:function(a){this._internal.uiControl.setVerticalItemSpacing(Number(a))}},horizontalItemSpacing:{index:2502,group:"Layout",displayName:"H. Spacing",type:"number",default:0,set:function(a){this._internal.uiControl.setHorizontalItemSpacing(Number(a))}},contentAlignX:{index:2503,type:{name:"enum",enums:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]},group:"Layout",displayName:"Content Align X",default:"left",set:function(a){this._internal.uiControl.setContentAlignX(a)}},contentAlignY:{index:2504,type:{name:"enum",enums:[{value:"top",label:"Top"},{value:"center",label:"Center"},{value:"bottom",label:"Bottom"}]},group:"Layout",displayName:"Content Align Y",default:"top",set:function(a){this._internal.uiControl.setContentAlignY(a)}}}}),b.exports=e.defineNode(f)},{"../../nodedefinition":210,"./layoutbase":269}],267:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=d.createDefinition({name:"Group",createControl:function(a){return a.createDockLayoutControl()},version:2});b.exports={node:e}},{"./layoutbase":269}],268:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f=d.createDefinition({sizeEnums:[{value:"explicit",label:"Explicit"},{value:"childWidth",label:"Content Width"},{value:"childHeight",label:"Content Height"},{value:"childSize",label:"Content Size"}],defaultSizeEnum:"childSize",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100,widthCondition:"sizeMode = explicit OR sizeMode = childHeight",heightCondition:"sizeMode = explicit OR sizeMode = childWidth",defaultColor:"#ffffff",createControl:function(a){return a.createImageControl()}});e.extend(f,{name:"Image",version:2,usePortAsLabel:"image",portLabelTruncationMode:"filename",inputs:{image:{index:2500,type:{name:"image"},displayName:"Image Path",group:"Image Properties",set:function(a){return a?("string"==typeof a&&0!==a.lastIndexOf("data:",0)&&0!==a.lastIndexOf("http:",0)&&0!==a.lastIndexOf("https:",0)&&this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a),void this._internal.uiControl.setImagePath(a)):void this._internal.uiControl.setImagePath(null)}},cornerRadius:{index:3004,type:"number",displayName:"Corner Radius",group:"Appearance",default:0,set:function(a){}},fillMode:{index:2501,type:{name:"enum",enums:[{value:"original",label:"Original"},{value:"aspectFill",label:"Aspect Fill"},{value:"aspectFit",label:"Aspect Fit"},{value:"fill",label:"Fill"}],allowEditOnly:!0},displayName:"Fill Mode",group:"Image Properties",default:"original",set:function(a){this._internal.uiControl.setFillMode(a)}},clipImage:{index:2502,type:"boolean",displayName:"Clip Image",default:!0,group:"Image Properties",set:function(a){this._internal.uiControl.setClip(!!a)}}}});var g=[{inputName:"cropStartX",index:0,default:0,displayName:"Crop Start X"},{inputName:"cropEndX",index:2,default:1,displayName:"Crop End X"},{inputName:"cropStartY",index:1,default:0,displayName:"Crop Start Y"},{inputName:"cropEndY",index:3,default:1,displayName:"Crop End Y"}],h={};g.forEach(function(a){var b=a.index;h[a.inputName]={index:2503+b,type:"number",group:"Image Properties",default:a.default,displayName:a.displayName,set:function(a){this._internal.innerControl._srcRect[b]=a,this._internal.innerControl.contentDirty=!0}}}),e.extend(f,h),b.exports=e.defineNode(f)},{"../../nodedefinition":210,"./renderable":273}],269:[function(a,b,c){"use strict";function d(a){var b=e.createDefinition({createControl:a.createControl,sizeEnums:[{value:"explicit",label:"Explicit"},{value:"childWidth",label:"Content Width"},{value:"childHeight",label:"Content Height"},{value:"childSize",label:"Content Size"}],defaultSizeEnum:"explicit",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100});return f.extend(b,{name:a.name,version:a.version,initialize:function(){var a=this._internal;a.children=[],a.padding=0},allowChildren:!0,inputs:{clip:{group:"Appearance",displayName:"Clip",type:"boolean",index:3100,default:!1,set:function(a){this._internal.uiControl.setClip(a)}},padding:{group:"Padding",displayName:"Padding",type:"number",index:2800,default:0,set:function(a){var b=this._internal.uiControl;this._internal.padding=a,b.setPaddingTop(a),b.setPaddingLeft(a),b.setPaddingBottom(a),b.setPaddingRight(a)}},paddingLeft:{group:"Padding",displayName:"Pad Left",type:"number",index:2801,set:function(a){a=void 0!==a?a:this._internal.padding,this._internal.uiControl.setPaddingLeft(a)}},paddingRight:{group:"Padding",displayName:"Pad Right",type:"number",index:2802,set:function(a){a=void 0!==a?a:this._internal.padding,this._internal.uiControl.setPaddingRight(a)}},paddingTop:{group:"Padding",displayName:"Pad Top",type:"number",index:2803,set:function(a){a=void 0!==a?a:this._internal.padding,this._internal.uiControl.setPaddingTop(a)}},paddingBottom:{group:"Padding",displayName:"Pad Bottom",type:"number",index:2804,set:function(a){a=void 0!==a?a:this._internal.padding,this._internal.uiControl.setPaddingBottom(a)}}},outputs:{childCount:{displayName:"Child Count",type:"number",getter:function(){return this._internal.children.length}}},prototypeExtensions:{addChild:{value:function(a,b){if(!a.getVisualRoot)throw new Error("child must have a visual root");var c=this._internal.uiControl,d=this._internal.children;void 0===b&&(b=d.length),b=Math.max(0,b),c.addChild(a.getVisualRoot()._internal.uiControl,b),b===d.length?d.push(a):d.splice(b,0,a),this.flagOutputDirty("childCount");for(var e=b;e<d.length;e++)d[e].getVisualRoot().flagOutputDirty("childIndex");a._internal.visualParent=this,a.getVisualRoot()._internal.visualParent=this}},getChildren:{value:function(){return g.clone(this._internal.children)}},removeChild:{value:function(a){if(!a.getVisualRoot)throw new Error("child must be a visual node");var b=this._internal.children,c=b.indexOf(a);if(c===-1)throw new Error("child is not a child of this node");if(a.getVisualRoot()){var d=a.getVisualRoot()._internal.uiControl;d.parent&&d.parent.removeChild(d)}b.splice(c,1),this.flagOutputDirty("childCount");for(var e=c;e<b.length;e++)b[e].getVisualRoot().flagOutputDirty("childIndex");a._internal.visualParent=void 0,a.getVisualRoot()&&(a.getVisualRoot()._internal.visualParent=void 0)}},isChild:{value:function(a){return this._internal.children.indexOf(a)!==-1}},getChildRoot:{value:function(){return this}}}}),a.hasOrientation&&f.extend(b,{initialize:function(){this._internal.uiControl.setOrientation("vertical")},inputs:{orientation:{index:2500,group:"Layout",displayName:"Orientation",type:{name:"enum",enums:[{value:"horizontal",label:"Horizontal"},{value:"vertical",label:"Vertical"}]},default:"vertical",set:function(a){this._internal.uiControl.setOrientation(a)}}}}),b}var e=a("./visualbase"),f=a("../../nodedefinition"),g=a("lodash");b.exports={createDefinition:d}},{"../../nodedefinition":210,"./visualbase":278,lodash:148}],270:[function(a,b,c){"use strict";function d(a,b){var c=a.getLayoutRect().width;void 0===c&&(c=0);var d=.3*-c;b<=0?a.setPositionX(g.easeInOut(d,0,1+b)):a.setPositionX(g.easeInOut(0,c,b))}var e=a("./layoutbase"),f=a("../../nodedefinition"),g=a("../../easecurves"),h=e.createDefinition({name:"Page",createControl:function(a){return a.createDockLayoutControl()}});f.extend(h,{initialize:function(){this._internal.title="",this._internal.transition="default",this._internal.transitionPosition=0,this._internal.transitionDuration=350,this._internal.customTransitionDuration=350},dynamicports:[{name:"conditionalports/basic",condition:"transition = custom",ports:[{name:"customTransitionDuration",plug:"input",type:"number",displayName:"Transition Duration",group:"Page",default:350}]}],inputs:{title:{type:"string",displayName:"Title",group:"Page",set:function(a){this._internal.title=a,this._internal.pagesNode&&this._internal.pagesNode.flagOutputDirty("currentPageTitle")}},transition:{displayName:"Transition",group:"Page",default:"default",type:{name:"enum",enums:[{value:"none",label:"None"},{value:"default",label:"Default"},{value:"custom",label:"Custom"}]},set:function(a){var b=this._internal;b.transition=a}},customTransitionDuration:{set:function(a){this._internal.customTransitionDuration=a}}},outputs:{transitionPosition:{index:0,type:"number",displayName:"Transition Position",group:"Page",getter:function(){return this._internal.transitionPosition}},pageShowing:{type:"signal",displayName:"Page Showing",group:"Page Signals"},pageHiding:{type:"signal",displayName:"Page Hiding",group:"Page Signals"},pageShown:{type:"signal",displayName:"Page Shown",group:"Page Signals"},pageHidden:{type:"signal",displayName:"Page Hidden",group:"Page Signals"}},prototypeExtensions:{setPagesNode:function(a){this._internal.pagesNode=a},setTransitionPosition:function(a){var b=this._internal;"default"===b.transition&&d(this,a),b.transitionPosition=a,this.flagOutputDirty("transitionPosition")},getAnimationDuration:function(){switch(this._internal.transition){case"none":return 0;case"default":case"ios":return 350;case"custom":return this._internal.customTransitionDuration}return 0},getAnimationPosition:function(){return this._internal.transitionPosition},sendPageShowingSignal:function(){this.sendSignalOnOutput("pageShowing")},sendPageHidingSignal:function(){this.sendSignalOnOutput("pageHiding")},sendPageShownSignal:function(){this.sendSignalOnOutput("pageShown")},sendPageHiddenSignal:function(){this.sendSignalOnOutput("pageHidden")},getTitle:function(){return this._internal.title}}}),b.exports=f.defineNode(h)},{"../../easecurves":196,"../../nodedefinition":210,"./layoutbase":269}],271:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=a("../../nodedefinition"),f=a("../../guid"),g=a("../../easecurves"),h=a("lodash"),i=a("../../node"),j=d.createDefinition({name:"Pages",createControl:function(a){return a.createDockLayoutControl()}});e.extend(j,{initialize:function(){this._internal.pageStack=[],this._internal.isNavigating=!1,this._internal.portUpdateScheduled=!1},inputs:{startPage:{type:"component",displayName:"Start Page",group:"Navigation",set:function(a){if(this._cleanup(),a){var b=this._createPage(a);this.startPageComponent=b;var c=this._internal,d=this.context.getComponentModel(a);c.startPageComponentModel=d,this.updateStartPagePorts(d),d.on("inputPortAdded",this.scheduleUpdateStartPagePorts.bind(this,d),this),d.on("inputPortRemoved",this.scheduleUpdateStartPagePorts.bind(this,d),this),c.pageStack.push(b),this.addPageAtIndex(b,0),b.getVisualRoot().sendPageShowingSignal()}}},back:{displayName:"Back",group:"Navigation",valueChangedToTrue:function(){this.back()}}},outputs:{currentPageTitle:{type:"string",displayName:"Current Page Title",group:"Pages",getter:function(){var a=this._internal.pageStack;return 0===a.length?"":a[a.length-1].getVisualRoot().getTitle()}},prevPageTitle:{type:"string",displayName:"Previous Page Title",group:"Pages",getter:function(){var a=this._internal.pageStack;return a.length<2?"":a[a.length-2].getVisualRoot().getTitle()}},hasPreviousPage:{type:"boolean",displayName:"Has Previous Page",group:"Pages",getter:function(){return this._internal.pageStack.length>1}},navigatedForward:{type:"signal",displayName:"Navigated Forward",group:"Pages Signals"},navigatedBack:{type:"signal",displayName:"Navigated Back",group:"Pages Signals"}},prototypeExtensions:{_cleanup:function(){var a=this._internal;a.startPageComponentModel&&(a.startPageComponentModel.removeListenersWithRef(this),a.startPageComponentModel=void 0);var b=this;this.getChildren().forEach(function(a){b.removeChild(a),b.nodeScope.deleteNode(a)}),a.pageStack.forEach(function(a){a._onNodeDeleted()}),this.startPageComponent=void 0,a.pageStack=[]},_onNodeDeleted:function(){i.prototype._onNodeDeleted.call(this),this._cleanup()},addPageAtIndex:function(a,b){this.addChild(a,b),this.flagOutputDirty("currentPageTitle"),this.flagOutputDirty("prevPageTitle")},navigateTo:function(a,b){if(!this._internal.isNavigating){var c=this._internal,d=c.pageStack,e=d[d.length-1],f=this._createPage(a,b),g=f.getVisualRoot();d.push(f),this.addPageAtIndex(f),this.context.layout(),g.setTransitionPosition(1),f.update();var h=this;this.context.scheduleNextFrame(function(){h._animationPageAnimationPositionTo(f,0),h._animationPageAnimationPositionTo(e,-1)}),d.length>1&&this.flagOutputDirty("hasPreviousPage"),this.sendSignalOnOutput("navigatedForward")}},resetTo:function(a,b){var c=this._internal,d=c.pageStack,e=this._createPage(a,b),f=e.getVisualRoot(),g=this;d.forEach(function(a){g.isChild(a)&&g.removeChild(a),g.nodeScope.deleteNode(a)}),d.length=0,d.push(e),this.addPageAtIndex(e),this.context.layout(),f.setTransitionPosition(0),e.update(),f.sendPageShownSignal(),this.flagOutputDirty("hasPreviousPage")},back:function(){var a=this._internal.pageStack;if(1!==a.length&&!this._internal.isNavigating){var b=a.pop();1===a.length&&this.flagOutputDirty("hasPreviousPage");var c=a[a.length-1];c.getVisualRoot()._internal.visualParent||this.addPageAtIndex(c,this._internal.children.indexOf(b)-1),this._animationPageAnimationPositionTo(c,0),this._animationPageAnimationPositionTo(b,1),this.sendSignalOnOutput("navigatedBack")}},_animationPageAnimationPositionTo:function(a,b){var c=a.getVisualRoot(),d=c.getAnimationPosition();if(d!==b){0===b?c.sendPageShowingSignal():c.sendPageHidingSignal(),this._internal.isNavigating=!0;var e=this,f=this.context.timerScheduler.createTimer({duration:c.getAnimationDuration(),onRunning:function(a){c.setTransitionPosition(g.linear(d,b,a))},onFinish:function(){b===-1||1===b?(c.sendPageHiddenSignal(),e.isChild(a)&&e.removeChild(a),1===b&&e.context.scheduleNextFrame(function(){e.nodeScope.deleteNode(a)})):0===b&&c.sendPageShownSignal(),e._internal.isNavigating=!1}});f.start()}},_createPage:function(a,b){var c=this.nodeScope.createNode(a,f());c.getVisualRoot().setPagesNode(this);for(var d in b)c.queueInput(d,b[d]);return c},registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:function(b){this.startPageComponent?this.startPageComponent.setInputValue(a,b):this.scheduleAfterInputsHaveUpdated(function(){this.startPageComponent.hasInput(a)&&this.startPageComponent.setInputValue(a,b)})}})},scheduleUpdateStartPagePorts:function(a){if(!this._internal.portUpdateScheduled){this._internal.portUpdateScheduled=!0;var b=this;this.context.scheduleAfterUpdate(function(){b.updateStartPagePorts(a),b._internal.portUpdateScheduled=!1})}},updateStartPagePorts:function(a){var b=h.values(a.getInputPorts()).map(function(a){return{name:a.name,plug:"input",type:a.type,group:"Start Page Inputs"}});this.context.editorConnection.sendDynamicPorts(this.id,b)}}}),b.exports=e.defineNode(j)},{"../../easecurves":196,"../../guid":202,"../../node":208,"../../nodedefinition":210,"./layoutbase":269,lodash:148}],272:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f="#f1f2f4",g=d.createDefinition({defaultSizeEnum:"explicit",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100,defaultColor:f,createControl:function(a){var b=a.createRectangleControl();return b.setColor(f),b}});e.extend(g,{name:"Rectangle",inputs:{cornerRadius:{index:3004,type:"number",displayName:"Corner Radius",group:"Appearance",default:0,set:function(a){this._internal.uiControl.setCornerRadius(a)}},blur:{index:3005,type:"number",displayName:"Blur Length",group:"Appearance",default:0,set:function(a){this._internal.uiControl.setBlur(a)}}}}),b.exports=e.defineNode(g)},{"../../nodedefinition":210,"./renderable":273}],273:[function(a,b,c){"use strict";function d(a){if(!a.defaultColor)throw new Error("No default color specified");var b=e.createDefinition(a),c=[{value:"alpha",label:"Alpha"},{value:"solid",label:"Solid"},{value:"additive",label:"Additive"},{value:"multiply",label:"Multiply"}];return f.extend(b,{inputs:{blendMode:{index:3003,type:{name:"enum",enums:c},default:"alpha",displayName:"Blend Mode",group:"Appearance",set:function(a){this._internal.uiControl.setBlendMode(a)}},color:{index:3002,type:"color",displayName:"Color",group:"Appearance",default:a.defaultColor,set:function(a){this._internal.uiControl.setColor(a)}}}}),b}var e=a("./visualbase"),f=a("../../nodedefinition");b.exports={createDefinition:d}},{"../../nodedefinition":210,"./visualbase":278}],274:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a){var b=this.noodlNode,c=b._internal;if(c.scrollEnabled===!1||c.uiControl.touchPropagation===!1)return c.isTracking&&(c.isTracking=!1,b.sendSignalOnOutput("dragEnded")),void(c.hasReceivedEnter=!1);var d,e=c.uiControl.scroller,f=c.uiControl.scrollOffset;if(a.isEnter&&(c.hasReceivedEnter=!0),a.isExit)c.isTracking===!0?(b.sendSignalOnOutput("dragEnded"),c.isTracking=!1,b.context.scheduleAfterUpdate(function(){e.onTouch(f,a)})):e.onTouch(f,a),c.hasReceivedEnter=!1;else{if(c.hasReceivedEnter===!1){c.hasReceivedEnter=!0;var g={};for(var h in a)g[h]=a[h];g.type="isEnter",g.isEnter=!0,g.isDown=g.isUp=g.isMove=!1,c.uiControl.onTouch(g)}d=e.onTouch(f,a),"StartTracking"===d&&c.isTracking===!1&&(c.isTracking=!0,b.sendSignalOnOutput("dragStarted"))}return d}function f(a){var b=this._internal.children;if(b.length<=1)return 0;for(var c="horizontal"===this._internal.uiControl.orientation?"width":"height",d=0,e=this._internal.uiControl.getItemSpacing(),f=0,g=b.length;f<g;++f){var h=b[f].getVisualRoot().getLayoutRect(),i=h[c];if(Math.floor(d+i)>a)return f;d+=i+e}return console.error("Invalid position",a),b.length-1}function g(a){var b=this._internal.children;if(a<0||a>=b.length)return console.error("ScrollView: Invalid item index",index),0;for(var c="horizontal"===this._internal.uiControl.orientation?"width":"height",d=this._internal.uiControl.getItemSpacing(),e=0,f=0;f<a;f++)e+=b[f].getVisualRoot().getLayoutRect()[c]+d;return e}function h(a){return a=d(0,this._internal.children.length-1,a),g.call(this,a)}function i(a){var b=this._internal;a!==b.currentIndex&&(b.currentIndex=a,this.flagOutputDirty("index"),this.sendSignalOnOutput("indexChanged"))}function j(a,b){var c=this;this.context.timerScheduler.createTimer({duration:b,startPosition:l.call(this),endPosition:-a,onRunning:function(a){c._internal.uiControl.setScrollOffset(q.easeOut(this.startPosition,this.endPosition,a))}}).start()}function k(a,b){return b}function l(){return this._internal.uiControl.scrollOffset}function m(a,b){var c=f.call(this,-l.call(this)),e=0;return e=a<0?c+1:c,e=d(0,this._internal.children.length-1,e),-h.call(this,e)}function n(a,b){var c="horizontal"===this._internal.uiControl.orientation?"width":"height",d=this._internal.children,e=this._internal.uiControl.getItemSpacing();if(1===d.length)return a<0?-d[0].getVisualRoot().getLayoutRect()[c]:0;for(var f=0,g=0,h=Number.MAX_VALUE,i=0,j=0;j<d.length-1;++j){var k=d[j].getVisualRoot().getLayoutRect()[c],m=f+k+e,n=Math.abs(f+b),o=Math.abs(m+b);if(n<h&&(h=n,i=f),o<h&&(h=o,i=m),o>n){var p=l.call(this);return a<0&&-f>p?-m:a>0&&-f<p?-g:-f}g=f,f+=k+e}return-f}var o=a("./layoutbase"),p=a("../../nodedefinition"),q=a("../../easecurves"),r=500,s=o.createDefinition({name:"Scroll View",createControl:function(a){return a.createScrollViewControl()},hasItemSpacing:!0});p.extend(s,{initialize:function(){var a=this._internal;a.scrollEnabled=!0,a.isTracking=!1,a.currentIndex=0,a.hasReceivedEnter=!1,a.scrollToPositionValue=0,a.scrollDuration=r,a.scrollToPositionDuration=r,a.scrollToIndexDuration=r,a.scrollToIndexValue=0,a.uiControl.scrollEndedPositionCallback=function(a,b){return b};var b=this;this._internal.uiControl.on("scrollOffsetChanged",function(a){b.flagOutputDirty("scrollPosition");var c=f.call(b,-a);if(c<b._internal.children.length){var d=b._internal.children[c].getVisualRoot().getLayoutRect(),e="horizontal"===b._internal.uiControl.orientation?"width":"height",g=-a+.5*d[e];i.call(b,f.call(b,g))}}),this.addTouchHandler(e,b)},inputs:{itemSpacing:{index:2400,group:"Layout",displayName:"Item Spacing",type:"number",default:0,set:function(a){this._internal.uiControl.setItemSpacing(Number(a))}},clip:{index:3100,type:"boolean",group:"Appearance",displayName:"Clip",default:!1,set:function(a){this._internal.uiControl.setClip(!!a)}},scrollDuration:{index:2500,type:"number",displayName:"Scroll Duration",group:"Scroll Behavior",default:r,set:function(a){this._internal.uiControl.setScrollDuration(Number(a))}},snap:{index:2501,type:{name:"enum",enums:[{value:"disabled",label:"Disabled"},{value:"item",label:"Item"},{value:"everyItem",label:"Every Item"}]},displayName:"Snap",group:"Scroll Behavior",default:"disabled",set:function(a){"disabled"===a?this._internal.uiControl.scrollEndedPositionCallback=k.bind(this):"everyItem"===a?this._internal.uiControl.scrollEndedPositionCallback=m.bind(this):"item"===a?this._internal.uiControl.scrollEndedPositionCallback=n.bind(this):console.error("Unknown snap value: "+a)}},scrollAxis:{index:2502,type:{name:"enum",enums:[{value:"0",label:"Horizontal"},{value:"1",label:"Vertical"}]},displayName:"Scroll Direction",group:"Scroll Behavior",default:"1",set:function(a){this._internal.uiControl.setOrientation(Number(a)?"vertical":"horizontal")}},scrollStartPosition:{index:2503,type:"number",displayName:"Start Position",group:"Scroll Behavior",default:0,set:function(a){this._internal.uiControl.setScrollOffset(Number(a))}},scrollEnabled:{index:2504,type:"boolean",displayName:"Scroll Enabled",group:"Scroll Behavior",default:!0,set:function(a){this._internal.scrollEnabled=!!a}},overscrollEnabled:{index:2505,type:"boolean",displayName:"Overscroll Enabled",group:"Scroll Behavior",default:!0,set:function(a){var b=!!a;this._internal.uiControl.setOverscrollEnabled(b)}},scrollThreshold:{index:2506,type:"number",displayName:"Scroll Threshold",group:"Scroll Behavior",default:50,set:function(a){this._internal.uiControl.setScrollThreshold(0|a)}},"scrollToPosition.value":{index:6e3,type:"number",displayName:"Position",editorName:"Position|Scroll To Position",group:"Scroll To Position",default:0,set:function(a){this._internal.scrollToPositionValue=a}},"scrollToPosition.do":{index:6001,group:"Scroll To Position",editorName:"Do|Scroll To Position",displayName:"Do",valueChangedToTrue:function(){this.scheduleAfterInputsHaveUpdated(function(){j.call(this,this._internal.scrollToPositionValue,this._internal.scrollToPositionDuration)})}},"scrollToPosition.duration":{index:6002,group:"Scroll To Position",displayName:"Duration",editorName:"Duration|Scroll To Position",type:"number",default:r,set:function(a){this._internal.scrollToPositionDuration=a}},"scrollToIndex.value":{index:6003,group:"Scroll To Index",editorName:"Index|Scroll To Index",displayName:"Index",type:"number",default:0,set:function(a){this._internal.scrollToIndexValue=Math.floor(a)}},"scrollToIndex.do":{index:6004,group:"Scroll To Index",editorName:"Do|Scroll To Index",displayName:"Do",valueChangedToTrue:function(){var a=this;this.scheduleAfterInputsHaveUpdated(function(){if(a._internal.children.length>0){var b=h.call(this,this._internal.scrollToIndexValue);j.call(this,b,this._internal.scrollToIndexDuration)}})}},"scrollToIndex.duration":{index:6005,type:"number",group:"Scroll To Index",displayName:"Duration",editorName:"Duration|Scroll To Index",default:r,set:function(a){this._internal.scrollToIndexDuration=a}}},outputs:{dragStarted:{type:"signal",displayName:"Drag Started",group:"Signals"},dragEnded:{type:"signal",displayName:"Drag Ended",group:"Signals"},indexChanged:{displayName:"Index Changed",group:"Signals",type:"signal"},scrollPosition:{displayName:"Scroll Position",type:"number",getter:function(){return this._internal.uiControl.scrollOffset}},index:{displayName:"Scroll Index",type:"number",getter:function(){return this._internal.currentIndex}},childCount:{displayName:"Child Count",type:"number",getter:function(){return this._internal.children.length}}}}),b.exports=p.defineNode(s)},{"../../easecurves":196,"../../nodedefinition":210,"./layoutbase":269}],275:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=a("../../nodedefinition"),f=d.createDefinition({name:"Stack Layout",hasOrientation:!0,hasItemSpacing:!0,createControl:function(a){return a.createStackLayoutControl()}});e.extend(f,{inputs:{itemSpacing:{index:2501,group:"Layout",displayName:"Item Spacing",type:"number",default:0,set:function(a){this._internal.uiControl.setItemSpacing(Number(a))}}}}),b.exports=e.defineNode(f)},{"../../nodedefinition":210,"./layoutbase":269}],276:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f=a("../../fontloader"),g="Text",h=d.createDefinition({createControl:function(a){var b=a.createTextControl();return b.setColor("#ffffff"),b.setFontFamily("Helvetica"),b.setFontSize(40),b.setText(g),b},defaultColor:"#ffffff",sizeEnums:[{value:"explicit",label:"Explicit"},{value:"childWidth",label:"Content Width"},{value:"childHeight",label:"Content Height"},{value:"childSize",label:"Content Size"}],defaultSizeEnum:"childSize",widthCondition:"sizeMode = explicit OR sizeMode = childHeight",heightCondition:"sizeMode = explicit OR sizeMode = childWidth",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100});e.extend(h,{name:"Text",version:2,usePortAsLabel:"text",inputs:{text:{index:2500,group:"Text",displayName:"Text",type:{name:"string",multiline:!0},default:g,set:function(a){this._internal.uiControl.setText(a)}},fontFamily:{index:2501,type:"font",group:"Text",displayName:"Font Family",default:"Helvetica",set:function(a){var b=a.replace(/\.[^\/.]+$/,"");b=b.split("/").pop();var c=this._internal;f.instance.callWhenFontIsActive(b,function(){c.uiControl.setFontFamily(b)})}},fontSize:{index:2502,type:"number",group:"Text",displayName:"Font Size",default:40,set:function(a){this._internal.uiControl.setFontSize(a)}},lineHeight:{index:2503,type:"number",displayName:"Line Height",group:"Text",default:0,set:function(a){this._internal.uiControl.setLineHeight(a)}},alignment:{index:2504,type:{name:"enum",enums:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}],allowEditOnly:!0},displayName:"Horizontal",group:"Text Alignment",default:"left",set:function(a){this._internal.uiControl.setHorizontalAlignment(a)}},verticalAlignment:{index:2505,type:{name:"enum",enums:[{value:"top",label:"Top"},{value:"center",label:"Center"},{value:"bottom",label:"Bottom"}],allowEditOnly:!0},displayName:"Vertical",group:"Text Alignment",default:"top",set:function(a){this._internal.uiControl.setVerticalAlignment(a)}},clipText:{index:2999,type:"boolean",displayName:"Clip Text",default:!0,group:"Appearance",set:function(a){this._internal.uiControl.setClip(!!a)}}}}),b.exports={node:h,setup:function(a,b){b.on("nodeAdded.Text",function(a){a.parameters.fontFamily&&f.instance.loadFont(a.parameters.fontFamily),a.on("parameterUpdated",function(a){"fontFamily"===a.name&&f.instance.loadFont(a.value)})})}}},{"../../fontloader":201,"../../nodedefinition":210,"./renderable":273}],277:[function(a,b,c){"use strict";function d(a){var b=this.noodlNode;if(a.isUp)return b._internal.uiControl.focus(),"StopPropagation"}var e=a("./renderable"),f=a("../../nodedefinition"),g=a("../../fontloader"),h="Text",i=e.createDefinition({controlAttribute:"innerTextControl",createControl:function(a){var b=a.createTextInputControl();return b.setColor("#ffffff"),b.setFontFamily("Helvetica"),b.setFontSize(40),b.setText(h),b},defaultColor:"#ffffff",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100});f.extend(i,{name:"Text Input",initialize:function(){this.addTouchHandler(d);var a=this;this._internal.uiControl.on("textChanged",function(){a.flagOutputDirty("text")},this),this._internal.uiControl.on("focused",function(){a.flagOutputDirty("focused"),a.flagOutputDirty("blurred")},this),this._internal.uiControl.on("blurred",function(){a.flagOutputDirty("focused"),a.flagOutputDirty("blurred")},this)},inputs:{text:{index:2500,group:"Text",displayName:"Text",type:{name:"string",multiline:!0},default:h,set:function(a){this._internal.uiControl.getText()!==a&&this._internal.uiControl.setText(a)}},fontFamily:{index:2501,type:"font",group:"Text",displayName:"Font Family",default:"Helvetica",set:function(a){var b=a.replace(/\.[^\/.]+$/,"");b=b.split("/").pop();var c=this._internal;g.instance.callWhenFontIsActive(b,function(){c.uiControl.setFontFamily(b)})}},fontSize:{index:2502,type:"number",group:"Text",displayName:"Font Size",default:40,set:function(a){this._internal.uiControl.setFontSize(a)}},clear:{index:2600,group:"Actions",displayName:"Clear",valueChangedToTrue:function(){this._internal.uiControl.setText("")}},type:{index:3001,group:"Appearance",displayName:"Type",default:"text",type:{name:"enum",enums:[{value:"text",label:"Text"},{value:"textarea",label:"Text Area"},{value:"password",label:"Password"},{value:"email",label:"Email"},{value:"tel",label:"Tel"},{value:"number",label:"Number"}]},set:function(a){this._internal.uiControl.setInputType(a)}},color:{index:3002,type:"color",displayName:"Color",group:"Appearance",default:"#ffffff",set:function(a){this._internal.uiControl.setColor(a)}}},outputs:{text:{index:2500,group:"Text",displayName:"Text",type:"string",getter:function(){return this._internal.uiControl.getText()}},focused:{index:2501,group:"State",displayName:"Focused",type:"boolean",getter:function(){return this._internal.uiControl.isFocused()}},blurred:{index:2502,group:"State",displayName:"Blurred",type:"boolean",getter:function(){return!this._internal.uiControl.isFocused()}}},prototypeExtensions:{setText:function(a){this._internal.uiControl.setText(a)}}}),b.exports={node:i,setup:function(a,b){b.on("nodeAdded.Text Input",function(a){a.parameters.fontFamily&&g.instance.loadFont(a.parameters.fontFamily),a.on("parameterUpdated",function(a,b){"fontFamily"===a&&g.instance.loadFont(b)})})}}},{"../../fontloader":201,"../../nodedefinition":210,"./renderable":273}],278:[function(a,b,c){"use strict";function d(a){if(a=a||{},!a.createControl)throw new Error("createControl can't be undefined");a.sizeEnums=a.sizeEnums||[],a.defaultSizeEnum=a.defaultSizeEnum||"",a.defaultSizeUnit=a.defaultSizeUnit||"px",a.defaultPivotUnit=a.defaultPivotUnit||"%",a.defaultWidth=a.hasOwnProperty("defaultWidth")?a.defaultWidth:0,a.defaultHeight=a.hasOwnProperty("defaultHeight")?a.defaultHeight:0,a.widthCondition=a.widthCondition||"sizeMode = explicit OR sizeMode = childHeight OR sizeMode NOT SET",a.heightCondition=a.heightCondition||"sizeMode = explicit OR sizeMode = childWidth OR sizeMode NOT SET";var b={category:"Visual",initialize:function(){var b=this._internal,c=a.createControl.call(this,this.context.uiEngine);c.onTouch=g,c.onHover=h,c.noodlNode=this,b.uiControl=c,b.touchHandlers=[],b.hoverHandlers=[],b.visualParent=void 0,c.setSizeMode(a.defaultSizeEnum),c.setWidth(a.defaultWidth),c.setHeight(a.defaultHeight),c.setWidthUnit(a.defaultSizeUnit),c.setHeightUnit(a.defaultSizeUnit),c.setPivotXUnit(a.defaultPivotUnit),c.setPivotYUnit(a.defaultPivotUnit),this._internal.tapHandler=this.context.uiEngine.createTapHandler(e),this.addTouchHandler(j,this),this.addHoverHandler(k,this);var d=this;c.on("screenXChanged",function(){d.flagOutputDirty("screenX")}),c.on("screenYChanged",function(){d.flagOutputDirty("screenY");
}),c.on("layoutWidthChanged",function(){d.flagOutputDirty("width")}),c.on("layoutHeightChanged",function(){d.flagOutputDirty("height")})},inputs:{x:{type:{name:"number"},group:"Placement",index:2002,displayName:"Position X",default:0,set:function(a){this.setPositionX(Number(a))}},y:{type:{name:"number"},index:2003,group:"Placement",displayName:"Position Y",default:0,set:function(a){this.setPositionY(Number(a))}},z:{type:{name:"number"},index:2004,group:"Placement",displayName:"Position Z",default:0,set:function(a){this._internal.uiControl.setPositionZ(Number(a))}},alignX:{index:2e3,type:{name:"enum",enums:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]},group:"Placement",displayName:"Align X",default:"left",set:function(a){this._internal.uiControl.setAlignX(a)}},alignY:{index:2001,type:{name:"enum",enums:[{value:"top",label:"Top"},{value:"center",label:"Center"},{value:"bottom",label:"Bottom"}]},group:"Placement",displayName:"Align Y",default:"top",set:function(a){this._internal.uiControl.setAlignY(a)}},width:{index:1001,type:{name:"number",units:["%","px"],defaultUnit:a.defaultSizeUnit},displayName:"Width",group:"Dimensions",default:a.defaultWidth,set:function(a,b){void 0!==a&&this._internal.uiControl.setWidth(Number(a)),b&&this._internal.uiControl.setWidthUnit(b)}},height:{index:1002,type:{name:"number",units:["%","px"],defaultUnit:a.defaultSizeUnit},displayName:"Height",group:"Dimensions",default:a.defaultHeight,set:function(a,b){void 0!==a&&this._internal.uiControl.setHeight(Number(a)),b&&this._internal.uiControl.setHeightUnit(b)}},opacity:{index:3e3,group:"Appearance",displayName:"Opacity",type:"number",default:1,set:function(a){this._internal.uiControl.setOpacity(Number(a))}},visible:{type:{name:"boolean"},index:3001,displayName:"Visible",group:"Appearance",default:!0,set:function(a){this._internal.uiControl.setVisible(!!a)}},scaleX:{index:5e3,type:"number",group:"Transform",displayName:"Scale X",default:1,set:function(a){this._internal.uiControl.setScaleX(Number(a))}},scaleY:{index:5001,type:"number",group:"Transform",displayName:"Scale Y",default:1,set:function(a){this._internal.uiControl.setScaleY(Number(a))}},rotationX:{index:5002,type:"number",group:"Transform",displayName:"Rotation X",default:0,set:function(a){this._internal.uiControl.setRotationX(Math.PI/180*Number(a))}},rotationY:{index:5003,type:"number",group:"Transform",displayName:"Rotation Y",default:0,set:function(a){this._internal.uiControl.setRotationY(Math.PI/180*Number(a))}},rotationZ:{index:5004,type:"number",group:"Transform",displayName:"Rotation Z",default:0,set:function(a){this._internal.uiControl.setRotationZ(Math.PI/180*Number(a))}},pivotX:{index:5005,type:{name:"number",units:["%","px"],defaultUnit:a.defaultPivotUnit},default:50,group:"Transform",displayName:"Pivot X",set:function(a,b){b&&this._internal.uiControl.setPivotXUnit(b),this._internal.uiControl.setPivotX(Number(a))}},pivotY:{index:5006,type:{name:"number",units:["%","px"],defaultUnit:a.defaultPivotUnit},default:50,group:"Transform",displayName:"Pivot Y",set:function(a,b){b&&this._internal.uiControl.setPivotYUnit(b),this._internal.uiControl.setPivotY(Number(a))}},pivotZ:{index:5007,type:"number",group:"Transform",displayName:"Pivot Z",default:0,set:function(a){this._internal.uiControl.setPivotZ(Number(a))}},touchPropagation:{index:4e3,type:{name:"boolean"},displayName:"Ignore Touch",default:!1,set:function(a){this._internal.uiControl.setTouchPropagation(!a)}},blockTouch:{index:4001,type:{name:"boolean"},displayName:"Block Touch",default:!1,set:function(a){this._internal.uiControl.setBlockTouch(!!a)}},depth:{index:4002,type:{name:"number"},displayName:"Depth",set:function(a){a===!0?a=1:a===!1&&(a=0),this._internal.uiControl.setDepth(Number(a))}}},outputs:{this:{type:"reference",displayName:"This",getter:function(){return this}},childIndex:{type:"number",displayName:"Child Index",getter:function(){var a=this._internal.uiControl.parent;return a?a.children.indexOf(this._internal.uiControl):-1}},width:{displayName:"Width",group:"Dimensions",type:"number",getter:function(){return this._internal.uiControl.layoutRect.width}},height:{displayName:"Height",group:"Dimensions",type:"number",getter:function(){return this._internal.uiControl.layoutRect.height}},x:{displayName:"Position X",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.positionX}},y:{displayName:"Position Y",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.positionY}},screenX:{displayName:"Screen Position X",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.getScreenX()}},screenY:{displayName:"Screen Position Y",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.getScreenY()}}},prototypeExtensions:{addTouchHandler:function(a,b){this._internal.touchHandlers.push({callback:a,id:b})},removeTouchHandlersWithId:function(a){n.remove(this._internal.touchHandlers,function(b){return b.id===a})},addHoverHandler:function(a,b){this._internal.hoverHandlers.push({callback:a,id:b})},removeHoverHandler:function(a){n.remove(this._internal.hoverHandlers,function(b){return b.id===a})},getVisualRoot:function(){return this},_onNodeDeleted:function(){m.prototype._onNodeDeleted.call(this),this._internal.uiControl.dispose()},setPositionX:function(a){this._internal.uiControl.setPositionX(a),this.flagOutputDirty("x")},setPositionY:function(a){this._internal.uiControl.setPositionY(a),this.flagOutputDirty("y")},getLayoutRect:function(){return this._internal.uiControl.layoutRect},setHighlightEnabled:function(a){this._internal.uiControl.setHighlightEnabled(a)}}};return a.sizeEnums.length>0&&f(b,a),i(b),b}function e(a){var b=a.noodlNode;b.sendSignalOnOutput("touch.tap")}function f(a,b){var c={index:1001,name:"width",plug:"input",type:{name:"number",units:["%","px"],defaultUnit:b.defaultSizeUnit},displayName:"Width",group:"Dimensions",default:b.defaultWidth},d={index:1002,name:"height",plug:"input",type:{name:"number",units:["%","px"],defaultUnit:b.defaultSizeUnit},displayName:"Height",group:"Dimensions",default:b.defaultHeight},e={name:"conditionalports/basic",condition:b.widthCondition,ports:[c]},f={name:"conditionalports/basic",condition:b.heightCondition,ports:[d]},g=[e,f];l(a,{dynamicports:g,inputs:{sizeMode:{index:1e3,type:{name:"enum",enums:b.sizeEnums,allowEditOnly:!0},group:"Dimensions",displayName:"Size Mode",default:b.defaultSizeEnum,set:function(a){this._internal.uiControl.setSizeMode(a)}}}})}function g(a){var b=void 0,c=this.noodlNode,d=this;return c._internal.touchHandlers.forEach(function(c){var e=c.callback.call(d,a);void 0!==e&&("StartTracking"===e?b=e:"StopPropagation"===e&&"StartTracking"!==b&&(b=e))}),c.context.scheduleFrame(),b}function h(a){var b=void 0,c=this.noodlNode,d=this;return c._internal.hoverHandlers.forEach(function(c){var e=c.callback.call(d,a);void 0!==e&&"StopPropagation"===e&&(b=e)}),c.context.scheduleFrame(),b}function i(a){l(a,{initialize:function(){this._internal.hasSignaledMove=!1,this.context.nodeIsDirty(this)},outputs:{"touch.tap":{group:"Touch",displayName:"Tap",type:"signal"},"touch.press":{type:"signal",group:"Touch",displayName:"Press"},"touch.release":{type:"signal",group:"Touch",displayName:"Release"},"touch.enter":{type:"signal",group:"Touch",displayName:"Enter"},"touch.exit":{type:"signal",group:"Touch",displayName:"Exit"},"touch.move":{type:"signal",group:"Touch",displayName:"Move"},"hover.enter":{type:"signal",group:"Hover",displayName:"Hover Enter"},"hover.move":{type:"signal",group:"Hover",displayName:"Hover Move"},"hover.exit":{type:"signal",group:"Hover",displayName:"Hover Exit"}}})}function j(a){var b=this.noodlNode;if(a.isDown&&(b.sendSignalOnOutput("touch.press"),b._internal.hasSignaledMove=!1),a.isMove?b._internal.hasSignaledMove===!1&&(b._internal.hasSignaledMove=!0,b.sendSignalOnOutput("touch.move")):a.isUp?b.sendSignalOnOutput("touch.release"):a.isEnter?b.sendSignalOnOutput("touch.enter"):a.isExit&&b.sendSignalOnOutput("touch.exit"),b.getOutput("touch.tap").hasConnections())return b._internal.tapHandler.onTouch(this,a)}function k(a){var b=this.noodlNode;a.isHoverEnter&&b.sendSignalOnOutput("hover.enter"),a.isHoverMove?b.sendSignalOnOutput("hover.move"):a.isHoverExit&&b.sendSignalOnOutput("hover.exit")}var l=a("../../nodedefinition").extend,m=a("../../node"),n=a("lodash");b.exports={createDefinition:d}},{"../../node":208,"../../nodedefinition":210,lodash:148}],279:[function(a,b,c){"use strict";function d(a){function b(){j[a]&&(console.log("websocket disconnected",a),delete j[a])}if(!j[a]){var c=new WebSocket(a);c.addEventListener("close",b),c.addEventListener("error",b),j[a]=c}return j[a]}function e(a){function b(){e.reconnectTimer||(e.reconnectTimer=window.setTimeout(e.connect.bind(e,e.uri),1e3))}function c(){console.log("websocket connected",e.socket.url),e.eventEmitter.emit("connected"),e.context.eventEmitter.once("applicationDataReloaded",function(){e._close(),e.eventEmitter.removeAllListeners()}),e.socket.addEventListener("message",e._onMessage)}function d(a){var b=JSON.parse(a.data);e.eventEmitter.emit("jsonMessage",b)}this.eventEmitter=new h,this.eventEmitter.setMaxListeners(1e3),this.context=a;var e=this;this._reconnect=b,this._onConnectionOpen=c,this._onMessage=d}function f(a,b){if(a){var c={};for(var d in b)isNaN(Number(b[d]))?c[d]=b[d]:c[d]=Number(b[d]);a.send(JSON.stringify(c))}}var g=a("../nodedefinition"),h=a("events").EventEmitter,i=a("lodash"),j={};e.prototype._close=function(){this.socket&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=void 0,this.eventEmitter.emit("disconnected"),this.socket.removeEventListener("close",this._reconnect),this.socket.removeEventListener("error",this._reconnect),this.socket.removeEventListener("open",this._onConnectionOpen),this.socket.removeEventListener("message",this._onMessage),this.socket=void 0)},e.prototype.connect=function(a){this._close(),this.uri=a,this.socket=d(a),this.socket.addEventListener("close",this._reconnect),this.socket.addEventListener("error",this._reconnect),this.socket.readyState===WebSocket.OPEN?this._onConnectionOpen():this.socket.addEventListener("open",this._onConnectionOpen)},e.prototype.addEventListener=function(a,b){this.eventEmitter.on(a,b)},e.prototype.send=function(a){this.socket&&this.socket.readyState===WebSocket.OPEN&&this.socket.send(a)},b.exports=g.defineNode({name:"Websocket",category:"Communication",initialize:function(){var a=this._internal;a.socket=new e(this.context),a.socket.addEventListener("connected",this.onConnected.bind(this)),a.socket.addEventListener("disconnected",this.onDisconnected.bind(this)),a.socket.addEventListener("jsonMessage",this.onMessageReceived.bind(this)),a.connected=!1,a.inputValues={},a.outputValues={},a.outputNames=[]},panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Outputs",plug:"output",type:{name:"*",group:"Output data"}},{name:"PortEditor",context:["select","connectTo"],title:"Data To Send",plug:"input",group:"Data To Send",type:{name:"string"}}],inputs:{address:{group:"Settings",displayName:"Ip Address:Port",type:{name:"string"},set:function(a){if(!(void 0===a||a.length<=0)){var b=a;i.startsWith(b,"ws://")||i.startsWith(b,"wss://")||(b="ws://"+b),b[b.length]-1!=="/"&&(b+="/"),this._internal.socket.connect(b)}}},sendData:{group:"Send Data",displayName:"Send Data",valueChangedToTrue:function(){var a=this;this.scheduleAfterInputsHaveUpdated(function(){a._internal.inputValues._nodeId=a.id,f(a._internal.socket,a._internal.inputValues)})}}},outputs:{newDataReceived:{displayName:"New Data Received",type:"signal"},connected:{displayName:"Connected",type:"boolean",getter:function(){return this._internal.connected}}},prototypeExtensions:{registerOutputIfNeeded:function(a){if(!this.hasOutput(a)){this._internal.outputValues[a]=void 0;var b=this;this.registerOutput(a,{getter:function(){return b._internal.outputValues[a]}})}},registerInputIfNeeded:function(a){if(!this.hasInput(a)){var b=this;this.registerInput(a,{set:function(c){b._internal.inputValues[a]=c}})}},onMessageReceived:function(a){if(!a._nodeIds||a._nodeIds.indexOf(this.id)!==-1){var b=!1;for(var c in a)this.hasOutput(c)&&(this._internal.outputValues[c]=a[c],this.flagOutputDirty(c),b=!0);b&&this.sendSignalOnOutput("newDataReceived")}},onConnected:function(){this._internal.connected!==!0&&(this._internal.connected=!0,this.flagOutputDirty("connected"))},onDisconnected:function(){this._internal.connected!==!1&&(this._internal.connected=!1,this.flagOutputDirty("connected"))}}})},{"../nodedefinition":210,events:8,lodash:148}],280:[function(a,b,c){"use strict";function d(a,b){this.context=a,this.nodes={},this.componentOwner=b,this.noodlJavascriptAPI=f(this),this.componentInstanceChildren={}}function e(a,b){b.forEach(function(b){if(!a[b])throw new Error("Missing "+b)})}var f=a("./noodl-js-api"),g=a("lodash");d.prototype.addConnection=function(a){try{e(a,["sourceId","sourcePort","targetId","targetPort"])}catch(b){throw new Error("Error in connection: "+b.message)}try{var c=this.getNodeWithId(a.sourceId),d=this.getNodeWithId(a.targetId);d.registerInputIfNeeded(a.targetPort),c.registerOutputIfNeeded(a.sourcePort),d.connectInput(a.targetPort,c,a.sourcePort)}catch(b){console.error(b.message)}},d.prototype.setNodeParameters=function(a,b){var c=Object.keys(b);if(this.context.nodeRegister.hasNode(a.name)){var d=this.context.nodeRegister.getNodeMetadata(a.name);c.sort(function(a,b){var c=d.inputs[a],e=d.inputs[b];return(e?e.inputPriority:0)-(c?c.inputPriority:0)})}c.forEach(function(c){function d(){var d=b[c];"object"==typeof d?a.setInputValue(c,d.value,d.unit):a.setInputValue(c,d)}a.registerInputIfNeeded(c),a.hasInput(c)!==!1&&d()})},d.prototype.createNodeFromModel=function(a){if("Component Children"!==a.type){var b;try{b=this.createNode(a.type,a.id),b.setNodeModel(a)}catch(c){return void console.error(c.message,c.stack)}this.setNodeParameters(b,a.parameters),a.parent&&this.insertNodeInTree(b,a)}else if(a.parent){var d=this.getNodeWithId(a.parent.id);this.componentOwner.setChildRoot(d)}},d.prototype.insertNodeInTree=function(a,b){var c=this.getNodeWithId(b.parent.id),d=b.parent.children.indexOf(b);if(!c.addChild)throw new Error("Node "+c.id+" of type "+c.constructor.name+" can't have children");a.getVisualRoot&&c.addChild(a,d)},d.prototype.getNodeWithId=function(a){if(this.nodes.hasOwnProperty(a)===!1)throw new Error("Unknown node id "+a);return this.nodes[a]},d.prototype.hasNodeWithId=function(a){return this.nodes.hasOwnProperty(a)},d.prototype.createNode=function(a,b){if(this.nodes.hasOwnProperty(b))throw Error("duplicate id "+b);var c;return this.context.hasComponentModelWithName(a)?(c=this.context.createComponentInstanceNode(a),c.parentNodeScope=this,this.componentInstanceChildren[b]=c):(c=this.context.nodeRegister.createNode(a),c.nodeScope=this),this.nodes[b]=c,c.id=b,c},d.prototype.getNodesWithIdRecursive=function(b){function c(a,b,e){a.nodes.hasOwnProperty(b)&&e.push(a.nodes[b]);var f=Object.keys(a.nodes).filter(function(b){return a.nodes[b]instanceof d});f.forEach(function(d){c(a.nodes[d].nodeScope,b,e)})}var d=a("./nodes/componentinstance"),e=[];return c(this,b,e),e},d.prototype.getNodesWithType=function(a){var b=this,c=Object.keys(this.nodes).filter(function(c){return b.nodes[c].name===a});return c.map(function(a){return b.nodes[a]})},d.prototype.getNodesWithTypeRecursive=function(b){function c(){f=f.concat(e.getNodesWithType(b));var a=Object.keys(e.nodes).filter(function(a){return e.nodes[a]instanceof d});a.forEach(function(a){var c=e.nodes[a].nodeScope.getNodesWithTypeRecursive(b);f=f.concat(c)})}var d=a("./nodes/componentinstance"),e=this,f=[];return c(f),f},d.prototype.onNodeModelRemoved=function(a){var b=this.getNodeWithId(a.id);if(a.parent){var c=this.getNodeWithId(a.parent.id);c.removeChild(b)}b._onNodeDeleted(),delete this.nodes[b.id],delete this.componentInstanceChildren[b.id]},d.prototype.removeConnection=function(a){var b=this.getNodeWithId(a.targetId);b.removeInputConnection(a.targetPort,a.sourceId,a.sourcePort)},d.prototype.removeNodeFromParent=function(a){if(a.getVisualRoot&&a.getVisualRoot()){var b=a.getVisualRoot()._internal.visualParent;b&&b.removeChild(a)}},d.prototype.setComponentModel=function(a){this.componentModel=a;var b=a.getAllNodes();b.forEach(this.createNodeFromModel.bind(this)),a.getAllConnections().forEach(this.addConnection.bind(this)),a.on("connectionAdded",this.addConnection,this),a.on("connectionRemoved",this.removeConnection,this),a.on("nodeAdded",this.createNodeFromModel,this);var c=this;a.on("nodeParentWillBeRemoved",function(a){if("Component Children"!==a.type){var b=c.getNodeWithId(a.id);c.removeNodeFromParent(b)}else if(a.parent){this.getNodeWithId(a.parent.id);this.componentOwner.setChildRoot(null)}},this),a.on("nodeParentUpdated",function(a){if("Component Children"===a.type){var b=this.getNodeWithId(a.parent.id);this.componentOwner.setChildRoot(b)}else{var d=c.getNodeWithId(a.id);c.insertNodeInTree(d,a)}},this),a.on("nodeRemoved",function(a){"Component Children"!==a.type&&c.onNodeModelRemoved(a)},this)},d.prototype.reset=function(){if(this.componentModel){this.componentModel.removeListenersWithRef(this);var a=this;Object.keys(this.nodes).forEach(function(b){a.nodes.hasOwnProperty(b)&&a.deleteNode(a.nodes[b])}),this.componentModel=void 0,this.noodlJavascriptAPI.eventEmitter.removeAllListeners()}},d.prototype.deleteNode=function(a){if(this.nodes.hasOwnProperty(a.id)===!1)return void console.error("Node doesn't belong to this scope",this,a);var b=this;this.removeNodeFromParent(a),a.getChildren&&(a.getChildren().forEach(a.removeChild.bind(a)),a.getChildren().forEach(function(a){b.deleteNode(a)}));var c=this.componentModel.getConnectionsFrom(a.id),d=this.componentModel.getConnectionsTo(a.id);c.concat(d).forEach(function(a){b.nodes.hasOwnProperty(a.targetId)&&b.nodes.hasOwnProperty(a.sourceId)&&b.removeConnection(a)}),a._onNodeDeleted(),delete this.nodes[a.id],delete this.componentInstanceChildren[a.id]},d.prototype.sendEventFromThisScope=function(a,b,c,d){if(d){var e=this.getNodesWithType("Event Receiver").filter(function(b){return b.getChannelName()===a});e.forEach(function(a){a.handleEvent(b)})}"parent"===c&&this.componentOwner.parentNodeScope?this.componentOwner.parentNodeScope.sendEventFromThisScope(a,b,c,!0):"children"===c&&g.forIn(this.componentInstanceChildren,function(d){d.nodeScope.sendEventFromThisScope(a,b,c,!0)})},b.exports=d},{"./nodes/componentinstance":217,"./noodl-js-api":281,lodash:148}],281:[function(a,b,c){"use strict";function d(a){function b(b){return b&&b.length>0&&"/"!==b[0]&&(b="/"+b),a.createNode(b,e())}function c(b){a.deleteNode(b)}function d(a,b){k.scheduleAfterUpdate(function(){k.setGlobalValue(a,b)})}function j(a,b){if(l[a]){var c=l[a].indexOf(b);c!==-1&&l[a].splice(c,1)}}var k=a.context,l={},m={on:function(a,b){var c=k.eventSenderEmitter;c.on(a,b),l[a]=l[a]||[],l[a].push(b),k.eventEmitter.once("applicationDataReloaded",function(){c.removeListener(a,b),j(a,b)})},once:function(a,b){k.eventSenderEmitter.once(a,b)},off:function(a,b){k.eventSenderEmitter.removeListener(a,b),j(a,b)},emit:function(a,b){k.eventSenderEmitter.emit(a,b)},removeAllListeners:function(){Object.keys(l).forEach(function(a){for(var b=l[a],c=b.length-1;c>=0;c--){var d=b[c];k.eventSenderEmitter.removeListener(a,d),j(a,d)}})}};return{createComponent:b,deleteComponent:c,setGlobalValue:d,eventEmitter:m,Collection:f,Model:g,Item:g,AnimationCurve:h,PubSub:i.pubsub}}var e=a("./guid"),f=a("./nodes/data/collection"),g=a("./nodes/data/model"),h=a("./easecurves"),i=a("./services/services");b.exports=d},{"./easecurves":196,"./guid":202,"./nodes/data/collection":220,"./nodes/data/model":224,"./services/services":287}],282:[function(a,b,c){"use strict";function d(a){if(!a.owner)throw new Error("Owner must be set");this.getter=a.getter,this.connections=[],this.owner=a.owner,this.name=a.name,this._id=void 0}Object.defineProperties(d.prototype,{value:{get:function(){return this.getter.call(this.owner)}},id:{get:function(){return this._id||(this._id=this.owner.id+this.name),this._id}},registerConnection:{value:function(a,b){this.connections.push({node:a,inputPortName:b})}},deregisterConnection:{value:function(a,b){for(var c=0;c<this.connections.length;c++){var d=this.connections[c];if(d.node===a&&d.inputPortName===b){this.connections.splice(c,1);break}}}},flagDependeesDirty:{value:function(a){for(var b=0,c=this.connections.length;b<c;b++)this.connections[b].node.flagDirty()}},sendValue:{value:function(a){for(var b=0,c=this.connections.length;b<c;b++){var d=this.connections[b];d.node.queueInput(d.inputPortName,a)}}},hasConnections:{value:function(){return this.connections.length>0}}}),b.exports=d},{}],283:[function(a,b,c){"use strict";function d(a,b,c){if(!c[a]){if(!g[a])throw new Error("Unknown patch key "+a);var d={nodePatches:[],dismissPatches:[]};for(var e in g[a])d[e]=g[a][e];c[a]=d}c[a].nodePatches.push(b)}function e(a,b){var c=[],e=[h,i,j,k,l];e.forEach(function(b){b.condition(a)&&c.push(b.generatePatch(a))}),c.forEach(function(a){d(a.key,a.patch,b)})}function f(a,b){e(a,b),a.children&&a.children.forEach(function(a){f(a,b)})}var g={LayoutNotSupported:{message:"Group with layout is no longer supported. These have been replaced with the new nodes Stack Layout and Flow Layout",notifyUser:!0,askPermission:!1,key:"LayoutNotSupported"},ImageDefaultUnitChanged:{notifyUser:!1,askPermission:!1,key:"ImageDefaultUnitChanged",message:""},TextMaxLineWidthReplaced:{notifyUser:!0,askPermission:!1,key:"TextMaxLineWidthReplaced",message:"Text max line width is no longer supported. Replaced with size mode content height and explicit width set in pixels"},RemoveValue:{notifyUser:!1,askPermission:!1,key:"RemoveValue",message:""}},h={condition:function(a){return void 0===a.version&&"Group"===a.type&&"none"===a.parameters.layout},generatePatch:function(a){return{key:"RemoveValue",version:2,patch:{nodeId:a.id,params:{layout:null}}}}},i={condition:function(a){return void 0===a.version&&"Group"===a.type&&a.parameters.hasOwnProperty("layout")&&"none"!==a.parameters.layout},generatePatch:function(a){var b,c;if("stackHorizontal"===a.parameters.layout)b="Stack Layout",c="horizontal";else if("stackVertical"===a.parameters.layout)b="Stack Layout",c="vertical";else if("flowHorizontal"===a.parameters.layout)b="Flow Layout",c="horizontal";else{if("flowVertical"!==a.parameters.layout)return void console.error("Can't convert layout",a);b="Flow Layout",c="vertical"}return{key:"LayoutNotSupported",patch:{nodeId:a.id,version:2,typename:b,params:{layout:null,orientation:c}}}}},j={condition:function(a){return void 0===a.version&&"Image"===a.type&&(("explicit"===a.parameters.sizeMode||"childHeight"===a.parameters.sizeMode)&&(!a.parameters.hasOwnProperty("width")||"object"!=typeof a.parameters.width))},generatePatch:function(a){var b=0;return a.parameters.width&&(b=a.parameters.width.value?a.parameters.width.value:a.parameters.width),{key:"ImageDefaultUnitChanged",patch:{nodeId:a.id,version:2,params:{width:{value:b,unit:"px"}}}}}},k={condition:function(a){return void 0===a.version&&"Image"===a.type&&(("explicit"===a.parameters.sizeMode||"childWidth"===a.parameters.sizeMode)&&(!a.parameters.hasOwnProperty("height")||"object"!=typeof a.parameters.height))},generatePatch:function(a){var b=0;return a.parameters.height&&(b=a.parameters.height.value?a.parameters.height.value:a.parameters.height),{key:"ImageDefaultUnitChanged",patch:{nodeId:a.id,version:2,params:{height:{value:b,unit:"px"}}}}}},l={condition:function(a){return void 0===a.version&&"Text"===a.type&&a.parameters.hasOwnProperty("maxWidth")},generatePatch:function(a){return{key:"TextMaxLineWidthReplaced",patch:{nodeId:a.id,version:2,params:{maxWidth:null,sizeMode:"childHeight",width:{value:a.parameters.maxWidth,unit:"px"}}}}}};b.exports={collectPatches:function(a){var b={};return a.components.forEach(function(a){a.nodes.forEach(function(a){f(a,b)})}),b}}},{}],284:[function(a,b,c){"use strict";function d(a,b){var c="Device Settings - "+a;b.ports.push({group:c,type:{name:"enum",enums:[{label:"WebGL",value:"webgl"},{label:"Canvas2D",value:"canvas2d"}]},name:a+".renderer",displayName:"Renderer",default:"webgl"}),b.ports.push({group:c,type:{name:"component"},name:a+".rootComponent",displayName:"Root Component"}),b.dynamicports.push({name:"conditionalports/basic",condition:"'"+a+".fillMode' = aspectFit OR '"+a+".fillMode' NOT SET",ports:[{group:c,type:"number",name:a+".canvasWidth",displayName:"Width",default:1080},{group:c,type:"number",name:a+".canvasHeight",displayName:"Height",default:1920}]}),b.ports.push({group:c,type:{name:"enum",enums:[{label:"Fill",value:"fill"},{label:"Aspect Fit",value:"aspectFit"}]},name:a+".fillMode",displayName:"Fill Mode",default:"aspectFit"})}function e(a){for(var b=[],c=0;c<__noodl_modules.length;c++){var d=__noodl_modules[c];d.mqttBrokers&&d.mqttBrokers.forEach(function(a){b.push(a)})}if(0===b.length)a.dynamicports.push({name:"conditionalports/basic",condition:"mqttUseExternalBroker = true",ports:[{group:"MQTT",type:"string",name:"mqttBrokerUrl",displayName:"Broker URL",default:"mqtt://user:pass@brokerurl.com:1883"}]});else{for(var e=[{value:"default",label:"Default"}],c=0;c<b.length;c++){var f=b[c];e.push({value:f.id,label:f.name})}a.dynamicports.push({name:"conditionalports/basic",condition:"mqttUseExternalBroker = true",ports:[{group:"MQTT",type:{name:"enum",enums:e},default:"default",displayName:"Type",name:"mqttBrokerType"}]}),a.dynamicports.push({name:"conditionalports/basic",condition:"mqttUseExternalBroker = true AND mqttBrokerType = default OR mqttBrokerType NOT SET",ports:[{group:"MQTT",type:"string",name:"mqttBrokerUrl",displayName:"Broker URL",default:"mqtt://user:pass@brokerurl.com:1883"}]});for(var c=0;c<b.length;c++){var f=b[c];a.dynamicports.push({name:"conditionalports/basic",condition:"mqttUseExternalBroker = true AND mqttBrokerType = "+f.id,ports:f.settings})}}a.ports.push({group:"MQTT",type:"boolean",name:"mqttUseExternalBroker",displayName:"External Broker",default:!1})}function f(a){for(var b=0;b<__noodl_modules.length;b++){var c=__noodl_modules[b];c.settings&&c.settings.forEach(function(b){a.ports.push(b)})}}function g(a){var b={dynamicports:[],ports:[{group:"Devices",type:"stringlist",name:"devices",displayName:"Devices",default:i}]},c=[i];return a.devices&&(c=a.devices.split(",")),c.forEach(function(a){d(a,b)}),e(b),f(b),b}function h(a){var b=["fillMode","canvasWidth","canvasHeight","renderer"],c=b.filter(function(b){return a.hasOwnProperty(b)});if(0!==c.length){var d={fillMode:null,canvasWidth:null,canvasHeight:null,renderer:null,devices:i};return c.forEach(function(b){d[i+"."+b]=a[b]}),{askPermission:!1,notifyUser:!1,settingsPatch:d}}}var i="Default Device";b.exports={generateProjectSettings:g,collectPatch:h}},{}],285:[function(a,b,c){"use strict";function d(){this.subscriptions={},f.call(this)}var e=(a("paho-mqtt"),a("./services")),f=a("../eventsender"),g=a("lodash");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype.connect=function(a){if(this.url!==a.url||this.clientId!==a.clientId||!this.client){this.connectArgs=a,this.url=a.url,this.clientId=a.clientId,this.client&&(this.client.disconnect(),this.client=void 0,this.hasClient=!1);var b="function"==typeof this.url?this.url():this.url;if(b){g.endsWith(b,"/")||b.indexOf("?")!==-1||(b+="/"),g.startsWith(b,"mqtt://")?b="ws://"+b.substring(7):g.startsWith(b,"mqtts://")&&(b="wss://"+b.substring(8));var c={useSSL:g.startsWith(b,"wss:")||g.startsWith(b,"mqtts:")},d=b.match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(d){var f=d[4]||d[2];if(f.indexOf("@")!==-1){var h=f.split("@"),i=h[0].split(":"),j=i[0],k=i[1];b=b.substring(0,b.indexOf("://")+3)+b.substring(b.indexOf("@")+1),c.userName=j,c.password=k}var l=new Paho.MQTT.Client(b,a.clientId);this.client=l;var m=this;c.onSuccess=function(){function a(){c--,0===c&&m.emit("connected")}console.log("MQTT","Connected to",b);var c=Object.keys(m.subscriptions).length;for(var d in m.subscriptions)m.client.subscribe(d,{onSuccess:a,onFailure:a})},c.onFailure=function(){console.log("MQTT","Failed to connect to",b),m.client=void 0,setTimeout(function(){m.connect(a)},2e3)},l.connect(c),l.onConnectionLost=function(b){console.log("MQTT",JSON.stringify(b)),m.client=void 0,m.emit("connectionClosed"),setTimeout(function(){m.connect(a)},2e3)},l.onMessageArrived=function(a){var b=a.destinationName,c=JSON.parse(a.payloadString.toString());e.pubsub.routeMessage({topic:b,payload:c})}}}}},d.prototype.reconnect=function(){this.connect(this.connectArgs)},d.prototype.disconnect=function(){this.client&&(this.client.disconnect(),this.client=null)},d.prototype.isConnected=function(){return this.client&&this.client.isConnected()},d.prototype.sendServiceRequest=function(a){if("subscribe"===a.type)this.subscriptions[a.topic]=!0,this.client&&this.client.isConnected()&&this.client.subscribe(a.topic);else if("unsubscribe"===a.type)delete this.subscriptions[a.topic],this.client&&this.client.isConnected()&&this.client.unsubscribe(a.topic);else if("publish"===a.type&&this.client&&this.client.isConnected()){var b=new Paho.MQTT.Message(JSON.stringify(a.payload));b.destinationName=a.topic,this.client.send(b)}},b.exports=d},{"../eventsender":200,"./services":287,lodash:148,"paho-mqtt":154}],286:[function(a,b,c){"use strict";function d(){}var e={},f=["connected","connectionClosed"];d.prototype.setConnection=function(a){var b=this;this.connection&&f.forEach(function(a){b.connection.removeAllListeners(a)}),this.connection=a},d.prototype.reconnect=function(){this.connection.reconnect&&this.connection.reconnect()},d.prototype.isConnected=function(){return this.connection.isConnected()},d.prototype.on=function(a,b){f.indexOf(a)!==-1&&this.connection.on(a,b)},d.prototype.getMatchingSubscribers=function(a){function b(a,b){var c=a.split("/"),d=b.split("/");if(c.length!==d.length)return!1;for(var e=0;e<c.length;e++)if("+"!==d[e]&&c[e]!==d[e])return!1;return!0}var c=[];for(var d in e)if(b(a,d))for(var f=e[d],g=0;g<f.length;g++)c.push(f[g]);return c},d.prototype.routeMessage=function(a){for(var b=this.getMatchingSubscribers(a.topic),c=0;c<b.length;c++)b[c](a)},d.prototype.getSubscribers=function(a){return e[a]||(e[a]=[]),e[a]},d.prototype.subscribe=function(a,b){var c=this.getSubscribers(a);0===c.length&&this.connection.sendServiceRequest({service:"pubsub",type:"subscribe",topic:a}),c.push(b)},d.prototype.unsubscribe=function(a,b){for(var c=this.getSubscribers(a),d=0;d<c.length;d++)c[d]===b&&c.splice(d,1);0===c.length&&this.connection.sendServiceRequest({service:"pubsub",type:"unsubscribe",topic:a})},d.prototype.publish=function(a,b){this.connection.sendServiceRequest({service:"pubsub",type:"publish",topic:a,payload:b})},b.exports=d},{}],287:[function(a,b,c){function d(){}var e=a("events").EventEmitter;d.events=new e,b.exports=d},{events:8}],288:[function(a,b,c){"use strict";function d(a,b){this.duration=b.duration||0,this._isRunning=!1,this._hasCalledOnStart=!1,this.scheduler=a,this.repeatCount=1,this.delay=0;for(var c in b)this[c]=b[c]}function e(a){this.requestFrame=a,this.runningTimers=[],this.newTimers=[]}d.prototype.start=function(){return this._isRunning&&this.stop(),this.scheduler.scheduleTimer(this),this},d.prototype.stop=function(){this.scheduler.stopTimer(this),this._hasCalledOnStart=!1,this._isRunning=!1,this._wasStopped=!0},e.prototype.createTimer=function(a){return new d(this,a)},e.prototype.scheduleTimer=function(a){this.newTimers.indexOf(a)===-1&&(0===a.repeatCount&&(a.repeatCount=1e5),this.newTimers.push(a),this.requestFrame())},e.prototype.stopTimer=function(a){var b;a._isRunning?(b=this.runningTimers.indexOf(a),b!==-1&&this.runningTimers.splice(b,1),a.onStop&&!a._wasStopped&&a.onStop()):(b=this.newTimers.indexOf(a),b!==-1&&this.newTimers.splice(b,1))},e.prototype.runTimers=function(a){var b,c,d=[],e=[],f=[],g=this.runningTimers.length;
for(b=0;b<g;++b)f[b]=this.runningTimers[b];for(b=0;b<g;++b)if(c=f[b],c&&a>=c._start){c._hasCalledOnStart===!1&&c.onStart&&(c.onStart(),c._hasCalledOnStart=!0);var h;h=c.duration>0?(a-c._start)/(c.duration*c.repeatCount):1;var i=h*c.repeatCount-Math.floor(h*c.repeatCount);h>=1&&(i=1),c.onRunning&&c.onRunning(i),h<1&&c._isRunning?d.push(c):c._wasStopped||e.push(c)}else d.push(c);for(this.runningTimers=d,b=0;b<e.length;++b)e[b]._isRunning=!1,e[b]._hasCalledOnStart=!1,e[b].onFinish&&e[b].onFinish();if(this.newTimers.length>0){for(b=0;b<this.newTimers.length;++b)c=this.newTimers[b],c._start=a+c.delay,c._isRunning=!0,c._wasStopped=!1,this.runningTimers.push(c),0===c.delay&&(c.onStart&&(c.onStart(),c._hasCalledOnStart=!0),c.onRunning&&c.onRunning(0));this.newTimers.length=0}},e.prototype.hasPendingTimers=function(){return this.runningTimers.length>0||this.newTimers.length>0},b.exports=e},{}],289:[function(a,b,c){"use strict";function d(a,b){e.call(this,a),this.layout=f,this.imageCache=b,this.renderCommand={type:"circle",color:"#ffffff",blendMode:"alpha",arcAngle:2*Math.PI,solid:!0,lineWidth:2,blur:0,image:null,imagePath:null}}var e=a("./uicontrol"),f={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){var d="%"===a.widthUnit?b*(a.width/100):a.width;return{width:d,height:d}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setArcAngle=function(a){this.renderCommand.arcAngle=a,this.setContentDirty(!0)},d.prototype.setSolid=function(a){this.renderCommand.solid=a,this.setContentDirty(!0)},d.prototype.setLineWidth=function(a){this.renderCommand.lineWidth=a,this.setContentDirty(!0)},d.prototype.setBlur=function(a){this.renderCommand.blur=a,this.setContentDirty(!0)},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},d.prototype.setImagePath=function(a){this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a,this.setContentDirty(!0),this.imageCache.getImage(a,this._onImageLoaded.bind(this))},d.prototype._onImageLoaded=function(a){a._path===this.path&&(this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.setContentDirty(!0))},d.prototype.setMaskType=function(a){this.renderCommand.maskType=a},b.exports=d},{"./uicontrol":303}],290:[function(a,b,c){"use strict";function d(a){e.call(this,a,f.static)}var e=a("./layoutcontrol"),f=a("../layout/docklayout");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d},{"../layout/docklayout":305,"./layoutcontrol":294}],291:[function(a,b,c){"use strict";function d(a){e.call(this,a,f.static),this.verticalItemSpacing=0,this.horizontalItemSpacing=0,this.orientation="horizontal",this.contentAlignX="left",this.contentAlignY="top"}var e=a("./layoutcontrol"),f=a("../layout/flowlayout");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setVerticalItemSpacing=function(a){this.verticalItemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setHorizontalItemSpacing=function(a){this.horizontalItemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setOrientation=function(a){this.orientation=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setContentAlignX=function(a){this.contentAlignX=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setContentAlignY=function(a){this.contentAlignY=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},b.exports=d},{"../layout/flowlayout":306,"./layoutcontrol":294}],292:[function(a,b,c){"use strict";function d(a,b,c,d){var e=c/a,f=d/b,g=Math.min(e,f);return{width:a*g,height:b*g}}function e(a,b,c,d){var e=c/a,f=d/b,g=Math.max(e,f);return{width:a*g,height:b*g}}function f(a,b){g.call(this,a),this.layout=h,this.setAlignX("center"),this.setAlignY("center"),this.setSizeMode("original"),this.imageCache=b,this.renderCommand={type:"image",color:"#ffffff",blendMode:"alpha",image:null,imagePath:null},this.imageWidth=0,this.imageHeight=0}var g=a("../uicontrol"),h={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){var f=a.imageWidth,g=a.imageHeight;if("fill"===a.sizeMode){var h=a.parent.sizeMode;"explicit"!==h&&"childHeight"!==h||(f=b),"explicit"!==h&&"childWidth"!==h||(g=c)}var i=b&&c&&a.imageWidth&&a.imageHeight;return"aspectFit"===a.sizeMode&&i?d(a.imageWidth,a.imageHeight,b,c):"aspectFill"===a.sizeMode&&i?e(a.imageWidth,a.imageHeight,b,c):{width:f,height:g}}};f.prototype=Object.create(g.prototype),f.prototype.setImagePath=function(a){if(this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a,this.imageWidth=0,this.imageHeight=0,this.setContentDirty(!0),this.layouter.setNeedsRelayout(this),null!==a)if("string"==typeof a)this.imageCache.getImage(a,this._onImageLoaded.bind(this));else if("object"==typeof a&&"CANVAS"===a.tagName){var b=a;this.imageWidth=b.width,this.imageHeight=b.height,this.renderCommand.image=b,this.renderCommand.imagePath=b.id||"canvas"}},f.prototype.setVideoElement=function(a){this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a.src,this.imageWidth=0,this.imageHeight=0,this.setContentDirty(!0),this.layouter.setNeedsRelayout(this),a.videoWidth?this._onVideoLoaded(a):a.addEventListener("canplay",this._onVideoLoaded.bind(this,a))},f.prototype._onVideoLoaded=function(a){a.src===this.path&&(this.imageWidth=a.videoWidth,this.imageHeight=a.videoHeight,this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.setContentDirty(!0),this.layouter.setNeedsRelayout(this))},f.prototype._onImageLoaded=function(a){a._path===this.path&&(this.imageWidth=a.width,this.imageHeight=a.height,this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0))},f.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},f.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},f.prototype.setImageSourceRect=function(a){var b=this.renderCommand;b.srcRect||(b.srcRect=[0,0,1,1]),b.srcRect[0]=a[0],b.srcRect[1]=a[1],b.srcRect[2]=a[2],b.srcRect[3]=a[3]},b.exports=f},{"../uicontrol":303}],293:[function(a,b,c){"use strict";function d(a,b){f.call(this,a),this.clip=!0,this.innerControl=new e(a,b),this.addChild(this.innerControl)}var e=a("./image/imageinnercontrol"),f=a("./docklayoutcontrol");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype.setImagePath=function(a){this.innerControl.setImagePath(a)},d.prototype.setVideoElement=function(a){this.innerControl.setVideoElement(a)},d.prototype.setFillMode=function(a){this.innerControl.setSizeMode(a)},d.prototype.setClip=function(a){this.clip=a,this.setContentDirty(!0)},d.prototype.setColor=function(a){this.innerControl.setColor(a)},d.prototype.setBlendMode=function(a){this.innerControl.setBlendMode(a)},d.prototype.setImageSourceRect=function(a){this.innerControl.setImageSourceRect(a)},d.prototype.dispose=function(){this.innerControl.dispose(),f.prototype.dispose.call(this)},b.exports=d},{"./docklayoutcontrol":290,"./image/imageinnercontrol":292}],294:[function(a,b,c){"use strict";function d(a,b){e.call(this,a),this.layout=b,this.children=[],this.padding={top:0,bottom:0,left:0,right:0},this.clip=!1,this.childAABB=f.create()}var e=a("./uicontrol"),f=a("../math/aabb");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setPaddingTop=function(a){this.padding.top=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPaddingLeft=function(a){this.padding.left=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPaddingRight=function(a){this.padding.right=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPaddingBottom=function(a){this.padding.bottom=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.addChild=function(a,b){void 0===b&&(b=this.children.length-1),this.children.splice(b,0,a),a.parent=this,this.layouter.setNeedsRelayout(this),this.layouter.setNeedsRelayout(a),a.setContentDirty(!0),a.localTransformDirty=!0},d.prototype.removeChild=function(a){var b=this.children.indexOf(a);b!==-1?this.children.splice(b,1):console.error("Node is not a child"),this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setClip=function(a){this.clip=a,this.setContentDirty(!0)},d.prototype.getChildren=function(){return this.children},b.exports=d},{"../math/aabb":311,"./uicontrol":303}],295:[function(a,b,c){"use strict";function d(a,b){e.call(this,a),this.layout=f,this.setWidth(100),this.setHeight(100),this.renderCommand={type:"mesh",color:"#ffffff",blendMode:"alpha",mesh:null,shader:null,image:null,imagePath:null,srcRect:[0,0,1,1]},this.imageCache=b}var e=a("./uicontrol"),f={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){return{width:"%"===a.widthUnit?b*(a.width/100):a.width,height:"%"===a.heightUnit?c*(a.height/100):a.height}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setImagePath=function(a){this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a,this.imageWidth=0,this.imageHeight=0,this.setContentDirty(!0),null!==a&&this.imageCache.getImage(a,this._onImageLoaded.bind(this))},d.prototype._onImageLoaded=function(a){a._path===this.path&&(this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.setContentDirty(!0))},d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setShader=function(a){this.renderCommand.shader=a,this.setContentDirty(!0)},d.prototype.setMesh=function(a){this.renderCommand.mesh=a,this.setContentDirty(!0)},d.prototype.setImageSourceRect=function(a){var b=this.renderCommand;b.srcRect||(b.srcRect=[0,0,1,1]),b.srcRect[0]=a[0],b.srcRect[1]=a[1],b.srcRect[2]=a[2],b.srcRect[3]=a[3]},d.prototype.dispose=function(){this.renderCommand.mesh&&this.renderCommand.mesh.dispose(),e.prototype.dispose.call(this)},b.exports=d},{"./uicontrol":303}],296:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.layout=f,this.renderCommand={type:"rectangle",color:"#ffffff",blendMode:"solid",cornerRadius:0,blur:0}}var e=a("./uicontrol"),f={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){return{width:"%"===a.widthUnit?b*(a.width/100):a.width,height:"%"===a.heightUnit?c*(a.height/100):a.height}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setCornerRadius=function(a){this.renderCommand.cornerRadius=a,this.setContentDirty(!0)},d.prototype.setBlur=function(a){this.renderCommand.blur=a,this.setContentDirty(!0)},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},d.prototype.setMaskType=function(a){this.renderCommand.maskType=a},b.exports=d},{"./uicontrol":303}],297:[function(a,b,c){"use strict";function d(a,b){e.call(this,a,f.static),this.itemSpacing=0,this.orientation="vertical",this.scrollOffset=0;var c=this;this.scroller=new g(b,{scrollThreshold:50,axis:1,scrollEndedAnimationDuration:300,bounceOnPositionEndedOverride:!1,scrollEndedPositionCallback:function(a,b){return c.scrollEndedPositionCallback(a,b)},scrollCallback:function(a){c.setScrollOffset(a)}}),this.contentLengthChanged=function(a){c.scroller.scrollObjectSize=a},this.on("layoutWidthChanged",this._updateScrollViewSize.bind(this)),this.on("layoutHeightChanged",this._updateScrollViewSize.bind(this))}var e=a("./layoutcontrol"),f=a("../layout/scrollviewlayout"),g=a("../touch/scroller");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype._updateScrollViewSize=function(){"horizontal"===this.orientation?this.scroller.scrollViewSize=this.layoutRect.width-this.padding.left-this.padding.right:"vertical"===this.orientation&&(this.scroller.scrollViewSize=this.layoutRect.height-this.padding.top-this.padding.bottom)},d.prototype.setPaddingTop=function(a){e.prototype.setPaddingTop.call(this,a),this._updateScrollViewSize()},d.prototype.setPaddingLeft=function(a){e.prototype.setPaddingLeft.call(this,a),this._updateScrollViewSize()},d.prototype.setPaddingRight=function(a){e.prototype.setPaddingRight.call(this,a),this._updateScrollViewSize()},d.prototype.setPaddingBottom=function(a){e.prototype.setPaddingBottom.call(this,a),this._updateScrollViewSize()},d.prototype.setItemSpacing=function(a){this.itemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.getItemSpacing=function(){return this.itemSpacing},d.prototype.setOrientation=function(a){this.orientation=a,this.scroller.setOrientation(a),this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setScrollOffset=function(a){this.scrollOffset=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0),this.emit("scrollOffsetChanged",a)},d.prototype.setOverscrollEnabled=function(a){this.scroller.shouldRubber=a},d.prototype.setScrollThreshold=function(a){this.scroller.scrollThreshold=a},d.prototype.setScrollDuration=function(a){this.scroller.scrollEndedAnimationDuration=a},b.exports=d},{"../layout/scrollviewlayout":309,"../touch/scroller":332,"./layoutcontrol":294}],298:[function(a,b,c){"use strict";function d(a){e.call(this,a,f.static),this.orientation="vertical",this.itemSpacing=0}var e=a("./layoutcontrol"),f=a("../layout/stacklayout");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setItemSpacing=function(a){this.itemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setOrientation=function(a){this.orientation=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},b.exports=d},{"../layout/stacklayout":310,"./layoutcontrol":294}],299:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.layout=g,this.renderCommand={type:"text",fontFamily:"Helvetica",fontSize:40,color:"#ffffff",text:"",lineHeight:0,blendMode:"alpha"},this.text="",this.textWidth=0,this.textHeight=0,this.horizontalAlignment="left",this.maxWidth=0,this.lineHeight=0}var e=a("../uicontrol"),f=a("./textlayout"),g={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){return a.contentDirty&&a.layoutText(),{width:a.textWidth,height:a.textHeight}}};d.prototype=Object.create(e.prototype),d.prototype.layoutText=function(){var a=f.layoutText(this.text,this.renderCommand.fontFamily,this.renderCommand.fontSize,this.horizontalAlignment,this.lineHeight,this.maxWidth);this.textWidth=a.width,this.textHeight=a.height,this.renderCommand.lines=a.lines,this.renderCommand.text=a.lines.map(function(a){return a.text}).join("\n"),this.setContentDirty(!0)},d.prototype.setFontFamily=function(a){this.renderCommand.fontFamily=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setFontSize=function(a){this.renderCommand.fontSize=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setLineHeight=function(a){this.lineHeight=a,this.renderCommand.lineHeight=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setText=function(a){a=String(a),this.text!==a&&(this.text=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0))},d.prototype.getText=function(){return this.text},d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setHorizontalAlignment=function(a){this.horizontalAlignment=a,this.renderCommand.horizontalAlignment=a,this.layouter.setNeedsRelayout(this)},d.prototype.setMaxWidth=function(a){this.maxWidth!==a&&(this.maxWidth=a,this.layouter.setNeedsRelayout(this))},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},b.exports=d},{"../uicontrol":303,"./textlayout":300}],300:[function(a,b,c){"use strict";function d(a,b){var c=a+" - "+b;if(void 0===i[c]){var d=document.createElement("span");d.style.fontFamily=a,d.style.fontSize=b+"px",d.innerHTML="yq|";var e=document.createElement("div");e.style.display="inline-block",e.style.width="1px",e.style.height="0px";var f=document.createElement("div");f.style.display="inline-block",f.appendChild(d),f.appendChild(e),document.body.appendChild(f),e.style.verticalAlign="bottom";var g=e.offsetTop-d.offsetTop;e.style.verticalAlign="baseline";var h=e.offsetTop-d.offsetTop;document.body.removeChild(f);var j={height:g,baseline:h};i[c]=j}return i[c]}function e(a,b,c){k.font=c+'px "'+b+'"';var e=d(b,c);return{width:k.measureText(a).width,height:e.height,baseline:e.baseline}}function f(a,b){if(k.measureText(a).width<b)return[a];var c=a.split(" ").map(function(a){return a+" "});c[c.length-1]=c[c.length-1].slice(0,-1);for(var d=[],e="";c.length>0;){for(;c[0].length>1&&k.measureText(c[0]).width>=b;){var f=c[0];c[0]=f.slice(0,-1),c.length>1?c[1]=f.slice(-1)+c[1]:c.push(f.slice(-1))}0===e.length||k.measureText(e+c[0]).width<b?e+=c.shift():(d.push(e),e="",c.length&&" "===c[0][0]&&(c[0]=c[0].slice(1),0===c[0].length&&c.shift())),0===c.length&&d.push(e)}return d}function g(a,b,c){return"center"===a?(b-c)/2:"right"===a?b-c:0}function h(a,b,c,e,h,i){k.font=c+'px "'+b+'"';var j=[];0===i?j=a.split("\n"):a.split("\n").forEach(function(a){j=j.concat(f(a,i))});var l=0,m=[];j.forEach(function(a){var b=k.measureText(a).width;l=Math.max(l,b),m.push(b)});var n=d(b,c),o=h?h:n.height,p=n.height+(j.length-1)*o,q=[];return j.forEach(function(a,b){var c=m[b],d=g(e,l,c);q.push({text:a,x:d,y:n.baseline+b*o})}),{width:l,height:p,lines:q}}var i={},j=document.createElement("canvas"),k=j.getContext("2d");b.exports={measureText:e,layoutText:h}},{}],301:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.innerControl=new f(a),this.addChild(this.innerControl)}var e=a("./docklayoutcontrol"),f=a("./text/textinnercontrol");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype._onLayoutWidthChanged=function(a){e.prototype._onLayoutWidthChanged.call(this,a),"explicit"===this.sizeMode||"childHeight"===this.sizeMode?this.innerControl.setMaxWidth(a):this.innerControl.setMaxWidth(0)},d.prototype.setFontFamily=function(a){this.innerControl.setFontFamily(a)},d.prototype.setFontSize=function(a){this.innerControl.setFontSize(a)},d.prototype.setLineHeight=function(a){this.innerControl.setLineHeight(a)},d.prototype.setText=function(a){this.innerControl.setText(a)},d.prototype.getText=function(){return this.innerControl.getText()},d.prototype.setColor=function(a){this.innerControl.setColor(a)},d.prototype.setHorizontalAlignment=function(a){this.innerControl.setHorizontalAlignment(a),this.innerControl.setAlignX(a)},d.prototype.setVerticalAlignment=function(a){this.innerControl.setAlignY(a)},d.prototype.setBlendMode=function(a){this.innerControl.setBlendMode(a)},d.prototype.dispose=function(){this.innerControl.dispose(),e.prototype.dispose.call(this)},b.exports=d},{"./docklayoutcontrol":290,"./text/textinnercontrol":299}],302:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.layout=h,this.contentWidth=0,this.contentHeight=0,this.renderCommand={type:"textInput",fontFamily:"Helvetica",fontSize:40,color:"#ffffff",focused:!1,text:"",blendMode:"alpha"},this.text="",this.type="text",this.clip=!0}var e=a("./uicontrol"),f=a("./text/textlayout"),g=a("../../useragent-utils"),h={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){var d=0,e=0;return d="childSize"===a.sizeMode||"childWidth"===a.sizeMode?a.contentWidth:"%"===a.widthUnit?b*(a.width/100):a.width,e="childSize"===a.sizeMode||"childHeight"===a.sizeMode?a.contentHeight:"%"===a.heightUnit?c*(a.height/100):a.height,{width:d,height:e}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.updateTextMetrics=function(){var a=f.measureText(this.renderCommand.text,this.renderCommand.fontFamily,this.renderCommand.fontSize);this.contentWidth=a.width,this.contentHeight=a.height,this.renderCommand.baseline=a.baseline,this.renderCommand.textWidth=a.width,this.renderCommand.textHeight=a.height,this.layouter.setNeedsRelayout(this)},d.prototype.setInputField=function(a){this.textInputField=a;var b=this;a.on("inputChanged",function(a){b.setText(a)},this),a.on("blur",this.blur.bind(this),this)},d.prototype.setFontFamily=function(a){this.renderCommand.fontFamily=a,this.updateTextMetrics(),this.setContentDirty(!0)},d.prototype.setFontSize=function(a){this.renderCommand.fontSize=a,this.updateTextMetrics(),this.setContentDirty(!0)},d.prototype.getRenderText=function(a){if("password"===this.type){var b=g.isMobile.iOS()?"":"";a=b.repeat(a.length)}return a},d.prototype.setText=function(a){this.renderCommand.text=this.getRenderText(a),this.updateTextMetrics(),this.setContentDirty(!0),this.text=a,this.emit("textChanged",a)},d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.getText=function(){return this.text},d.prototype.setHorizontalAlignment=function(a){},d.prototype.setVerticalAlignment=function(a){},d.prototype.focus=function(){this.renderCommand.focused!==!0&&(this.renderCommand.focused=!0,this.textInputField.focus(),this.setContentDirty(!0),this.emit("focused",this))},d.prototype.blur=function(){this.renderCommand.focused!==!1&&(this.renderCommand.focused=!1,this.textInputField.blur(),this.setContentDirty(!0),this.emit("blurred",this))},d.prototype.isFocused=function(){return this.renderCommand.focused},d.prototype.setInputType=function(a){this.type=a,this.textInputField.setType(a),this.renderCommand.text=this.getRenderText(this.text),this.updateTextMetrics(),this.setContentDirty(!0)},d.prototype.dispose=function(){e.prototype.dispose.call(this),this.textInputField&&(this.textInputField.removeListenersWithRef(this),this.textInputField.dispose())},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},b.exports=d},{"../../useragent-utils":337,"./text/textlayout":300,"./uicontrol":303}],303:[function(a,b,c){"use strict";function d(a){f.call(this),this.id=g(),this.layouter=a,this.sizeMode="explicit",this.pivotUnitType=[],this.pivotFactors=[.5,.5],this.parent=null,this.positionX=0,this.positionY=0,this.positionZ=0,this.alignX="left",this.alignY="top",this.pivotX=50,this.pivotY=50,this.pivotXUnit="%",this.pivotYUnit="%",this.pivotXPx=0,this.pivotYPx=0,this.pivotZPx=0,this.width=0,this.height=0,this.widthUnit="%",this.heightUnit="%",this.depth=void 0,this.opacity=1,this.visible=!0,this.scaleX=1,this.scaleY=1,this.rotationX=0,this.rotationY=0,this.rotationZ=0,this.blockTouch=!1,this.touchPropagation=!0,this.contentDirty=!0,this.highlightEnabled=!1,this.layoutRect=new e({xChanged:this._onLayoutPositionChanged.bind(this),yChanged:this._onLayoutPositionChanged.bind(this),widthChanged:this._onLayoutWidthChanged.bind(this),heightChanged:this._onLayoutHeightChanged.bind(this)}),this.screenAABB=i.create(),this.transform=h.create(),this.localTransform=h.create(),this.localTransformDirty=!1}var e=a("./../layout/layoutrect"),f=a("../../eventsender"),g=a("../../guid"),h=a("../math/mat4"),i=a("../math/aabb");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype._onLayoutPositionChanged=function(){this.localTransformDirty=!0},d.prototype._onLayoutWidthChanged=function(a){this.emit("layoutWidthChanged",a),"%"===this.pivotXUnit&&this.setPivotX(this.pivotX)},d.prototype._onLayoutHeightChanged=function(a){this.emit("layoutHeightChanged",a),"%"===this.pivotYUnit&&this.setPivotY(this.pivotY)},d.prototype.setPositionX=function(a){this.positionX=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPositionY=function(a){this.positionY=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPositionZ=function(a){this.positionZ=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setWidth=function(a){a===1/0&&(a=0),this.width=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setHeight=function(a){a===1/0&&(a=0),this.height=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setWidthUnit=function(a){this.widthUnit=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setHeightUnit=function(a){this.heightUnit=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setSizeMode=function(a){this.sizeMode=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setAlignX=function(a){this.alignX=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setAlignY=function(a){this.alignY=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setBlockTouch=function(a){this.blockTouch=a},d.prototype.setTouchPropagation=function(a){this.touchPropagation=a},d.prototype.setDepth=function(a){this.depth=a,this.setContentDirty(!0)},d.prototype.setOpacity=function(a){0===this.opacity&&a>0&&(this.localTransformDirty=!0),this.opacity=a,this.setContentDirty(!0)},d.prototype.setVisible=function(a){this.visible=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setPivotX=function(a){this.pivotX=a;var b=a;if("%"===this.pivotXUnit){var c=void 0===this.layoutRect.width?0:this.layoutRect.width;b=c*a*.01}this.pivotXPx!==b&&(this.pivotXPx=b,this.localTransformDirty=!0,this.setContentDirty(!0))},d.prototype.setPivotXUnit=function(a){this.pivotXUnit=a,this.setPivotX(this.pivotX),this.setContentDirty(!0)},d.prototype.setPivotY=function(a){this.pivotY=a;var b=a;if("%"===this.pivotYUnit){var c=void 0===this.layoutRect.height?0:this.layoutRect.height;b=c*a*.01}this.pivotYPx!==b&&(this.pivotYPx=b,this.localTransformDirty=!0,this.setContentDirty(!0))},d.prototype.setPivotYUnit=function(a){this.pivotYUnit=a,this.setPivotY(this.pivotY),this.setContentDirty(!0)},d.prototype.setPivotZ=function(a){this.pivotZPx=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setRotationX=function(a){this.rotationX=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setRotationY=function(a){this.rotationY=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setRotationZ=function(a){this.rotationZ=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setScaleX=function(a){this.scaleX=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setScaleY=function(a){this.scaleY=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setContentDirty=function(a){this.contentDirty!==a&&(this.contentDirty=a,a&&this.parent&&this.parent.setContentDirty(!0))},d.prototype.setHighlightEnabled=function(a){this.highlightEnabled=a,this.setContentDirty(!0)},d.prototype.getScreenX=function(){return this.screenAABB.min[0]},d.prototype.getScreenY=function(){return this.screenAABB.min[1]},d.prototype.dispose=function(){this.emit("disposed",this),this.removeAllListeners()},b.exports=d},{"../../eventsender":200,"../../guid":202,"../math/aabb":311,"../math/mat4":313,"./../layout/layoutrect":308}],304:[function(a,b,c){"use strict";function d(){this.cache={},this.crossOrigin=!1}d.prototype.setCrossOrigin=function(a){this.crossOrigin=!!a},d.prototype.getImage=function(a,b){var c=this.cache[a];if(c)return void(c.isLoaded?b(c.image):c.callbacks.push(b));this.cache[a]={image:new Image,callbacks:[],isLoaded:!1},c=this.cache[a],c.callbacks.push(b);var d=c.image;this.crossOrigin&&(d.crossOrigin="anonymous"),d.addEventListener("load",function(){c.callbacks.forEach(function(a){a(d)}),c.isLoaded=!0,delete c.callbacks}),d.src=a,d._path=a},d.prototype.clear=function(){this.cache={}},b.exports=d},{}],305:[function(a,b,c){"use strict";function d(){}d.prototype.layoutChildHorizontally=function(a,b,c,d,e){"left"===b.alignX?(a.x=b.positionX+e.left,a.width=c):"right"===b.alignX?(a.x=d.width-e.right+b.positionX-c,a.width=c):"center"===b.alignX&&(a.x=(d.width-e.right-e.left)/2+e.left+b.positionX-c/2,a.width=c),a.x=Math.round(a.x)},d.prototype.layoutChildVertically=function(a,b,c,d,e){"top"===b.alignY?(a.y=b.positionY+e.top,a.height=c):"bottom"===b.alignY?(a.y=d.height-e.bottom+b.positionY-c,a.height=c):"center"===b.alignY&&(a.y=(d.height-e.bottom-e.top)/2+e.top+b.positionY-c/2,a.height=c),a.y=Math.round(a.y)},d.prototype.setChildLayoutRect=function(a,b){var c=a.layoutRect.width!=b.width||a.layoutRect.height!=b.height;a.layoutRect.x=b.x,a.layoutRect.y=b.y,a.layoutRect.width=Math.max(b.width,0),a.layoutRect.height=Math.max(b.height,0),(c||a.needsRelayout)&&(a.layout.layout&&a.layout.layout(a),a.needsRelayout=!1)},d.prototype.layout=function(a){for(var b={x:0,y:0,width:0,height:0},c=0;c<a.children.length;c++){var d=a.children[c],e=a.layoutRect.width-a.padding.left-a.padding.right,f=a.layoutRect.height-a.padding.top-a.padding.bottom,g=d.layout.layoutSize(d,e,f);this.layoutChildHorizontally(b,d,g.width,a.layoutRect,a.padding),this.layoutChildVertically(b,d,g.height,a.layoutRect,a.padding),this.setChildLayoutRect(d,b)}},d.prototype.layoutSize=function(a,b,c){var d=this.measure(a,b,c);return{width:"childWidth"===a.sizeMode||"childSize"===a.sizeMode?d.width:this.layoutWidth(a,b),height:"childHeight"===a.sizeMode||"childSize"===a.sizeMode?d.height:this.layoutHeight(a,c)}},d.prototype.measureChildrenWidth=function(a,b){for(var c=0,d=0;d<a.children.length;d++){var e=a.children[d],f=e.layout.measure(e,b.width,b.height);c=Math.max(c,Math.max(e.positionX,0)+f.width)}return c},d.prototype.measureChildrenHeight=function(a,b){for(var c=0,d=0;d<a.children.length;d++){var e=a.children[d],f=e.layout.measure(e,b.width,b.height);c=Math.max(c,Math.max(e.positionY,0)+f.height)}return c},d.prototype.layoutWidth=function(a,b){return"%"===a.widthUnit?b*(a.width/100):a.width},d.prototype.layoutHeight=function(a,b){return"%"===a.heightUnit?b*(a.height/100):a.height},d.prototype.measure=function(a,b,c){var d={width:"childWidth"===a.sizeMode||"childSize"===a.sizeMode?0:this.layoutWidth(a,b),height:"childHeight"===a.sizeMode||"childSize"===a.sizeMode?0:this.layoutHeight(a,c)},e={width:"childWidth"===a.sizeMode||"childSize"===a.sizeMode?this.measureChildrenWidth(a,d)+a.padding.left+a.padding.right:d.width,height:"childHeight"===a.sizeMode||"childSize"===a.sizeMode?this.measureChildrenHeight(a,d)+a.padding.top+a.padding.bottom:d.height};return e},d.static=new d,b.exports=d},{}],306:[function(a,b,c){"use strict";function d(){}var e=a("./docklayout");d.prototype=Object.create(e.prototype),d.prototype.measureChildrenHeightForHorizontalFlow=function(a,b){if("explict"===this.sizeMode||"childWidth"===this.sizeMode)return b.height;for(var c="childSize"===a.sizeMode?Number.MAX_VALUE:b.width-a.padding.left-a.padding.right,d=0,e=0,f=0,g=a.children.length,h=0;h<g;h++){var i=a.children[h],j=i.layout.measure(i,b.width,b.height);e+j.width>c&&(d+=f+a.verticalItemSpacing,f=e=0),f=Math.max(f,j.height+i.positionY),e+=j.width+a.horizontalItemSpacing}return d+=f},d.prototype.measureChildrenWidthForHorizontalFlow=function(a,b){if("explict"===this.sizeMode||"childHeight"===this.sizeMode)return b.width;for(var c=0,d=a.children.length,e=0;e<d;e++){var f=a.children[e],g=f.layout.measure(f,b.width,b.height);c+=g.width+(e!==d-1?a.horizontalItemSpacing:0)}return c},d.prototype.measureChildrenWidthForVerticalFlow=function(a,b){if("explict"===this.sizeMode||"childHeight"===this.sizeMode)return dim.width;for(var c="childSize"===a.sizeMode?Number.MAX_VALUE:b.height-a.padding.top-a.padding.left,d=0,e=0,f=0,g=a.children.length,h=0;h<g;h++){var i=a.children[h],j=i.layout.measure(i,b.width,b.height);d+j.height>c&&(e+=f+a.horizontalItemSpacing,f=d=0),f=Math.max(f,j.width+i.positionX),d+=j.height+a.verticalItemSpacing}return e+=f},d.prototype.measureChildrenHeightForVerticalFlow=function(a,b){if("explict"===this.sizeMode||"childWidth"===this.sizeMode)return b.height;for(var c=0,d=a.children.length,e=0;e<d;e++){var f=a.children[e],g=f.layout.measure(f,b.width,b.height);
c+=g.height+(e!==d-1?a.verticalItemSpacing:0)}return c},d.prototype.measureChildrenWidth=function(a,b){return"horizontal"===a.orientation?this.measureChildrenWidthForHorizontalFlow(a,b):this.measureChildrenWidthForVerticalFlow(a,b)},d.prototype.measureChildrenHeight=function(a,b){return"horizontal"===a.orientation?this.measureChildrenHeightForHorizontalFlow(a,b):this.measureChildrenHeightForVerticalFlow(a,b)};var f=[];d.prototype.layout=function(a){function b(b,c,d,e,g){var h=0,i=a.layoutRect.width-a.padding.left-a.padding.right;"center"===a.contentAlignX?h=Math.round(.5*(i-g)):"right"===a.contentAlignX&&(h=i-g);for(var k=b;k<c;k++){var l=a.children[k],m=f[k],n=l.layout.layoutSize(l,0,e);j.layoutChildVertically(m,l,n.height,{height:e},{top:0,bottom:0,left:0,right:0}),m.x+=h,m.y+=d,j.setChildLayoutRect(l,m)}}function c(b,c,d,e,g){var h=0,i=a.layoutRect.height-a.padding.top-a.padding.bottom;"center"===a.contentAlignY?h=Math.round(.5*(i-g)):"bottom"===a.contentAlignY&&(h=i-g);for(var k=b;k<c;k++){var l=a.children[k],m=f[k],n=l.layout.layoutSize(l,e,0);j.layoutChildHorizontally(m,l,n.width,{width:e},{top:0,bottom:0,left:0,right:0}),m.x+=d,m.y+=h,j.setChildLayoutRect(l,m)}}var d,e,g,h,i,j=this,k=0,l=0,m=0,n=0,o=0,p=a.children.length;if(f.length<p)for(e=0;e<p;e++)f[e]={x:0,y:0,width:0,height:0};if("horizontal"===a.orientation){var q=a.layoutRect.width-a.padding.left-a.padding.right;d=q;var n=0;for(e=0;e<p;e++)i=f[e],g=a.children[e],h=g.layout.layoutSize(g,q,0),k+h.width>d&&(b(o,e,l+a.padding.top,m,k-a.horizontalItemSpacing),l+=m+a.verticalItemSpacing,o=e,m=0,n=0,k=0),m=Math.round(Math.max(m,h.height)),i.x=k+a.padding.left+g.positionX,i.width=h.width,k+=Math.round(h.width)+a.horizontalItemSpacing;b(o,e,l+a.padding.top,m,k-a.horizontalItemSpacing)}else{var r=a.layoutRect.height-a.padding.top-a.padding.bottom;for(d=r,e=0;e<p;e++)i=f[e],g=a.children[e],h=g.layout.layoutSize(g,0,r),l+h.height>d&&(c(o,e,k+a.padding.left,n,l-a.verticalItemSpacing),k+=n+a.horizontalItemSpacing,o=e,n=0,l=0),n=Math.round(Math.max(n,h.width)),i.y=l+a.padding.top+g.positionY,i.height=h.height,l+=Math.round(h.height)+a.verticalItemSpacing;c(o,e,k+a.padding.left,n,l-a.verticalItemSpacing)}},d.static=new d,b.exports=d},{"./docklayout":305}],307:[function(a,b,c){"use strict";function d(){}var e=a("./docklayout");d.prototype.setWindowSize=function(a,b){this.windowSize={width:a,height:b}},d.prototype.layout=function(a){var b={layoutRect:{x:0,y:0,width:this.windowSize.width,height:this.windowSize.height},padding:{top:0,left:0,bottom:0,right:0},children:[a]};e.static.layout(b),a.needsRelayout=!1},d.prototype.setNeedsFullRelayout=function(a){function b(a){if(a.measuredSize=void 0,a.needsRelayout=!0,a.children)for(var c=0;c<a.children.length;c++)b(a.children[c])}b(a)},d.prototype.setNeedsRelayout=function(a){a.needsRelayout||(a.measuredSize=void 0,a.needsRelayout=!0,a.parent&&this.setNeedsRelayout(a.parent))},d.prototype.relayout=function(a){this.setNeedsFullRelayout(a),this.layout(a)},b.exports=d},{"./docklayout":305}],308:[function(a,b,c){var d=function(a){this._x=this._y=this._width=this._height=void 0,this.callbacks=a};Object.defineProperties(d.prototype,{x:{set:function(a){this._x!==a&&(this._x=a,this.callbacks.xChanged(a))},get:function(){return this._x}},y:{set:function(a){this._y!==a&&(this._y=a,this.callbacks.yChanged(a))},get:function(){return this._y}},width:{set:function(a){this._width!==a&&(this._width=a,this.callbacks.widthChanged(a))},get:function(){return this._width}},height:{set:function(a){this._height!==a&&(this._height=a,this.callbacks.heightChanged(a))},get:function(){return this._height}}}),b.exports=d},{}],309:[function(a,b,c){"use strict";function d(){}var e=a("./stacklayout");d.prototype=Object.create(e.prototype),d.prototype.layout=function(a){var b,c,d,e=a.children.length,f={x:0,y:0,width:0,height:0},g=a.layoutRect.height-a.padding.top-a.padding.bottom,h=a.layoutRect.width-a.padding.left-a.padding.right;if("horizontal"===a.orientation){var i=a.padding.left;for(d=0;d<e;d++)b=a.children[d],c=b.layout.layoutSize(b,h,g),f.x=Math.round(i+a.scrollOffset+b.positionX),f.width=Math.round(c.width),this.layoutChildVertically(f,b,c.height,a.layoutRect,a.padding),this.setChildLayoutRect(b,f),i+=a.itemSpacing+b.layoutRect.width;a.contentLengthChanged&&a.contentLengthChanged(i-(d>0?a.itemSpacing:0)-a.padding.left)}else{var j=a.padding.top;for(d=0;d<e;d++)b=a.children[d],c=b.layout.layoutSize(b,h,g),this.layoutChildHorizontally(f,b,c.width,a.layoutRect,a.padding),f.y=Math.round(j+a.scrollOffset+b.positionY),f.height=Math.round(c.height),this.setChildLayoutRect(b,f),j+=a.itemSpacing+b.layoutRect.height;a.contentLengthChanged&&a.contentLengthChanged(j-(d>0?a.itemSpacing:0)-a.padding.top)}},d.static=new d,b.exports=d},{"./stacklayout":310}],310:[function(a,b,c){"use strict";function d(){}var e=a("./docklayout");d.prototype=Object.create(e.prototype),d.prototype.layout=function(a){var b,c,d,e=0,f=0,g=0,h={x:0,y:0,width:0,height:0},i=a.layoutRect.width-a.padding.left-a.padding.right,j=a.layoutRect.height-a.padding.top-a.padding.bottom;if("horizontal"===a.orientation){for(c=a.children.length,d=0;d<c;d++)if(b=a.children[d],"%"!==b.widthUnit||"explicit"!==b.sizeMode&&"childHeight"!==b.sizeMode){var k=b.layout.measure(b,i,j);e+=k.width}else g+=b.width/100;f=Math.max(0,a.layoutRect.width-a.padding.left-a.padding.right-e-a.itemSpacing*(c-1))/g;var l=Math.round(a.padding.left);for(d=0;d<c;d++){b=a.children[d];var m=a.layoutRect.height-a.padding.top-a.padding.bottom;k=b.layout.layoutSize(b,f,m),h.x=l+b.positionX,h.width=Math.round(k.width),this.layoutChildVertically(h,b,k.height,a.layoutRect,a.padding),this.setChildLayoutRect(b,h),l+=a.itemSpacing+b.layoutRect.width}}else{for(c=a.children.length,d=0;d<c;d++)b=a.children[d],"%"!==b.heightUnit||"explicit"!==b.sizeMode&&"childWidth"!==b.sizeMode?(k=b.layout.measure(b,i,j),e+=k.height):g+=b.height/100;f=Math.max(0,a.layoutRect.height-a.padding.top-a.padding.bottom-e-a.itemSpacing*(c-1))/g;var n=Math.round(a.padding.top);for(d=0;d<c;d++){b=a.children[d];var o=a.layoutRect.width-a.padding.left-a.padding.right;k=b.layout.layoutSize(b,o,f),this.layoutChildHorizontally(h,b,k.width,a.layoutRect,a.padding),h.y=n+b.positionY,h.height=Math.round(k.height),this.setChildLayoutRect(b,h),n+=a.itemSpacing+b.layoutRect.height}}a.needsRelayout=!1},d.prototype.measureChildrenWidth=function(a,b){if("horizontal"===a.orientation){for(var c=0,d=a.children.length,f=0;f<d;f++){var g=a.children[f],h=g.layout.measure(g,b.width,b.height);c+=h.width+(f!==d-1?a.itemSpacing:0)}return c}return e.prototype.measureChildrenWidth.call(this,a,b)},d.prototype.measureChildrenHeight=function(a,b){if("vertical"===a.orientation){for(var c=0,d=a.children.length,f=0;f<d;f++){var g=a.children[f],h=g.layout.measure(g,b.width,b.height);c+=h.height+(f!==d-1?a.itemSpacing:0)}return c}return e.prototype.measureChildrenHeight.call(this,a,b)},d.static=new d,b.exports=d},{"./docklayout":305}],311:[function(a,b,c){"use strict";var d=a("./mat3"),e=a("./mat4"),f=[[0,0,0],[0,0,0],[0,0,0],[0,0,0]],g={};g.create=function(){return{min:[0,0],max:[0,0]}},g.set=function(a,b,c,d,e){a.min[0]=b,a.min[1]=c,a.max[0]=d,a.max[1]=e},g.transform3=function(a,b){f[0][0]=a.min[0],f[0][1]=a.min[1],f[1][0]=a.min[0],f[1][1]=a.max[1],f[2][0]=a.max[0],f[2][1]=a.min[1],f[3][0]=a.max[0],f[3][1]=a.max[1],d.transformPoint(b,f[0]),a.min[0]=a.max[0]=f[0][0],a.min[1]=a.max[1]=f[0][1];for(var c=1;c<4;++c){var e=f[c];d.transformPoint(b,e),e[0]<a.min[0]&&(a.min[0]=e[0]),e[1]<a.min[1]&&(a.min[1]=e[1]),e[0]>a.max[0]&&(a.max[0]=e[0]),e[1]>a.max[1]&&(a.max[1]=e[1])}},g.transform4=function(a,b){f[0][0]=a.min[0],f[0][1]=a.min[1],f[1][0]=a.min[0],f[1][1]=a.max[1],f[2][0]=a.max[0],f[2][1]=a.min[1],f[3][0]=a.max[0],f[3][1]=a.max[1],e.transformPoint(b,f[0]),a.min[0]=a.max[0]=f[0][0],a.min[1]=a.max[1]=f[0][1];for(var c=1;c<4;++c){var d=f[c];e.transformPoint(b,d),d[0]<a.min[0]&&(a.min[0]=d[0]),d[1]<a.min[1]&&(a.min[1]=d[1]),d[0]>a.max[0]&&(a.max[0]=d[0]),d[1]>a.max[1]&&(a.max[1]=d[1])}},g.copy=function(a,b){a.min[0]=b.min[0],a.min[1]=b.min[1],a.max[0]=b.max[0],a.max[1]=b.max[1]},g.intersects=function(a,b){return!(a.min[0]>=b.max[0]||a.max[0]<=b.min[0]||a.min[1]>=b.max[1]||a.max[1]<=b.min[1])},g.union=function(a,b){b.min[0]<a.min[0]&&(a.min[0]=b.min[0]),b.min[1]<a.min[1]&&(a.min[1]=b.min[1]),b.max[0]>a.max[0]&&(a.max[0]=b.max[0]),b.max[1]>a.max[1]&&(a.max[1]=b.max[1])},g.width=function(a){return a.max[0]-a.min[0]},g.height=function(a){return a.max[1]-a.min[1]},g.isPointInside=function(a,b){return b[0]>=a.min[0]&&b[0]<=a.max[0]&&b[1]>=a.min[1]&&b[1]<=a.max[1]},g.intersection=function(a,b){a.min[0]=Math.max(a.min[0],b.min[0]),a.min[1]=Math.max(a.min[1],b.min[1]),a.max[0]=Math.min(a.max[0],b.max[0]),a.max[1]=Math.min(a.max[1],b.max[1])},b.exports=g},{"./mat3":312,"./mat4":313}],312:[function(b,c,d){"use strict";var e={};e.create=function(){var a=new Array(9);return e.identity(a),a},e.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},e.copy=function(a,b){for(var c=0;c<9;c++)a[c]=b[c];return a},e.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=c[0],n=c[1],o=c[2],p=c[3],q=c[4],r=c[5],s=c[6],t=c[7],u=c[8];return a[0]=m*d+n*g+o*j,a[1]=m*e+n*h+o*k,a[2]=m*f+n*i+o*l,a[3]=p*d+q*g+r*j,a[4]=p*e+q*h+r*k,a[5]=p*f+q*i+r*l,a[6]=s*d+t*g+u*j,a[7]=s*e+t*h+u*k,a[8]=s*f+t*i+u*l,a},e.translate=function(a,b,c){return a[6]=b*a[0]+c*a[3]+a[6],a[7]=b*a[1]+c*a[4]+a[7],a[8]=b*a[2]+c*a[5]+a[8],a},e.rotate=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=a[8],l=Math.sin(b),m=Math.cos(b);return a[0]=m*c+l*f,a[1]=m*d+l*g,a[2]=m*e+l*h,a[3]=m*f-l*c,a[4]=m*g-l*d,a[5]=m*h-l*e,a[6]=i,a[7]=j,a[8]=k,a},e.scale=function(b,c,d){return b[0]=c*a[0],b[1]=c*a[1],b[2]=c*a[2],b[3]=d*a[3],b[4]=d*a[4],b[5]=d*a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},e.transformPoint=function(a,b){var c=b[0],d=b[1];b[0]=a[0]*c+a[3]*d+a[6],b[1]=a[1]*c+a[4]*d+a[7]},e.invert=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=j*f-g*i,l=-j*e+g*h,m=i*e-f*h,n=b*k+c*l+d*m;return n?(n=1/n,a[0]=k*n,a[1]=(-j*c+d*i)*n,a[2]=(g*c-d*f)*n,a[3]=l*n,a[4]=(j*b-d*h)*n,a[5]=(-g*b+d*e)*n,a[6]=m*n,a[7]=(-i*b+c*h)*n,a[8]=(f*b-c*e)*n,a):null},c.exports=e},{}],313:[function(b,c,d){"use strict";var e={};e.create=function(){var a=new Array(16);return e.identity(a),a},e.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.copy=function(a,b){for(var c=0;c<16;c++)a[c]=b[c];return a},e.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14],s=b[15],t=c[0],u=c[1],v=c[2],w=c[3];return a[0]=t*d+u*h+v*l+w*p,a[1]=t*e+u*i+v*m+w*q,a[2]=t*f+u*j+v*n+w*r,a[3]=t*g+u*k+v*o+w*s,t=c[4],u=c[5],v=c[6],w=c[7],a[4]=t*d+u*h+v*l+w*p,a[5]=t*e+u*i+v*m+w*q,a[6]=t*f+u*j+v*n+w*r,a[7]=t*g+u*k+v*o+w*s,t=c[8],u=c[9],v=c[10],w=c[11],a[8]=t*d+u*h+v*l+w*p,a[9]=t*e+u*i+v*m+w*q,a[10]=t*f+u*j+v*n+w*r,a[11]=t*g+u*k+v*o+w*s,t=c[12],u=c[13],v=c[14],w=c[15],a[12]=t*d+u*h+v*l+w*p,a[13]=t*e+u*i+v*m+w*q,a[14]=t*f+u*j+v*n+w*r,a[15]=t*g+u*k+v*o+w*s,a},e.translate=function(a,b,c,d){return a[12]=a[0]*b+a[4]*c+a[8]*d+a[12],a[13]=a[1]*b+a[5]*c+a[9]*d+a[13],a[14]=a[2]*b+a[6]*c+a[10]*d+a[14],a[15]=a[3]*b+a[7]*c+a[11]*d+a[15],a},e.rotateX=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[4],f=a[5],g=a[6],h=a[7],i=a[8],j=a[9],k=a[10],l=a[11];return a[4]=e*d+i*c,a[5]=f*d+j*c,a[6]=g*d+k*c,a[7]=h*d+l*c,a[8]=i*d-e*c,a[9]=j*d-f*c,a[10]=k*d-g*c,a[11]=l*d-h*c,a},e.rotateY=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[0],f=a[1],g=a[2],h=a[3],i=a[8],j=a[9],k=a[10],l=a[11];return a[0]=e*d-i*c,a[1]=f*d-j*c,a[2]=g*d-k*c,a[3]=h*d-l*c,a[8]=e*c+i*d,a[9]=f*c+j*d,a[10]=g*c+k*d,a[11]=h*c+l*d,a},e.rotateZ=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[0],f=a[1],g=a[2],h=a[3],i=a[4],j=a[5],k=a[6],l=a[7];return a[0]=e*d+i*c,a[1]=f*d+j*c,a[2]=g*d+k*c,a[3]=h*d+l*c,a[4]=i*d-e*c,a[5]=j*d-f*c,a[6]=k*d-g*c,a[7]=l*d-h*c,a},e.scale=function(b,c,d,e){return b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c,b[3]=a[3]*c,b[4]=a[4]*d,b[5]=a[5]*d,b[6]=a[6]*d,b[7]=a[7]*d,b[8]=a[8]*e,b[9]=a[9]*e,b[10]=a[10]*e,b[11]=a[11]*e,b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},e.transformPoint=function(a,b){var c=b[0],d=b[1],e=b[2],f=a[3]*c+a[7]*d+a[11]*e+a[15];f=f||1,b[0]=(a[0]*c+a[4]*d+a[8]*e+a[12])/f,b[1]=(a[1]*c+a[5]*d+a[9]*e+a[13])/f,b[2]=(a[2]*c+a[6]*d+a[10]*e+a[14])/f},e.invert=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15],r=b*g-c*f,s=b*h-d*f,t=b*i-e*f,u=c*h-d*g,v=c*i-e*g,w=d*i-e*h,x=j*o-k*n,y=j*p-l*n,z=j*q-m*n,A=k*p-l*o,B=k*q-m*o,C=l*q-m*p,D=r*C-s*B+t*A+u*z-v*y+w*x;return D?(D=1/D,a[0]=(g*C-h*B+i*A)*D,a[1]=(d*B-c*C-e*A)*D,a[2]=(o*w-p*v+q*u)*D,a[3]=(l*v-k*w-m*u)*D,a[4]=(h*z-f*C-i*y)*D,a[5]=(b*C-d*z+e*y)*D,a[6]=(p*t-n*w-q*s)*D,a[7]=(j*w-l*t+m*s)*D,a[8]=(f*B-g*z+i*x)*D,a[9]=(c*z-b*B-e*x)*D,a[10]=(n*v-o*t+q*r)*D,a[11]=(k*t-j*v-m*r)*D,a[12]=(g*y-f*A-h*x)*D,a[13]=(b*A-c*y+d*x)*D,a[14]=(o*s-n*u-p*r)*D,void(a[15]=(j*u-k*s+l*r)*D)):null},e.perspective=function(a,b,c,d,e){var f=1/Math.tan(b/2),g=1/(d-e);return a[0]=f/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=f,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(e+d)*g,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*e*d*g,a[15]=0,a},c.exports=e},{}],314:[function(a,b,c){"use strict";function d(a){h.call(this),this.rootElement=document.createElement("div"),this.rootElement.style.position="absolute",this.rootElement.style.display="block",this.rootElement.style.perspective="1000px",this.rootElement.style.webkitPerspective="1000px",a.appendChild(this.rootElement),document.ontouchstart=function(a){a.preventDefault()},this.clipAABB=g.create(),this.renderers=[],this.renderDepthSet={},this._resizeRootElement();var b=this;i.isMobile.Android()&&window.addEventListener("orientationchange",function(){window.setTimeout(b._resizeRootElement.bind(b),100)})}function e(a,b){return a-b}var f=a("./math/mat4"),g=a("./math/aabb"),h=a("../eventsender"),i=a("../useragent-utils"),j=a("lodash");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.prototype._resizeRootElement=function(){i.isMobile.Android()?(this.rootElement.style.width=window.innerWidth+"px",this.rootElement.style.height=window.innerHeight+"px"):(this.rootElement.style.width="100%",this.rootElement.style.height="100%"),this.renderers.forEach(function(a){a.resizeRootElement&&a.resizeRootElement()}),this.emit("requestFrame")},d.prototype.removeAllRenderers=function(){this.renderers.forEach(function(a){a.detach&&a.detach()}),this.renderers=[]},d.prototype.addRenderer=function(a){a.setViewportSize&&a.setViewportSize(this.viewportWidth,this.viewportHeight),a.attach&&a.attach(this.rootElement),this.renderers.push(a)},d.prototype.createTextInputField=function(a){for(var b=0;b<this.renderers.length;b++){var c=this.renderers[b];if(c.createInputField)return c.createInputField(a)}},d.prototype.beginLayout=function(){this.renderDepthSet={}},d.prototype.layout=function(a,b){if(a.visible&&0!==a.opacity){a.contentDirty=!1;var c=a.layoutRect,d=a.localTransform,e=b||a.localTransformDirty;if(a.localTransformDirty&&(f.identity(d),d[0]=a.scaleX,d[5]=a.scaleY,d[12]=c.x+a.pivotXPx,d[13]=c.y+a.pivotYPx,d[14]=a.positionZ+a.pivotZPx,a.rotationX&&f.rotateX(d,a.rotationX),a.rotationY&&f.rotateY(d,a.rotationY),a.rotationZ&&f.rotateZ(d,a.rotationZ),f.translate(d,-a.pivotXPx,-a.pivotYPx,-a.pivotZPx),a.localTransformDirty=!1),e){f.multiply(a.transform,a.parent.transform,d);var h=a.screenAABB.min[0],i=a.screenAABB.min[1];g.set(a.screenAABB,0,0,c.width,c.height),g.transform4(a.screenAABB,a.transform),h!==a.screenAABB.min[0]&&a.emit("screenXChanged",a.screenAABB.min[0]),i!==a.screenAABB.min[1]&&a.emit("screenYChanged",a.screenAABB.min[1])}if(a.renderDepth=void 0!==a.depth?a.depth:a.parent.renderDepth||0,this.renderDepthSet[a.renderDepth]=!0,a.children){g.copy(a.childAABB,a.screenAABB);for(var j=0,k=a.children.length;j<k;j++){var l=a.children[j];this.layout(l,e),a.clip||g.union(a.childAABB,l.childAABB||l.screenAABB)}}}},d.prototype._addRenderCommand=function(a,b,c){if(void 0!==c)a[c].push(b);else for(var d=0;d<this.renderDepths.length;d++)a[this.renderDepths[d]].push(b)},d.prototype._collectRenderCommandsRecursive=function(a,b,c,d){if(a.visible&&0!==a.opacity&&g.intersects(this.clipAABB,a.childAABB||a.screenAABB)!==!1){if(a.clip){this._addRenderCommand(b,{content:{type:"pushClipRect"},id:a.id+"clip",transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height});var e=g.create();g.copy(e,this.clipAABB),g.intersection(this.clipAABB,a.screenAABB)}var f=a.renderCommand;if(f&&("image"!==f.type||f.image)&&(f.opacity=a.opacity*d,this._addRenderCommand(b,{content:f,id:a.id,transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height},a.renderDepth)),f&&f.maskType&&"none"!==f.maskType){var h=j.clone(f);h.maskType="positive"===f.maskType?"negative":"positive",c.push({content:h,id:a.id+"-undoMask",transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height})}if(a.children){for(var i=[],k=0,l=a.children.length;k<l;k++)this._collectRenderCommandsRecursive(a.children[k],b,i,a.opacity*d);for(var k=0,l=i.length;k<l;k++)this._addRenderCommand(b,i[k],a.renderDepth)}if(a.highlightEnabled&&this._addRenderCommand(b,{id:a.id+"-hl",content:{type:"rectangle",color:"#8BC6E9",opacity:.6,cornerRadius:0,blur:0},transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height},a.renderDepth),a.clip){for(var k=0;k<this.renderDepths.length;k++){var m=b[this.renderDepths[k]];"pushClipRect"===m[m.length-1].content.type?m.length=m.length-1:m.push({content:{type:"popClipRect"}})}g.copy(this.clipAABB,e)}}},d.prototype._collectRenderCommands=function(a){var b={};this.renderDepths=Object.keys(this.renderDepthSet);for(var c=0;c<this.renderDepths.length;c++)b[this.renderDepths[c]]=[];return this._collectRenderCommandsRecursive(a,b,[],1),b},d.prototype.render=function(a){var b=this._collectRenderCommands(a),c=Object.keys(b).sort(e);this.renderers.forEach(function(a){for(var d=0;d<c.length;d++)a.render(b[c[d]])})},d.prototype.setViewportSize=function(a,b){this.viewportWidth=a,this.viewportHeight=b,this.renderers.forEach(function(c){c.setViewportSize&&c.setViewportSize(a,b)})},d.prototype.beginFrame=function(){g.set(this.clipAABB,0,0,this.viewportWidth,this.viewportHeight),this.renderers.forEach(function(a){a.beginFrame&&a.beginFrame()})},d.prototype.endFrame=function(){this.renderers.forEach(function(a){a.endFrame&&a.endFrame()})},d.prototype.setFillMode=function(a){this.fillMode=a,this.renderers.forEach(function(b){b.setFillMode&&b.setFillMode(a)})},d.prototype.captureScreenShot=function(a,b,c){for(var d,e=0;e<this.renderers.length;e++){var f=this.renderers[e];if(f.rootElement&&"CANVAS"===f.rootElement.tagName){d=f;break}}if(d){var g=this.rootElement.style.width,h=this.rootElement.style.height;this.rootElement.style.width=b+"px",this.rootElement.style.height=c+"px",d.resizeRootElement(),d.beginFrame&&d.beginFrame();for(var i=this._collectRenderCommands(a),j=Object.keys(i).sort(),e=0;e<j.length;e++)d.render(i[j[e]]);d.endFrame&&d.endFrame();var k;try{k=d.rootElement.toDataURL()}catch(l){}return this.rootElement.style.width=g,this.rootElement.style.height=h,d.resizeRootElement(),this.emit("requestFrame"),k}},d.prototype.onControlDisposed=function(a){this.renderers.forEach(function(b){b.removeResourcesForRenderCommand({id:a.id,content:a.renderCommand})})},d.prototype.clearImageCaches=function(){this.renderers.forEach(function(a){a.clearImageCache&&a.clearImageCache()})},b.exports=d},{"../eventsender":200,"../useragent-utils":337,"./math/aabb":311,"./math/mat4":313,lodash:148}],315:[function(a,b,c){"use strict";function d(a,b){e.call(this);var c=document.createElement("input");c.style.position="absolute",c.style.display="block",c.style.transformOrigin="0% 0%",c.style.padding="0px",c.style.margin="0px",c.style.border="none",c.style.outline="none",c.style.background="none",c.style.textAlign="left",c._noodlStyle={},this.element=c,this.inputListener=this.onInput.bind(this),this.blurListener=this.emit.bind(this,"blur"),c.addEventListener("keyup",this.inputListener),c.addEventListener("blur",this.blurListener),this.renderer=b,this.id=a}var e=a("../../../eventsender");d.prototype=Object.create(e.prototype),d.prototype.onInput=function(){this.emit("inputChanged",this.element.value)},d.prototype.focus=function(){this.element.style.visibility="visible",this.element._noodlStyle.visibility="visible",this.element.focus()},d.prototype.blur=function(){this.element.style.visibility="hidden",this.element._noodlStyle.visibility="hidden",this.element.blur()},d.prototype.setText=function(a){this.element.value=a},d.prototype.setType=function(a){this.element.type=a},d.prototype.dispose=function(){this.element.removeEventListener("input",this.inputListener),this.element.removeEventListener("blur",this.blurListener),this.renderer.removeInputField(this.id)},b.exports=d},{"../../../eventsender":200}],316:[function(a,b,c){"use strict";function d(a){this.rootElement=document.createElement(a.rootElementTag),this.rootElement.style.position="absolute",this.rootElement.style.display="block",this.rootElement.style.overflow="hidden",this.rootElement.style.pointerEvents="none",this.fillMode="aspectFit",this.viewportWidth=0,this.viewportHeight=0,this.onResizeCallback=a.onResize,this.onWindowResizeHandler=this._windowResizeListener.bind(this)}d.prototype._windowResizeListener=function(){"aspectFit"===this.fillMode&&this.resizeRootElement(),this.onResizeCallback&&this.onResizeCallback()},d.prototype.attach=function(a){a.appendChild(this.rootElement),window.addEventListener("resize",this.onWindowResizeHandler),this.resizeRootElement()},d.prototype.detach=function(){window.removeEventListener("resize",this.onWindowResizeHandler),this.rootElement.parentNode&&this.rootElement.parentNode.removeChild(this.rootElement)},d.prototype.setViewportSize=function(a,b){this.viewportWidth=a,this.viewportHeight=b,this.rootElement.parentNode&&"aspectFit"===this.fillMode&&this.resizeRootElement(),this.onResizeCallback&&this.onResizeCallback()},d.prototype._calculateAspectFit=function(){var a=this.viewportWidth,b=this.viewportHeight,c=1,d=1,e=a/b,f=this.rootElement.parentElement.getBoundingClientRect(),g=f.width/f.height;return e/g>1?d=g/e:c=e/g,{width:f.width*c,height:f.height*d}},d.prototype.resizeRootElementAspectFit=function(){var a=this._calculateAspectFit();this.rootElement.style.width=a.width+"px",this.rootElement.style.height=a.height+"px";var b=this.rootElement.parentElement.getBoundingClientRect(),c=Math.round(b.width-a.width)/2+"px",d=Math.round(b.height-a.height)/2+"px";this.rootElement.style.transform="translate("+c+","+d+")",this.rootElement.style.webkitTransform=this.rootElement.style.transform},d.prototype.resizeRootElementFill=function(){this.rootElement.style.width="100%",this.rootElement.style.height="100%",this.rootElement.style.transform="",this.rootElement.style.webkitTransform=""},d.prototype.resizeRootElement=function(){"aspectFit"===this.fillMode?this.resizeRootElementAspectFit():this.resizeRootElementFill(),this.onResizeCallback&&this.onResizeCallback()},d.prototype.setFillMode=function(a){this.fillMode=a,this.resizeRootElement()},b.exports=d},{}],317:[function(a,b,c){"use strict";function d(a){e.call(this,{rootElementTag:"canvas",onResize:this._onResize.bind(this)}),this.useScreenResolution=!!a.useScreenResolution}var e=a("./renderer-base");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype._onResize=function(){this.resizeCanvasBuffer()},d.prototype.resizeCanvasBuffer=function(){var a=this.rootElement.getBoundingClientRect(),b=window.devicePixelRatio||1;if("aspectFit"===this.fillMode){var c=Math.max(a.width*b/this.viewportWidth,a.height*b/this.viewportHeight);this.useScreenResolution===!1&&(c=Math.max(1,Math.round(c))),this.rootElement.width=this.viewportWidth*c,this.rootElement.height=this.viewportHeight*c,this.renderScale=this.rootElement.width/this.viewportWidth}else this.rootElement.width=a.width*b,this.rootElement.height=a.height*b,this.renderScale=b},b.exports=d},{"./renderer-base":316}],318:[function(a,b,c){"use strict";function d(a){j.call(this,a),this.coloredImagesCache=new k,this.rectangleBlurEdgeCache=new k,this.circleBlurCache=new k,this.circleStrokeBlurCache=new k,this.circleStrokeCache=new k,this.ctx=this.rootElement.getContext("2d",{alpha:!!a.alpha})}function e(a,b){for(var c=0;c<3;++c){var d=1+2*c;a[c]=parseInt(b.substring(d,d+2),16)}}function f(a,b,c){var d=Math.max(0,Math.min(1,(c-a)/(b-a)));return d*d*(3-2*d)}function g(a,b){var c=document.createElement("canvas"),d=c.getContext("2d");c.width=1,c.height=a;var g=d.createImageData(1,a);e(l,b);for(var h=0;h<a;h++){var i=f(0,1,h/(a-1));g.data[4*h]=l[0],g.data[4*h+1]=l[1],g.data[4*h+2]=l[2],g.data[4*h+3]=255*i}return d.putImageData(g,0,0),c}function h(a,b,c){var d=document.createElement("canvas"),g=d.getContext("2d");d.width=a+b,d.height=a+b;var h=g.createImageData(a+b,a+b);e(l,c);for(var i=0;i<h.height;i++)for(var j=0;j<h.width;j++){var k=Math.sqrt(j*j+i*i)-a,m=f(1,0,k/b),n=h.width-1-j+(h.height-1-i)*h.width;h.data[4*n]=l[0],h.data[4*n+1]=l[1],h.data[4*n+2]=l[2],h.data[4*n+3]=255*m}return g.putImageData(h,0,0),d}function i(a,b,c,d){var g=document.createElement("canvas"),h=g.getContext("2d");g.width=a+b,g.height=a+b;var i=h.createImageData(a+b,a+b);e(l,d);for(var j=0;j<i.height;j++)for(var k=0;k<i.width;k++){var m=Math.sqrt(k*k+j*j),n=0;m>=a-c-b&&m<=a-c?n=f(a-c-b,a-c,m):m>a-c&&m<a?n=1:m>=a&&(n=1-f(a,a+b,m));var o=i.width-1-k+(i.height-1-j)*i.width;i.data[4*o]=l[0],i.data[4*o+1]=l[1],i.data[4*o+2]=l[2],i.data[4*o+3]=255*n}return h.putImageData(i,0,0),g}var j=a("./renderer-canvas-base"),k=a("../resourcecache");d.prototype=Object.create(j.prototype),d.prototype.constructor=d,d.prototype.beginFrame=function(){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.globalAlpha=1,this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,this.toPixel(this.viewportWidth),this.toPixel(this.viewportHeight))},d.prototype.endFrame=function(){},d.prototype.render=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=c.content.type;"pushClipRect"===d?this.pushClipRect(c):"popClipRect"===d?this.popClipRect():this._renderContent(c)}},d.prototype.drawColoredImage=function(a,b,c){var d=b.src+"."+c;if(this.coloredImagesCache.isInCache(d)===!1){var e=document.createElement("canvas");e.width=b.width,e.height=b.height;var f=e.getContext("2d",{alpha:!0});f.clearRect(0,0,e.width,e.height),f.drawImage(b,0,0,b.width,b.height),f.globalCompositeOperation="source-in",f.fillStyle=c,f.fillRect(0,0,b.width,b.height),this.coloredImagesCache.addResource(d,e)}return this.coloredImagesCache.updateReference(a,d),this.coloredImagesCache.getResource(d)},d.prototype._drawRoundedRect=function(a,b,c,d){a<2*c&&(c=a/2),b<2*c&&(c=b/2),this.ctx.beginPath(),this.ctx.moveTo(c,0),this.ctx.arcTo(a,0,a,b,c),this.ctx.arcTo(a,b,0,b,c),this.ctx.arcTo(0,b,0,0,c),this.ctx.arcTo(0,0,a,0,c),this.ctx.closePath(),"positive"===d?(this.ctx.save(),this.ctx.clip()):this.ctx.fill()};var l=[0,0,0];d.prototype._drawRectangleBlurred=function(a,b,c,d,f,i){b<2*d&&(d=b/2),c<2*d&&(d=c/2),d>0?(this.ctx.fillRect(d,0,b-2*d,d),this.ctx.fillRect(0,d,b,c-2*d),this.ctx.fillRect(d,c-d,b-2*d,d)):this.ctx.fillRect(0,0,b,c),e(l,i);var j=i+f;this.rectangleBlurEdgeCache.isInCache(j)===!1&&this.rectangleBlurEdgeCache.addResource(j,g(f,i)),this.rectangleBlurEdgeCache.updateReference(a,j);var k=i+d+"."+f;this.circleBlurCache.isInCache(k)===!1&&this.circleBlurCache.addResource(k,h(d,f,i)),this.circleBlurCache.updateReference(a,k);var m=this.rectangleBlurEdgeCache.getResource(j),n=this.circleBlurCache.getResource(k);this.ctx.drawImage(m,d,-f,b-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.save(),this.ctx.rotate(Math.PI/2),this.ctx.translate(0,-b),this.ctx.drawImage(m,d,-f,c-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.rotate(Math.PI/2),this.ctx.translate(0,-c),this.ctx.drawImage(m,d,-f,b-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.rotate(Math.PI/2),this.ctx.translate(0,-b),this.ctx.drawImage(m,d,-f,c-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.restore()},d.prototype._drawCircleBlurred=function(a,b,c,d,e){var f=d+b+"."+c;this.circleBlurCache.isInCache(f)===!1&&this.circleBlurCache.addResource(f,h(b,c,d)),this.circleBlurCache.updateReference(a,f);var g=this.circleBlurCache.getResource(f);this.ctx.save(),e<2*Math.PI&&(this.ctx.beginPath(),this.ctx.arc(b,b,b+c,-Math.PI/2,-Math.PI/2+e,!1),this.ctx.lineTo(b,b),this.ctx.clip()),this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c,-c-2*b,c+b,c+b),e>Math.PI/2&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c-2*b,-c-2*b,c+b,c+b),e>Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c-2*b,-c,c+b,c+b),e>1.5*Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c,-c,c+b,c+b)))),this.ctx.restore()},d.prototype._drawCircleStrokeBlurred=function(a,b,c,d,e,f){var g=d+b+"."+c+"."+f;this.circleStrokeBlurCache.isInCache(g)===!1&&this.circleStrokeBlurCache.addResource(g,i(b,c,f,d)),this.circleStrokeBlurCache.updateReference(a,g);var h=this.circleStrokeBlurCache.getResource(g);this.ctx.save(),e<2*Math.PI&&(this.ctx.beginPath(),this.ctx.arc(b,b,b+c,-Math.PI/2,-Math.PI/2+e,!1),this.ctx.lineTo(b,b),this.ctx.clip()),this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c,-c-2*b,c+b,c+b),e>Math.PI/2&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c-2*b,-c-2*b,c+b,c+b),e>Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c-2*b,-c,c+b,c+b),e>1.5*Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c,-c,c+b,c+b)))),this.ctx.restore()},d.prototype.toPixel=function(a){return a*this.renderScale},d.prototype._renderContent=function(a){var b=a.content.type;switch(this._setTransform(a.transform),this.ctx.globalAlpha=a.content.opacity,a.content.blendMode){case"alpha":this.ctx.globalCompositeOperation="source-over";break;case"solid":this.ctx.globalCompositeOperation="source-over";break;case"additive":this.ctx.globalCompositeOperation="lighter";break;case"multiply":this.ctx.globalCompositeOperation="multiply"}if("-undoMask"===a.id.slice(-9))return void this.ctx.restore();if("rectangle"===b){this.ctx.fillStyle=a.content.color;var c=Math.floor(this.toPixel(a.content.blur));c>0?this._drawRectangleBlurred(a.id,this.toPixel(a.width),this.toPixel(a.height),this.toPixel(a.content.cornerRadius),a.content.blur,a.content.color):a.content.cornerRadius>0?this._drawRoundedRect(this.toPixel(a.width),this.toPixel(a.height),this.toPixel(a.content.cornerRadius),a.content.maskType):this.ctx.fillRect(0,0,this.toPixel(a.width),this.toPixel(a.height))}else if("image"===b&&a.content.image){var d=a.content.image;"#ffffff"!==a.content.color&&(d=this.drawColoredImage(a.id,a.content.image,a.content.color)),this.ctx.drawImage(d,0,0,this.toPixel(a.width),this.toPixel(a.height))}else if("text"===b&&a.content.text){this.ctx.fillStyle=a.content.color,this.ctx.font=this.toPixel(a.content.fontSize)+'px "'+a.content.fontFamily+'"';for(var e=0;e<a.content.lines.length;e++){var f=a.content.lines[e];this.ctx.fillText(f.text,this.toPixel(f.x),this.toPixel(f.y))}}else if("textInput"===b&&a.content.text&&!a.content.focused){this.ctx.fillStyle=a.content.color,this.ctx.font=this.toPixel(a.content.fontSize)+'px "'+a.content.fontFamily+'"';var g=.5*(a.height-a.content.textHeight);this.ctx.fillText(a.content.text,0,this.toPixel(g+a.content.baseline))}else if("circle"===b){var h=a.width/2,c=Math.floor(this.toPixel(a.content.blur));if(c>1)a.content.solid?this._drawCircleBlurred(a.id,Math.floor(this.toPixel(h)),c,a.content.color,a.content.arcAngle):this._drawCircleStrokeBlurred(a.id,Math.floor(this.toPixel(h)),c,a.content.color,a.content.arcAngle,Math.floor(this.toPixel(a.content.lineWidth)));else{var i=a.width/2,g=a.height/2;if(this.ctx.beginPath(),a.content.solid||(h-=.5*a.content.lineWidth),
this.ctx.arc(this.toPixel(i),this.toPixel(g),this.toPixel(h),-Math.PI/2,-Math.PI/2+a.content.arcAngle,!1),a.content.solid)if(a.content.arcAngle<2*Math.PI&&this.ctx.lineTo(this.toPixel(i),this.toPixel(g)),a.content.image){this.ctx.save(),this.ctx.clip();var d=a.content.image;"#ffffff"!==a.content.color&&(d=this.drawColoredImage(a.id,a.content.image,a.content.color)),this.ctx.drawImage(d,0,0,this.toPixel(a.width),this.toPixel(a.height)),this.ctx.restore()}else this.ctx.fillStyle=a.content.color,this.ctx.fill();else this.ctx.strokeStyle=a.content.color,this.ctx.lineWidth=Math.max(1,this.toPixel(a.content.lineWidth)),this.ctx.stroke()}}},d.prototype._setTransform=function(a){this.ctx.setTransform(a[0],a[1],a[4],a[5],this.toPixel(a[12]),this.toPixel(a[13]))},d.prototype.pushClipRect=function(a){this._setTransform(a.transform),this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(0,0,this.toPixel(a.width),this.toPixel(a.height)),this.ctx.clip()},d.prototype.popClipRect=function(){this.ctx.restore()},d.prototype.removeResourcesForRenderCommand=function(a){"image"===a.content.type||"circle"===a.content.type?this.coloredImagesCache.removeReference(a.id):"rectangle"===a.content.type?(this.rectangleBlurEdgeCache.removeReference(a.id),this.circleBlurCache.removeReference(a.id)):"circle"===a.content.type&&(this.circleBlurCache.removeReference(a.id),this.circleStrokeBlurCache.removeReference(a.id),this.circleStrokeCache.removeReference(a.id))},d.prototype.detach=function(){j.prototype.detach.call(this),this.coloredImagesCache.clear(),this.rectangleBlurEdgeCache.clear(),this.circleBlurCache.clear(),this.circleStrokeBlurCache.clear(),this.circleStrokeCache.clear()},b.exports=d},{"../resourcecache":330,"./renderer-canvas-base":317}],319:[function(a,b,c){"use strict";function d(a){var b=document.createElement(a);return b.style.position="absolute",b.style.display="block",b.style.pointerEvents="none",b.style.transformOrigin="0% 0%",b._noodlStyle={},b}function e(){j.call(this,{rootElementTag:"div",onResize:this._onResize.bind(this)}),this.rootElement.style.transformStyle="preserve-3d",this.rootElement.style.webkitTransformStyle="preserve-3d",this.elements={},this.unusedElements={},this.transformStack=[],this.textFields={},this.renderTextInputOnly=!1}function f(a,b,c){a._noodlStyle[b]!==c&&(a.style[b]=c,a._noodlStyle[b]=c)}function g(a,b,c){if(a.parentNode!==b||a.index!==c){c<b.children.length-1?b.insertBefore(a,b.children[c+1]):b.appendChild(a);for(var d=0;d<b.children.length;d++)b.children[d].index=d}}var h=a("../math/mat4"),i=a("./dom/dominputfield"),j=a("./renderer-base");e.prototype=Object.create(j.prototype),e.prototype.constructor=e,e.prototype.setRenderInputFieldsOnly=function(a){this.renderTextInputOnly=a},e.prototype._onResize=function(){"aspectFit"===this.fillMode?this.renderScale=this.rootElement.getBoundingClientRect().width/this.viewportWidth:this.renderScale=1},e.prototype.endFrame=function(){this._removeUnusedElements()},e.prototype._removeUnusedElements=function(){for(var a in this.elements)if(!this.elementsThisFrame[a]){var b=this.elements[a],c=b.parentNode;c.removeChild(b),delete this.elements[a],this.unusedElements[a]=b,b.index=void 0;for(var d=0;d<c.children.length;d++)c.children[d].index=d}},e.prototype._getTextInputCommands=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.content.type;"textInput"!==e&&"pushClipRect"!==e&&"popClipRect"!==e||("popClipRect"===d.content.type&&"pushClipRect"===b[b.length-1].content.type?b.length=b.length-1:b.push(d))}return b},e.prototype.beginFrame=function(){this.elementsThisFrame={},this.nodeIndices=[0]},e.prototype.render=function(a){var b=this.nodeIndices;this.parentElement=this.rootElement,this.renderTextInputOnly&&(a=this._getTextInputCommands(a));for(var c=0;c<a.length;c++){var d=a[c],e=d.content.type;"pushClipRect"===e?(this.pushClipRect(d,b[b.length-1]),b[b.length-1]++,b.push(0)):"popClipRect"===e?(this.popClipRect(),b.pop()):(this._renderContent(d,b[b.length-1]),b[b.length-1]++)}};var k=h.create();e.prototype._setTransform=function(a,b){this.transformStack.length&&(h.identity(k),h.multiply(k,this.transformStack[this.transformStack.length-1],k),h.multiply(k,k,b),b=k);var c="matrix3d("+b[0]+","+b[1]+","+b[2]+","+b[3]+","+b[4]+","+b[5]+","+b[6]+","+b[7]+","+b[8]+","+b[9]+","+b[10]+","+b[11]+","+b[12]*this.renderScale+","+b[13]*this.renderScale+","+b[14]*this.renderScale+","+b[15]+")";a._noodlStyle.transform!==c&&(a._noodlStyle.transform=c,a.style.transform=c,a.style.webkitTransform=c)},e.prototype.createInputField=function(a){var b=new i(a,this);return this.textFields[a]=b,b},e.prototype.removeInputField=function(a){delete this.textFields[a]},e.prototype._renderContent=function(a,b){var c=a.id,e=a.content.type;if(!this.elements[c]){var h;this.unusedElements[c]?(h=this.unusedElements[c],delete this.unusedElements[c]):"rectangle"===e?h=d("div"):"image"===e?(h=d("div"),h.style.backgroundSize="100% 100%"):"text"===e?(h=d("div"),h.style.whiteSpace="nowrap"):"circle"===e?(h=d("div"),h.style.borderRadius="50%"):"textInput"===e&&(h=this.textFields[c].element),h.className=e,this.elements[c]=h}this.elementsThisFrame[c]=!0;var i=this.elements[c];g(i,this.parentElement,b),this._setTransform(i,a.transform),f(i,"width",a.width*this.renderScale+"px"),f(i,"height",a.height*this.renderScale+"px"),f(i,"opacity",a.content.opacity),"rectangle"===e?(f(i,"backgroundColor",a.content.color),f(i,"borderRadius",.5*a.content.cornerRadius+"px")):"image"===e?(f(i,"backgroundImage","url("+a.content.image.src+")"),"#ffffff"!==a.content.color?(f(i,"backgroundColor",a.content.color),f(i,"backgroundBlendMode","overlay"),f(i,"isolation","isolate")):(f(i,"backgroundColor",void 0),f(i,"backgroundBlendMode","normal"))):"text"===e?(f(i,"color",a.content.color),f(i,"fontFamily",a.content.fontFamily),f(i,"fontSize",a.content.fontSize*this.renderScale+"px"),f(i,"textAlign",a.content.horizontalAlignment),f(i,"lineHeight",a.content.lineHeight?a.content.lineHeight*this.renderScale+"px":"normal"),i.innerText!==a.content.text&&(i.innerText=a.content.text)):"textInput"===e?(f(i,"color",a.content.color),f(i,"fontFamily",a.content.fontFamily),f(i,"fontSize",a.content.fontSize*this.renderScale+"px"),a.content.focused||i.value===a.content.text||(i.value=a.content.text),this.renderTextInputOnly&&!a.content.focused&&f(i,"visibility","hidden")):"circle"===e&&(a.content.solid?f(i,"backgroundColor",a.content.color):f(i,"border",a.content.lineWidth+"px solid "+a.content.color))},e.prototype.pushClipRect=function(a,b){var c=a.id;if(!this.elements[c]){var e=d("div");e._noodlStyle={},e.style.overflow="hidden",this.elements[c]=e}this.elementsThisFrame[c]=!0;var i=this.elements[c];this._setTransform(i,a.transform),f(i,"width",a.width*this.renderScale+"px"),f(i,"height",a.height*this.renderScale+"px"),g(i,this.parentElement,b);var j=h.create();h.copy(j,a.transform),h.invert(j),this.transformStack.push(j),this.parentElement=i},e.prototype.popClipRect=function(){this.parentElement=this.parentElement.parentNode,this.transformStack.pop()},e.prototype.removeResourcesForRenderCommand=function(a){},b.exports=e},{"../math/mat4":313,"./dom/dominputfield":315,"./renderer-base":316}],320:[function(a,b,c){"use strict";function d(a){m.call(this,a);var b={alpha:!!a.alpha,stencil:!0},c=this.rootElement.getContext("webgl",b);if(c||(c=this.rootElement.getContext("experimental-webgl",b)),!c)throw new Error("WebGL not supported");this.webGLHelper=new p(c,1080,1920),this.defaultShader=this.createShader({vertexSource:this.webGLHelper._defaultVsSource,fragmentSource:this.webGLHelper._defaultFsSource}),this.defaultTextShader=this._createDefaultTextShader(),this.clipRects=[o.create()],this.defaultMesh=this.webGLHelper.createMesh(),this.numVerticesThisFrame=0,this.textCache=new q(this.webGLHelper),this.circleCache={},this.roundedRectCache={},this.textureCache=new t(this.webGLHelper),this.tempVertices=new Float32Array(u*this.defaultShader.numComponentsPerVertex)}function e(a,b,c,d,e,f,g){a[0]=0,a[1]=0,a[2]=0,b[0]=e,b[1]=0,b[2]=0,c[0]=0,c[1]=f,c[2]=0,d[0]=e,d[1]=f,d[2]=0,n.transformPoint(g,a),n.transformPoint(g,b),n.transformPoint(g,c),n.transformPoint(g,d)}function f(a,b,c,d,e,f,g,h){var i=g.width,j=g.height;a[0]<h.min[0]&&(e[0]=(h.min[0]-a[0])/i,a[0]=h.min[0],c[0]=h.min[0]),a[1]<h.min[1]&&(e[1]=(h.min[1]-a[1])/j,a[1]=h.min[1],b[1]=h.min[1]),b[0]>h.max[0]&&(f[0]=(b[0]-h.max[0])/i,b[0]=h.max[0],d[0]=h.max[0]),c[1]>h.max[1]&&(f[1]=(c[1]-h.max[1])/j,c[1]=h.max[1],d[1]=h.max[1])}function g(a,b,c,d,e,f){var g=Math.min(a[0],b[0],c[0],d[0]),h=Math.min(a[1],b[1],c[1],d[1]),i=Math.max(a[0],b[0],c[0],d[0]),j=Math.max(a[1],b[1],c[1],d[1]),k=g<f.min[0]||h<f.min[1]||i>f.max[0]||j>f.max[1];k&&(e.scissorTest=!0,e.scissorRect[0]=f.min[0],e.scissorRect[1]=f.min[1],e.scissorRect[2]=f.max[0],e.scissorRect[3]=f.max[1])}function h(a){return 1!==a[0]||1!==a[5]||1!==a[10]}function i(a){return 0!==a[1]||0!==a[2]||0!==a[4]||0!==a[6]||0!==a[8]||0!==a[9]}function j(a,b){for(var c=0;c<3;++c){var d=1+2*c;a[c]=parseInt(b.substring(d,d+2),16)/255}}function k(a,b,c,d){var j=b.transform;e(w,x,y,z,b.width,b.height,j),A[0]=0,A[1]=0,B[0]=0,B[1]=0;var k=i(j)||h(j);k||0!==j[14]?g(w,x,y,z,c,d):f(w,x,y,z,A,B,b,d);var l=c.srcRect,m=l[2]-l[0],n=l[3]-l[1],o=c.color;a[0]=w[0],a[1]=w[1],a[2]=w[2],a[3]=l[0]+A[0]*m,a[4]=l[1]+A[1]*n,a[5]=o[0]*b.content.opacity,a[6]=o[1]*b.content.opacity,a[7]=o[2]*b.content.opacity,a[8]=b.content.opacity,a[9]=x[0],a[10]=x[1],a[11]=x[2],a[12]=l[2]-B[0]*m,a[13]=a[4],a[14]=a[5],a[15]=a[6],a[16]=a[7],a[17]=a[8],a[18]=y[0],a[19]=y[1],a[20]=y[2],a[21]=a[3],a[22]=l[3]-B[1]*n,a[23]=a[5],a[24]=a[6],a[25]=a[7],a[26]=a[8],a[27]=z[0],a[28]=z[1],a[29]=z[2],a[30]=a[12],a[31]=a[22],a[32]=a[5],a[33]=a[6],a[34]=a[7],a[35]=a[8]}function l(a,b,c,d,f){d.mesh=a,d.shader=b,b&&b.standardUniforms.u_world!==-1&&(d.worldTransform=c.transform),e(w,x,y,z,c.width,c.height,c.transform),g(w,x,y,z,d,f)}var m=a("./renderer-canvas-base"),n=a("../math/mat4"),o=a("../math/aabb"),p=a("./webgl/webglhelper"),q=a("./webgl/text-cache"),r=a("./webgl/circle"),s=a("./webgl/roundedrect"),t=a("./webgl/texturecache"),u=4;d.prototype=Object.create(m.prototype),d.prototype.constructor=d,d.prototype.createShader=function(a){return this.webGLHelper.createShader(a)},d.prototype._onResize=function(){m.prototype._onResize.call(this),o.set(this.clipRects[0],0,0,this.viewportWidth,this.viewportHeight),this.webGLHelper.setVirtualSize(this.viewportWidth,this.viewportHeight),this.webGLHelper.setRenderBufferSize(this.rootElement.width,this.rootElement.height)},d.prototype.render=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.content.type;if("pushClipRect"===e)this.pushClipRect(d);else if("popClipRect"===e)this.popClipRect();else{var f="textInput"===d.content.type&&d.content.focused;f===!1&&this._renderContent(d,b)}}for(c=0;c<b.length;c++)this.webGLHelper.executeRenderCommand(b[c])},d.prototype.pushClipRect=function(a){var b=o.create();o.set(b,0,0,a.width,a.height),o.transform4(b,a.transform),o.intersection(b,this.clipRects[this.clipRects.length-1]),this.clipRects.push(b)},d.prototype.popClipRect=function(){this.clipRects.pop()};var v=[0,0,1,1];d.prototype._renderContent=function(a,b){var c={texture:null,blendMode:p.BlendMode.Alpha,mesh:null,depthTest:!1,vertexIndex:-1,opacity:a.content.opacity,scissorTest:!1,scissorRect:[0,0,0,0],srcRect:a.content.srcRect||v,flipTexCoordY:0,writeToStencil:!1,maskIsPositive:!1,shader:this.defaultShader,worldTransform:null,color:[0,0,0]};switch(a.content.shader&&(c.shader=a.content.shader,a.content.shaderUniforms&&(c.shaderUniforms=a.content.shaderUniforms)),a.content.blendMode){case"alpha":c.blendMode=p.BlendMode.Alpha;break;case"solid":c.blendMode=p.BlendMode.Solid;break;case"additive":c.blendMode=p.BlendMode.Additive;break;case"multiply":c.blendMode=p.BlendMode.Multiply}if("solid"===a.content.blendMode&&a.content.opacity<1&&(c.blendMode=p.BlendMode.Alpha),a.content.maskType&&"none"!==a.content.maskType&&(c.writeToStencil=!0,c.maskIsPositive="positive"===a.content.maskType),j(c.color,a.content.color),a.content.image?(c.texture=this.textureCache.getTexture(a.content.imagePath,a.content.image),c.texture.refCount=1,c.texture.videoDOMNode&&c.texture.updateVideoTexture()):"text"===a.content.type||"textInput"===a.content.type?(c.texture=this.textCache.getTextTexture(a,this.renderScale,a.content.color),c.shader=this.defaultTextShader):c.texture=this.webGLHelper.whiteTexture(),"circle"===a.content.type){var d=this._getCircle(a);this.circleShader||(this.circleShader=r.createShader(this.webGLHelper)),l(d.getMesh(),this.circleShader,a,c,this.clipRects[this.clipRects.length-1])}else if("rectangle"===a.content.type&&s.cornerTooSmall(a.content.cornerRadius,a.content.blur)===!1){var e=this._getRoundedRectangle(a);this.roundedRectangleShader||(this.roundedRectangleShader=s.createShader(this.webGLHelper)),l(e.getMesh(),this.roundedRectangleShader,a,c,this.clipRects[this.clipRects.length-1])}else"mesh"===a.content.type&&a.content.mesh&&a.content.shader&&a.content.mesh.vertices&&a.content.mesh.vertices.length>0?l(a.content.mesh,a.content.shader,a,c,this.clipRects[this.clipRects.length-1]):(k(this.tempVertices,a,c,this.clipRects[this.clipRects.length-1]),c.vertexIndex=this.numVerticesThisFrame,this.numVerticesThisFrame+=this.tempVertices.length,this.numVerticesThisFrame*this.defaultShader.numComponentsPerVertex>this.defaultMesh.vertices.length&&(this.defaultMesh.vertices=new Float32Array(this.numVerticesThisFrame*this.defaultShader.numComponentsPerVertex*u*2)),c.mesh=this.defaultMesh,this.defaultMesh.vertices.set(this.tempVertices,c.vertexIndex*this.defaultShader.numComponentsPerVertex),this.defaultMesh.vertexDataDirty=!0);b.push(c)},d.prototype.removeResourcesForRenderCommand=function(a){"rectangle"===a.content.type&&this.roundedRectCache.hasOwnProperty(a.id)?(this.roundedRectCache[a.id].dispose(),delete this.roundedRectCache[a.id]):"circle"===a.content.type&&this.circleCache.hasOwnProperty(a.id)?(this.circleCache[a.id].dispose(),delete this.circleCache[a.id]):"text"!==a.content.type&&"textInput"!==a.content.type||this.textCache.textResourceRemoved(a.id)},d.prototype.beginFrame=function(){this.webGLHelper.beginFrame(),this.webGLHelper.bindRenderTarget(0),this.numVerticesThisFrame=0},d.prototype.endFrame=function(){},d.prototype._getCircle=function(a){this.circleCache[a.id]||(this.circleCache[a.id]=new r(this.webGLHelper));var b=this.circleCache[a.id];return b.setSize(a.width),b.setArcAngle(a.content.arcAngle),b.setSolid(a.content.solid),b.setLineWidth(a.content.lineWidth),b.setBlur(Math.max(1,a.content.blur)),b.updateMesh(),b},d.prototype._getRoundedRectangle=function(a){this.roundedRectCache[a.id]||(this.roundedRectCache[a.id]=new s(this.webGLHelper));var b=this.roundedRectCache[a.id];return b.setWidth(a.width),b.setHeight(a.height),b.setBlur(a.content.blur),b.setCornerRadius(a.content.cornerRadius),b.updateMesh(),b},d.prototype.detach=function(){m.prototype.detach.call(this),this.textCache.clear(),this.textureCache.clear();var a=this.roundedRectCache;Object.keys(a).forEach(function(b){a[b].dispose()});var b=this.circleCache;Object.keys(b).forEach(function(a){b[a].dispose()})},d.prototype.clearImageCache=function(){this.textureCache.clear()};var w=[0,0,0],x=[0,0,0],y=[0,0,0],z=[0,0,0],A=[0,0],B=[0,0];d.prototype._createDefaultTextShader=function(){return this.createShader({vertexSource:["uniform mat4 u_projection;","uniform mat4 u_view;","attribute vec3 a_position;","attribute vec2 a_uv;","attribute vec4 a_color;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","   gl_Position = u_projection * u_view * vec4(a_position, 1.0);","   uv = a_uv;","   color = a_color;","}"].join("\n"),fragmentSource:["uniform sampler2D texture;","uniform lowp float u_opacity;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    lowp vec4 texColor = texture2D(texture, uv);","    gl_FragColor = texColor*color.a;","}"].join("\n")})},b.exports=d},{"../math/aabb":311,"../math/mat4":313,"./renderer-canvas-base":317,"./webgl/circle":321,"./webgl/roundedrect":324,"./webgl/text-cache":326,"./webgl/texturecache":328,"./webgl/webglhelper":329}],321:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a,b){b=b||{},this.solid=!b.hasOwnProperty("solid")||b.solid,this.radius=b.size/2||100,this.lineWidth=b.lineWidth||1,this.blurDistance=b.hasOwnProperty("blur")?b.blur:2,this.arcAngle=b.hasOwnProperty("arcAngle")?d(0,2*Math.PI,b.arcAngle):2*Math.PI,this.error=b.error||.075,this.meshDirty=!0,this._calculateVertices(),this.mesh=a.createMesh({vertices:this.vertices,indices:this.indices,primitiveType:g.PrimitiveType.TriangleStrip})}function f(a){var b=["uniform mat4 u_projection;","uniform mat4 u_view;","uniform mat4 u_world;","uniform mediump vec4 u_srcRect;","uniform lowp float u_flipTexCoordY;","attribute vec2 a_position;","attribute vec2 a_uv;","attribute float aBlur;","attribute float aVertexOpacity;","varying mediump vec2 uv;","varying lowp float blur;","varying lowp float vertexOpacity;","void main(void) {","   gl_Position = u_projection * u_view * u_world * vec4(a_position, 0.0, 1.0);","   uv = u_srcRect.xy + a_uv * (u_srcRect.zw - u_srcRect.xy);","   if(u_flipTexCoordY > 0.0) { uv.y = 1.0 - uv.y; }","   blur = aBlur;","   vertexOpacity = aVertexOpacity;","}"].join("\n"),c=["uniform sampler2D texture;","uniform lowp vec3 u_color;","uniform lowp float u_opacity;","varying mediump vec2 uv;","varying lowp float blur;","varying lowp float vertexOpacity;","void main(void) {","   lowp float intensity = smoothstep(0.0, 1.0, blur*vertexOpacity);","   gl_FragColor = texture2D(texture, uv)*vec4(u_color,1.0)*(u_opacity*intensity);","}"].join("\n");return a.createShader({vertexSource:b,fragmentSource:c})}var g=a("./mesh");e.prototype._calculateVertices=function(){function a(a,c,d,e){var f=Math.cos(d-.5*Math.PI),g=Math.sin(d-.5*Math.PI);n[i++]=a+b*f,n[i++]=c+b*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=0,n[i++]=e,n[i++]=a+p*f,n[i++]=c+p*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=1,n[i++]=e,n[i++]=a+j*f,n[i++]=c+j*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=1,n[i++]=e,n[i++]=a+k*f,n[i++]=c+k*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=0,n[i++]=e}var b=this.radius+this.blurDistance,c=Math.acos(2*(1-this.error/b)*(1-this.error/b)-1),d=Math.ceil(this.arcAngle/c),e=24,f=this.arcAngle<2*Math.PI;this.arcAngle>0&&d<4&&(d=2);var g=d;f&&(g+=2);var h=g*e;this.vertices&&this.vertices.length===h||(this.vertices=new Float32Array(h));var i=0,j=this.radius-this.lineWidth,k=j-this.blurDistance,l=this.radius,m=this.radius;this.solid&&(j=0,k=0);var n=this.vertices,o=this.blurDistance,p=this.radius;f&&a(l,m-this.blurDistance,0,0);var q;for(q=0;q<d;++q){var r=q/(d-1),s=this.arcAngle*r;a(l,m,s,1)}f&&a(l-Math.sin(this.arcAngle)*o,m+Math.cos(this.arcAngle)*o,this.arcAngle,0);var t=8*(g-1);for(this.indices&&this.indices.length===t||(this.indices=new Uint16Array(t)),i=0,q=0;q<g-1;++q){var u;if(q%2===0)for(u=0;u<4;++u)this.indices[i++]=4*q+u,this.indices[i++]=4*(q+1)+u;else for(u=0;u<4;++u)this.indices[i++]=4*q+3-u,this.indices[i++]=4*(q+1)+3-u}},e.prototype.updateMesh=function(){this.meshDirty!==!1&&(this._calculateVertices(),this.mesh.vertices=this.vertices,this.mesh.indices=this.indices,this.mesh.vertexDataDirty=!0,this.meshDirty=!1)},e.prototype.setSize=function(a){this.radius!==a/2&&(this.radius=a/2,this.meshDirty=!0)},e.prototype.setLineWidth=function(a){this.lineWidth!==a&&(this.lineWidth=a,this.meshDirty=!0)},e.prototype.setSolid=function(a){this.solid!==a&&(this.solid=a,this.meshDirty=!0)},e.prototype.setBlur=function(a){this.blurDistance!==a&&(this.blurDistance=a,this.meshDirty=!0)},e.prototype.setArcAngle=function(a){a=d(0,2*Math.PI,a),this.arcAngle!==a&&(this.arcAngle=a,this.meshDirty=!0)},e.prototype.getMesh=function(){return this.mesh},e.prototype.dispose=function(){this.mesh.dispose()},e.createShader=function(a){return f(a)},b.exports=e},{"./mesh":323}],322:[function(a,b,c){"use strict";function d(a,b){this.texture=b.texture;var c,d,e=a.getParameter(a.FRAMEBUFFER_BINDING),f=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,f),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texture.handle,0),d=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,d),a.renderbufferStorage(a.RENDERBUFFER,a.STENCIL_INDEX8,b.width,b.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,d),b.depthBuffer&&(c=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,c),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,b.width,b.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,c));var g=a.checkFramebufferStatus(a.FRAMEBUFFER);switch(g){case a.FRAMEBUFFER_COMPLETE:break;case a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case a.FRAMEBUFFER_UNSUPPORTED:console.log("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;default:console.log("Incomplete framebuffer: "+g)}a.bindFramebuffer(a.FRAMEBUFFER,e),this.fbo=f,this.gl=a,this.width=b.width,this.height=b.height}b.exports=d},{}],323:[function(a,b,c){"use strict";function d(a,b){b=b||{},void 0===b.vertices&&(b.vertices=new Float32Array(0)),b.vertices instanceof Float32Array==!1&&console.error("Vertices must be of type Float32Array"),b.indices&&b.indices instanceof Uint16Array==!1&&console.error("Indices must be of type Uint16Array"),this.gl=a,this.vertexBuffer=a.createBuffer(),this.vertices=b.vertices,this.indexBuffer=null,this.indices=b.indices,b.primitiveType===d.PrimitiveType.Triangles?this.primitiveType=a.TRIANGLES:b.primitiveType===d.PrimitiveType.Lines?this.primitiveType=a.LINES:b.primitiveType===d.PrimitiveType.LineStrip?this.primitiveType=a.LINE_STRIP:b.primitiveType===d.PrimitiveType.TriangleFan?this.primitiveType=a.TRIANGLE_FAN:this.primitiveType=a.TRIANGLE_STRIP,this.vertexDataDirty=!0}d.prototype.bind=function(a,b){var c=this.gl;this.numComponentsPerVertex=b,c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer);var d,e=0;for(d=c.numVertexAttribsEnabled;d<a.length;++d)c.enableVertexAttribArray(d);for(d=a.length;d<c.numVertexAttribsEnabled;++d)c.disableVertexAttribArray(d);for(c.numVertexAttribsEnabled=a.length,d=0;d<a.length;++d){var f=a[d];c.vertexAttribPointer(d,f.numComponents,c.FLOAT,!1,4*b,4*e),e+=f.numComponents}null===this.indexBuffer&&this.indices&&this.indices.length>0&&(this.indexBuffer=c.createBuffer()),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer)},d.prototype.syncVertexData=function(){var a=this.gl;this.vertexDataDirty&&(this.indices&&this.indices.length>0&&a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),a.bufferData(a.ARRAY_BUFFER,this.vertices,a.STREAM_DRAW),this.vertexDataDirty=!1)},d.prototype.draw=function(){this.syncVertexData();var a=this.gl,b=0;this.indexBuffer?a.drawElements(this.primitiveType,this.indices.length,a.UNSIGNED_SHORT,0):(b=this.vertices.length/this.numComponentsPerVertex,a.drawArrays(this.primitiveType,0,b))},d.prototype.drawVertexRange=function(a,b){this.syncVertexData();var c=this.gl;this.indexBuffer?c.drawElements(this.primitiveType,b,c.UNSIGNED_SHORT,2*a):c.drawArrays(this.primitiveType,a,b)},d.prototype.dispose=function(){this.gl.deleteBuffer(this.vertexBuffer),this.indexBuffer&&this.gl.deleteBuffer(this.indexBuffer)},d.PrimitiveType={TriangleStrip:0,Triangles:1,Lines:2,LineStrip:3,TriangleFan:4},b.exports=d},{}],324:[function(a,b,c){"use strict";function d(a){this.width=0,this.height=0,this.mesh=a.createMesh({vertices:new Float32Array(0),indices:new Uint16Array(0),primitiveType:e.PrimitiveType.TriangleStrip})}var e=a("./mesh");d.createShader=function(a){var b=["uniform mat4 u_projection;","uniform mat4 u_view;","uniform mat4 u_world;","uniform mediump vec4 u_srcRect;","uniform lowp float u_flipTexCoordY;","attribute vec2 a_position;","attribute vec2 a_uv;","attribute float a_blur;","varying mediump vec2 uv;","varying lowp float blur;","void main(void) {","   gl_Position = u_projection * u_view * u_world * vec4(a_position, 0.0, 1.0);","   uv = u_srcRect.xy + a_uv * (u_srcRect.zw - u_srcRect.xy);","   if(u_flipTexCoordY > 0.0) { uv.y = 1.0 - uv.y; }","   blur = a_blur;","}"].join("\n"),c=["uniform sampler2D texture;","uniform lowp vec3 u_color;","uniform lowp float u_opacity;","varying mediump vec2 uv;","varying lowp float blur;","void main(void) {","   lowp float intensity = smoothstep(0.0, 1.0, blur);","   gl_FragColor = texture2D(texture, uv)*vec4(u_color,1.0)*(u_opacity*intensity);","}"].join("\n");return a.createShader({vertexSource:b,fragmentSource:c})},d.prototype._generateMesh=function(){function a(a){return(a.numSegments+1)*s}function b(){var b=0;return k.forEach(function(c){b+=a(c)*p}),b}function c(){var a=0;k.forEach(function(b){a+=b.numSegments});var b=4,c=6,d=5,e=c*b+d,f=6;return a*f+e}function d(a,b,c,d,e){for(var f=b.radius+n,g=r/b.numSegments,h=0;h<=b.numSegments;++h){var i=Math.cos(e+h*g),j=Math.sin(e+h*g);a[o++]=c,a[o++]=d,a[o++]=a[o-3]/l,a[o++]=a[o-3]/m,a[o++]=1,a[o++]=c+b.radius*i,a[o++]=d-b.radius*j,a[o++]=a[o-3]/l,a[o++]=a[o-3]/m,a[o++]=1,a[o++]=c+f*i,a[o++]=d-f*j,a[o++]=a[o-3]/l,a[o++]=a[o-3]/m,a[o++]=0}}function e(a){d(a,k[0],k[0].radius,k[0].radius,Math.PI/2),d(a,k[1],k[1].radius,m-k[1].radius,Math.PI),d(a,k[2],l-k[2].radius,m-k[2].radius,3*Math.PI/2),d(a,k[3],l-k[3].radius,k[3].radius,0)}function f(a,b,c){for(var d=c.startFromVertexIndex,e=c.startFromInnerEdge===!0?0:1,f=0;f<b.numSegments;++f){var g;if(f%2===e){for(g=0;g<s;++g)a[o++]=f*s+g+d,a[o++]=(f+1)*s+g+d;c.startFromInnerEdge=!1}else{for(g=0;g<s;++g)a[o++]=f*s+(s-1)-g+d,a[o++]=(f+1)*s+(s-1)-g+d;c.startFromInnerEdge=!0}}c.startFromVertexIndex=a[o-1]}function g(a,b){var c,d,e=t/p;b.startFromInnerEdge===!0?(c=b.startFromVertexIndex+s,d=b.startFromVertexIndex,a[o++]=d,a[o++]=c%e,a[o++]=d+1,a[o++]=(c+1)%e,a[o++]=d+2,a[o++]=(c+2)%e,b.startFromInnerEdge=!1):b.startFromInnerEdge===!1&&(c=b.startFromVertexIndex+1,d=b.startFromVertexIndex,a[o++]=d,a[o++]=(c+2)%e,a[o++]=d-1,a[o++]=(c+1)%e,a[o++]=d-2,a[o++]=c%e,b.startFromInnerEdge=!0),b.startFromVertexIndex=c}function h(b){var c=[a(k[0]),a(k[1]),a(k[2]),a(k[3])];b[o++]=0,b[o++]=0,b[o++]=c[0]+c[1]+c[2],b[o++]=c[0],b[o++]=c[0]+c[1]}function i(a){var b={startFromInnerEdge:!0,startFromVertexIndex:0};o=0,f(a,k[0],b),g(a,b),f(a,k[1],b),g(a,b),f(a,k[2],b),g(a,b),f(a,k[3],b),g(a,b),h(a)}function j(){k.forEach(function(a){if(0===a.radius)a.numSegments=1;else{var b=1-q/(a.radius+n),c=Math.acos(2*b*b-1);a.numSegments=Math.ceil(r/c)}})}var k=this.corners,l=this.width,m=this.height,n=this.blurDistance,o=0,p=5,q=.2,r=Math.PI/2,s=3;j();var t=b();void 0!==this.vertices&&this.vertices.length===t||(this.vertices=new Float32Array(t)),e(this.vertices);var u=c();void 0!==this.indices&&this.indices.length===u||(this.indices=new Uint16Array(u)),i(this.indices),this.mesh.vertices=this.vertices,this.mesh.indices=this.indices,this.mesh.vertexDataDirty=!0},d.prototype.setCornerRadius=function(a){a=Math.max(0,a),this.corners&&this.corners[0].radius===a&&this.corners[1].radius===a&&this.corners[2].radius===a&&this.corners[3].radius===a||(a=Math.max(1,a),this.corners=[{radius:a},{radius:a},{radius:a},{radius:a}],this.meshDirty=!0)},d.prototype.setIndividualCornerRadii=function(a,b,c,d){this.corners=[{radius:Math.max(0,a)},{radius:Math.max(0,b)},{radius:Math.max(0,c)},{radius:Math.max(0,d)}],this.meshDirty=!0},d.prototype.updateMesh=function(){this.meshDirty!==!1&&(this._generateMesh(),this.meshDirty=!1)},d.cornerTooSmall=function(a,b){var c=.1;return a+b<c},d.prototype.setBlur=function(a){this.blurDistance!==a&&(this.blurDistance=a,this.meshDirty=!0)},d.prototype.setWidth=function(a){this.width!==a&&(this.width=a,this.meshDirty=!0)},d.prototype.setHeight=function(a){this.height!==a&&(this.height=a,this.meshDirty=!0)},d.prototype.setBlur=function(a){this.blurDistance!==a&&(this.blurDistance=a,this.meshDirty=!0)},d.prototype.dispose=function(){this.mesh.dispose()},d.prototype.getMesh=function(){return this.mesh},b.exports=d},{"./mesh":323}],325:[function(a,b,c){"use strict";function d(a,b,c){var d=a.createShader(c);if(a.shaderSource(d,b),a.compileShader(d),!a.getShaderParameter(d,a.COMPILE_STATUS))throw new Error("An error occurred compiling a shader: "+a.getShaderInfoLog(d));return d}function e(a,b){var c=1;switch(b.type){case"float":c=1;break;case"vec2":c=2;break;case"vec3":c=3;break;case"vec4":c=4}return{name:b.name,numComponents:c}}function f(a,b){var c,d=[],e=new RegExp(b+"\\s*([^;]*)","g");do if(c=e.exec(a)){var f=c[1].split(" ");3===f.length&&f.splice(0,1),d.push({type:f[0],name:f[1]})}while(c);return d}function g(a,b,c){var d,e=f(c,"attribute"),g=a.getProgramParameter(b,a.ACTIVE_ATTRIBUTES),h={};for(d=0;d<g;++d)h[a.getActiveAttrib(b,d).name]=!0;for(d=0;d<e.length;)h[e[d].name]!==!0?e.splice(d,1):d++;return e}function h(a,b){function c(a){a.forEach(function(a){d.some(function(b){return b.name===a.name})===!1&&d.push(a)})}var d=[];return c(f(a,"uniform")),c(f(b,"uniform")),d}function i(a){switch(a){case"float":return 0;case"vec2":return[0,0];case"vec3":return[0,0,0];case"vec4":return[0,0,0,0]}return 0}function j(a,b,c){function d(d,e,f){Object.defineProperty(d,e,{set:function(d){null===c.value&&(c.value=i(b)),c.value[f]=d,a.hasDirtyUniforms=!0},get:function(){return c.value[f]}})}for(var e=Number(b[b.length-1]),f={},g=0;g<e;g++)for(var h=0;h<m[g].length;h++)d(f,m[g][h],g);return Object.defineProperty(f,"array",{get:function(){return c.value},set:function(a){if(a.length!==e)throw new Error("Uniform array: Array must be of size "+e);c.value=a}}),Object.freeze(f)}function k(a,b){if(!b.vertexSource)throw new Error("No vertex shader source");if(!b.fragmentSource)throw new Error("No fragment shader source");if(b.uniforms&&Array.isArray(b.uniforms))throw new Error("WebGLShader: old style uniforms is unsupported");this.program=a.createProgram(),this.attributes=[];var c=d(a,b.vertexSource,a.VERTEX_SHADER),f=b.fragmentSource+"\nvoid _haxAndroidShaderCache() { lowp float hax="+Math.random()+";}",j=d(a,f,a.FRAGMENT_SHADER);if(a.attachShader(this.program,c),a.attachShader(this.program,j),a.linkProgram(this.program),!a.getProgramParameter(this.program,a.LINK_STATUS))throw new Error("Unable to initialize the shader program.");var k=0,m=this,n=g(a,this.program,b.vertexSource);n.forEach(function(b,c){a.bindAttribLocation(m.program,c,b.name);var d=e(a,b);m.attributes.push(d),k+=d.numComponents}),a.linkProgram(this.program),this.numComponentsPerVertex=k,this.standardUniforms={},this._uniforms={};var o=h(b.vertexSource,b.fragmentSource);o.forEach(function(b){var c=a.getUniformLocation(m.program,b.name);l[b.name]?m.standardUniforms[b.name]=c:m._uniforms[b.name]={type:b.type,location:c,value:i(b.type)}}),this.uniforms=this.createUniformSetters(this._uniforms),this.uniformNames=Object.keys(this._uniforms),this.hasDirtyUniforms=!0}var l={texture:!0,u_view:!0,u_projection:!0,u_world:!0,u_opacity:!0,u_color:!0,u_srcRect:!0,u_flipTexCoordY:!0},m=[["x","r","u"],["y","g","v"],["z","b"],["w","a"]];k.prototype.createUniformSetters=function(a){var b={},c=this;return Object.keys(this._uniforms).forEach(function(d){var e=c._uniforms[d];"vec"!==e.type.substring(0,3)?Object.defineProperty(b,d,{set:function(b){a[d].value=b,c.hasDirtyUniforms=!0},get:function(){return a[d].value}}):b[d]=j(c,e.type,a[d])}),b},b.exports=k},{}],326:[function(a,b,c){"use strict";function d(a){this.webGLHelper=a,this.textureCache=new e({freelistSize:50}),this.canvas=document.createElement("canvas")}var e=a("../../resourcecache");d.prototype._createNewTextTexture=function(a,b,c){var d=this.canvas;d.width=a.width*b,d.height=a.height*b;var e=d.getContext("2d");
if(e.clearRect(0,0,d.width,d.height),e.font=a.content.fontSize*b+'px "'+a.content.fontFamily+'"',e.fillStyle=c,"text"===a.content.type)for(var f=0;f<a.content.lines.length;f++){var g=a.content.lines[f];e.fillText(g.text,g.x*b,g.y*b)}else if("textInput"===a.content.type){var h=.5*(a.height-a.content.textHeight);e.fillText(a.content.text,0,b*(h+a.content.baseline))}return this.webGLHelper.createTexture({canvas:d})},d.prototype.getTextTexture=function(a,b,c,d){var e=b+""+a.content.fontSize+a.content.fontFamily+c;return e+="text"===a.content.type?a.content.lines.map(function(a){return a.x+" "+a.text}).join(""):a.content.text,this.textureCache.isInCache(e)===!1&&this.textureCache.addResource(e,this._createNewTextTexture(a,b,c)),this.textureCache.updateReference(a.id,e),this.textureCache.getResource(e)},d.prototype.textResourceRemoved=function(a){this.textureCache.removeReference(a)},d.prototype.clear=function(){this.textureCache.clear()},b.exports=d},{"../../resourcecache":330}],327:[function(a,b,c){"use strict";function d(a,b){this.handle=0,this.size=[0,0],this.loaded=!1,this.path=null,this.target=null,this.gl=a,this.refCount=0,this.preloadedAndUnused=!1,this.keepForever=!1,this.sizeCallbacks=[],this._pixelDataChangedListeners=[],b.wrapMode=b.wrapMode||d.WrapMode.Clamp,b.filter=b.filter||d.Filter.Linear,b.pixels?this._uploadPixelData(b.pixels,b.width,b.height,b.wrapMode,b.filter):b.path instanceof Array?6==b.path.length?this._uploadCubemap(b.resourceDirectory,b.path,b.wrapMode,b.filter):console.error("Cubemap requries six image paths"):b.path&&b.domElement?this._uploadDomElement(b.domElement,b.path,b.wrapMode,b.filter):b.path?this._uploadImageData(b.resourceDirectory,b.path,b.wrapMode,b.filter):b.canvas?this._uploadCanvas(b.canvas,b.wrapMode,b.filter):b.video?this._uploadVideo(b.video,b.wrapMode,b.filter):this._uploadEmptyTexture(b.width,b.height,b.wrapMode,b.filter)}var e=0;d.prototype._uploadEmptyTexture=function(a,b,c,d){var e=this.gl;this._createAndBindHandle(e.TEXTURE_2D,c,d),e.texImage2D(this.target,0,e.RGBA,a,b,0,e.RGBA,e.UNSIGNED_BYTE,null),this._textureDataLoaded(a,b)},d.prototype._uploadPixelData=function(a,b,c,d,e){if(Array.isArray(a))a=new Uint8Array(a);else if(a instanceof Uint8Array==!1)throw new Error("pixels must be an array or Uint8Array");var f=this.gl;this._createAndBindHandle(f.TEXTURE_2D,d,e),f.bindTexture(this.target,this.handle),f.texImage2D(this.target,0,f.RGBA,b,c,0,f.RGBA,f.UNSIGNED_BYTE,a),this._textureDataLoaded(b,c)},d.prototype._uploadVideo=function(a,b,c){this.videoDOMNode=a,this._createAndBindHandle(this.gl.TEXTURE_2D,b,c)},d.prototype._uploadImageData=function(a,b,c,d){var e=this.gl;this._createAndBindHandle(e.TEXTURE_2D,c,d);var f="http"===b.substring(0,4).toLowerCase(),g=new Image;f&&(g.crossOrigin="anonymous");var h=this;g.onload=function(){e.bindTexture(h.target,h.handle),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(h.target,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this),h._textureDataLoaded(this.width,this.height)},g.src=a+b,this.path=b},d.prototype._uploadDomElement=function(a,b,c,d){if("video"===a.tagName.toLowerCase())this._uploadVideo(a,c,d);else{var e=this.gl;this._createAndBindHandle(e.TEXTURE_2D,c,d),e.bindTexture(this.target,this.handle),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(this.target,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a),this._textureDataLoaded(a.width,a.height)}this.path=b},d.prototype._uploadCubemap=function(a,b,c,d){var e=this.gl;this._createAndBindHandle(e.TEXTURE_CUBE_MAP,c,d);for(var f=[e.TEXTURE_CUBE_MAP_NEGATIVE_X,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.TEXTURE_CUBE_MAP_NEGATIVE_Z,e.TEXTURE_CUBE_MAP_POSITIVE_X,e.TEXTURE_CUBE_MAP_POSITIVE_Y,e.TEXTURE_CUBE_MAP_POSITIVE_Z],g=this,h=0;h<6;++h){var i=new Image;i.crossOrigin="anonymous",i.onload=function(a){return function(){e.bindTexture(g.target,g.handle),e.texImage2D(f[a],0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this),g._textureDataLoaded(this.width,this.height)}}(h),i.src=a+b[h]}},d.prototype._uploadCanvas=function(a,b,c){var d=this.gl;this._createAndBindHandle(d.TEXTURE_2D,b,c),d.bindTexture(this.target,this.handle),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),d.texImage2D(this.target,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,a);var e=window.devicePixelRatio||1;this._textureDataLoaded(a.width/e,a.height/e)},d.prototype.updateVideoTexture=function(){var a=this.videoDOMNode;if(a.readyState===a.HAVE_ENOUGH_DATA){var b=this.gl;b.bindTexture(this.target,this.handle),b.texImage2D(this.target,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a),this.loaded===!1&&this._textureDataLoaded(a.videoWidth,a.videoHeight),this._notifyPixleDataChangedListeners()}},d.prototype.addPixelDataChangedListener=function(a){this._pixelDataChangedListeners.push(a)},d.prototype.removePixelDataChangedListener=function(a){var b=this._pixelDataChangedListeners.indexOf(a);if(b===-1)throw new Error("Listener is not added");this._pixelDataChangedListeners.splice(b,1)},d.prototype._notifyPixleDataChangedListeners=function(){for(var a=0;a<this._pixelDataChangedListeners.length;++a)this._pixelDataChangedListeners[a].onTexturePixelDataChanged(this)},d.prototype._createAndBindHandle=function(a,b,c){var e=this.gl;this.handle=e.createTexture(),this.target=a,e.bindTexture(a,this.handle);var f;c===d.Filter.Nearest?f=e.NEAREST:c===d.Filter.Linear&&(f=e.LINEAR),e.texParameteri(a,e.TEXTURE_MAG_FILTER,f),e.texParameteri(a,e.TEXTURE_MIN_FILTER,f),b===d.WrapMode.Repeat?(e.texParameteri(a,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(a,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),this.wrapMode=b},d.prototype._textureDataLoaded=function(a,b){this.size=[a,b],this.loaded=!0,this._notifySizeCallbacks(this.size),e+=a*b*4},d.prototype._notifySizeCallbacks=function(a){if(0!==this.sizeCallbacks.length){for(var b=0;b<this.sizeCallbacks.length;++b)this.sizeCallbacks[b].callback(a);this.sizeCallbacks.length=0}},d.prototype.dispose=function(){this.gl.deleteTexture(this.handle)},d.WrapMode={Clamp:0,Repeat:1},d.Filter={Nearest:1,Linear:2},b.exports=d},{}],328:[function(a,b,c){"use strict";function d(a){this.webGLHelper=a,this.textureCache={}}d.prototype.getTexture=function(a,b){var c=this.textureCache[a];return c||(c=this.webGLHelper.createTexture({path:a,domElement:b}),this.textureCache[a]=c),c},d.prototype.flushUnused=function(){for(var a in this.textureCache){var b=this.textureCache[a];0===b.refCount&&b.preloadedAndUnused===!1&&b.keepForever===!1&&delete this.textureCache[a]}},d.prototype.evict=function(a){this.textureCache[a]?delete this.textureCache[a]:console.log("WebGLTextureCache.evict: texture doesn't exist: "+a)},d.prototype.clear=function(){this.textureCache={}},b.exports=d},{}],329:[function(a,b,c){"use strict";function d(a,b,c){this.gl=a,this.gl.numVertexAttribsEnabled=0,this.screenCameraProjection=l.create(),this.screenCameraView=l.create(),this.fieldOfView=25,this._whiteTexture=null,this.currentBlendMode=d.BlendMode.Solid,this.currentRenderTarget=0,this.currentShader=0,this.currentUniformValues=null,this.currentViewMatrix=this.screenCameraView,this.currentProjectionMatrix=this.screenCameraProjection,this.currentDepthTestState=!1,this.currentScissorTestState=!1,this.currentStencilTestState=!1,this.currentBoundMesh=null,this.maskRenderingEnabled=!1,this.currentViewport={width:0,height:0},a.disable(a.CULL_FACE),a.clearColor(0,0,0,0),a.stencilMask(255),a.clearStencil(128),this.supportsEGLImageExternal=!!a.TEXTURE_EXTERNAL_OES,this.cameraMatricesDirty=!0,this.activeTexture=0,this.setVirtualSize(b,c),this.resourceDirectory="",this._defaultVsSource=["uniform mat4 u_projection;","uniform mat4 u_view;","attribute vec3 a_position;","attribute vec2 a_uv;","attribute vec4 a_color;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","   gl_Position = u_projection * u_view * vec4(a_position, 1.0);","   uv = a_uv;","   color = a_color;","}"].join("\n"),this._defaultFsSource=["uniform sampler2D texture;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    gl_FragColor = texture2D(texture, uv)*color;","}"].join("\n"),this._videoFsSource=["#extension GL_OES_EGL_image_external : require","uniform samplerExternalOES texture;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    gl_FragColor = texture2D(texture, uv)*color;","}"].join("\n"),this._imageMaskFsSource=["uniform sampler2D texture;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    lowp vec4 tex = texture2D(texture, uv);","    if (tex.a < 0.5) {","       discard;","    }","    else {","       gl_FragColor = vec4(vec3(tex.a), 1.);","    }","}"].join("\n")}function e(a,b){var c=new window.XMLHttpRequest;c.onreadystatechange=function(){if(4===c.readyState&&200===c.status)b(c.responseText);else if(404===c.status)throw new Error("Failed to read shader file: "+a)},c.open("GET",a,!0),c.send()}function f(a,b,c){var d=g(c,"vertex"),e=g(c,"fragment"),f=b.file;b.file=void 0,b.vertexSource=d,b.fragmentSource=e;var h=a.createShader(b);void 0!==b.onCreated&&b.onCreated(h,f)}function g(a,b){function c(a,b,c,d){void 0===c&&(c=0),void 0===d&&(d=a.length);for(var e=0,f=a.indexOf(b,c);f!=-1&&f<d;)e++,f=a.indexOf(b,f+1);return e}function d(a,b){for(var c="",d=0;d<b;d++)c+=a;return c}var e,f,g="(^|\\n)\\s*\\["+b+"\\]((\\n|.)*?)(\\n\\s*\\[|$)",h=new RegExp(g);if(e=h.exec(a),null!==e){var i=e[2],j=a.indexOf(i),k=c(a,"\n",0,j),l=c(a,"\n",j+i.length);f=d("\n",k),f+=i,f+=d("\n",l)}return f}var h=a("./mesh"),i=a("./shader"),j=a("./texture"),k=a("./fbo"),l=a("../../math/mat4");d.prototype.setVirtualSize=function(a,b){this.virtualWidth=a,this.virtualHeight=b,this.calculateCamera(this.screenCameraView,this.screenCameraProjection,this.virtualWidth,this.virtualHeight)},d.prototype.setRenderBufferSize=function(a,b){this.renderWidth=a,this.renderHeight=b,this.gl.viewport(0,0,a,b),this.currentViewport.width=a,this.currentViewport.height=b},d.prototype.createShader=function(a){return void 0===a.vertexSource&&(a.vertexSource=this._defaultVsSource),void 0===a.fragmentSource&&(a.fragmentSource=this._defaultFsSource),new i(this.gl,a)},d.prototype.createShaderFromFile=function(a){if(void 0===a.file)throw new Error("createShaderFromFile: no file specified");e(a.file,f.bind(null,this,a))},d.prototype.createMesh=function(a){return new h(this.gl,a)},d.prototype.createTexture=function(a){return new j(this.gl,a)},d.prototype.createFBO=function(a){return a.texture=j(this.gl,{width:a.width,height:a.height}),new k(this.gl,a)},d.prototype.calculateCamera=function(a,b,c,d){var e=this.fieldOfView*Math.PI/180,f=.5*d/Math.tan(.5*e);l.perspective(b,e,c/d,.05*f,5*f),l.identity(a),l.translate(a,.5*-c,.5*d,-f),a[5]=-1,this.cameraMatricesDirty=!0},d.prototype.bindScreen=function(){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,null),a.viewport(0,0,this.renderWidth,this.renderHeight),this.currentViewport.width=this.renderWidth,this.currentViewport.height=this.renderHeight},d.prototype.setBlendMode=function(a){if(a!==this.currentBlendMode){var b=this.gl;this.currentBlendMode=a,this.currentBlendMode===d.BlendMode.Alpha?(b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.enable(b.BLEND)):this.currentBlendMode===d.BlendMode.Additive?(b.blendFunc(b.ONE,b.ONE),b.enable(b.BLEND)):this.currentBlendMode===d.BlendMode.Solid?b.disable(b.BLEND):this.currentBlendMode===d.BlendMode.Multiply&&(b.blendFunc(b.DST_COLOR,b.ONE_MINUS_SRC_ALPHA),b.enable(b.BLEND))}},d.prototype.setDepthTest=function(a){if(a!==this.currentDepthTestState){var b=this.gl;a?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST),this.currentDepthTestState=a}},d.prototype.setStencilTest=function(a){if(a!==this.currentStencilTestState){var b=this.gl;a?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST),this.currentStencilTestState=a}},d.prototype.setScissorTest=function(a,b){var c=this.gl;if(this.currentScissorTestState!==a&&(a?c.enable(c.SCISSOR_TEST):c.disable(c.SCISSOR_TEST),this.currentScissorTestState=a),a){var d=this.currentViewport.width/this.virtualWidth,e=this.currentViewport.height/this.virtualHeight,f=0!==this.currentRenderTarget;f&&(d=1,e=1);var g=Math.ceil(b[0]*d),h=Math.ceil(this.currentViewport.height-b[3]*e),i=Math.ceil((b[2]-b[0])*d),j=Math.ceil((b[3]-b[1])*e);c.scissor(g,h,i,j)}},d.prototype.bindFbo=function(a){var b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,a.fbo),b.viewport(0,0,a.width,a.height),this.currentViewport.width=a.width,this.currentViewport.height=a.height},d.prototype.bindRenderTarget=function(a){a!==this.currentRenderTarget&&(this.currentRenderTarget=a,0===this.currentRenderTarget||null===this.currentRenderTarget?(this.bindScreen(),this.currentViewMatrix=this.screenCameraView,this.currentProjectionMatrix=this.screenCameraProjection,this.cameraMatricesDirty=!0):(this.bindFbo(this.currentRenderTarget.fbo),this.currentViewMatrix=this.currentRenderTarget.cameraView,this.currentProjectionMatrix=this.currentRenderTarget.cameraProjection,this.cameraMatricesDirty=!0)),this.setScissorTest(!1),this.setMaskRendering(!1),this.gl.stencilMask(255),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT)},d.prototype.bindTexture=function(a,b){this.activeTexture!==a&&(this.activeTexture=a,this.gl.activeTexture(this.gl.TEXTURE0+a)),this.gl.bindTexture(b.target,b.handle)},d.prototype.bindShader=function(a,b){var c=this.gl;if(this.currentShader!==a&&(this.currentShader=a,this.currentBoundMesh=null,c.useProgram(this.currentShader.program),void 0!==a.standardUniforms.texture&&c.uniform1i(a.standardUniforms.texture,0),this.cameraMatricesDirty=!0,a.hasDirtyUniforms=!0),b!==this.currentUniformValues&&(this.currentUniformValues=b,a.hasDirtyUniforms=!0),this.currentShader.hasDirtyUniforms){for(var d=1,e=this.currentShader._uniforms,f=0,g=a.uniformNames.length;f<g;f++){var h=a.uniformNames[f],i=e[h],j=i.value;b&&b.hasOwnProperty(h)&&(j=b[h]),"float"===i.type||"f"===i.type?c.uniform1f(i.location,j):"vec2"===i.type?c.uniform2f(i.location,j[0],j[1]):"vec3"===i.type?c.uniform3f(i.location,j[0],j[1],j[2]):"vec4"===i.type?c.uniform4f(i.location,j[0],j[1],j[2],j[3]):"sampler2D"===i.type&&(this.bindTexture(d,j),c.uniform1i(i.location,d),d++)}a.hasDirtyUniforms=!1}this.cameraMatricesDirty&&(void 0!==a.standardUniforms.u_projection&&c.uniformMatrix4fv(a.standardUniforms.u_projection,!1,this.currentProjectionMatrix),void 0!==a.standardUniforms.u_view&&c.uniformMatrix4fv(a.standardUniforms.u_view,!1,this.currentViewMatrix),this.cameraMatricesDirty=!1)},d.prototype.bindMesh=function(a){this.currentBoundMesh!==a&&(a.bind(this.currentShader.attributes,this.currentShader.numComponentsPerVertex),this.currentBoundMesh=a)},d.prototype.beginFrame=function(){var a=this.gl;a.stencilMask(255),a.clear(a.STENCIL_BUFFER_BIT)},d.prototype.setMaskRendering=function(a,b){var c=this.gl;this.setStencilTest(!0),a?(this.maskRenderingEnabled===!1&&(c.colorMask(!1,!1,!1,!1),c.depthMask(!1),c.stencilFunc(c.NEVER,1,255),this.maskRenderingEnabled=!0),b?c.stencilOp(c.INCR,c.INCR,c.INCR):c.stencilOp(c.DECR,c.DECR,c.DECR)):this.maskRenderingEnabled===!0&&(c.colorMask(!0,!0,!0,!0),c.depthMask(!0),c.stencilFunc(c.LEQUAL,128,255),c.stencilOp(c.KEEP,c.KEEP,c.KEEP),this.maskRenderingEnabled=!1)},d.prototype.executeRenderCommand=function(a){var b=this.gl;this.setBlendMode(a.blendMode),this.setDepthTest(a.depthTest),this.setMaskRendering(a.writeToStencil,a.maskIsPositive),this.setScissorTest(a.scissorTest,a.scissorRect),this.bindShader(a.shader,a.shaderUniforms),this.bindTexture(0,a.texture);var c=this.currentShader.standardUniforms.u_world;void 0!==c&&a.worldTransform&&b.uniformMatrix4fv(c,!1,a.worldTransform);var d=this.currentShader.standardUniforms.u_opacity;void 0!==d&&b.uniform1f(d,a.opacity);var e=this.currentShader.standardUniforms.u_color;void 0!==e&&b.uniform3f(e,a.color[0],a.color[1],a.color[2]);var f=this.currentShader.standardUniforms.u_srcRect;void 0!==f&&b.uniform4f(f,a.srcRect[0],a.srcRect[1],a.srcRect[2],a.srcRect[3]);var g=this.currentShader.standardUniforms.u_flipTexCoordY;void 0!==g&&b.uniform1f(g,a.flipTexCoordY),this.bindMesh(a.mesh),a.vertexIndex===-1?a.mesh.draw():a.mesh.drawVertexRange(a.vertexIndex,4)},d.prototype.whiteTexture=function(){return null===this._whiteTexture&&(this._whiteTexture=this.createTexture({pixels:new Uint8Array([255,255,255,255]),width:1,height:1})),this._whiteTexture},d.prototype.setFieldOfView=function(a){this.fieldOfView=a,this.calculateCamera(this.screenCameraView,this.screenCameraProjection,this.virtualWidth,this.virtualHeight)},d.BlendMode={Alpha:0,Solid:1,Additive:2,Multiply:3},b.exports=d},{"../../math/mat4":313,"./fbo":322,"./mesh":323,"./shader":325,"./texture":327}],330:[function(a,b,c){"use strict";function d(a){a=a||{},this.cache={},this.activeReferences={},this.freelist={},this.freelistKeys=[],this.freelistMaxLength=a.freelistSize||0,this.disposeCallback=a.disposeCallback}d.prototype.isInCache=function(a){return this.cache.hasOwnProperty(a)||this.freelist.hasOwnProperty(a)},d.prototype.addResource=function(a,b){this.cache[a]={resource:b,refCount:0}},d.prototype._decreaseRefCount=function(a){var b=this.cache[a];if(b.refCount--,0===b.refCount){if(this.freelistMaxLength>0){if(this.freelistKeys.length===this.freelistMaxLength){var c=this.freelistKeys.shift();this._dispose(this.freelist[c]),delete this.freelist[c]}this.freelistKeys.push(a),this.freelist[a]=b.resource}else this._dispose(b.resource);delete this.cache[a]}},d.prototype.removeReference=function(a){if(this.activeReferences.hasOwnProperty(a)!==!1){var b=this.activeReferences[a];this._decreaseRefCount(b),delete this.activeReferences[a]}},d.prototype.updateReference=function(a,b){if(this.activeReferences[a]!==b){var c=this.activeReferences[a];if(this.freelist.hasOwnProperty(b)){this.cache[b]={resource:this.freelist[b],refCount:0},delete this.freelist[b];var d=this.freelistKeys.indexOf(b);this.freelistKeys.splice(d,1)}this.activeReferences[a]=b,this.cache[b].refCount++,c&&this._decreaseRefCount(c)}},d.prototype.getResource=function(a){return this.cache[a].resource},d.prototype.clear=function(){var a;for(a in this.cache)this._dispose(this.cache[a].resource);for(a in this.freelist)this._dispose(this.freelist[a]);this.cache={},this.freelist={},this.freelistKeys=[]},d.prototype._dispose=function(a){this.disposeCallback?this.disposeCallback(a):a.dispose&&a.dispose()},b.exports=d},{}],331:[function(a,b,c){"use strict";function d(){}function e(a){this.axis=a.axis||0,this.track=!a.hasOwnProperty("track")||a.track,this.threshold=a.threshold,this.onDragStart=a.onDragStart||d,this.onDrag=a.onDrag||d,this.onDragEnd=a.onDragEnd||d,this._startPosition=0,this._touchPosition=0,this._hasPressedDown=!1,this._isDragging=!1,this._velocity=0,this._deltaPosition=0}e.prototype=Object.create(e.prototype,{velocity:{get:function(){return this._velocity}},dragDistance:{get:function(){return this._touchPosition-this._startPosition}},dragDelta:{get:function(){return this._deltaPosition}}}),e.prototype.onTouch=function(a){if(a.isDown)this._touchPosition=a.pos[this.axis],this._hasPressedDown=!0,this._velocity=0,this._deltaPosition=0,this._startPosition=this._touchPosition;else if(a.isMove&&this._hasPressedDown){var b=a.pos[this.axis];if(this._isDragging===!1?Math.abs(b-this._touchPosition)>this.threshold&&(this._isDragging=!0,this._startPosition=b,this._touchPosition=b,this.onDragStart()):(a.deltaTime>0&&(this._velocity=(b-this._touchPosition)/a.deltaTime),this._touchPosition=b,this._deltaPosition=a.delta[this.axis],this.onDrag()),this._isDragging&&this.track)return"StartTracking"}else(a.isUp||a.isExit)&&this._isDragging&&(this._isDragging=!1,this._hasPressedDown=!1,this._deltaPosition=0,this.onDragEnd())},b.exports=e},{}],332:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f=1-e;return f*f*f*a+3*f*f*e*b+3*f*e*e*c+e*e*e*d}function e(a,b){this.axis=b.axis,this.scrollCallback=b.scrollCallback,this.scrollThreshold=b.scrollThreshold,this.shouldRubber=void 0===b.shouldRubber||b.shouldRubber,this.scrollSpeed=void 0!==b.scrollSpeed?b.scrollSpeed:1,this.scrollEndedAnimationDuration=b.scrollEndedAnimationDuration||300,this.scrollEndedPositionCallback=b.scrollEndedPositionCallback,this.trackId=-1,this.animation=null,this.speed=0,this.timerScheduler=a,this.scrollObjectSize=1,this.scrollViewSize=1,this.rubberLength=4}e.prototype.onTouch=function(a,b){if(this.trackId===-1||b.id===this.trackId){var c=0,e=this.axis,f=!0;if(b.isDown||b.isEnter)this.hasMoved=!1,this.downStartPos=b.pos[e],this.animation&&this.animation.stop(),this.speed=0;else if(b.isMove&&(this.hasMoved||Math.abs(b.pos[e]-this.downStartPos)>this.scrollThreshold)){this.hasMoved=!0;var g=0,h=a+b.delta[e],i=Math.min(0,-this.scrollObjectSize+this.scrollViewSize);if(h>0?g=h:h<i&&(g=i-h),g>0&&this.shouldRubber){var j=Math.max(0,1-g/this.scrollViewSize*this.rubberLength);c=b.delta[e]*j}else h>0?(c=-a,this.shouldRubber===!1&&(f=!1)):h<i?(c=i-a,this.shouldRubber===!1&&(f=!1)):c=b.delta[e];b.deltaTime>0&&(this.speed=b.delta[this.axis]/b.deltaTime),0!==c&&(a+=c,this.scrollCallback(a,c))}else if((b.isUp||b.isExit)&&this.hasMoved===!0){this.hasMoved=!1;var k=this.scrollEndedAnimationDuration,l=a+this.speed*k/3,m=a+this.speed*k/3,n=Math.min(0,this.scrollViewSize-this.scrollObjectSize);l>0?(l=0,m=0):l<n&&(l=n,m=l),l=this.scrollEndedPositionCallback(this.speed,l),this.shouldRubber===!1&&(m=l);var o=this.scrollCallback,p=this.onScrollEnded;this.animation=this.timerScheduler.createTimer({duration:k,p0:a,p1:m,p2:l,p3:l,onRunning:function(a){o(d(this.p0,this.p1,this.p2,this.p3,a))},onFinish:function(){p&&p()}}).start()}return this.hasMoved&&f?(this.trackId=b.id,"StartTracking"):void(this.trackId=-1)}},e.prototype.setOrientation=function(a){this.axis="horizontal"===a?0:1},b.exports=e},{}],333:[function(a,b,c){"use strict";function d(a,b){this.scrollThreshold=a,this.startPos=[0,0],this.hasReceivedDownEvent=!1,this.callback=b}d.prototype.onTouch=function(a,b){if(b.isDown)this.startPos[0]=b.pos[0],this.startPos[1]=b.pos[1],this.hasReceivedDownEvent=!0;else if(b.isMove)(Math.abs(b.pos[0]-this.startPos[0])>this.scrollThreshold||Math.abs(b.pos[1]-this.startPos[1])>this.scrollThreshold)&&(this.hasReceivedDownEvent=!1);else if(b.isUp&&this.hasReceivedDownEvent===!0)return this.callback(a,b),this.hasReceivedDownEvent=!1,"StopPropagation"},b.exports=d},{}],334:[function(a,b,c){"use strict";function d(){this.trackedControls=[],this.lastTouch=[],this.prevIntersectedControlsDepthLayers={},this.hoverState={prevIntersectedControlsDepthLayers:{},lastHover:{}},this.depthIndices=[],this.numDepthIndices=0,this.focusedControl=null}function e(a,b){return a-b}function f(a){for(var b=0,c=a.length;b<c;++b)null!==a[b].onTouch&&a[b].onTouch(p)}function g(a){for(var b=0,c=a.length;b<c;++b)null!==a[b].onHover&&a[b].onHover(r)}function h(a,b){return n.isPointInside(a.childAABB||a.screenAABB,b)}function i(a,b){return n.isPointInside(a.screenAABB,b)}function j(a,b,c,d){if(d=void 0===a.depth?d:a.depth,a.touchPropagation&&a.visible&&a.opacity>0&&h(a,b.pos)){(a.onTouch||a.blockTouch)&&i(a,b.pos)&&(a.blockTouch&&(c[d]=[],s=Math.max(s,d)),a.onTouch&&(void 0===c[d]&&(c[d]=[]),c[d].push(a)));var e=a.children;if(e)for(var f=0,g=e.length;f<g;f++)j(e[f],b,c,d)}}function k(a,b,c,d){if(d=void 0===a.depth?d:a.depth,a.touchPropagation&&a.visible&&a.opacity>0&&h(a,b.pos)){(a.onHover||a.blockTouch)&&i(a,b.pos)&&(a.blockTouch&&(c[d]=[],s=Math.max(s,d)),a.onHover&&(void 0===c[d]&&(c[d]=[a]),c[d].push(a)));var e=a.children;if(e)for(var f=0,g=e.length;f<g;f++)k(e[f],b,c,d)}}function l(a,b,c,d){if(d=void 0===a.depth?d:a.depth,a.visible&&a.opacity>0&&h(a,b)){(a.onTouch||a.blockTouch)&&i(a,b)&&(void 0===c[d]&&(c[d]=[]),c[d].push(a));var e=a.children;if(e)for(var f=0,g=e.length;f<g;f++)l(e[f],b,c,d)}}function m(){return{pos:[0,0],delta:[0,0],deltaTime:0,type:"isMove",isMove:!1,isUp:!1,isDown:!1,isEnter:!1,isExit:!1,id:0}}var n=a("../math/aabb"),o=m();o.type="isEnter",o.isEnter=!0;var p=m();p.type="isExit",p.isExit=!0;var q=m();q.type="isHoverEnter",q.isHoverEnter=!0;var r=m();r.type="isHoverExit",r.isHoverExit=!0,d.prototype.processTouchEvent=function(a,b){var c=b.id,d=this.lastTouch[c];d||(this.lastTouch[c]={pos:[0,0],time:0},d=this.lastTouch[c]),b.isMove&&(b.delta[0]=b.pos[0]-d.pos[0],b.delta[1]=b.pos[1]-d.pos[1],b.deltaTime=b.time-d.time),d.time=b.time,d.pos[0]=b.pos[0],d.pos[1]=b.pos[1];var g={0:[]};this.trackedControls[b.id]?g[0].push(this.trackedControls[b.id]):(s=-1e7,j(a,b,g,void 0===a.depth?0:a.depth)),o.id=b.id,o.pos[0]=b.pos[0],o.pos[1]=b.pos[1],o.delta[0]=b.delta[0],o.delta[1]=b.delta[1],o.deltaTime=b.deltaTime,o.force=b.force,o.domEvent=b.domEvent,p.id=b.id,p.pos[0]=b.pos[0],p.pos[1]=b.pos[1],p.delta[0]=b.delta[0],p.delta[1]=b.delta[1],p.deltaTime=b.deltaTime,p.force=0,p.domEvent=b.domEvent;var h,i,k,l,m,n,q=!0;this.numDepthIndices=0;for(n in g)n>=s&&(this.depthIndices[this.numDepthIndices++]=n);for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),l=this.numDepthIndices-1;l>=0&&q;--l)for(k=this.depthIndices[l],m=g[k],h=m.length-1;h>=0;--h){var r=m[h],t=!1;for(i in this.prevIntersectedControlsDepthLayers){var u=this.prevIntersectedControlsDepthLayers[i].indexOf(r);if(u!==-1){t=!0,this.prevIntersectedControlsDepthLayers[i].splice(u,1);break}}t===!1&&(r.onTouch(o),this.focusedControl&&r!==this.focusedControl&&(this.focusedControl.blur(),this.focusedControl=null));var v=r.onTouch(b);if("StartTracking"===v){this.trackedControls[b.id]=r,q=!1;break}if(this.trackedControls[b.id]=null,"StopPropagation"===v){q=!1;break}void 0!==v&&console.log("unknown return value from from onTouch "+v)}if(b.isUp){for(l=this.numDepthIndices-1;l>=0;--l)k=this.depthIndices[l],m=g[k],f(m);this.prevIntersectedControlsDepthLayers={}}else{this.numDepthIndices=0;for(n in this.prevIntersectedControlsDepthLayers)this.depthIndices[this.numDepthIndices++]=n;for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),l=this.numDepthIndices-1;l>=0;--l)k=this.depthIndices[l],m=this.prevIntersectedControlsDepthLayers[k],f(m);this.prevIntersectedControlsDepthLayers=g}},d.prototype.processHoverEvent=function(a,b){var c=(b.id,{0:[]});s=-1e7,k(a,b,c,void 0===a.depth?0:a.depth),q.id=b.id,q.pos[0]=b.pos[0],q.pos[1]=b.pos[1],q.delta[0]=b.delta[0],q.delta[1]=b.delta[1],q.deltaTime=b.deltaTime,q.domEvent=b.domEvent,r.id=b.id,r.pos[0]=b.pos[0],r.pos[1]=b.pos[1],r.delta[0]=b.delta[0],r.delta[1]=b.delta[1],r.deltaTime=b.deltaTime,r.domEvent=b.domEvent;var d,f,h,i,j,l,m=!0;this.numDepthIndices=0;for(l in c)l>=s&&(this.depthIndices[this.numDepthIndices++]=l);for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),i=this.numDepthIndices-1;i>=0&&m;--i)for(h=this.depthIndices[i],j=c[h],d=j.length-1;d>=0;--d){var n=j[d],o=!1;for(f in this.hoverState.prevIntersectedControlsDepthLayers){var p=this.hoverState.prevIntersectedControlsDepthLayers[f].indexOf(n);if(p!==-1){o=!0,this.hoverState.prevIntersectedControlsDepthLayers[f].splice(p,1);break}}o===!1&&n.onHover(q);var t=n.onHover(b);if("StopPropagation"===t){m=!1;break}void 0!==t&&console.log("unknown return value from from onhoverEvent "+t)}this.numDepthIndices=0;for(l in this.hoverState.prevIntersectedControlsDepthLayers)this.depthIndices[this.numDepthIndices++]=l;for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),i=this.numDepthIndices-1;i>=0;--i)h=this.depthIndices[i],j=this.hoverState.prevIntersectedControlsDepthLayers[h],g(j);this.hoverState.prevIntersectedControlsDepthLayers=c},d.prototype.handleTouchEvent=function(a,b){var c=m();c.pos[0]=b.x,c.pos[1]=b.y,c.delta[0]=0,c.delta[1]=0,c.time=b.timestamp,c[c.type]=!1,c.type=b.type,c[b.type]=!0,c.id=b.id,c.force=b.force,c.domEvent=b.domEvent,this.processTouchEvent(a,c)},d.prototype.handleHoverEvent=function(a,b){var c=m();c.pos[0]=b.x,c.pos[1]=b.y,c.delta[0]=0,c.delta[1]=0,c.time=b.timestamp,c[c.type]=!1,c.type=b.type,c[b.type]=!0,c.id=b.id,c.force=0,c.domEvent=b.domEvent,this.processHoverEvent(a,c)},d.prototype.setFocus=function(a){return a.blur?void(this.focusedControl=a):void console.error("Can't set focus on a control that can't be blurred")};var s;d.prototype.hitTest=function(a,b){var c={};return l(a,b,c,0),c},b.exports=d},{"../math/aabb":311}],335:[function(a,b,c){"use strict";function d(){e.call(this),this.mouseDown=!1,this.lastTouch=[];var a=this;this.onMouseMove=function(b){b.preventDefault(),a.mouseDown===!0&&a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),0,b.timeStamp,"isMove",b),a.emitHoverEvent(0,a.getTouchX(b),a.getTouchY(b),b.timeStamp,"isHoverMove",b)},this.onTouchMove=function(b){a.onTouchEvent(b,"isMove")},this.onTouchLeave=function(b){a.onTouchEvent(b,"isUp")},this.onTouchEnd=function(b){a.onTouchEvent(b,"isUp")},this.onMouseUp=function(b){0===b.button&&(b.preventDefault(),a.mouseDown=!1,a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),b.force,b.timeStamp,"isUp",b))},this.onMouseOut=function(b){b.preventDefault(),a.mouseDown&&(a.mouseDown=!1,a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),b.force,b.timeStamp,"isUp",b)),a.emitHoverEvent(0,a.getTouchX(b),a.getTouchY(b),b.timeStamp,"isHoverMove",b)},this.onTouchStart=function(b){a.onTouchEvent(b,"isDown")},this.onMouseDown=function(b){0===b.button&&(b.preventDefault(),a.mouseDown=!0,a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),b.force,b.timeStamp,"isDown",b))}}var e=a("../../eventsender");d.prototype=Object.create(e.prototype),d.prototype.setDOMElement=function(a){this.domElement=a,a.style.pointerEvents="auto",this.setTouchEnabled(!0)},d.prototype.setTouchEnabled=function(a){var b=this.domElement;b&&(a?(b.addEventListener("mousemove",this.onMouseMove,!1),b.addEventListener("touchmove",this.onTouchMove,!1),b.addEventListener("touchleave",this.onTouchLeave,!1),b.addEventListener("touchend",this.onTouchEnd,!1),b.addEventListener("mouseup",this.onMouseUp,!1),b.addEventListener("mouseout",this.onMouseOut,!1),b.addEventListener("touchstart",this.onTouchStart,!1),b.addEventListener("mousedown",this.onMouseDown,!1)):(b.removeEventListener("mousemove",this.onMouseMove),b.removeEventListener("touchmove",this.onTouchMove),b.removeEventListener("touchleave",this.onTouchLeave),b.removeEventListener("touchend",this.onTouchEnd),b.removeEventListener("mouseup",this.onMouseUp),b.removeEventListener("mouseout",this.onMouseOut),b.removeEventListener("touchstart",this.onTouchStart),b.removeEventListener("mousedown",this.onMouseDown)))},d.prototype.onTouchEvent=function(a,b){a.preventDefault();for(var c=0;c<a.changedTouches.length;++c){var d=a.changedTouches[c];this.emitEvent(d.identifier,this.getTouchX(d),this.getTouchY(d),d.force,a.timeStamp,b,a)}},d.prototype.emitEvent=function(a,b,c,d,e,f,g){this.emit("touchEvent",{id:a,x:b,y:c,force:d,timestamp:e,type:f,domEvent:g})},d.prototype.emitHoverEvent=function(a,b,c,d,e,f){this.emit("hoverEvent",{id:a,x:b,y:c,timestamp:d,type:e,domEvent:f})},d.prototype.getTouchX=function(a){var b=this.domElement.getBoundingClientRect(),c=b.right-b.left,d=a.pageX-b.left;return d/c},d.prototype.getTouchY=function(a){var b=this.domElement.getBoundingClientRect(),c=b.bottom-b.top,d=a.pageY-b.top;return d/c},b.exports=d},{"../../eventsender":200}],336:[function(a,b,c){"use strict";function d(a,b){i.call(this),this.timerScheduler=a,this.eventSender=new i,this.layouter=new f,this.imageCache=new v,this.renderer=new e(b);var c=this;this.renderer.on("requestFrame",function(){c.eventSender.emit("requestFrame")}),this.root=this.createDockLayoutControl(),this.root.setSizeMode("explicit"),this.root.setWidthUnit("px"),this.root.setHeightUnit("px"),this.touchEngine=new g,this.touchListener=new h,this.touchListener.on("touchEvent",this.handleTouchEvent.bind(this),this),this.touchListener.on("hoverEvent",this.handleHoverEvent.bind(this),this),this.fillMode="aspectFit",this.setAspectFitViewport(1080,1920),this.root.setContentDirty=function(a){k.prototype.setContentDirty(a),a&&c.eventSender.emit("requestFrame")},window.addEventListener("resize",function(){c._resizeViewport(),c.eventSender.emit("requestFrame");
}),this.rendererSet=!1}var e=a("./renderer"),f=a("./layout/layouter"),g=a("./touch/touchengine"),h=a("./touch/touchlistener"),i=a("../eventsender"),j=a("./controls/circlecontrol"),k=a("./controls/docklayoutcontrol"),l=a("./controls/flowlayoutcontrol"),m=a("./controls/imagecontrol"),n=a("./controls/rectanglecontrol"),o=a("./controls/scrollviewcontrol"),p=a("./controls/stacklayoutcontrol"),q=a("./controls/textcontrol"),r=a("./controls/textinputcontrol"),s=a("./controls/meshcontrol"),t=a("./touch/taphandler"),u=a("./touch/draggesturerecognizer"),v=a("./imagecache");d.prototype=Object.create(i.prototype),d.prototype.constructor=d,d.prototype._addListenersToControl=function(a){a.on("disposed",this.renderer.onControlDisposed.bind(this.renderer))},d.prototype.createCircleControl=function(){var a=new j(this.layouter,this.imageCache);return this._addListenersToControl(a),a},d.prototype.createDockLayoutControl=function(){var a=new k(this.layouter);return a},d.prototype.createFlowLayoutControl=function(){return new l(this.layouter)},d.prototype.createImageControl=function(){var a=new m(this.layouter,this.imageCache);return this._addListenersToControl(a.innerControl),a},d.prototype.createRectangleControl=function(){var a=new n(this.layouter);return this._addListenersToControl(a),a},d.prototype.createScrollViewControl=function(){return new o(this.layouter,this.timerScheduler)},d.prototype.createStackLayoutControl=function(){return new p(this.layouter)},d.prototype.createTextControl=function(){var a=new q(this.layouter);return this._addListenersToControl(a.innerControl),a},d.prototype.createTextInputControl=function(){var a=new r(this.layouter);this._addListenersToControl(a);var b=this.renderer.createTextInputField(a.id);return b&&a.setInputField(b),a.on("focused",this.touchEngine.setFocus.bind(this.touchEngine)),a},d.prototype.createMeshControl=function(){var a=new s(this.layouter,this.imageCache);return this._addListenersToControl(a),a},d.prototype.createTapHandler=function(a){return new t(50,a)},d.prototype.createDragGestureRecognizer=function(a){return new u(a)},d.prototype.setAspectFitViewport=function(a,b){this.aspectFillViewportSize={width:a,height:b},this._resizeViewport()},d.prototype._resizeViewport=function(){var a,b;if("aspectFit"===this.fillMode)a=this.aspectFillViewportSize.width,b=this.aspectFillViewportSize.height;else{var c=this.renderer.rootElement.getBoundingClientRect();a=c.width,b=c.height}this._setViewportSize(a,b)},d.prototype._setViewportSize=function(a,b){this.renderer.setViewportSize(a,b),this.layouter.setWindowSize(a,b),this.root.setWidth(a),this.root.setHeight(b),this.root.screenAABB.max[0]=a,this.root.screenAABB.max[1]=b,this.root.childAABB.max[0]=a,this.root.childAABB.max[1]=b,this.emit("viewportSizeChanged",{width:a,height:b})},d.prototype.layout=function(){if(this.layouter.layout(this.root),this.root.contentDirty){this.renderer.beginLayout();for(var a=0;a<this.root.children.length;a++)this.renderer.layout(this.root.children[a],!1)}},d.prototype.renderFrame=function(){this.renderer.beginFrame(),this.renderer.render(this.root),this.renderer.endFrame()},d.prototype.handleTouchEvent=function(a){a.x*=this.renderer.viewportWidth,a.y*=this.renderer.viewportHeight,this.emit("touchEvent",a),this.touchEngine.handleTouchEvent(this.root,a)},d.prototype.handleHoverEvent=function(a){a.x*=this.renderer.viewportWidth,a.y*=this.renderer.viewportHeight,this.emit("hoverEvent",a),this.touchEngine.handleHoverEvent(this.root,a)},d.prototype.removeAllRenderers=function(){this.rendererSet=!1,this.renderer.removeAllRenderers()},d.prototype.addRenderer=function(a){this.rendererSet===!1&&a.rootElement&&(this.touchListener.setDOMElement(a.rootElement),this.rendererSet=!0),this.renderer.addRenderer(a)},d.prototype.setFillMode=function(a){this.fillMode=a,this.renderer.setFillMode(a),this._resizeViewport()},d.prototype.hitTest=function(a,b){return this.touchEngine.hitTest(this.root,[a,b])},d.prototype.captureScreenShot=function(a,b){return this.renderer.captureScreenShot(this.root,a,b)},d.prototype.getViewportSize=function(){return{width:this.renderer.viewportWidth,height:this.renderer.viewportHeight}},d.prototype.clearImageCache=function(){this.imageCache.clear(),this.renderer.clearImageCaches()},b.exports=d},{"../eventsender":200,"./controls/circlecontrol":289,"./controls/docklayoutcontrol":290,"./controls/flowlayoutcontrol":291,"./controls/imagecontrol":293,"./controls/meshcontrol":295,"./controls/rectanglecontrol":296,"./controls/scrollviewcontrol":297,"./controls/stacklayoutcontrol":298,"./controls/textcontrol":301,"./controls/textinputcontrol":302,"./imagecache":304,"./layout/layouter":307,"./renderer":314,"./touch/draggesturerecognizer":331,"./touch/taphandler":333,"./touch/touchengine":334,"./touch/touchlistener":335}],337:[function(a,b,c){"use strict";var d={Windows:function(){return/IEMobile/i.test(navigator.userAgent)},Android:function(){return/Android/i.test(navigator.userAgent)},BlackBerry:function(){return/BlackBerry/i.test(navigator.userAgent)},iOS:function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)},any:function(){return d.Android()||d.BlackBerry()||d.iOS()||d.Windows()}};b.exports={isMobile:d}},{}]},{},[195])(195)});